{"meta":{"version":1,"warehouse":"4.0.2"},"models":{"Asset":[{"_id":"source/imgs/image-20230913154437526.png","path":"imgs/image-20230913154437526.png","modified":0,"renderable":0},{"_id":"source/imgs/image-20230913154510439.png","path":"imgs/image-20230913154510439.png","modified":0,"renderable":0},{"_id":"source/imgs/image-20230913154524492.png","path":"imgs/image-20230913154524492.png","modified":0,"renderable":0},{"_id":"source/imgs/image-20230913154559571.png","path":"imgs/image-20230913154559571.png","modified":0,"renderable":0},{"_id":"source/imgs/image-20230913161638961.png","path":"imgs/image-20230913161638961.png","modified":0,"renderable":0},{"_id":"source/imgs/image-20230913161842174.png","path":"imgs/image-20230913161842174.png","modified":0,"renderable":0},{"_id":"themes/3-hexo/source/css/mobile.styl","path":"css/mobile.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/gitalk.css","path":"css/gitalk.css","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/style.styl","path":"css/style.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/img/alipay.jpg","path":"img/alipay.jpg","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/img/article-list-background.jpeg","path":"img/article-list-background.jpeg","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/img/avatar.jpg","path":"img/avatar.jpg","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/img/school-book.png","path":"img/school-book.png","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/img/brown-papersq.png","path":"img/brown-papersq.png","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/img/gov.png","path":"img/gov.png","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/img/weixin.jpg","path":"img/weixin.jpg","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/js/gitalk.js","path":"js/gitalk.js","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/js/gitment.js","path":"js/gitment.js","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/js/iconfont.js","path":"js/iconfont.js","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/js/jquery.pjax.js","path":"js/jquery.pjax.js","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/js/script.js","path":"js/script.js","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/js/search.js","path":"js/search.js","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/js/titleTip.js","path":"js/titleTip.js","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/atom-dark.styl","path":"css/hl_theme/atom-dark.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/atom-light.styl","path":"css/hl_theme/atom-light.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/brown-paper.styl","path":"css/hl_theme/brown-paper.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/github-gist.styl","path":"css/hl_theme/github-gist.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/github.styl","path":"css/hl_theme/github.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/darcula.styl","path":"css/hl_theme/darcula.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/gruvbox-dark.styl","path":"css/hl_theme/gruvbox-dark.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/kimbie-dark.styl","path":"css/hl_theme/kimbie-dark.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/gruvbox-light.styl","path":"css/hl_theme/gruvbox-light.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/kimbie-light.styl","path":"css/hl_theme/kimbie-light.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/railscasts.styl","path":"css/hl_theme/railscasts.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/rainbow.styl","path":"css/hl_theme/rainbow.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/school-book.styl","path":"css/hl_theme/school-book.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/sublime.styl","path":"css/hl_theme/sublime.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/sunburst.styl","path":"css/hl_theme/sunburst.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/zenbum.styl","path":"css/hl_theme/zenbum.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/icomoon.eot","path":"css/fonts/icomoon.eot","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/icomoon.svg","path":"css/fonts/icomoon.svg","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/iconfont.eot","path":"css/fonts/iconfont.eot","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/icomoon.woff","path":"css/fonts/icomoon.woff","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/icomoon.ttf","path":"css/fonts/icomoon.ttf","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/iconfont.svg","path":"css/fonts/iconfont.svg","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/iconfont.ttf","path":"css/fonts/iconfont.ttf","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/iconfont.woff","path":"css/fonts/iconfont.woff","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/iconfont.woff2","path":"css/fonts/iconfont.woff2","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/selection.json","path":"css/fonts/selection.json","modified":0,"renderable":1},{"_id":"source/img/84b0b5e31bb246c0a970ace7c71a3f82.png","path":"img/84b0b5e31bb246c0a970ace7c71a3f82.png","modified":0,"renderable":0},{"_id":"source/img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_16,color_FFFFFF,t_70,g_se,x_16.png","path":"img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_16,color_FFFFFF,t_70,g_se,x_16.png","modified":0,"renderable":0},{"_id":"source/img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_18,color_FFFFFF,t_70,g_se,x_16.png","path":"img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_18,color_FFFFFF,t_70,g_se,x_16.png","modified":0,"renderable":0},{"_id":"source/imgs/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_18,color_FFFFFF,t_70,g_se,x_16-17158590663256.png","path":"imgs/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_18,color_FFFFFF,t_70,g_se,x_16-17158590663256.png","modified":0,"renderable":0},{"_id":"source/imgs/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_16,color_FFFFFF,t_70,g_se,x_16.png","path":"imgs/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_16,color_FFFFFF,t_70,g_se,x_16.png","modified":0,"renderable":0},{"_id":"source/back_posts/img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_16,color_FFFFFF,t_70,g_se,x_16.png","path":"back_posts/img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_16,color_FFFFFF,t_70,g_se,x_16.png","modified":1,"renderable":0},{"_id":"source/back_posts/img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_18,color_FFFFFF,t_70,g_se,x_16-17158590663256.png","path":"back_posts/img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_18,color_FFFFFF,t_70,g_se,x_16-17158590663256.png","modified":1,"renderable":0},{"_id":"source/back_posts/img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_18,color_FFFFFF,t_70,g_se,x_16.png","path":"back_posts/img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_18,color_FFFFFF,t_70,g_se,x_16.png","modified":1,"renderable":0}],"Cache":[{"_id":"source/_posts/00-rustå­¦ä¹ ç½‘ç«™.md","hash":"ef43232f54b328d6331469557c4e0102a30dd417","modified":1715754396420},{"_id":"source/_posts/01-rustç¯å¢ƒæ­å»º.md","hash":"4c0f2bf37246a6be0f2a1b4c50da3722a42cc2a9","modified":1714288418745},{"_id":"source/_posts/03-rustå¤åˆç±»å‹.md","hash":"a685e502e9b04520bf35f50947f30836ed21c045","modified":1714288418746},{"_id":"source/_posts/02-ruståŸºæœ¬ç±»å‹.md","hash":"dd43f2a740d88aa19ed009ea66180206718fbe9e","modified":1714288418746},{"_id":"source/_posts/Hexoåœ¨å¤šå°ç”µè„‘ä¸Šæäº¤å’Œæ›´æ–°.md","hash":"e12a758b512c7cbc53fdca37286bdd057047f592","modified":1714288676763},{"_id":"source/_posts/cpufreq.md","hash":"67c7dd7ad6bf22963d7b933905e6d33cf55d184d","modified":1714295240119},{"_id":"source/_posts/github+hexoåšå®¢æ­å»º.md","hash":"85bd7eb698db516682385515b622694385fc8e14","modified":1714288418769},{"_id":"source/_posts/hello-world.md","hash":"abfe52bd7857c6997069eef12c9cc7bf35918421","modified":1714288418770},{"_id":"source/imgs/image-20230913154437526.png","hash":"9693caf3cc21eae7a101d17fa3773fd662a67458","modified":1714288418811},{"_id":"source/imgs/image-20230913154524492.png","hash":"93e1edcb969e6ab1b921e40c4181a41a35df6626","modified":1714288418813},{"_id":"source/imgs/image-20230913154510439.png","hash":"51bd7ce03a392ca543c2600eed536a3e681fe4e1","modified":1714288418812},{"_id":"source/imgs/image-20230913154559571.png","hash":"ffeb7e12c2271cca2c1e9e4bf26b513add8096fd","modified":1714288418814},{"_id":"source/imgs/image-20230913161842174.png","hash":"618c9c7b1bf25a26b97352bbd1b5b74d8a0f99e1","modified":1714288418816},{"_id":"source/imgs/image-20230913161638961.png","hash":"14a58ce37072ca0e819bae203a82aae720546ebc","modified":1714288418815},{"_id":"themes/3-hexo/.gitignore","hash":"86a50fa08e69cab561892aa5edef24f9081bbde1","modified":1714288418819},{"_id":"themes/3-hexo/_config.yml","hash":"cda697611a8a69f383644cfa5c1764f57e5ac812","modified":1715755960145},{"_id":"themes/3-hexo/LICENSE","hash":"b04140c5f682db2b300428f97bb164fd7f5f18bd","modified":1714288418820},{"_id":"themes/3-hexo/languages/en.yml","hash":"53ae29ae1237fc7822df85a6d2f8da6f0078625e","modified":1714288418822},{"_id":"themes/3-hexo/README.md","hash":"d2c42534ceabcb7cd2e58ed994bf7d6f734d1f3b","modified":1714288418820},{"_id":"themes/3-hexo/languages/zh-CN.yml","hash":"d2c6d86fe2ff03e6ee9bbc16dff8efe5b47ac297","modified":1714288418823},{"_id":"themes/3-hexo/layout/index.ejs","hash":"27ea3dac053d501b79bbef5117b4f3aff063d8cd","modified":1714288418839},{"_id":"themes/3-hexo/layout/post.ejs","hash":"4abd16c0f5e3f51103d23b73710d695dc7fdc5d2","modified":1714288418840},{"_id":"themes/3-hexo/layout/indexs.md","hash":"9aba38b192c510e94f34b37347f120475604a088","modified":1714288418839},{"_id":"themes/3-hexo/layout/_partial/article.ejs","hash":"516844c4a0e13d6773f6029849f51c59613b6f69","modified":1714288418825},{"_id":"themes/3-hexo/layout/_partial/article_copyright.ejs","hash":"0ebb17d001cb7bb7606c616c380049a2e7124496","modified":1714288418825},{"_id":"themes/3-hexo/layout/_partial/comment.ejs","hash":"5507b4dfab2032345e012a0c5356f63b01395157","modified":1714288418826},{"_id":"themes/3-hexo/.github/ISSUE_TEMPLATE/bug_report.md","hash":"0e662956cbfcaf6c1666e5c30a1fe03461de685e","modified":1714288418818},{"_id":"themes/3-hexo/layout/_partial/copyright.ejs","hash":"f66939a8c9d5258948b47842b8b4495e6ec45988","modified":1714288418831},{"_id":"themes/3-hexo/layout/_partial/dashang.ejs","hash":"bc94eee27701b67d238f328737b578e8270989eb","modified":1714288418832},{"_id":"themes/3-hexo/layout/_partial/friends.ejs","hash":"d11092791e5c140ff81f2aefa0d1b051f403239d","modified":1714288418834},{"_id":"themes/3-hexo/layout/_partial/footer.ejs","hash":"ed479aa9affee3b02a76da06de45a7c40a97a706","modified":1714288418833},{"_id":"themes/3-hexo/layout/_partial/full-toc.ejs","hash":"a734c26d86da6697003ed27672c1b9b82b216c82","modified":1714288418834},{"_id":"themes/3-hexo/layout/_partial/header.ejs","hash":"76768204853a8a5e030a96d605a247f9686cf994","modified":1714288418835},{"_id":"themes/3-hexo/layout/_partial/mathjax.ejs","hash":"c2e5cef2377884cd79e5f686fe4f74b082744306","modified":1714288418836},{"_id":"themes/3-hexo/layout/_partial/meta.ejs","hash":"8a9e93f9cbe80763264018290da0b14b4bbe8ac5","modified":1714288418836},{"_id":"themes/3-hexo/layout/_partial/nav-left.ejs","hash":"cbad17074f7a44520b4c7dad5a515d6aaf5e1e14","modified":1714288418837},{"_id":"themes/3-hexo/layout/_partial/nav-right.ejs","hash":"e205f9bb61fd4403d24d863693d4a34ea31b8539","modified":1714288418837},{"_id":"themes/3-hexo/layout/_partial/tag.ejs","hash":"3cf8ba0c6112dfa8089603b8df3e31f70a272715","modified":1714288418838},{"_id":"themes/3-hexo/layout/_partial/toc-ref.ejs","hash":"6406251dabda66ef686d4c15edbc3061b6d828b8","modified":1714288418838},{"_id":"themes/3-hexo/source/css/gitalk.css","hash":"58177ce227c50ee359fbf99a4fdd26058887afc5","modified":1714288418856},{"_id":"themes/3-hexo/source/img/alipay.jpg","hash":"e457d1d3dfefbbd824d154cf756a2c6d10b812a2","modified":1714288418869},{"_id":"themes/3-hexo/source/css/mobile.styl","hash":"59a4abd36cc8ff2107f1fcb3c0fe48d0492c9030","modified":1714288418867},{"_id":"themes/3-hexo/source/css/style.styl","hash":"7090b81f34e26172670c68da6a366ca186523779","modified":1714288418868},{"_id":"themes/3-hexo/source/img/article-list-background.jpeg","hash":"4fdf8b3e53dd02d6ee6360aebfadb0cba1fb5633","modified":1714288418871},{"_id":"themes/3-hexo/source/img/avatar.jpg","hash":"a42360089bfa892d803cf5747eab359d90f337f1","modified":1714288418871},{"_id":"themes/3-hexo/source/img/school-book.png","hash":"711ec983c874e093bb89eb77afcbdf6741fa61ee","modified":1714288418873},{"_id":"themes/3-hexo/source/img/gov.png","hash":"f31c9f47faedf7f33b9580d6284ab891fb697560","modified":1714288418873},{"_id":"themes/3-hexo/source/img/brown-papersq.png","hash":"3a1332ede3a75a3d24f60b6ed69035b72da5e182","modified":1714288418872},{"_id":"themes/3-hexo/source/js/iconfont.js","hash":"3a0869ca1b09af07d82987e343a3bc4cb9558ecb","modified":1714288418881},{"_id":"themes/3-hexo/source/js/jquery.pjax.js","hash":"191c49fdb40dff115a49cfd2b30dffb888d86550","modified":1714288418882},{"_id":"themes/3-hexo/layout/_partial/comments/gitment.ejs","hash":"f16442568b43d034faaa8e3507f5ae8da34c7b72","modified":1714288418830},{"_id":"themes/3-hexo/source/js/search.js","hash":"c80c9a231ee040c7adc07a477793873fb85ce8bc","modified":1714288418883},{"_id":"themes/3-hexo/source/js/titleTip.js","hash":"81dca549063e29ba3a4a278f0f4388eba8a2167b","modified":1714288418884},{"_id":"themes/3-hexo/layout/_partial/comments/gitalk.ejs","hash":"fbd3c7d72c8354d700918390c6cbfc0a11408277","modified":1714288418829},{"_id":"themes/3-hexo/layout/_partial/comments/livere.ejs","hash":"e820aa16b5ed4e024616b5e2d424925820d43e56","modified":1714288418830},{"_id":"themes/3-hexo/source/js/script.js","hash":"61e8ba1228d8441144fa7a655aa02ec546bd1f02","modified":1714288418883},{"_id":"themes/3-hexo/layout/_partial/comments/click2show.ejs","hash":"fa6675230f8c313236604e26926b142f4f418bdd","modified":1714288418827},{"_id":"themes/3-hexo/layout/_partial/comments/utteranc.ejs","hash":"c76773b96860940083baf16470b7b80ac098e645","modified":1714288418831},{"_id":"themes/3-hexo/source/css/_partial/font.styl","hash":"c68d6942ed62f9cce8a9042f5a59055a0ee5441c","modified":1714288418843},{"_id":"themes/3-hexo/source/css/_partial/dashang.styl","hash":"f6447a2ac407228e1d53e3455db2919ac0e9f094","modified":1714288418842},{"_id":"themes/3-hexo/source/css/_partial/comment.styl","hash":"2a9b5ffb759be85545a89f6d1194579a800f51a5","modified":1714288418841},{"_id":"themes/3-hexo/layout/_partial/comments/disqus.ejs","hash":"cd0022ce7e6d6efb07a00e87477cdf791f7f6703","modified":1714288418828},{"_id":"themes/3-hexo/source/css/_partial/nav-left.styl","hash":"d35df7f5e68880d1f1ebec541b816f8257fd42cb","modified":1714288418844},{"_id":"themes/3-hexo/source/css/_partial/fade.styl","hash":"4f687cbc74caf8a0887f5e89250284a9bce8b5c1","modified":1714288418843},{"_id":"themes/3-hexo/source/css/_partial/nprogress.styl","hash":"65efbddd23a264e7d1e85f4073228526770e833c","modified":1714288418846},{"_id":"themes/3-hexo/source/css/_partial/full-toc.styl","hash":"0143711c1221cb4e70a3db866754d79c8a81d253","modified":1714288418844},{"_id":"themes/3-hexo/source/css/_partial/nav-right.styl","hash":"36b47f4221e9bccae8e6f1685ea8942e601766d6","modified":1714288418845},{"_id":"themes/3-hexo/source/css/_partial/num-load.styl","hash":"4b996440bba8ec755aa70bc6d074d7dbba55ec0c","modified":1714288418846},{"_id":"themes/3-hexo/source/css/hl_theme/atom-dark.styl","hash":"f3eb4e5feda9cbd6242ccf44ca064e2979b5d719","modified":1714288418857},{"_id":"themes/3-hexo/source/css/_partial/post.styl","hash":"0dd8d208081b92e05d6db3361743c520a2816828","modified":1714288418847},{"_id":"themes/3-hexo/source/css/hl_theme/atom-light.styl","hash":"553987211d3323a7dfc0b08786b183a3435978c9","modified":1714288418858},{"_id":"themes/3-hexo/source/css/hl_theme/github.styl","hash":"53276ff1f224f691dfe811e82c0af7f4476abf5d","modified":1714288418860},{"_id":"themes/3-hexo/source/css/hl_theme/github-gist.styl","hash":"5e05b19832c1099bd9d284bc3ed00dc8a3d7ee23","modified":1714288418859},{"_id":"themes/3-hexo/source/css/hl_theme/brown-paper.styl","hash":"03af387edcc1cf8c18d12e9c440fd51b6cf425b6","modified":1714288418858},{"_id":"themes/3-hexo/source/css/hl_theme/darcula.styl","hash":"2bfc14f27ccca108b4b3755782de8366e8bd001e","modified":1714288418859},{"_id":"themes/3-hexo/source/css/hl_theme/kimbie-light.styl","hash":"0c3ccd0d64e7504c7061d246dc32737f502f64e4","modified":1714288418863},{"_id":"themes/3-hexo/source/css/hl_theme/gruvbox-dark.styl","hash":"315ad610d303caba9eac80a7d51002193a15478a","modified":1714288418861},{"_id":"themes/3-hexo/source/css/hl_theme/school-book.styl","hash":"51659351b391a2be5c68728bb51b7ad467c5e0db","modified":1714288418864},{"_id":"themes/3-hexo/source/css/hl_theme/gruvbox-light.styl","hash":"1bece084b1dbbbd4af064f05feffd8c332b96a48","modified":1714288418861},{"_id":"themes/3-hexo/source/css/hl_theme/kimbie-dark.styl","hash":"e9c190f9ffc37a13cac430512e4e0c760205be4a","modified":1714288418862},{"_id":"themes/3-hexo/source/css/hl_theme/rainbow.styl","hash":"e5c37646a9d9c1094f9aab7a7c65a4b242e8db00","modified":1714288418864},{"_id":"themes/3-hexo/source/css/hl_theme/sunburst.styl","hash":"2aa9817e68fb2ed216781ea04b733039ebe18214","modified":1714288418866},{"_id":"themes/3-hexo/source/css/hl_theme/railscasts.styl","hash":"a6e8cfd2202afd7893f5268f3437421e35066e7b","modified":1714288418863},{"_id":"themes/3-hexo/source/css/hl_theme/zenbum.styl","hash":"933a3b196d01254dea5e6f48105ea15e210ae000","modified":1714288418867},{"_id":"themes/3-hexo/source/css/fonts/icomoon.eot","hash":"b6195bedc1cb2f9cfcb26cc27021f2e94be2ab0a","modified":1714288418848},{"_id":"themes/3-hexo/source/css/fonts/icomoon.woff","hash":"3985d29416bb9b19f50a2f20f2bbbce47f10af8d","modified":1714288418851},{"_id":"themes/3-hexo/source/css/fonts/iconfont.eot","hash":"b14b8624988ff069aff3145f88c0d7ac49052bd3","modified":1714288418851},{"_id":"themes/3-hexo/source/css/hl_theme/sublime.styl","hash":"501d75ef0f4385bea24d9b9b4cc434ba68d4be27","modified":1714288418865},{"_id":"themes/3-hexo/source/css/fonts/icomoon.svg","hash":"37ac1ef28b03f46bf3ad2606c86f0e1ec3e4405f","modified":1714288418849},{"_id":"themes/3-hexo/source/css/fonts/icomoon.ttf","hash":"eb976d8b8559fcddfc2658a03a4350cb566fc06b","modified":1714288418850},{"_id":"themes/3-hexo/source/css/fonts/iconfont.svg","hash":"13974fe35fca836e870a960ecb11b7eca2e036f8","modified":1714288418852},{"_id":"themes/3-hexo/source/css/fonts/iconfont.ttf","hash":"140829ecf12d30c6e18d8dc6dc0c188a66addd25","modified":1714288418853},{"_id":"themes/3-hexo/source/css/fonts/iconfont.woff2","hash":"b0317a0b2ebb1181a8bf5a97d03556dd54538645","modified":1714288418854},{"_id":"themes/3-hexo/source/css/fonts/selection.json","hash":"57c7f100019d57b512aab509185cb0a6eb9aa4c8","modified":1714288418855},{"_id":"themes/3-hexo/source/css/fonts/iconfont.woff","hash":"0d2d4559f1ac4fa801eb8cc099fa5bf9dcf955ef","modified":1714288418854},{"_id":"themes/3-hexo/source/img/weixin.jpg","hash":"8dafb22561698d0758fba9ea2a45abf6ad3512a2","modified":1714288418875},{"_id":"themes/3-hexo/source/js/gitment.js","hash":"59a1e03f2b0ce61dd9bd405d3c52d3e07cc10dec","modified":1714288418881},{"_id":"themes/3-hexo/source/js/gitalk.js","hash":"26ba4841dcb4b178f730f53a8d1f4a7c89442b4f","modified":1714288418879},{"_id":"public/search.xml","hash":"3552ea477bdba8d079218c7a4427a5e8660dd72f","modified":1715860315827},{"_id":"public/2024/04/28/cpufreq/index.html","hash":"81322ab96e2ec12b9b73b61e1993e67d720310a2","modified":1715859774642},{"_id":"public/2023/09/13/Hexoåœ¨å¤šå°ç”µè„‘ä¸Šæäº¤å’Œæ›´æ–°/index.html","hash":"702dbd31089525d50a5bde343a361b767b46d79d","modified":1715859774642},{"_id":"public/2023/08/28/03-rustå¤åˆç±»å‹/index.html","hash":"60916def5fd9d82031754a11d9d29cdacb2f129e","modified":1715859774642},{"_id":"public/2023/08/26/02-ruståŸºæœ¬ç±»å‹/index.html","hash":"c6f44160142f4c3680ad96fc7b4d93edea2dd5f8","modified":1715859774642},{"_id":"public/2023/08/26/01-rustç¯å¢ƒæ­å»º/index.html","hash":"b0965b0288e7d88a5b60aca51857a9e16fd4174d","modified":1715859774642},{"_id":"public/2023/08/26/00-rustå­¦ä¹ ç½‘ç«™/index.html","hash":"3e5dd12418783b568ff9eb4f1a48ec78bc5a2d93","modified":1715859774642},{"_id":"public/2023/08/25/github+hexoåšå®¢æ­å»º/index.html","hash":"cb6f187b10348450aa68c9916bce445238e6921b","modified":1715859774642},{"_id":"public/2023/08/25/hello-world/index.html","hash":"33bc197972b6e9257d55978d3a3673e0d0c58dc1","modified":1715859774642},{"_id":"public/archives/index.html","hash":"a2b01b409f2115581016a849575a716f58de7593","modified":1715859774642},{"_id":"public/archives/2023/index.html","hash":"a2b01b409f2115581016a849575a716f58de7593","modified":1715859774642},{"_id":"public/archives/2023/08/index.html","hash":"a2b01b409f2115581016a849575a716f58de7593","modified":1715859774642},{"_id":"public/archives/2023/09/index.html","hash":"a2b01b409f2115581016a849575a716f58de7593","modified":1715859774642},{"_id":"public/archives/2024/index.html","hash":"a2b01b409f2115581016a849575a716f58de7593","modified":1715859774642},{"_id":"public/archives/2024/04/index.html","hash":"a2b01b409f2115581016a849575a716f58de7593","modified":1715859774642},{"_id":"public/categories/rust/index.html","hash":"a2b01b409f2115581016a849575a716f58de7593","modified":1715859774642},{"_id":"public/categories/test/index.html","hash":"a2b01b409f2115581016a849575a716f58de7593","modified":1715859774642},{"_id":"public/index.html","hash":"a2b01b409f2115581016a849575a716f58de7593","modified":1715859774642},{"_id":"public/tags/å­¦ä¹ ç½‘ç«™/index.html","hash":"a2b01b409f2115581016a849575a716f58de7593","modified":1715859774642},{"_id":"public/categories/kernel/index.html","hash":"a2b01b409f2115581016a849575a716f58de7593","modified":1715859774642},{"_id":"public/tags/power/index.html","hash":"a2b01b409f2115581016a849575a716f58de7593","modified":1715859774642},{"_id":"public/tags/rust/index.html","hash":"a2b01b409f2115581016a849575a716f58de7593","modified":1715859774642},{"_id":"public/tags/rustç¯å¢ƒæ­å»º/index.html","hash":"a2b01b409f2115581016a849575a716f58de7593","modified":1715859774642},{"_id":"public/tags/test/index.html","hash":"a2b01b409f2115581016a849575a716f58de7593","modified":1715859774642},{"_id":"public/tags/cpufreq/index.html","hash":"a2b01b409f2115581016a849575a716f58de7593","modified":1715859774642},{"_id":"public/tags/ruståŸºæœ¬ç±»å‹/index.html","hash":"a2b01b409f2115581016a849575a716f58de7593","modified":1715859774642},{"_id":"public/tags/rustå¤åˆç±»å‹/index.html","hash":"a2b01b409f2115581016a849575a716f58de7593","modified":1715859774642},{"_id":"public/imgs/image-20230913154510439.png","hash":"51bd7ce03a392ca543c2600eed536a3e681fe4e1","modified":1715785012068},{"_id":"public/imgs/image-20230913154559571.png","hash":"ffeb7e12c2271cca2c1e9e4bf26b513add8096fd","modified":1715785012068},{"_id":"public/imgs/image-20230913154524492.png","hash":"93e1edcb969e6ab1b921e40c4181a41a35df6626","modified":1715785012068},{"_id":"public/imgs/image-20230913154437526.png","hash":"9693caf3cc21eae7a101d17fa3773fd662a67458","modified":1715785012068},{"_id":"public/imgs/image-20230913161842174.png","hash":"618c9c7b1bf25a26b97352bbd1b5b74d8a0f99e1","modified":1715785012068},{"_id":"public/img/article-list-background.jpeg","hash":"4fdf8b3e53dd02d6ee6360aebfadb0cba1fb5633","modified":1715785012068},{"_id":"public/img/avatar.jpg","hash":"a42360089bfa892d803cf5747eab359d90f337f1","modified":1715785012068},{"_id":"public/img/gov.png","hash":"f31c9f47faedf7f33b9580d6284ab891fb697560","modified":1715785012068},{"_id":"public/img/school-book.png","hash":"711ec983c874e093bb89eb77afcbdf6741fa61ee","modified":1715785012068},{"_id":"public/img/brown-papersq.png","hash":"3a1332ede3a75a3d24f60b6ed69035b72da5e182","modified":1715785012068},{"_id":"public/img/alipay.jpg","hash":"e457d1d3dfefbbd824d154cf756a2c6d10b812a2","modified":1715785012068},{"_id":"public/css/fonts/icomoon.eot","hash":"b6195bedc1cb2f9cfcb26cc27021f2e94be2ab0a","modified":1715785012068},{"_id":"public/css/fonts/icomoon.svg","hash":"37ac1ef28b03f46bf3ad2606c86f0e1ec3e4405f","modified":1715785012068},{"_id":"public/css/fonts/iconfont.eot","hash":"b14b8624988ff069aff3145f88c0d7ac49052bd3","modified":1715785012068},{"_id":"public/css/fonts/icomoon.woff","hash":"3985d29416bb9b19f50a2f20f2bbbce47f10af8d","modified":1715785012068},{"_id":"public/css/fonts/icomoon.ttf","hash":"eb976d8b8559fcddfc2658a03a4350cb566fc06b","modified":1715785012068},{"_id":"public/css/fonts/iconfont.svg","hash":"13974fe35fca836e870a960ecb11b7eca2e036f8","modified":1715785012068},{"_id":"public/css/fonts/iconfont.ttf","hash":"140829ecf12d30c6e18d8dc6dc0c188a66addd25","modified":1715785012068},{"_id":"public/css/fonts/iconfont.woff","hash":"0d2d4559f1ac4fa801eb8cc099fa5bf9dcf955ef","modified":1715785012068},{"_id":"public/css/fonts/iconfont.woff2","hash":"b0317a0b2ebb1181a8bf5a97d03556dd54538645","modified":1715785012068},{"_id":"public/imgs/image-20230913161638961.png","hash":"14a58ce37072ca0e819bae203a82aae720546ebc","modified":1715785012068},{"_id":"public/img/weixin.jpg","hash":"8dafb22561698d0758fba9ea2a45abf6ad3512a2","modified":1715785012068},{"_id":"public/css/mobile.css","hash":"5998f6fc27998596beb1e40e4bc3c43be2ed764c","modified":1715785012068},{"_id":"public/js/search.js","hash":"c80c9a231ee040c7adc07a477793873fb85ce8bc","modified":1715785012068},{"_id":"public/js/titleTip.js","hash":"81dca549063e29ba3a4a278f0f4388eba8a2167b","modified":1715785012068},{"_id":"public/css/hl_theme/brown-paper.css","hash":"500c8e750373f6656ff49a7857c871ceedcf8777","modified":1715785012068},{"_id":"public/css/hl_theme/github.css","hash":"e05a0806a508a26b9f3f3794b6b588ec6504ad3f","modified":1715785012068},{"_id":"public/css/hl_theme/darcula.css","hash":"4341074bae4bc9f0b86e32b623e27babc0159b6e","modified":1715785012068},{"_id":"public/css/hl_theme/atom-dark.css","hash":"88d11052a24e8100af6248eb4dbe1ce7b0e96408","modified":1715785012068},{"_id":"public/css/hl_theme/atom-light.css","hash":"d31edb9816dae6b01410028bceb91757a962f780","modified":1715785012068},{"_id":"public/css/hl_theme/github-gist.css","hash":"7a41c1c479d09df875f99f1f6d94aac42e9e2ad0","modified":1715785012068},{"_id":"public/css/hl_theme/gruvbox-dark.css","hash":"8c440d9b4ee19ac03eaee3c6af78ba52e5ba5535","modified":1715785012068},{"_id":"public/css/hl_theme/gruvbox-light.css","hash":"30514aaa242a34647aa666cfca4fc74c595ea8f2","modified":1715785012068},{"_id":"public/css/hl_theme/rainbow.css","hash":"7ff4251938076ddb7e4e49413db82653e5b61321","modified":1715785012068},{"_id":"public/css/hl_theme/railscasts.css","hash":"511f2fd2a84d426e5da5cb17880cc08f73beb002","modified":1715785012068},{"_id":"public/css/hl_theme/sublime.css","hash":"f65c5b116d9213afb9c324384a2f3bc86cb71121","modified":1715785012068},{"_id":"public/css/hl_theme/zenbum.css","hash":"0a78f74a93568e20b32ca7427c719e9bae9a0b55","modified":1715785012068},{"_id":"public/css/hl_theme/sunburst.css","hash":"8a135abac1512cf430d1d1ad2304b79afa1a4d6e","modified":1715785012068},{"_id":"public/css/hl_theme/kimbie-dark.css","hash":"728527fcc308da454722c119b89e6da3025bd1e3","modified":1715785012068},{"_id":"public/css/hl_theme/school-book.css","hash":"ffbbcd13a74ac2404262c50b7a43053dfd0096ff","modified":1715785012068},{"_id":"public/css/hl_theme/kimbie-light.css","hash":"0c61926c989163faefb031d27bce3e287d6e10f2","modified":1715785012068},{"_id":"public/css/gitalk.css","hash":"58177ce227c50ee359fbf99a4fdd26058887afc5","modified":1715785012068},{"_id":"public/css/style.css","hash":"c7adbb2af0e65ecd85f8c06851f34d377d4b834c","modified":1715785012068},{"_id":"public/js/iconfont.js","hash":"3a0869ca1b09af07d82987e343a3bc4cb9558ecb","modified":1715785012068},{"_id":"public/js/jquery.pjax.js","hash":"191c49fdb40dff115a49cfd2b30dffb888d86550","modified":1715785012068},{"_id":"public/js/script.js","hash":"61e8ba1228d8441144fa7a655aa02ec546bd1f02","modified":1715785012068},{"_id":"public/js/gitment.js","hash":"59a1e03f2b0ce61dd9bd405d3c52d3e07cc10dec","modified":1715785012068},{"_id":"public/css/fonts/selection.json","hash":"047b615ea32dc48dae5b964061427d41feaaafdf","modified":1715785012068},{"_id":"public/js/gitalk.js","hash":"26ba4841dcb4b178f730f53a8d1f4a7c89442b4f","modified":1715785012068},{"_id":"source/_posts/uboot-fdt.md","hash":"000f5314305a9fa5cc319b3ea7d6d978289b2a53","modified":1715754303532},{"_id":"source/_posts/OSTEP-40-æ–‡ä»¶ç³»ç»Ÿå®ç°.md","hash":"454c27352e2830ccfab8138969d18de95f9ec800","modified":1715754500891},{"_id":"source/_posts/linuxå—è®¾å¤‡é©±åŠ¨.md","hash":"b8a1c65e95a7601d9b1ab7232a0cbfb5ae11b13b","modified":1715754470467},{"_id":"source/back_posts/00-rustå­¦ä¹ ç½‘ç«™.md","hash":"ef43232f54b328d6331469557c4e0102a30dd417","modified":1715756060707},{"_id":"source/back_posts/02-ruståŸºæœ¬ç±»å‹.md","hash":"dd43f2a740d88aa19ed009ea66180206718fbe9e","modified":1715753468980},{"_id":"source/back_posts/03-rustå¤åˆç±»å‹.md","hash":"a685e502e9b04520bf35f50947f30836ed21c045","modified":1715753468981},{"_id":"source/back_posts/01-rustç¯å¢ƒæ­å»º.md","hash":"4c0f2bf37246a6be0f2a1b4c50da3722a42cc2a9","modified":1715753468969},{"_id":"source/back_posts/Hexoåœ¨å¤šå°ç”µè„‘ä¸Šæäº¤å’Œæ›´æ–°.md","hash":"e12a758b512c7cbc53fdca37286bdd057047f592","modified":1715753468981},{"_id":"source/back_posts/OSTEP-40-æ–‡ä»¶ç³»ç»Ÿå®ç°.md","hash":"dbd3f4f4675948185f284fa0d0242db82c715cfc","modified":1715753468982},{"_id":"source/back_posts/cpufreq.md","hash":"67c7dd7ad6bf22963d7b933905e6d33cf55d184d","modified":1715753468989},{"_id":"source/back_posts/github+hexoåšå®¢æ­å»º.md","hash":"85bd7eb698db516682385515b622694385fc8e14","modified":1715753468990},{"_id":"source/back_posts/linuxå—è®¾å¤‡é©±åŠ¨.md","hash":"86323d12a2c1fd3ebbbaa19e899ff55db6c6be8a","modified":1715753468991},{"_id":"source/back_posts/ubootä¹‹fdt.md","hash":"4e5aa13f6525b5806f06572124fd91a69e46222a","modified":1715753468992},{"_id":"source/back_posts/hello-world.md","hash":"abfe52bd7857c6997069eef12c9cc7bf35918421","modified":1715753468991},{"_id":"public/back_posts/02-ruståŸºæœ¬ç±»å‹.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1715785012068},{"_id":"public/back_posts/03-rustå¤åˆç±»å‹.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1715785012068},{"_id":"public/back_posts/cpufreq.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1715785012068},{"_id":"public/back_posts/01-rustç¯å¢ƒæ­å»º.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1715785012068},{"_id":"public/back_posts/github+hexoåšå®¢æ­å»º.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1715785012068},{"_id":"public/back_posts/hello-world.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1715785012068},{"_id":"public/back_posts/Hexoåœ¨å¤šå°ç”µè„‘ä¸Šæäº¤å’Œæ›´æ–°.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1715785012068},{"_id":"public/back_posts/00-rustå­¦ä¹ ç½‘ç«™.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1715785012068},{"_id":"public/back_posts/linuxå—è®¾å¤‡é©±åŠ¨.html","hash":"40cd8ce050459c8af27df916d2d8867a2d645f70","modified":1715859774642},{"_id":"public/back_posts/OSTEP-40-æ–‡ä»¶ç³»ç»Ÿå®ç°.html","hash":"225830d2cbb771bb477a601629211421e8d80974","modified":1715859774642},{"_id":"public/back_posts/ubootä¹‹fdt.html","hash":"5597653245f93de710e41fe1080532a4700b6eae","modified":1715859774642},{"_id":"public/2024/05/15/uboot-fdt/index.html","hash":"b45e62ab6025c01b0d35f0aab1ea2f1c0288e49f","modified":1715754726255},{"_id":"public/2024/05/15/linuxå—è®¾å¤‡é©±åŠ¨/index.html","hash":"a4b89b703bdae8e886367625233bbe0c4a8b2b1f","modified":1715754726255},{"_id":"public/2024/05/06/OSTEP-40-æ–‡ä»¶ç³»ç»Ÿå®ç°/index.html","hash":"afdb3efa53aa5268ec6ec038c5f956af4cac9685","modified":1715754112053},{"_id":"public/archives/page/2/index.html","hash":"a2b01b409f2115581016a849575a716f58de7593","modified":1715859774642},{"_id":"public/archives/2024/05/index.html","hash":"a2b01b409f2115581016a849575a716f58de7593","modified":1715859774642},{"_id":"public/page/2/index.html","hash":"a2b01b409f2115581016a849575a716f58de7593","modified":1715859774642},{"_id":"public/2024/05/15/OSTEP-40-æ–‡ä»¶ç³»ç»Ÿå®ç°/index.html","hash":"ee5d6ebf7e825f29064ded1e4f562f8b771c7843","modified":1715754726255},{"_id":"source/_posts/U-Boot-fdt-GPT.md","hash":"4b6af68d08a516b2460136c6ee1e564bf62f6274","modified":1715755822548},{"_id":"source/_posts/OSTEP-40-VSFS.md","hash":"e72a9f32ba2fa96b4f7d5ff4c3a4b2bea60cf516","modified":1715755972721},{"_id":"source/_posts/linux-block.md","hash":"2addf204e4bb8415357f5714032592f65022de7e","modified":1715755916921},{"_id":"public/2024/05/15/OSTEP-40-VSFS/index.html","hash":"3aefbdb614a7a8a0920abf8e5d0e4eb31979f4da","modified":1715859774642},{"_id":"public/2024/05/15/U-Boot-fdt-GPT/index.html","hash":"f3f5145f0b5ddbe0c37bbebf4eae496e454dad95","modified":1715859774642},{"_id":"public/2024/05/15/linux-block/index.html","hash":"525e5f43b0e4163abcb63a244fcc6c96da751e6d","modified":1715859774642},{"_id":"public/categories/OSTEP/index.html","hash":"a2b01b409f2115581016a849575a716f58de7593","modified":1715859774642},{"_id":"public/categories/linux/index.html","hash":"6e861d6ec883b0a74b061167ca3830acebe62c56","modified":1715755545023},{"_id":"public/tags/block/index.html","hash":"a2b01b409f2115581016a849575a716f58de7593","modified":1715859774642},{"_id":"public/tags/uboot/index.html","hash":"6e861d6ec883b0a74b061167ca3830acebe62c56","modified":1715755545023},{"_id":"public/tags/fdt/index.html","hash":"a2b01b409f2115581016a849575a716f58de7593","modified":1715859774642},{"_id":"public/tags/rk3588/index.html","hash":"a2b01b409f2115581016a849575a716f58de7593","modified":1715859774642},{"_id":"public/tags/GPT/index.html","hash":"a2b01b409f2115581016a849575a716f58de7593","modified":1715859774642},{"_id":"public/categories/uboot/index.html","hash":"a2b01b409f2115581016a849575a716f58de7593","modified":1715859774642},{"_id":"public/categories/driver/index.html","hash":"a2b01b409f2115581016a849575a716f58de7593","modified":1715859774642},{"_id":"public/tags/vsfs/index.html","hash":"a2b01b409f2115581016a849575a716f58de7593","modified":1715859774642},{"_id":"source/back_posts/OSTEP-40-VSFS.md","hash":"e72a9f32ba2fa96b4f7d5ff4c3a4b2bea60cf516","modified":1715756060710},{"_id":"source/back_posts/U-Boot-fdt-GPT.md","hash":"4b6af68d08a516b2460136c6ee1e564bf62f6274","modified":1715756060711},{"_id":"source/back_posts/linux-block.md","hash":"2addf204e4bb8415357f5714032592f65022de7e","modified":1715756060713},{"_id":"public/back_posts/OSTEP-40-VSFS.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1715785012068},{"_id":"public/back_posts/linux-block.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1715785012068},{"_id":"public/back_posts/U-Boot-fdt-GPT.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1715785012068},{"_id":"source/_posts/uboot-01-æ¦‚å¿µ.md","hash":"1187308c94ad8375469d649f544a5cb1067f11d2","modified":1715837496959},{"_id":"public/2024/05/15/uboot-01-æ¦‚å¿µ/index.html","hash":"202054c3435c2583f4eb3de1147e15edb665be1c","modified":1715859774642},{"_id":"public/tags/ubootæ¦‚å¿µ/index.html","hash":"a2b01b409f2115581016a849575a716f58de7593","modified":1715859774642},{"_id":"source/_posts/cgroup.md","hash":"7a7cc20e8a798798b392e2d49084a9a1c49357b8","modified":1715853613008},{"_id":"source/_posts/pinctrl.md","hash":"1ceb0adf15d9f09019b61783aa55792765914644","modified":1715844875594},{"_id":"public/2024/05/16/pinctrl/index.html","hash":"7d6add202e280ab4e238d78640b70bd8369b3c95","modified":1715859774642},{"_id":"public/2024/05/16/cgroup/index.html","hash":"e300c0aa4273a6c00e3d000d48dcffb816c86901","modified":1715859774642},{"_id":"public/tags/cgroup/index.html","hash":"a2b01b409f2115581016a849575a716f58de7593","modified":1715859774642},{"_id":"public/tags/pinctrl/index.html","hash":"a2b01b409f2115581016a849575a716f58de7593","modified":1715859774642},{"_id":"source/back_posts/uboot-01-æ¦‚å¿µ.md","hash":"1187308c94ad8375469d649f544a5cb1067f11d2","modified":1715844943760},{"_id":"source/back_posts/pinctrl.md","hash":"1ceb0adf15d9f09019b61783aa55792765914644","modified":1715844943759},{"_id":"source/_posts/PHYèŠ¯ç‰‡.md","hash":"c79c63d28fe4c9851462fb08dd15f4fe14fa8d99","modified":1715860310145},{"_id":"source/back_posts/cgroup.md","hash":"7a7cc20e8a798798b392e2d49084a9a1c49357b8","modified":1715857286743},{"_id":"public/back_posts/cgroup.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1715857264053},{"_id":"public/back_posts/uboot-01-æ¦‚å¿µ.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1715857264053},{"_id":"public/back_posts/pinctrl.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1715857264053},{"_id":"public/2024/05/16/PHYèŠ¯ç‰‡/index.html","hash":"0e0a36a50ef06fc5e514686e372b5b801b49db77","modified":1715860315827},{"_id":"public/tags/PHYèŠ¯ç‰‡/index.html","hash":"a2b01b409f2115581016a849575a716f58de7593","modified":1715859774642},{"_id":"source/img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_18,color_FFFFFF,t_70,g_se,x_16.png","hash":"7e3789d8fb2bcf7e4dad182a698dc8625735002a","modified":1715859649660},{"_id":"source/img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_16,color_FFFFFF,t_70,g_se,x_16.png","hash":"f7ccce22774cc7960810982fa7743d17ef809d04","modified":1715859211118},{"_id":"source/back_posts/PHYèŠ¯ç‰‡.md","hash":"c90b4bd11300956bc2c014ad7d8634e52f10aaa0","modified":1715859797805},{"_id":"source/imgs/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_18,color_FFFFFF,t_70,g_se,x_16-17158590663256.png","hash":"9c9e454c3032a583f0d7449a8f21818f3b3cd35f","modified":1715859075855},{"_id":"source/_posts/img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_18,color_FFFFFF,t_70,g_se,x_16-17158590663256.png","hash":"9c9e454c3032a583f0d7449a8f21818f3b3cd35f","modified":1715859066327},{"_id":"source/_posts/img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_18,color_FFFFFF,t_70,g_se,x_16.png","hash":"9c9e454c3032a583f0d7449a8f21818f3b3cd35f","modified":1715858910742},{"_id":"source/img/84b0b5e31bb246c0a970ace7c71a3f82.png","hash":"ddf5bc08e2bcc4f354513360a3afbc09465a71c6","modified":1715859145462},{"_id":"source/imgs/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_16,color_FFFFFF,t_70,g_se,x_16.png","hash":"28af7bbe758244cd040a7763b86d29bc51a755e5","modified":1715859046341},{"_id":"source/_posts/img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_16,color_FFFFFF,t_70,g_se,x_16.png","hash":"28af7bbe758244cd040a7763b86d29bc51a755e5","modified":1715859015033},{"_id":"public/back_posts/PHYèŠ¯ç‰‡.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1715859774642},{"_id":"public/imgs/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_18,color_FFFFFF,t_70,g_se,x_16-17158590663256.png","hash":"9c9e454c3032a583f0d7449a8f21818f3b3cd35f","modified":1715859774642},{"_id":"public/img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_18,color_FFFFFF,t_70,g_se,x_16.png","hash":"7e3789d8fb2bcf7e4dad182a698dc8625735002a","modified":1715859774642},{"_id":"public/img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_16,color_FFFFFF,t_70,g_se,x_16.png","hash":"f7ccce22774cc7960810982fa7743d17ef809d04","modified":1715859774642},{"_id":"public/img/84b0b5e31bb246c0a970ace7c71a3f82.png","hash":"ddf5bc08e2bcc4f354513360a3afbc09465a71c6","modified":1715859774642},{"_id":"public/imgs/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_16,color_FFFFFF,t_70,g_se,x_16.png","hash":"28af7bbe758244cd040a7763b86d29bc51a755e5","modified":1715859774642},{"_id":"source/back_posts/img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_18,color_FFFFFF,t_70,g_se,x_16-17158590663256.png","hash":"9c9e454c3032a583f0d7449a8f21818f3b3cd35f","modified":1715859797810},{"_id":"source/back_posts/img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_18,color_FFFFFF,t_70,g_se,x_16.png","hash":"9c9e454c3032a583f0d7449a8f21818f3b3cd35f","modified":1715859797809},{"_id":"source/back_posts/img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_16,color_FFFFFF,t_70,g_se,x_16.png","hash":"28af7bbe758244cd040a7763b86d29bc51a755e5","modified":1715859797811},{"_id":"public/back_posts/img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_18,color_FFFFFF,t_70,g_se,x_16.png","hash":"9c9e454c3032a583f0d7449a8f21818f3b3cd35f","modified":1715860315827},{"_id":"public/back_posts/img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_18,color_FFFFFF,t_70,g_se,x_16-17158590663256.png","hash":"9c9e454c3032a583f0d7449a8f21818f3b3cd35f","modified":1715860315827},{"_id":"public/back_posts/img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_16,color_FFFFFF,t_70,g_se,x_16.png","hash":"28af7bbe758244cd040a7763b86d29bc51a755e5","modified":1715860315827}],"Category":[{"name":"rust","_id":"clvjcoaap0002r9w0crcqdq03"},{"name":"test","_id":"clvjcoaav000br9w04s5fhod2"},{"name":"kernel","_id":"clvjcoaax000ir9w04u7q98wg"},{"name":"OSTEP","_id":"clw7gjvtt00024zw0fh4pclyx"},{"name":"linux","_id":"clw7gjvtw00054zw09m1y49ox"},{"name":"uboot","_id":"clw7gupas000164w0bopbhhya"},{"name":"driver","_id":"clw7gupat000364w0drn50ao5"}],"Data":[],"Page":[{"title":"02-ruståŸºæœ¬ç±»å‹","date":"2023-08-26T13:17:00.000Z","categories":["rust"],"tags":["ruståŸºæœ¬ç±»å‹","rust"],"_content":"\n\n\n\n\n\n\n\n\n[toc]\n\n# RuståŸºæœ¬æ•°æ®ç±»å‹\n\nRust æ¯ä¸ªå€¼éƒ½æœ‰å…¶ç¡®åˆ‡çš„æ•°æ®ç±»å‹ï¼Œæ€»çš„æ¥è¯´å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼šåŸºæœ¬ç±»å‹å’Œå¤åˆç±»å‹ã€‚ åŸºæœ¬ç±»å‹æ„å‘³ç€å®ƒä»¬å¾€å¾€æ˜¯ä¸€ä¸ªæœ€å°åŒ–åŸå­ç±»å‹ï¼Œæ— æ³•è§£æ„ä¸ºå…¶å®ƒç±»å‹(ä¸€èˆ¬æ„ä¹‰ä¸Šæ¥è¯´)ï¼Œç”±ä»¥ä¸‹ç»„æˆï¼š\n\n- æ•°å€¼ç±»å‹: æœ‰ç¬¦å·æ•´æ•° (`i8`, `i16`, `i32`, `i64`, `isize`)ã€ æ— ç¬¦å·æ•´æ•° (`u8`, `u16`, `u32`, `u64`, `usize`) ã€æµ®ç‚¹æ•° (`f32`, `f64`)ã€ä»¥åŠæœ‰ç†æ•°ã€å¤æ•°\n- å­—ç¬¦ä¸²ï¼šå­—ç¬¦ä¸²å­—é¢é‡å’Œå­—ç¬¦ä¸²åˆ‡ç‰‡ `&str`\n- å¸ƒå°”ç±»å‹ï¼š `true`å’Œ`false`\n- å­—ç¬¦ç±»å‹: è¡¨ç¤ºå•ä¸ª Unicode å­—ç¬¦ï¼Œå­˜å‚¨ä¸º 4 ä¸ªå­—èŠ‚\n- å•å…ƒç±»å‹: å³ `()` ï¼Œå…¶å”¯ä¸€çš„å€¼ä¹Ÿæ˜¯ `()`\n\n## 1.æ•°å€¼ç±»å‹\n\n| é•¿åº¦       | æœ‰ç¬¦å·ç±»å‹ | æ— ç¬¦å·ç±»å‹ |\n| ---------- | ---------- | ---------- |\n| 8 ä½       | `i8`       | `u8`       |\n| 16 ä½      | `i16`      | `u16`      |\n| 32 ä½      | `i32`      | `u32`      |\n| 64 ä½      | `i64`      | `u64`      |\n| 128 ä½     | `i128`     | `u128`     |\n| è§†æ¶æ„è€Œå®š | `isize`    | `usize`    |\n\næ•´å½¢å­—é¢é‡å¯ä»¥ç”¨ä¸‹è¡¨çš„å½¢å¼ä¹¦å†™ï¼š\n\n| æ•°å­—å­—é¢é‡         | ç¤ºä¾‹          |\n| ------------------ | ------------- |\n| åè¿›åˆ¶             | `98_222`      |\n| åå…­è¿›åˆ¶           | `0xff`        |\n| å…«è¿›åˆ¶             | `0o77`        |\n| äºŒè¿›åˆ¶             | `0b1111_0000` |\n| å­—èŠ‚ (ä»…é™äº `u8`) | `b'A'`        |\n\n## 2.[æµ®ç‚¹ç±»å‹](https://course.rs/basic/base-type/numbers.html#æµ®ç‚¹ç±»å‹)\n\n**æµ®ç‚¹ç±»å‹æ•°å­—** æ˜¯å¸¦æœ‰å°æ•°ç‚¹çš„æ•°å­—ï¼Œåœ¨ Rust ä¸­æµ®ç‚¹ç±»å‹æ•°å­—ä¹Ÿæœ‰ä¸¤ç§åŸºæœ¬ç±»å‹ï¼š `f32` å’Œ `f64`ï¼Œåˆ†åˆ«ä¸º 32 ä½å’Œ 64 ä½å¤§å°ã€‚é»˜è®¤æµ®ç‚¹ç±»å‹æ˜¯ `f64`ï¼Œåœ¨ç°ä»£çš„ CPU ä¸­å®ƒçš„é€Ÿåº¦ä¸ `f32` å‡ ä¹ç›¸åŒï¼Œä½†ç²¾åº¦æ›´é«˜ã€‚\n\nä¸‹é¢æ˜¯ä¸€ä¸ªæ¼”ç¤ºæµ®ç‚¹æ•°çš„ç¤ºä¾‹ï¼š\n\n```rust\nfn main() {\n    let x = 2.0; // f64\n\n    let y: f32 = 3.0; // f32\n}\n```\n\n## 3.[åºåˆ—(Range)](https://course.rs/basic/base-type/numbers.html#åºåˆ—range)\n\nRust æä¾›äº†ä¸€ä¸ªéå¸¸ç®€æ´çš„æ–¹å¼ï¼Œç”¨æ¥ç”Ÿæˆè¿ç»­çš„æ•°å€¼ï¼Œä¾‹å¦‚ **`1..5`ï¼Œç”Ÿæˆä» 1 åˆ° 4 çš„è¿ç»­æ•°å­—ï¼Œä¸åŒ…å« 5** ï¼›`1..=5`ï¼Œç”Ÿæˆä» 1 åˆ° 5 çš„è¿ç»­æ•°å­—ï¼ŒåŒ…å« 5ï¼Œå®ƒçš„ç”¨é€”å¾ˆç®€å•ï¼Œå¸¸å¸¸ç”¨äºå¾ªç¯ä¸­ï¼š\n\n```rust\nfor i in 1..=5 {\n    println!(\"{}\",i);\n}\n```\n\næœ€ç»ˆç¨‹åºè¾“å‡º:\n\n```console\n1\n2\n3\n4\n5\n```\n\n**åºåˆ—åªå…è®¸ç”¨äºæ•°å­—æˆ–å­—ç¬¦ç±»å‹**ï¼ŒåŸå› æ˜¯ï¼šå®ƒä»¬å¯ä»¥è¿ç»­ï¼ŒåŒæ—¶ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æœŸå¯ä»¥æ£€æŸ¥è¯¥åºåˆ—æ˜¯å¦ä¸ºç©ºï¼Œå­—ç¬¦å’Œæ•°å­—å€¼æ˜¯ Rust ä¸­ä»…æœ‰çš„å¯ä»¥ç”¨äºåˆ¤æ–­æ˜¯å¦ä¸ºç©ºçš„ç±»å‹ã€‚å¦‚ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨å­—ç¬¦ç±»å‹åºåˆ—çš„ä¾‹å­ï¼š\n\n```rust\nfor i in 'a'..='z' {\n    println!(\"{}\",i);\n}\n```\n\n## 4.[æœ‰ç†æ•°å’Œå¤æ•°](https://course.rs/basic/base-type/numbers.html#æœ‰ç†æ•°å’Œå¤æ•°)\n\nRust çš„æ ‡å‡†åº“ç›¸æ¯”å…¶å®ƒè¯­è¨€ï¼Œå‡†å…¥é—¨æ§›è¾ƒé«˜ï¼Œå› æ­¤æœ‰ç†æ•°å’Œå¤æ•°å¹¶æœªåŒ…å«åœ¨æ ‡å‡†åº“ä¸­ï¼š\n\n- æœ‰ç†æ•°å’Œå¤æ•°\n- ä»»æ„å¤§å°çš„æ•´æ•°å’Œä»»æ„ç²¾åº¦çš„æµ®ç‚¹æ•°\n- å›ºå®šç²¾åº¦çš„åè¿›åˆ¶å°æ•°ï¼Œå¸¸ç”¨äºè´§å¸ç›¸å…³çš„åœºæ™¯\n\nå¥½åœ¨ç¤¾åŒºå·²ç»å¼€å‘å‡ºé«˜è´¨é‡çš„ Rust æ•°å€¼åº“ï¼š[num](https://crates.io/crates/num)ã€‚\n\næŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ¥å¼•å…¥ `num` åº“ï¼š\n\n1. åˆ›å»ºæ–°å·¥ç¨‹ `cargo new complex-num && cd complex-num`\n2. åœ¨ `Cargo.toml` ä¸­çš„ `[dependencies]` ä¸‹æ·»åŠ ä¸€è¡Œ `num = \"0.4.0\"`\n3. å°† `src/main.rs` æ–‡ä»¶ä¸­çš„ `main` å‡½æ•°æ›¿æ¢ä¸ºä¸‹é¢çš„ä»£ç \n4. è¿è¡Œ `cargo run`\n\n```rust\nuse num::complex::Complex;\n\n fn main() {\n   let a = Complex { re: 2.1, im: -1.2 };\n   let b = Complex::new(11.1, 22.2);\n   let result = a + b;\n\n   println!(\"{} + {}i\", result.re, result.im)\n }\n```\n\n#### [æ€»ç»“](https://course.rs/basic/base-type/numbers.html#æ€»ç»“)\n\nä¹‹å‰æåˆ°äº†è¿‡ Rust çš„æ•°å€¼ç±»å‹å’Œè¿ç®—è·Ÿå…¶ä»–è¯­è¨€è¾ƒä¸ºç›¸ä¼¼ï¼Œä½†æ˜¯å®é™…ä¸Šï¼Œé™¤äº†è¯­æ³•ä¸Šçš„ä¸åŒä¹‹å¤–ï¼Œè¿˜æ˜¯å­˜åœ¨ä¸€äº›å·®å¼‚ç‚¹ï¼š\n\n- **Rust æ‹¥æœ‰ç›¸å½“å¤šçš„æ•°å€¼ç±»å‹**. å› æ­¤ä½ éœ€è¦ç†Ÿæ‚‰è¿™äº›ç±»å‹æ‰€å ç”¨çš„å­—èŠ‚æ•°ï¼Œè¿™æ ·å°±çŸ¥é“è¯¥ç±»å‹å…è®¸çš„å¤§å°èŒƒå›´ä»¥åŠä½ é€‰æ‹©çš„ç±»å‹æ˜¯å¦èƒ½è¡¨è¾¾è´Ÿæ•°\n- **ç±»å‹è½¬æ¢å¿…é¡»æ˜¯æ˜¾å¼çš„**. Rust æ°¸è¿œä¹Ÿä¸ä¼šå·å·æŠŠä½ çš„ 16bit æ•´æ•°è½¬æ¢æˆ 32bit æ•´æ•°\n- **Rust çš„æ•°å€¼ä¸Šå¯ä»¥ä½¿ç”¨æ–¹æ³•**. ä¾‹å¦‚ä½ å¯ä»¥ç”¨ä»¥ä¸‹æ–¹æ³•æ¥å°† `13.14` å–æ•´ï¼š`13.14_f32.round()`ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº†ç±»å‹åç¼€ï¼Œå› ä¸ºç¼–è¯‘å™¨éœ€è¦çŸ¥é“ `13.14` çš„å…·ä½“ç±»å‹\n\n## 5.[å‡½æ•°è¦ç‚¹](https://course.rs/basic/base-type/function.html#å‡½æ•°è¦ç‚¹)\n\n- å‡½æ•°åå’Œå˜é‡åä½¿ç”¨[è›‡å½¢å‘½åæ³•(snake case)](https://course.rs/practice/naming.html)ï¼Œä¾‹å¦‚ `fn add_two() -> {}`\n- å‡½æ•°çš„ä½ç½®å¯ä»¥éšä¾¿æ”¾ï¼ŒRust ä¸å…³å¿ƒæˆ‘ä»¬åœ¨å“ªé‡Œå®šä¹‰äº†å‡½æ•°ï¼Œåªè¦æœ‰å®šä¹‰å³å¯\n- æ¯ä¸ªå‡½æ•°å‚æ•°éƒ½éœ€è¦æ ‡æ³¨ç±»å‹\n\n```\nfn add(i: i32, j: i32) -> i32 {\n   i + j\n }\n\n```\n\n![img](https://pic2.zhimg.com/80/v2-54b3a6d435d2482243edc4be9ab98153_1440w.png)\n\n### è¿”å›å€¼ï¼š\n\nâ€‹\t[æ— è¿”å›å€¼`()`](https://course.rs/basic/base-type/function.html#æ— è¿”å›å€¼)\n\n- å‡½æ•°æ²¡æœ‰è¿”å›å€¼ï¼Œé‚£ä¹ˆè¿”å›ä¸€ä¸ª `()`\n- é€šè¿‡ `;` ç»“å°¾çš„è¡¨è¾¾å¼è¿”å›ä¸€ä¸ª `()`\n\nâ€‹    [æ°¸ä¸è¿”å›çš„å‘æ•£å‡½æ•° `!`](https://course.rs/basic/base-type/function.html#æ°¸ä¸è¿”å›çš„å‘æ•£å‡½æ•°-)\n\nâ€‹\t\tå½“ç”¨ `!` ä½œå‡½æ•°è¿”å›ç±»å‹çš„æ—¶å€™ï¼Œè¡¨ç¤ºè¯¥å‡½æ•°æ°¸ä¸è¿”å›( diverge function )ï¼Œç‰¹åˆ«çš„ï¼Œè¿™ç§è¯­æ³•å¾€å¾€ç”¨åšä¼šå¯¼è‡´ç¨‹åºå´©æºƒçš„å‡½æ•°ï¼š\n\n## 6.ç»ƒä¹ \n\n[æ•°å€¼ç±»å‹ - Rust By Practice( Rust ç»ƒä¹ å®è·µ )](https://zh.practice.rs/basic-types/numbers.html)\n\n```// å¡«ç©º\nfn main() {\n    let v: u16 = 38_u8 as u16; //ä»8ä½æ— ç¬¦å·æ•´æ•°ï¼ˆu8ï¼‰åˆ°16ä½æ— ç¬¦å·æ•´æ•°ï¼ˆu16ï¼‰çš„ç±»å‹è½¬æ¢\n}\n```\n\n```\n\n// ä¿®æ”¹ `assert_eq!` è®©ä»£ç å·¥ä½œ\nfn main() {\n    let x = 5;\t\t//i32\n    assert_eq!(\"i32\".to_string(), type_of(&x)); //\n}\n\n// ä»¥ä¸‹å‡½æ•°å¯ä»¥è·å–ä¼ å…¥å‚æ•°çš„ç±»å‹ï¼Œå¹¶è¿”å›ç±»å‹çš„å­—ç¬¦ä¸²å½¢å¼ï¼Œä¾‹å¦‚  \"i8\", \"u8\", \"i32\", \"u32\"\nfn type_of<T>(_: &T) -> String {\n    format!(\"{}\", std::any::type_name::<T>())\n}\n\n```\n\n```\nfn main() {\n    assert_eq!(i8::MAX, 127); \n    assert_eq!(u8::MAX, 255); \n}\n\n```\n\n```\n\n// è§£å†³ä»£ç ä¸­çš„é”™è¯¯å’Œ `panic`\nfn main() {\n   let v1 = 251_u8.wrapping_add(8);\n   let v2 = match u8::checked_add(251, 8) {\n        Some(value) => value,\n        None => {\n            println!(\"Overflow occurred.\");\n            0\n        }\n    };\n   println!(\"{},{}\",v1,v2);\n}\n\n```\n\n```\nfn main() {\n    let x = 1_000.000_1; // f64\n    let y: f32 = 0.12; // f32\n    let z = 0.01_f64; // f64\n}\n```\n\n```c\n#ä½¿ç”¨ä¸¤ç§æ–¹æ³•æ¥è®©ä¸‹é¢ä»£ç å·¥ä½œ\nfn main() {\n    assert!(0.1+0.2==0.3);\n}\n fn main() {\n     assert!(0.1_f32+0.2_f32==0.3_f32);\n }\n//é™ä½ç²¾åº¦\nfn main() {\n    let eps=0.001;\n    assert!((0.1_f64+ 0.2 - 0.3).abs() < eps);\n}\n//è®¾ç½®å…è®¸è¯¯å·®\n```\n\n### [åºåˆ—Range](https://zh.practice.rs/basic-types/numbers.html#åºåˆ—range)\n\n1. ğŸŒŸğŸŒŸ ä¸¤ä¸ªç›®æ ‡: 1. ä¿®æ”¹ `assert!` è®©å®ƒå·¥ä½œ 2. è®© `println!` è¾“å‡º: 97 - 122\n\n```\nfn main() {\n    let mut sum = 0;\n    for i in -3..2 {\n        sum += i\n    }\n\n    assert!(sum == -5);\n\n    for c in 'a'..='z' {\n        println!(\"{}\",c as u8);\n    }\n}\n\n```\n\n```\\// å¡«ç©º\nuse std::ops::{Range, RangeInclusive};\nfn main() {\n    assert_eq!((1..5), Range{ start: 1, end: 5 });\n    assert_eq!((1..=5), RangeInclusive::new(1, 5));\n}\n///RangeInclusive::new(1, 5) åˆ›å»ºçš„æ˜¯ä¸€ä¸ªé—­åŒºé—´ï¼Œè¡¨ç¤ºä» 1 åˆ° 5ï¼ˆåŒ…æ‹¬ 5ï¼‰çš„èŒƒå›´ã€‚è‹¥ (1..5) åˆ›å»ºçš„æ˜¯ä¸€ä¸ªåŠå¼€åŒºé—´ï¼Œè¡¨ç¤ºä» 1 åˆ° 5ï¼ˆä¸åŒ…æ‹¬ 5ï¼‰çš„èŒƒå›´ã€‚\n```\n\n```\nuse std::mem::size_of_val;\nfn main() {\n    let unit: () = ();\n    assert!(size_of_val(&unit) == 0);\t\t//å•å…ƒç±»å‹å ç”¨çš„å†…å­˜å¤§å° 0\n\n    println!(\"Success!\")\n}\n```\n\n### [è¯­å¥ä¸è¡¨è¾¾å¼](https://zh.practice.rs/basic-types/statements-expressions.html#è¯­å¥ä¸è¡¨è¾¾å¼)\n\n```\nfn main() {\n   let v = {\n       let mut x = 1;\n       x += 2\t\t// æ²¡æœ‰è¿”å›å€¼  \n   };\n\n   assert_eq!(v, 3);\n}\næ­£ç¡®çš„åšæ³•\nfn main() {\n   let v = {\n       let mut x = 1;\n       x += 2;\n       x\n   };\n\n   assert_eq!(v, 3);\n}\n\nlet z = {\n\t// åˆ†å·è®©è¡¨è¾¾å¼å˜æˆäº†è¯­å¥ï¼Œå› æ­¤è¿”å›çš„ä¸å†æ˜¯è¡¨è¾¾å¼ `2 * x` çš„å€¼ï¼Œè€Œæ˜¯è¯­å¥çš„å€¼ `()`\n\t2 * x;\n};\nfn main() {\n   let v = { let x = 3; x};\n\n   assert!(v == 3);\n}\n```\n\n### [å‡½æ•°](https://zh.practice.rs/basic-types/functions.html#å‡½æ•°)\n\n\n\n## 7.æ€»ç»“ï¼š\n\n1.`let x = 2.0; // f64`\n\n2.æ¯”è¾ƒæµ®ç‚¹æ•°`(0.1_f64 + 0.2 - 0.3).abs() < 0.00001`\n\n3.`ç¼–è¯‘å™¨ä¼šè¿›è¡Œè‡ªåŠ¨æ¨å¯¼ï¼Œç»™äºˆtwenty i32çš„ç±»å‹  let twenty = 20;`\n\n4.æŒ‰ç…§è¡¥ç å¾ªç¯æº¢å‡ºè§„åˆ™å¤„ç†`et b = 255_u8.wrapping_add(20);  // 19`  `åœ¨ u8 çš„æƒ…å†µä¸‹ï¼Œ256 å˜æˆ 0ï¼Œ257 å˜æˆ 1ï¼Œ`\n\n5.`(1..5)  è¡¨ç¤ºä» 1 åˆ° 5ï¼ˆä¸åŒ…æ‹¬ 5ï¼‰åŠå¼€åŒºé—´çš„èŒƒå›´`\n\n6.`(1..=5)  è¡¨ç¤ºä» 1 åˆ° 5ï¼ˆåŒ…æ‹¬ 5ï¼‰åŠé—­åŒºé—´çš„èŒƒå›´`\n\n6.**è¡¨è¾¾å¼ä¸èƒ½åŒ…å«åˆ†å·**ã€‚`è¡¨è¾¾å¼æ€»è¦è¿”å›å€¼`\n\n7.è¿”å›å€¼ä¸ºï¼çš„è¡¨è¾¾å¼\n\n```\nloop {}  \npanic!(\"Never return\");  \ntodo!();  \nunimplemented!();  //æœªå®ç°çš„å ä½ç¬¦å‡½æ•°\n \n```\n","source":"back_posts/02-ruståŸºæœ¬ç±»å‹.md","raw":"---\ntitle: 02-ruståŸºæœ¬ç±»å‹\ndate: 2023-08-26 21:17:00\ncategories:\n- rust\ntags:\n- ruståŸºæœ¬ç±»å‹\n- rust\n\n---\n\n\n\n\n\n\n\n\n\n[toc]\n\n# RuståŸºæœ¬æ•°æ®ç±»å‹\n\nRust æ¯ä¸ªå€¼éƒ½æœ‰å…¶ç¡®åˆ‡çš„æ•°æ®ç±»å‹ï¼Œæ€»çš„æ¥è¯´å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼šåŸºæœ¬ç±»å‹å’Œå¤åˆç±»å‹ã€‚ åŸºæœ¬ç±»å‹æ„å‘³ç€å®ƒä»¬å¾€å¾€æ˜¯ä¸€ä¸ªæœ€å°åŒ–åŸå­ç±»å‹ï¼Œæ— æ³•è§£æ„ä¸ºå…¶å®ƒç±»å‹(ä¸€èˆ¬æ„ä¹‰ä¸Šæ¥è¯´)ï¼Œç”±ä»¥ä¸‹ç»„æˆï¼š\n\n- æ•°å€¼ç±»å‹: æœ‰ç¬¦å·æ•´æ•° (`i8`, `i16`, `i32`, `i64`, `isize`)ã€ æ— ç¬¦å·æ•´æ•° (`u8`, `u16`, `u32`, `u64`, `usize`) ã€æµ®ç‚¹æ•° (`f32`, `f64`)ã€ä»¥åŠæœ‰ç†æ•°ã€å¤æ•°\n- å­—ç¬¦ä¸²ï¼šå­—ç¬¦ä¸²å­—é¢é‡å’Œå­—ç¬¦ä¸²åˆ‡ç‰‡ `&str`\n- å¸ƒå°”ç±»å‹ï¼š `true`å’Œ`false`\n- å­—ç¬¦ç±»å‹: è¡¨ç¤ºå•ä¸ª Unicode å­—ç¬¦ï¼Œå­˜å‚¨ä¸º 4 ä¸ªå­—èŠ‚\n- å•å…ƒç±»å‹: å³ `()` ï¼Œå…¶å”¯ä¸€çš„å€¼ä¹Ÿæ˜¯ `()`\n\n## 1.æ•°å€¼ç±»å‹\n\n| é•¿åº¦       | æœ‰ç¬¦å·ç±»å‹ | æ— ç¬¦å·ç±»å‹ |\n| ---------- | ---------- | ---------- |\n| 8 ä½       | `i8`       | `u8`       |\n| 16 ä½      | `i16`      | `u16`      |\n| 32 ä½      | `i32`      | `u32`      |\n| 64 ä½      | `i64`      | `u64`      |\n| 128 ä½     | `i128`     | `u128`     |\n| è§†æ¶æ„è€Œå®š | `isize`    | `usize`    |\n\næ•´å½¢å­—é¢é‡å¯ä»¥ç”¨ä¸‹è¡¨çš„å½¢å¼ä¹¦å†™ï¼š\n\n| æ•°å­—å­—é¢é‡         | ç¤ºä¾‹          |\n| ------------------ | ------------- |\n| åè¿›åˆ¶             | `98_222`      |\n| åå…­è¿›åˆ¶           | `0xff`        |\n| å…«è¿›åˆ¶             | `0o77`        |\n| äºŒè¿›åˆ¶             | `0b1111_0000` |\n| å­—èŠ‚ (ä»…é™äº `u8`) | `b'A'`        |\n\n## 2.[æµ®ç‚¹ç±»å‹](https://course.rs/basic/base-type/numbers.html#æµ®ç‚¹ç±»å‹)\n\n**æµ®ç‚¹ç±»å‹æ•°å­—** æ˜¯å¸¦æœ‰å°æ•°ç‚¹çš„æ•°å­—ï¼Œåœ¨ Rust ä¸­æµ®ç‚¹ç±»å‹æ•°å­—ä¹Ÿæœ‰ä¸¤ç§åŸºæœ¬ç±»å‹ï¼š `f32` å’Œ `f64`ï¼Œåˆ†åˆ«ä¸º 32 ä½å’Œ 64 ä½å¤§å°ã€‚é»˜è®¤æµ®ç‚¹ç±»å‹æ˜¯ `f64`ï¼Œåœ¨ç°ä»£çš„ CPU ä¸­å®ƒçš„é€Ÿåº¦ä¸ `f32` å‡ ä¹ç›¸åŒï¼Œä½†ç²¾åº¦æ›´é«˜ã€‚\n\nä¸‹é¢æ˜¯ä¸€ä¸ªæ¼”ç¤ºæµ®ç‚¹æ•°çš„ç¤ºä¾‹ï¼š\n\n```rust\nfn main() {\n    let x = 2.0; // f64\n\n    let y: f32 = 3.0; // f32\n}\n```\n\n## 3.[åºåˆ—(Range)](https://course.rs/basic/base-type/numbers.html#åºåˆ—range)\n\nRust æä¾›äº†ä¸€ä¸ªéå¸¸ç®€æ´çš„æ–¹å¼ï¼Œç”¨æ¥ç”Ÿæˆè¿ç»­çš„æ•°å€¼ï¼Œä¾‹å¦‚ **`1..5`ï¼Œç”Ÿæˆä» 1 åˆ° 4 çš„è¿ç»­æ•°å­—ï¼Œä¸åŒ…å« 5** ï¼›`1..=5`ï¼Œç”Ÿæˆä» 1 åˆ° 5 çš„è¿ç»­æ•°å­—ï¼ŒåŒ…å« 5ï¼Œå®ƒçš„ç”¨é€”å¾ˆç®€å•ï¼Œå¸¸å¸¸ç”¨äºå¾ªç¯ä¸­ï¼š\n\n```rust\nfor i in 1..=5 {\n    println!(\"{}\",i);\n}\n```\n\næœ€ç»ˆç¨‹åºè¾“å‡º:\n\n```console\n1\n2\n3\n4\n5\n```\n\n**åºåˆ—åªå…è®¸ç”¨äºæ•°å­—æˆ–å­—ç¬¦ç±»å‹**ï¼ŒåŸå› æ˜¯ï¼šå®ƒä»¬å¯ä»¥è¿ç»­ï¼ŒåŒæ—¶ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æœŸå¯ä»¥æ£€æŸ¥è¯¥åºåˆ—æ˜¯å¦ä¸ºç©ºï¼Œå­—ç¬¦å’Œæ•°å­—å€¼æ˜¯ Rust ä¸­ä»…æœ‰çš„å¯ä»¥ç”¨äºåˆ¤æ–­æ˜¯å¦ä¸ºç©ºçš„ç±»å‹ã€‚å¦‚ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨å­—ç¬¦ç±»å‹åºåˆ—çš„ä¾‹å­ï¼š\n\n```rust\nfor i in 'a'..='z' {\n    println!(\"{}\",i);\n}\n```\n\n## 4.[æœ‰ç†æ•°å’Œå¤æ•°](https://course.rs/basic/base-type/numbers.html#æœ‰ç†æ•°å’Œå¤æ•°)\n\nRust çš„æ ‡å‡†åº“ç›¸æ¯”å…¶å®ƒè¯­è¨€ï¼Œå‡†å…¥é—¨æ§›è¾ƒé«˜ï¼Œå› æ­¤æœ‰ç†æ•°å’Œå¤æ•°å¹¶æœªåŒ…å«åœ¨æ ‡å‡†åº“ä¸­ï¼š\n\n- æœ‰ç†æ•°å’Œå¤æ•°\n- ä»»æ„å¤§å°çš„æ•´æ•°å’Œä»»æ„ç²¾åº¦çš„æµ®ç‚¹æ•°\n- å›ºå®šç²¾åº¦çš„åè¿›åˆ¶å°æ•°ï¼Œå¸¸ç”¨äºè´§å¸ç›¸å…³çš„åœºæ™¯\n\nå¥½åœ¨ç¤¾åŒºå·²ç»å¼€å‘å‡ºé«˜è´¨é‡çš„ Rust æ•°å€¼åº“ï¼š[num](https://crates.io/crates/num)ã€‚\n\næŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ¥å¼•å…¥ `num` åº“ï¼š\n\n1. åˆ›å»ºæ–°å·¥ç¨‹ `cargo new complex-num && cd complex-num`\n2. åœ¨ `Cargo.toml` ä¸­çš„ `[dependencies]` ä¸‹æ·»åŠ ä¸€è¡Œ `num = \"0.4.0\"`\n3. å°† `src/main.rs` æ–‡ä»¶ä¸­çš„ `main` å‡½æ•°æ›¿æ¢ä¸ºä¸‹é¢çš„ä»£ç \n4. è¿è¡Œ `cargo run`\n\n```rust\nuse num::complex::Complex;\n\n fn main() {\n   let a = Complex { re: 2.1, im: -1.2 };\n   let b = Complex::new(11.1, 22.2);\n   let result = a + b;\n\n   println!(\"{} + {}i\", result.re, result.im)\n }\n```\n\n#### [æ€»ç»“](https://course.rs/basic/base-type/numbers.html#æ€»ç»“)\n\nä¹‹å‰æåˆ°äº†è¿‡ Rust çš„æ•°å€¼ç±»å‹å’Œè¿ç®—è·Ÿå…¶ä»–è¯­è¨€è¾ƒä¸ºç›¸ä¼¼ï¼Œä½†æ˜¯å®é™…ä¸Šï¼Œé™¤äº†è¯­æ³•ä¸Šçš„ä¸åŒä¹‹å¤–ï¼Œè¿˜æ˜¯å­˜åœ¨ä¸€äº›å·®å¼‚ç‚¹ï¼š\n\n- **Rust æ‹¥æœ‰ç›¸å½“å¤šçš„æ•°å€¼ç±»å‹**. å› æ­¤ä½ éœ€è¦ç†Ÿæ‚‰è¿™äº›ç±»å‹æ‰€å ç”¨çš„å­—èŠ‚æ•°ï¼Œè¿™æ ·å°±çŸ¥é“è¯¥ç±»å‹å…è®¸çš„å¤§å°èŒƒå›´ä»¥åŠä½ é€‰æ‹©çš„ç±»å‹æ˜¯å¦èƒ½è¡¨è¾¾è´Ÿæ•°\n- **ç±»å‹è½¬æ¢å¿…é¡»æ˜¯æ˜¾å¼çš„**. Rust æ°¸è¿œä¹Ÿä¸ä¼šå·å·æŠŠä½ çš„ 16bit æ•´æ•°è½¬æ¢æˆ 32bit æ•´æ•°\n- **Rust çš„æ•°å€¼ä¸Šå¯ä»¥ä½¿ç”¨æ–¹æ³•**. ä¾‹å¦‚ä½ å¯ä»¥ç”¨ä»¥ä¸‹æ–¹æ³•æ¥å°† `13.14` å–æ•´ï¼š`13.14_f32.round()`ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº†ç±»å‹åç¼€ï¼Œå› ä¸ºç¼–è¯‘å™¨éœ€è¦çŸ¥é“ `13.14` çš„å…·ä½“ç±»å‹\n\n## 5.[å‡½æ•°è¦ç‚¹](https://course.rs/basic/base-type/function.html#å‡½æ•°è¦ç‚¹)\n\n- å‡½æ•°åå’Œå˜é‡åä½¿ç”¨[è›‡å½¢å‘½åæ³•(snake case)](https://course.rs/practice/naming.html)ï¼Œä¾‹å¦‚ `fn add_two() -> {}`\n- å‡½æ•°çš„ä½ç½®å¯ä»¥éšä¾¿æ”¾ï¼ŒRust ä¸å…³å¿ƒæˆ‘ä»¬åœ¨å“ªé‡Œå®šä¹‰äº†å‡½æ•°ï¼Œåªè¦æœ‰å®šä¹‰å³å¯\n- æ¯ä¸ªå‡½æ•°å‚æ•°éƒ½éœ€è¦æ ‡æ³¨ç±»å‹\n\n```\nfn add(i: i32, j: i32) -> i32 {\n   i + j\n }\n\n```\n\n![img](https://pic2.zhimg.com/80/v2-54b3a6d435d2482243edc4be9ab98153_1440w.png)\n\n### è¿”å›å€¼ï¼š\n\nâ€‹\t[æ— è¿”å›å€¼`()`](https://course.rs/basic/base-type/function.html#æ— è¿”å›å€¼)\n\n- å‡½æ•°æ²¡æœ‰è¿”å›å€¼ï¼Œé‚£ä¹ˆè¿”å›ä¸€ä¸ª `()`\n- é€šè¿‡ `;` ç»“å°¾çš„è¡¨è¾¾å¼è¿”å›ä¸€ä¸ª `()`\n\nâ€‹    [æ°¸ä¸è¿”å›çš„å‘æ•£å‡½æ•° `!`](https://course.rs/basic/base-type/function.html#æ°¸ä¸è¿”å›çš„å‘æ•£å‡½æ•°-)\n\nâ€‹\t\tå½“ç”¨ `!` ä½œå‡½æ•°è¿”å›ç±»å‹çš„æ—¶å€™ï¼Œè¡¨ç¤ºè¯¥å‡½æ•°æ°¸ä¸è¿”å›( diverge function )ï¼Œç‰¹åˆ«çš„ï¼Œè¿™ç§è¯­æ³•å¾€å¾€ç”¨åšä¼šå¯¼è‡´ç¨‹åºå´©æºƒçš„å‡½æ•°ï¼š\n\n## 6.ç»ƒä¹ \n\n[æ•°å€¼ç±»å‹ - Rust By Practice( Rust ç»ƒä¹ å®è·µ )](https://zh.practice.rs/basic-types/numbers.html)\n\n```// å¡«ç©º\nfn main() {\n    let v: u16 = 38_u8 as u16; //ä»8ä½æ— ç¬¦å·æ•´æ•°ï¼ˆu8ï¼‰åˆ°16ä½æ— ç¬¦å·æ•´æ•°ï¼ˆu16ï¼‰çš„ç±»å‹è½¬æ¢\n}\n```\n\n```\n\n// ä¿®æ”¹ `assert_eq!` è®©ä»£ç å·¥ä½œ\nfn main() {\n    let x = 5;\t\t//i32\n    assert_eq!(\"i32\".to_string(), type_of(&x)); //\n}\n\n// ä»¥ä¸‹å‡½æ•°å¯ä»¥è·å–ä¼ å…¥å‚æ•°çš„ç±»å‹ï¼Œå¹¶è¿”å›ç±»å‹çš„å­—ç¬¦ä¸²å½¢å¼ï¼Œä¾‹å¦‚  \"i8\", \"u8\", \"i32\", \"u32\"\nfn type_of<T>(_: &T) -> String {\n    format!(\"{}\", std::any::type_name::<T>())\n}\n\n```\n\n```\nfn main() {\n    assert_eq!(i8::MAX, 127); \n    assert_eq!(u8::MAX, 255); \n}\n\n```\n\n```\n\n// è§£å†³ä»£ç ä¸­çš„é”™è¯¯å’Œ `panic`\nfn main() {\n   let v1 = 251_u8.wrapping_add(8);\n   let v2 = match u8::checked_add(251, 8) {\n        Some(value) => value,\n        None => {\n            println!(\"Overflow occurred.\");\n            0\n        }\n    };\n   println!(\"{},{}\",v1,v2);\n}\n\n```\n\n```\nfn main() {\n    let x = 1_000.000_1; // f64\n    let y: f32 = 0.12; // f32\n    let z = 0.01_f64; // f64\n}\n```\n\n```c\n#ä½¿ç”¨ä¸¤ç§æ–¹æ³•æ¥è®©ä¸‹é¢ä»£ç å·¥ä½œ\nfn main() {\n    assert!(0.1+0.2==0.3);\n}\n fn main() {\n     assert!(0.1_f32+0.2_f32==0.3_f32);\n }\n//é™ä½ç²¾åº¦\nfn main() {\n    let eps=0.001;\n    assert!((0.1_f64+ 0.2 - 0.3).abs() < eps);\n}\n//è®¾ç½®å…è®¸è¯¯å·®\n```\n\n### [åºåˆ—Range](https://zh.practice.rs/basic-types/numbers.html#åºåˆ—range)\n\n1. ğŸŒŸğŸŒŸ ä¸¤ä¸ªç›®æ ‡: 1. ä¿®æ”¹ `assert!` è®©å®ƒå·¥ä½œ 2. è®© `println!` è¾“å‡º: 97 - 122\n\n```\nfn main() {\n    let mut sum = 0;\n    for i in -3..2 {\n        sum += i\n    }\n\n    assert!(sum == -5);\n\n    for c in 'a'..='z' {\n        println!(\"{}\",c as u8);\n    }\n}\n\n```\n\n```\\// å¡«ç©º\nuse std::ops::{Range, RangeInclusive};\nfn main() {\n    assert_eq!((1..5), Range{ start: 1, end: 5 });\n    assert_eq!((1..=5), RangeInclusive::new(1, 5));\n}\n///RangeInclusive::new(1, 5) åˆ›å»ºçš„æ˜¯ä¸€ä¸ªé—­åŒºé—´ï¼Œè¡¨ç¤ºä» 1 åˆ° 5ï¼ˆåŒ…æ‹¬ 5ï¼‰çš„èŒƒå›´ã€‚è‹¥ (1..5) åˆ›å»ºçš„æ˜¯ä¸€ä¸ªåŠå¼€åŒºé—´ï¼Œè¡¨ç¤ºä» 1 åˆ° 5ï¼ˆä¸åŒ…æ‹¬ 5ï¼‰çš„èŒƒå›´ã€‚\n```\n\n```\nuse std::mem::size_of_val;\nfn main() {\n    let unit: () = ();\n    assert!(size_of_val(&unit) == 0);\t\t//å•å…ƒç±»å‹å ç”¨çš„å†…å­˜å¤§å° 0\n\n    println!(\"Success!\")\n}\n```\n\n### [è¯­å¥ä¸è¡¨è¾¾å¼](https://zh.practice.rs/basic-types/statements-expressions.html#è¯­å¥ä¸è¡¨è¾¾å¼)\n\n```\nfn main() {\n   let v = {\n       let mut x = 1;\n       x += 2\t\t// æ²¡æœ‰è¿”å›å€¼  \n   };\n\n   assert_eq!(v, 3);\n}\næ­£ç¡®çš„åšæ³•\nfn main() {\n   let v = {\n       let mut x = 1;\n       x += 2;\n       x\n   };\n\n   assert_eq!(v, 3);\n}\n\nlet z = {\n\t// åˆ†å·è®©è¡¨è¾¾å¼å˜æˆäº†è¯­å¥ï¼Œå› æ­¤è¿”å›çš„ä¸å†æ˜¯è¡¨è¾¾å¼ `2 * x` çš„å€¼ï¼Œè€Œæ˜¯è¯­å¥çš„å€¼ `()`\n\t2 * x;\n};\nfn main() {\n   let v = { let x = 3; x};\n\n   assert!(v == 3);\n}\n```\n\n### [å‡½æ•°](https://zh.practice.rs/basic-types/functions.html#å‡½æ•°)\n\n\n\n## 7.æ€»ç»“ï¼š\n\n1.`let x = 2.0; // f64`\n\n2.æ¯”è¾ƒæµ®ç‚¹æ•°`(0.1_f64 + 0.2 - 0.3).abs() < 0.00001`\n\n3.`ç¼–è¯‘å™¨ä¼šè¿›è¡Œè‡ªåŠ¨æ¨å¯¼ï¼Œç»™äºˆtwenty i32çš„ç±»å‹  let twenty = 20;`\n\n4.æŒ‰ç…§è¡¥ç å¾ªç¯æº¢å‡ºè§„åˆ™å¤„ç†`et b = 255_u8.wrapping_add(20);  // 19`  `åœ¨ u8 çš„æƒ…å†µä¸‹ï¼Œ256 å˜æˆ 0ï¼Œ257 å˜æˆ 1ï¼Œ`\n\n5.`(1..5)  è¡¨ç¤ºä» 1 åˆ° 5ï¼ˆä¸åŒ…æ‹¬ 5ï¼‰åŠå¼€åŒºé—´çš„èŒƒå›´`\n\n6.`(1..=5)  è¡¨ç¤ºä» 1 åˆ° 5ï¼ˆåŒ…æ‹¬ 5ï¼‰åŠé—­åŒºé—´çš„èŒƒå›´`\n\n6.**è¡¨è¾¾å¼ä¸èƒ½åŒ…å«åˆ†å·**ã€‚`è¡¨è¾¾å¼æ€»è¦è¿”å›å€¼`\n\n7.è¿”å›å€¼ä¸ºï¼çš„è¡¨è¾¾å¼\n\n```\nloop {}  \npanic!(\"Never return\");  \ntodo!();  \nunimplemented!();  //æœªå®ç°çš„å ä½ç¬¦å‡½æ•°\n \n```\n","updated":"2024-05-15T06:11:08.980Z","path":"back_posts/02-ruståŸºæœ¬ç±»å‹.html","comments":1,"layout":"page","_id":"clw7fflkf0000x2w0001j3j23","content":"<p>[toc]</p>\n<h1 id=\"RuståŸºæœ¬æ•°æ®ç±»å‹\"><a href=\"#RuståŸºæœ¬æ•°æ®ç±»å‹\" class=\"headerlink\" title=\"RuståŸºæœ¬æ•°æ®ç±»å‹\"></a>RuståŸºæœ¬æ•°æ®ç±»å‹</h1><p>Rust æ¯ä¸ªå€¼éƒ½æœ‰å…¶ç¡®åˆ‡çš„æ•°æ®ç±»å‹ï¼Œæ€»çš„æ¥è¯´å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼šåŸºæœ¬ç±»å‹å’Œå¤åˆç±»å‹ã€‚ åŸºæœ¬ç±»å‹æ„å‘³ç€å®ƒä»¬å¾€å¾€æ˜¯ä¸€ä¸ªæœ€å°åŒ–åŸå­ç±»å‹ï¼Œæ— æ³•è§£æ„ä¸ºå…¶å®ƒç±»å‹(ä¸€èˆ¬æ„ä¹‰ä¸Šæ¥è¯´)ï¼Œç”±ä»¥ä¸‹ç»„æˆï¼š</p>\n<ul>\n<li>æ•°å€¼ç±»å‹: æœ‰ç¬¦å·æ•´æ•° (<code>i8</code>, <code>i16</code>, <code>i32</code>, <code>i64</code>, <code>isize</code>)ã€ æ— ç¬¦å·æ•´æ•° (<code>u8</code>, <code>u16</code>, <code>u32</code>, <code>u64</code>, <code>usize</code>) ã€æµ®ç‚¹æ•° (<code>f32</code>, <code>f64</code>)ã€ä»¥åŠæœ‰ç†æ•°ã€å¤æ•°</li>\n<li>å­—ç¬¦ä¸²ï¼šå­—ç¬¦ä¸²å­—é¢é‡å’Œå­—ç¬¦ä¸²åˆ‡ç‰‡ <code>&amp;str</code></li>\n<li>å¸ƒå°”ç±»å‹ï¼š <code>true</code>å’Œ<code>false</code></li>\n<li>å­—ç¬¦ç±»å‹: è¡¨ç¤ºå•ä¸ª Unicode å­—ç¬¦ï¼Œå­˜å‚¨ä¸º 4 ä¸ªå­—èŠ‚</li>\n<li>å•å…ƒç±»å‹: å³ <code>()</code> ï¼Œå…¶å”¯ä¸€çš„å€¼ä¹Ÿæ˜¯ <code>()</code></li>\n</ul>\n<h2 id=\"1-æ•°å€¼ç±»å‹\"><a href=\"#1-æ•°å€¼ç±»å‹\" class=\"headerlink\" title=\"1.æ•°å€¼ç±»å‹\"></a>1.æ•°å€¼ç±»å‹</h2><table>\n<thead>\n<tr>\n<th>é•¿åº¦</th>\n<th>æœ‰ç¬¦å·ç±»å‹</th>\n<th>æ— ç¬¦å·ç±»å‹</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>8 ä½</td>\n<td><code>i8</code></td>\n<td><code>u8</code></td>\n</tr>\n<tr>\n<td>16 ä½</td>\n<td><code>i16</code></td>\n<td><code>u16</code></td>\n</tr>\n<tr>\n<td>32 ä½</td>\n<td><code>i32</code></td>\n<td><code>u32</code></td>\n</tr>\n<tr>\n<td>64 ä½</td>\n<td><code>i64</code></td>\n<td><code>u64</code></td>\n</tr>\n<tr>\n<td>128 ä½</td>\n<td><code>i128</code></td>\n<td><code>u128</code></td>\n</tr>\n<tr>\n<td>è§†æ¶æ„è€Œå®š</td>\n<td><code>isize</code></td>\n<td><code>usize</code></td>\n</tr>\n</tbody></table>\n<p>æ•´å½¢å­—é¢é‡å¯ä»¥ç”¨ä¸‹è¡¨çš„å½¢å¼ä¹¦å†™ï¼š</p>\n<table>\n<thead>\n<tr>\n<th>æ•°å­—å­—é¢é‡</th>\n<th>ç¤ºä¾‹</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>åè¿›åˆ¶</td>\n<td><code>98_222</code></td>\n</tr>\n<tr>\n<td>åå…­è¿›åˆ¶</td>\n<td><code>0xff</code></td>\n</tr>\n<tr>\n<td>å…«è¿›åˆ¶</td>\n<td><code>0o77</code></td>\n</tr>\n<tr>\n<td>äºŒè¿›åˆ¶</td>\n<td><code>0b1111_0000</code></td>\n</tr>\n<tr>\n<td>å­—èŠ‚ (ä»…é™äº <code>u8</code>)</td>\n<td><code>b&#39;A&#39;</code></td>\n</tr>\n</tbody></table>\n<h2 id=\"2-æµ®ç‚¹ç±»å‹\"><a href=\"#2-æµ®ç‚¹ç±»å‹\" class=\"headerlink\" title=\"2.æµ®ç‚¹ç±»å‹\"></a>2.<a href=\"https://course.rs/basic/base-type/numbers.html#%E6%B5%AE%E7%82%B9%E7%B1%BB%E5%9E%8B\">æµ®ç‚¹ç±»å‹</a></h2><p><strong>æµ®ç‚¹ç±»å‹æ•°å­—</strong> æ˜¯å¸¦æœ‰å°æ•°ç‚¹çš„æ•°å­—ï¼Œåœ¨ Rust ä¸­æµ®ç‚¹ç±»å‹æ•°å­—ä¹Ÿæœ‰ä¸¤ç§åŸºæœ¬ç±»å‹ï¼š <code>f32</code> å’Œ <code>f64</code>ï¼Œåˆ†åˆ«ä¸º 32 ä½å’Œ 64 ä½å¤§å°ã€‚é»˜è®¤æµ®ç‚¹ç±»å‹æ˜¯ <code>f64</code>ï¼Œåœ¨ç°ä»£çš„ CPU ä¸­å®ƒçš„é€Ÿåº¦ä¸ <code>f32</code> å‡ ä¹ç›¸åŒï¼Œä½†ç²¾åº¦æ›´é«˜ã€‚</p>\n<p>ä¸‹é¢æ˜¯ä¸€ä¸ªæ¼”ç¤ºæµ®ç‚¹æ•°çš„ç¤ºä¾‹ï¼š</p>\n<figure class=\"highlight rust\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">fn</span> <span class=\"title function_\">main</span>() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> <span class=\"variable\">x</span> = <span class=\"number\">2.0</span>; <span class=\"comment\">// f64</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">let</span> <span class=\"variable\">y</span>: <span class=\"type\">f32</span> = <span class=\"number\">3.0</span>; <span class=\"comment\">// f32</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3-åºåˆ—-Range\"><a href=\"#3-åºåˆ—-Range\" class=\"headerlink\" title=\"3.åºåˆ—(Range)\"></a>3.<a href=\"https://course.rs/basic/base-type/numbers.html#%E5%BA%8F%E5%88%97range\">åºåˆ—(Range)</a></h2><p>Rust æä¾›äº†ä¸€ä¸ªéå¸¸ç®€æ´çš„æ–¹å¼ï¼Œç”¨æ¥ç”Ÿæˆè¿ç»­çš„æ•°å€¼ï¼Œä¾‹å¦‚ <strong><code>1..5</code>ï¼Œç”Ÿæˆä» 1 åˆ° 4 çš„è¿ç»­æ•°å­—ï¼Œä¸åŒ…å« 5</strong> ï¼›<code>1..=5</code>ï¼Œç”Ÿæˆä» 1 åˆ° 5 çš„è¿ç»­æ•°å­—ï¼ŒåŒ…å« 5ï¼Œå®ƒçš„ç”¨é€”å¾ˆç®€å•ï¼Œå¸¸å¸¸ç”¨äºå¾ªç¯ä¸­ï¼š</p>\n<figure class=\"highlight rust\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"variable\">i</span> <span class=\"keyword\">in</span> <span class=\"number\">1</span>..=<span class=\"number\">5</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">println!</span>(<span class=\"string\">&quot;&#123;&#125;&quot;</span>,i);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>æœ€ç»ˆç¨‹åºè¾“å‡º:</p>\n<figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td></tr></table></figure>\n\n<p><strong>åºåˆ—åªå…è®¸ç”¨äºæ•°å­—æˆ–å­—ç¬¦ç±»å‹</strong>ï¼ŒåŸå› æ˜¯ï¼šå®ƒä»¬å¯ä»¥è¿ç»­ï¼ŒåŒæ—¶ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æœŸå¯ä»¥æ£€æŸ¥è¯¥åºåˆ—æ˜¯å¦ä¸ºç©ºï¼Œå­—ç¬¦å’Œæ•°å­—å€¼æ˜¯ Rust ä¸­ä»…æœ‰çš„å¯ä»¥ç”¨äºåˆ¤æ–­æ˜¯å¦ä¸ºç©ºçš„ç±»å‹ã€‚å¦‚ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨å­—ç¬¦ç±»å‹åºåˆ—çš„ä¾‹å­ï¼š</p>\n<figure class=\"highlight rust\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"variable\">i</span> <span class=\"keyword\">in</span> <span class=\"string\">&#x27;a&#x27;</span>..=<span class=\"string\">&#x27;z&#x27;</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">println!</span>(<span class=\"string\">&quot;&#123;&#125;&quot;</span>,i);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"4-æœ‰ç†æ•°å’Œå¤æ•°\"><a href=\"#4-æœ‰ç†æ•°å’Œå¤æ•°\" class=\"headerlink\" title=\"4.æœ‰ç†æ•°å’Œå¤æ•°\"></a>4.<a href=\"https://course.rs/basic/base-type/numbers.html#%E6%9C%89%E7%90%86%E6%95%B0%E5%92%8C%E5%A4%8D%E6%95%B0\">æœ‰ç†æ•°å’Œå¤æ•°</a></h2><p>Rust çš„æ ‡å‡†åº“ç›¸æ¯”å…¶å®ƒè¯­è¨€ï¼Œå‡†å…¥é—¨æ§›è¾ƒé«˜ï¼Œå› æ­¤æœ‰ç†æ•°å’Œå¤æ•°å¹¶æœªåŒ…å«åœ¨æ ‡å‡†åº“ä¸­ï¼š</p>\n<ul>\n<li>æœ‰ç†æ•°å’Œå¤æ•°</li>\n<li>ä»»æ„å¤§å°çš„æ•´æ•°å’Œä»»æ„ç²¾åº¦çš„æµ®ç‚¹æ•°</li>\n<li>å›ºå®šç²¾åº¦çš„åè¿›åˆ¶å°æ•°ï¼Œå¸¸ç”¨äºè´§å¸ç›¸å…³çš„åœºæ™¯</li>\n</ul>\n<p>å¥½åœ¨ç¤¾åŒºå·²ç»å¼€å‘å‡ºé«˜è´¨é‡çš„ Rust æ•°å€¼åº“ï¼š<a href=\"https://crates.io/crates/num\">num</a>ã€‚</p>\n<p>æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ¥å¼•å…¥ <code>num</code> åº“ï¼š</p>\n<ol>\n<li>åˆ›å»ºæ–°å·¥ç¨‹ <code>cargo new complex-num &amp;&amp; cd complex-num</code></li>\n<li>åœ¨ <code>Cargo.toml</code> ä¸­çš„ <code>[dependencies]</code> ä¸‹æ·»åŠ ä¸€è¡Œ <code>num = &quot;0.4.0&quot;</code></li>\n<li>å°† <code>src/main.rs</code> æ–‡ä»¶ä¸­çš„ <code>main</code> å‡½æ•°æ›¿æ¢ä¸ºä¸‹é¢çš„ä»£ç </li>\n<li>è¿è¡Œ <code>cargo run</code></li>\n</ol>\n<figure class=\"highlight rust\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">use</span> num::complex::Complex;</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"keyword\">fn</span> <span class=\"title function_\">main</span>() &#123;</span><br><span class=\"line\">   <span class=\"keyword\">let</span> <span class=\"variable\">a</span> = Complex &#123; re: <span class=\"number\">2.1</span>, im: -<span class=\"number\">1.2</span> &#125;;</span><br><span class=\"line\">   <span class=\"keyword\">let</span> <span class=\"variable\">b</span> = Complex::<span class=\"title function_ invoke__\">new</span>(<span class=\"number\">11.1</span>, <span class=\"number\">22.2</span>);</span><br><span class=\"line\">   <span class=\"keyword\">let</span> <span class=\"variable\">result</span> = a + b;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"built_in\">println!</span>(<span class=\"string\">&quot;&#123;&#125; + &#123;&#125;i&quot;</span>, result.re, result.im)</span><br><span class=\"line\"> &#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a><a href=\"https://course.rs/basic/base-type/numbers.html#%E6%80%BB%E7%BB%93\">æ€»ç»“</a></h4><p>ä¹‹å‰æåˆ°äº†è¿‡ Rust çš„æ•°å€¼ç±»å‹å’Œè¿ç®—è·Ÿå…¶ä»–è¯­è¨€è¾ƒä¸ºç›¸ä¼¼ï¼Œä½†æ˜¯å®é™…ä¸Šï¼Œé™¤äº†è¯­æ³•ä¸Šçš„ä¸åŒä¹‹å¤–ï¼Œè¿˜æ˜¯å­˜åœ¨ä¸€äº›å·®å¼‚ç‚¹ï¼š</p>\n<ul>\n<li><strong>Rust æ‹¥æœ‰ç›¸å½“å¤šçš„æ•°å€¼ç±»å‹</strong>. å› æ­¤ä½ éœ€è¦ç†Ÿæ‚‰è¿™äº›ç±»å‹æ‰€å ç”¨çš„å­—èŠ‚æ•°ï¼Œè¿™æ ·å°±çŸ¥é“è¯¥ç±»å‹å…è®¸çš„å¤§å°èŒƒå›´ä»¥åŠä½ é€‰æ‹©çš„ç±»å‹æ˜¯å¦èƒ½è¡¨è¾¾è´Ÿæ•°</li>\n<li><strong>ç±»å‹è½¬æ¢å¿…é¡»æ˜¯æ˜¾å¼çš„</strong>. Rust æ°¸è¿œä¹Ÿä¸ä¼šå·å·æŠŠä½ çš„ 16bit æ•´æ•°è½¬æ¢æˆ 32bit æ•´æ•°</li>\n<li><strong>Rust çš„æ•°å€¼ä¸Šå¯ä»¥ä½¿ç”¨æ–¹æ³•</strong>. ä¾‹å¦‚ä½ å¯ä»¥ç”¨ä»¥ä¸‹æ–¹æ³•æ¥å°† <code>13.14</code> å–æ•´ï¼š<code>13.14_f32.round()</code>ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº†ç±»å‹åç¼€ï¼Œå› ä¸ºç¼–è¯‘å™¨éœ€è¦çŸ¥é“ <code>13.14</code> çš„å…·ä½“ç±»å‹</li>\n</ul>\n<h2 id=\"5-å‡½æ•°è¦ç‚¹\"><a href=\"#5-å‡½æ•°è¦ç‚¹\" class=\"headerlink\" title=\"5.å‡½æ•°è¦ç‚¹\"></a>5.<a href=\"https://course.rs/basic/base-type/function.html#%E5%87%BD%E6%95%B0%E8%A6%81%E7%82%B9\">å‡½æ•°è¦ç‚¹</a></h2><ul>\n<li>å‡½æ•°åå’Œå˜é‡åä½¿ç”¨<a href=\"https://course.rs/practice/naming.html\">è›‡å½¢å‘½åæ³•(snake case)</a>ï¼Œä¾‹å¦‚ <code>fn add_two() -&gt; &#123;&#125;</code></li>\n<li>å‡½æ•°çš„ä½ç½®å¯ä»¥éšä¾¿æ”¾ï¼ŒRust ä¸å…³å¿ƒæˆ‘ä»¬åœ¨å“ªé‡Œå®šä¹‰äº†å‡½æ•°ï¼Œåªè¦æœ‰å®šä¹‰å³å¯</li>\n<li>æ¯ä¸ªå‡½æ•°å‚æ•°éƒ½éœ€è¦æ ‡æ³¨ç±»å‹</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fn add(i: i32, j: i32) -&gt; i32 &#123;</span><br><span class=\"line\">   i + j</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://pic2.zhimg.com/80/v2-54b3a6d435d2482243edc4be9ab98153_1440w.png\" alt=\"img\"></p>\n<h3 id=\"è¿”å›å€¼ï¼š\"><a href=\"#è¿”å›å€¼ï¼š\" class=\"headerlink\" title=\"è¿”å›å€¼ï¼š\"></a>è¿”å›å€¼ï¼š</h3><p>â€‹\t<a href=\"https://course.rs/basic/base-type/function.html#%E6%97%A0%E8%BF%94%E5%9B%9E%E5%80%BC\">æ— è¿”å›å€¼<code>()</code></a></p>\n<ul>\n<li>å‡½æ•°æ²¡æœ‰è¿”å›å€¼ï¼Œé‚£ä¹ˆè¿”å›ä¸€ä¸ª <code>()</code></li>\n<li>é€šè¿‡ <code>;</code> ç»“å°¾çš„è¡¨è¾¾å¼è¿”å›ä¸€ä¸ª <code>()</code></li>\n</ul>\n<p>â€‹    <a href=\"https://course.rs/basic/base-type/function.html#%E6%B0%B8%E4%B8%8D%E8%BF%94%E5%9B%9E%E7%9A%84%E5%8F%91%E6%95%A3%E5%87%BD%E6%95%B0-\">æ°¸ä¸è¿”å›çš„å‘æ•£å‡½æ•° <code>!</code></a></p>\n<p>â€‹\t\tå½“ç”¨ <code>!</code> ä½œå‡½æ•°è¿”å›ç±»å‹çš„æ—¶å€™ï¼Œè¡¨ç¤ºè¯¥å‡½æ•°æ°¸ä¸è¿”å›( diverge function )ï¼Œç‰¹åˆ«çš„ï¼Œè¿™ç§è¯­æ³•å¾€å¾€ç”¨åšä¼šå¯¼è‡´ç¨‹åºå´©æºƒçš„å‡½æ•°ï¼š</p>\n<h2 id=\"6-ç»ƒä¹ \"><a href=\"#6-ç»ƒä¹ \" class=\"headerlink\" title=\"6.ç»ƒä¹ \"></a>6.ç»ƒä¹ </h2><p><a href=\"https://zh.practice.rs/basic-types/numbers.html\">æ•°å€¼ç±»å‹ - Rust By Practice( Rust ç»ƒä¹ å®è·µ )</a></p>\n<figure class=\"highlight plaintext\"><figcaption><span>å¡«ç©º</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let v: u16 = 38_u8 as u16; //ä»8ä½æ— ç¬¦å·æ•´æ•°ï¼ˆu8ï¼‰åˆ°16ä½æ— ç¬¦å·æ•´æ•°ï¼ˆu16ï¼‰çš„ç±»å‹è½¬æ¢</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">// ä¿®æ”¹ `assert_eq!` è®©ä»£ç å·¥ä½œ</span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let x = 5;\t\t//i32</span><br><span class=\"line\">    assert_eq!(&quot;i32&quot;.to_string(), type_of(&amp;x)); //</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// ä»¥ä¸‹å‡½æ•°å¯ä»¥è·å–ä¼ å…¥å‚æ•°çš„ç±»å‹ï¼Œå¹¶è¿”å›ç±»å‹çš„å­—ç¬¦ä¸²å½¢å¼ï¼Œä¾‹å¦‚  &quot;i8&quot;, &quot;u8&quot;, &quot;i32&quot;, &quot;u32&quot;</span><br><span class=\"line\">fn type_of&lt;T&gt;(_: &amp;T) -&gt; String &#123;</span><br><span class=\"line\">    format!(&quot;&#123;&#125;&quot;, std::any::type_name::&lt;T&gt;())</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    assert_eq!(i8::MAX, 127); </span><br><span class=\"line\">    assert_eq!(u8::MAX, 255); </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">// è§£å†³ä»£ç ä¸­çš„é”™è¯¯å’Œ `panic`</span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">   let v1 = 251_u8.wrapping_add(8);</span><br><span class=\"line\">   let v2 = match u8::checked_add(251, 8) &#123;</span><br><span class=\"line\">        Some(value) =&gt; value,</span><br><span class=\"line\">        None =&gt; &#123;</span><br><span class=\"line\">            println!(&quot;Overflow occurred.&quot;);</span><br><span class=\"line\">            0</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">   println!(&quot;&#123;&#125;,&#123;&#125;&quot;,v1,v2);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let x = 1_000.000_1; // f64</span><br><span class=\"line\">    let y: f32 = 0.12; // f32</span><br><span class=\"line\">    let z = 0.01_f64; // f64</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#ä½¿ç”¨ä¸¤ç§æ–¹æ³•æ¥è®©ä¸‹é¢ä»£ç å·¥ä½œ</span><br><span class=\"line\">fn <span class=\"title function_\">main</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    assert!(<span class=\"number\">0.1</span>+<span class=\"number\">0.2</span>==<span class=\"number\">0.3</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> fn <span class=\"title function_\">main</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">     assert!(<span class=\"number\">0.1</span>_f32+<span class=\"number\">0.2</span>_f32==<span class=\"number\">0.3</span>_f32);</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"><span class=\"comment\">//é™ä½ç²¾åº¦</span></span><br><span class=\"line\">fn <span class=\"title function_\">main</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    let eps=<span class=\"number\">0.001</span>;</span><br><span class=\"line\">    assert!((<span class=\"number\">0.1</span>_f64+ <span class=\"number\">0.2</span> - <span class=\"number\">0.3</span>).<span class=\"built_in\">abs</span>() &lt; eps);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//è®¾ç½®å…è®¸è¯¯å·®</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"åºåˆ—Range\"><a href=\"#åºåˆ—Range\" class=\"headerlink\" title=\"åºåˆ—Range\"></a><a href=\"https://zh.practice.rs/basic-types/numbers.html#%E5%BA%8F%E5%88%97range\">åºåˆ—Range</a></h3><ol>\n<li>ğŸŒŸğŸŒŸ ä¸¤ä¸ªç›®æ ‡: 1. ä¿®æ”¹ <code>assert!</code> è®©å®ƒå·¥ä½œ 2. è®© <code>println!</code> è¾“å‡º: 97 - 122</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let mut sum = 0;</span><br><span class=\"line\">    for i in -3..2 &#123;</span><br><span class=\"line\">        sum += i</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    assert!(sum == -5);</span><br><span class=\"line\"></span><br><span class=\"line\">    for c in &#x27;a&#x27;..=&#x27;z&#x27; &#123;</span><br><span class=\"line\">        println!(&quot;&#123;&#125;&quot;,c as u8);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><figcaption><span>å¡«ç©º</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">use std::ops::&#123;Range, RangeInclusive&#125;;</span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    assert_eq!((1..5), Range&#123; start: 1, end: 5 &#125;);</span><br><span class=\"line\">    assert_eq!((1..=5), RangeInclusive::new(1, 5));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">///RangeInclusive::new(1, 5) åˆ›å»ºçš„æ˜¯ä¸€ä¸ªé—­åŒºé—´ï¼Œè¡¨ç¤ºä» 1 åˆ° 5ï¼ˆåŒ…æ‹¬ 5ï¼‰çš„èŒƒå›´ã€‚è‹¥ (1..5) åˆ›å»ºçš„æ˜¯ä¸€ä¸ªåŠå¼€åŒºé—´ï¼Œè¡¨ç¤ºä» 1 åˆ° 5ï¼ˆä¸åŒ…æ‹¬ 5ï¼‰çš„èŒƒå›´ã€‚</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">use std::mem::size_of_val;</span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let unit: () = ();</span><br><span class=\"line\">    assert!(size_of_val(&amp;unit) == 0);\t\t//å•å…ƒç±»å‹å ç”¨çš„å†…å­˜å¤§å° 0</span><br><span class=\"line\"></span><br><span class=\"line\">    println!(&quot;Success!&quot;)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"è¯­å¥ä¸è¡¨è¾¾å¼\"><a href=\"#è¯­å¥ä¸è¡¨è¾¾å¼\" class=\"headerlink\" title=\"è¯­å¥ä¸è¡¨è¾¾å¼\"></a><a href=\"https://zh.practice.rs/basic-types/statements-expressions.html#%E8%AF%AD%E5%8F%A5%E4%B8%8E%E8%A1%A8%E8%BE%BE%E5%BC%8F\">è¯­å¥ä¸è¡¨è¾¾å¼</a></h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">   let v = &#123;</span><br><span class=\"line\">       let mut x = 1;</span><br><span class=\"line\">       x += 2\t\t// æ²¡æœ‰è¿”å›å€¼  </span><br><span class=\"line\">   &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">   assert_eq!(v, 3);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">æ­£ç¡®çš„åšæ³•</span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">   let v = &#123;</span><br><span class=\"line\">       let mut x = 1;</span><br><span class=\"line\">       x += 2;</span><br><span class=\"line\">       x</span><br><span class=\"line\">   &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">   assert_eq!(v, 3);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">let z = &#123;</span><br><span class=\"line\">\t// åˆ†å·è®©è¡¨è¾¾å¼å˜æˆäº†è¯­å¥ï¼Œå› æ­¤è¿”å›çš„ä¸å†æ˜¯è¡¨è¾¾å¼ `2 * x` çš„å€¼ï¼Œè€Œæ˜¯è¯­å¥çš„å€¼ `()`</span><br><span class=\"line\">\t2 * x;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">   let v = &#123; let x = 3; x&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">   assert!(v == 3);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"å‡½æ•°\"><a href=\"#å‡½æ•°\" class=\"headerlink\" title=\"å‡½æ•°\"></a><a href=\"https://zh.practice.rs/basic-types/functions.html#%E5%87%BD%E6%95%B0\">å‡½æ•°</a></h3><h2 id=\"7-æ€»ç»“ï¼š\"><a href=\"#7-æ€»ç»“ï¼š\" class=\"headerlink\" title=\"7.æ€»ç»“ï¼š\"></a>7.æ€»ç»“ï¼š</h2><p>1.<code>let x = 2.0; // f64</code></p>\n<p>2.æ¯”è¾ƒæµ®ç‚¹æ•°<code>(0.1_f64 + 0.2 - 0.3).abs() &lt; 0.00001</code></p>\n<p>3.<code>ç¼–è¯‘å™¨ä¼šè¿›è¡Œè‡ªåŠ¨æ¨å¯¼ï¼Œç»™äºˆtwenty i32çš„ç±»å‹  let twenty = 20;</code></p>\n<p>4.æŒ‰ç…§è¡¥ç å¾ªç¯æº¢å‡ºè§„åˆ™å¤„ç†<code>et b = 255_u8.wrapping_add(20);  // 19</code>  <code>åœ¨ u8 çš„æƒ…å†µä¸‹ï¼Œ256 å˜æˆ 0ï¼Œ257 å˜æˆ 1ï¼Œ</code></p>\n<p>5.<code>(1..5)  è¡¨ç¤ºä» 1 åˆ° 5ï¼ˆä¸åŒ…æ‹¬ 5ï¼‰åŠå¼€åŒºé—´çš„èŒƒå›´</code></p>\n<p>6.<code>(1..=5)  è¡¨ç¤ºä» 1 åˆ° 5ï¼ˆåŒ…æ‹¬ 5ï¼‰åŠé—­åŒºé—´çš„èŒƒå›´</code></p>\n<p>6.<strong>è¡¨è¾¾å¼ä¸èƒ½åŒ…å«åˆ†å·</strong>ã€‚<code>è¡¨è¾¾å¼æ€»è¦è¿”å›å€¼</code></p>\n<p>7.è¿”å›å€¼ä¸ºï¼çš„è¡¨è¾¾å¼</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">loop &#123;&#125;  </span><br><span class=\"line\">panic!(&quot;Never return&quot;);  </span><br><span class=\"line\">todo!();  </span><br><span class=\"line\">unimplemented!();  //æœªå®ç°çš„å ä½ç¬¦å‡½æ•°</span><br><span class=\"line\"> </span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<p>[toc]</p>\n<h1 id=\"RuståŸºæœ¬æ•°æ®ç±»å‹\"><a href=\"#RuståŸºæœ¬æ•°æ®ç±»å‹\" class=\"headerlink\" title=\"RuståŸºæœ¬æ•°æ®ç±»å‹\"></a>RuståŸºæœ¬æ•°æ®ç±»å‹</h1><p>Rust æ¯ä¸ªå€¼éƒ½æœ‰å…¶ç¡®åˆ‡çš„æ•°æ®ç±»å‹ï¼Œæ€»çš„æ¥è¯´å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼šåŸºæœ¬ç±»å‹å’Œå¤åˆç±»å‹ã€‚ åŸºæœ¬ç±»å‹æ„å‘³ç€å®ƒä»¬å¾€å¾€æ˜¯ä¸€ä¸ªæœ€å°åŒ–åŸå­ç±»å‹ï¼Œæ— æ³•è§£æ„ä¸ºå…¶å®ƒç±»å‹(ä¸€èˆ¬æ„ä¹‰ä¸Šæ¥è¯´)ï¼Œç”±ä»¥ä¸‹ç»„æˆï¼š</p>\n<ul>\n<li>æ•°å€¼ç±»å‹: æœ‰ç¬¦å·æ•´æ•° (<code>i8</code>, <code>i16</code>, <code>i32</code>, <code>i64</code>, <code>isize</code>)ã€ æ— ç¬¦å·æ•´æ•° (<code>u8</code>, <code>u16</code>, <code>u32</code>, <code>u64</code>, <code>usize</code>) ã€æµ®ç‚¹æ•° (<code>f32</code>, <code>f64</code>)ã€ä»¥åŠæœ‰ç†æ•°ã€å¤æ•°</li>\n<li>å­—ç¬¦ä¸²ï¼šå­—ç¬¦ä¸²å­—é¢é‡å’Œå­—ç¬¦ä¸²åˆ‡ç‰‡ <code>&amp;str</code></li>\n<li>å¸ƒå°”ç±»å‹ï¼š <code>true</code>å’Œ<code>false</code></li>\n<li>å­—ç¬¦ç±»å‹: è¡¨ç¤ºå•ä¸ª Unicode å­—ç¬¦ï¼Œå­˜å‚¨ä¸º 4 ä¸ªå­—èŠ‚</li>\n<li>å•å…ƒç±»å‹: å³ <code>()</code> ï¼Œå…¶å”¯ä¸€çš„å€¼ä¹Ÿæ˜¯ <code>()</code></li>\n</ul>\n<h2 id=\"1-æ•°å€¼ç±»å‹\"><a href=\"#1-æ•°å€¼ç±»å‹\" class=\"headerlink\" title=\"1.æ•°å€¼ç±»å‹\"></a>1.æ•°å€¼ç±»å‹</h2><table>\n<thead>\n<tr>\n<th>é•¿åº¦</th>\n<th>æœ‰ç¬¦å·ç±»å‹</th>\n<th>æ— ç¬¦å·ç±»å‹</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>8 ä½</td>\n<td><code>i8</code></td>\n<td><code>u8</code></td>\n</tr>\n<tr>\n<td>16 ä½</td>\n<td><code>i16</code></td>\n<td><code>u16</code></td>\n</tr>\n<tr>\n<td>32 ä½</td>\n<td><code>i32</code></td>\n<td><code>u32</code></td>\n</tr>\n<tr>\n<td>64 ä½</td>\n<td><code>i64</code></td>\n<td><code>u64</code></td>\n</tr>\n<tr>\n<td>128 ä½</td>\n<td><code>i128</code></td>\n<td><code>u128</code></td>\n</tr>\n<tr>\n<td>è§†æ¶æ„è€Œå®š</td>\n<td><code>isize</code></td>\n<td><code>usize</code></td>\n</tr>\n</tbody></table>\n<p>æ•´å½¢å­—é¢é‡å¯ä»¥ç”¨ä¸‹è¡¨çš„å½¢å¼ä¹¦å†™ï¼š</p>\n<table>\n<thead>\n<tr>\n<th>æ•°å­—å­—é¢é‡</th>\n<th>ç¤ºä¾‹</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>åè¿›åˆ¶</td>\n<td><code>98_222</code></td>\n</tr>\n<tr>\n<td>åå…­è¿›åˆ¶</td>\n<td><code>0xff</code></td>\n</tr>\n<tr>\n<td>å…«è¿›åˆ¶</td>\n<td><code>0o77</code></td>\n</tr>\n<tr>\n<td>äºŒè¿›åˆ¶</td>\n<td><code>0b1111_0000</code></td>\n</tr>\n<tr>\n<td>å­—èŠ‚ (ä»…é™äº <code>u8</code>)</td>\n<td><code>b&#39;A&#39;</code></td>\n</tr>\n</tbody></table>\n<h2 id=\"2-æµ®ç‚¹ç±»å‹\"><a href=\"#2-æµ®ç‚¹ç±»å‹\" class=\"headerlink\" title=\"2.æµ®ç‚¹ç±»å‹\"></a>2.<a href=\"https://course.rs/basic/base-type/numbers.html#%E6%B5%AE%E7%82%B9%E7%B1%BB%E5%9E%8B\">æµ®ç‚¹ç±»å‹</a></h2><p><strong>æµ®ç‚¹ç±»å‹æ•°å­—</strong> æ˜¯å¸¦æœ‰å°æ•°ç‚¹çš„æ•°å­—ï¼Œåœ¨ Rust ä¸­æµ®ç‚¹ç±»å‹æ•°å­—ä¹Ÿæœ‰ä¸¤ç§åŸºæœ¬ç±»å‹ï¼š <code>f32</code> å’Œ <code>f64</code>ï¼Œåˆ†åˆ«ä¸º 32 ä½å’Œ 64 ä½å¤§å°ã€‚é»˜è®¤æµ®ç‚¹ç±»å‹æ˜¯ <code>f64</code>ï¼Œåœ¨ç°ä»£çš„ CPU ä¸­å®ƒçš„é€Ÿåº¦ä¸ <code>f32</code> å‡ ä¹ç›¸åŒï¼Œä½†ç²¾åº¦æ›´é«˜ã€‚</p>\n<p>ä¸‹é¢æ˜¯ä¸€ä¸ªæ¼”ç¤ºæµ®ç‚¹æ•°çš„ç¤ºä¾‹ï¼š</p>\n<figure class=\"highlight rust\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">fn</span> <span class=\"title function_\">main</span>() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> <span class=\"variable\">x</span> = <span class=\"number\">2.0</span>; <span class=\"comment\">// f64</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">let</span> <span class=\"variable\">y</span>: <span class=\"type\">f32</span> = <span class=\"number\">3.0</span>; <span class=\"comment\">// f32</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3-åºåˆ—-Range\"><a href=\"#3-åºåˆ—-Range\" class=\"headerlink\" title=\"3.åºåˆ—(Range)\"></a>3.<a href=\"https://course.rs/basic/base-type/numbers.html#%E5%BA%8F%E5%88%97range\">åºåˆ—(Range)</a></h2><p>Rust æä¾›äº†ä¸€ä¸ªéå¸¸ç®€æ´çš„æ–¹å¼ï¼Œç”¨æ¥ç”Ÿæˆè¿ç»­çš„æ•°å€¼ï¼Œä¾‹å¦‚ <strong><code>1..5</code>ï¼Œç”Ÿæˆä» 1 åˆ° 4 çš„è¿ç»­æ•°å­—ï¼Œä¸åŒ…å« 5</strong> ï¼›<code>1..=5</code>ï¼Œç”Ÿæˆä» 1 åˆ° 5 çš„è¿ç»­æ•°å­—ï¼ŒåŒ…å« 5ï¼Œå®ƒçš„ç”¨é€”å¾ˆç®€å•ï¼Œå¸¸å¸¸ç”¨äºå¾ªç¯ä¸­ï¼š</p>\n<figure class=\"highlight rust\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"variable\">i</span> <span class=\"keyword\">in</span> <span class=\"number\">1</span>..=<span class=\"number\">5</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">println!</span>(<span class=\"string\">&quot;&#123;&#125;&quot;</span>,i);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>æœ€ç»ˆç¨‹åºè¾“å‡º:</p>\n<figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td></tr></table></figure>\n\n<p><strong>åºåˆ—åªå…è®¸ç”¨äºæ•°å­—æˆ–å­—ç¬¦ç±»å‹</strong>ï¼ŒåŸå› æ˜¯ï¼šå®ƒä»¬å¯ä»¥è¿ç»­ï¼ŒåŒæ—¶ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æœŸå¯ä»¥æ£€æŸ¥è¯¥åºåˆ—æ˜¯å¦ä¸ºç©ºï¼Œå­—ç¬¦å’Œæ•°å­—å€¼æ˜¯ Rust ä¸­ä»…æœ‰çš„å¯ä»¥ç”¨äºåˆ¤æ–­æ˜¯å¦ä¸ºç©ºçš„ç±»å‹ã€‚å¦‚ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨å­—ç¬¦ç±»å‹åºåˆ—çš„ä¾‹å­ï¼š</p>\n<figure class=\"highlight rust\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"variable\">i</span> <span class=\"keyword\">in</span> <span class=\"string\">&#x27;a&#x27;</span>..=<span class=\"string\">&#x27;z&#x27;</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">println!</span>(<span class=\"string\">&quot;&#123;&#125;&quot;</span>,i);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"4-æœ‰ç†æ•°å’Œå¤æ•°\"><a href=\"#4-æœ‰ç†æ•°å’Œå¤æ•°\" class=\"headerlink\" title=\"4.æœ‰ç†æ•°å’Œå¤æ•°\"></a>4.<a href=\"https://course.rs/basic/base-type/numbers.html#%E6%9C%89%E7%90%86%E6%95%B0%E5%92%8C%E5%A4%8D%E6%95%B0\">æœ‰ç†æ•°å’Œå¤æ•°</a></h2><p>Rust çš„æ ‡å‡†åº“ç›¸æ¯”å…¶å®ƒè¯­è¨€ï¼Œå‡†å…¥é—¨æ§›è¾ƒé«˜ï¼Œå› æ­¤æœ‰ç†æ•°å’Œå¤æ•°å¹¶æœªåŒ…å«åœ¨æ ‡å‡†åº“ä¸­ï¼š</p>\n<ul>\n<li>æœ‰ç†æ•°å’Œå¤æ•°</li>\n<li>ä»»æ„å¤§å°çš„æ•´æ•°å’Œä»»æ„ç²¾åº¦çš„æµ®ç‚¹æ•°</li>\n<li>å›ºå®šç²¾åº¦çš„åè¿›åˆ¶å°æ•°ï¼Œå¸¸ç”¨äºè´§å¸ç›¸å…³çš„åœºæ™¯</li>\n</ul>\n<p>å¥½åœ¨ç¤¾åŒºå·²ç»å¼€å‘å‡ºé«˜è´¨é‡çš„ Rust æ•°å€¼åº“ï¼š<a href=\"https://crates.io/crates/num\">num</a>ã€‚</p>\n<p>æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ¥å¼•å…¥ <code>num</code> åº“ï¼š</p>\n<ol>\n<li>åˆ›å»ºæ–°å·¥ç¨‹ <code>cargo new complex-num &amp;&amp; cd complex-num</code></li>\n<li>åœ¨ <code>Cargo.toml</code> ä¸­çš„ <code>[dependencies]</code> ä¸‹æ·»åŠ ä¸€è¡Œ <code>num = &quot;0.4.0&quot;</code></li>\n<li>å°† <code>src/main.rs</code> æ–‡ä»¶ä¸­çš„ <code>main</code> å‡½æ•°æ›¿æ¢ä¸ºä¸‹é¢çš„ä»£ç </li>\n<li>è¿è¡Œ <code>cargo run</code></li>\n</ol>\n<figure class=\"highlight rust\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">use</span> num::complex::Complex;</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"keyword\">fn</span> <span class=\"title function_\">main</span>() &#123;</span><br><span class=\"line\">   <span class=\"keyword\">let</span> <span class=\"variable\">a</span> = Complex &#123; re: <span class=\"number\">2.1</span>, im: -<span class=\"number\">1.2</span> &#125;;</span><br><span class=\"line\">   <span class=\"keyword\">let</span> <span class=\"variable\">b</span> = Complex::<span class=\"title function_ invoke__\">new</span>(<span class=\"number\">11.1</span>, <span class=\"number\">22.2</span>);</span><br><span class=\"line\">   <span class=\"keyword\">let</span> <span class=\"variable\">result</span> = a + b;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"built_in\">println!</span>(<span class=\"string\">&quot;&#123;&#125; + &#123;&#125;i&quot;</span>, result.re, result.im)</span><br><span class=\"line\"> &#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a><a href=\"https://course.rs/basic/base-type/numbers.html#%E6%80%BB%E7%BB%93\">æ€»ç»“</a></h4><p>ä¹‹å‰æåˆ°äº†è¿‡ Rust çš„æ•°å€¼ç±»å‹å’Œè¿ç®—è·Ÿå…¶ä»–è¯­è¨€è¾ƒä¸ºç›¸ä¼¼ï¼Œä½†æ˜¯å®é™…ä¸Šï¼Œé™¤äº†è¯­æ³•ä¸Šçš„ä¸åŒä¹‹å¤–ï¼Œè¿˜æ˜¯å­˜åœ¨ä¸€äº›å·®å¼‚ç‚¹ï¼š</p>\n<ul>\n<li><strong>Rust æ‹¥æœ‰ç›¸å½“å¤šçš„æ•°å€¼ç±»å‹</strong>. å› æ­¤ä½ éœ€è¦ç†Ÿæ‚‰è¿™äº›ç±»å‹æ‰€å ç”¨çš„å­—èŠ‚æ•°ï¼Œè¿™æ ·å°±çŸ¥é“è¯¥ç±»å‹å…è®¸çš„å¤§å°èŒƒå›´ä»¥åŠä½ é€‰æ‹©çš„ç±»å‹æ˜¯å¦èƒ½è¡¨è¾¾è´Ÿæ•°</li>\n<li><strong>ç±»å‹è½¬æ¢å¿…é¡»æ˜¯æ˜¾å¼çš„</strong>. Rust æ°¸è¿œä¹Ÿä¸ä¼šå·å·æŠŠä½ çš„ 16bit æ•´æ•°è½¬æ¢æˆ 32bit æ•´æ•°</li>\n<li><strong>Rust çš„æ•°å€¼ä¸Šå¯ä»¥ä½¿ç”¨æ–¹æ³•</strong>. ä¾‹å¦‚ä½ å¯ä»¥ç”¨ä»¥ä¸‹æ–¹æ³•æ¥å°† <code>13.14</code> å–æ•´ï¼š<code>13.14_f32.round()</code>ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº†ç±»å‹åç¼€ï¼Œå› ä¸ºç¼–è¯‘å™¨éœ€è¦çŸ¥é“ <code>13.14</code> çš„å…·ä½“ç±»å‹</li>\n</ul>\n<h2 id=\"5-å‡½æ•°è¦ç‚¹\"><a href=\"#5-å‡½æ•°è¦ç‚¹\" class=\"headerlink\" title=\"5.å‡½æ•°è¦ç‚¹\"></a>5.<a href=\"https://course.rs/basic/base-type/function.html#%E5%87%BD%E6%95%B0%E8%A6%81%E7%82%B9\">å‡½æ•°è¦ç‚¹</a></h2><ul>\n<li>å‡½æ•°åå’Œå˜é‡åä½¿ç”¨<a href=\"https://course.rs/practice/naming.html\">è›‡å½¢å‘½åæ³•(snake case)</a>ï¼Œä¾‹å¦‚ <code>fn add_two() -&gt; &#123;&#125;</code></li>\n<li>å‡½æ•°çš„ä½ç½®å¯ä»¥éšä¾¿æ”¾ï¼ŒRust ä¸å…³å¿ƒæˆ‘ä»¬åœ¨å“ªé‡Œå®šä¹‰äº†å‡½æ•°ï¼Œåªè¦æœ‰å®šä¹‰å³å¯</li>\n<li>æ¯ä¸ªå‡½æ•°å‚æ•°éƒ½éœ€è¦æ ‡æ³¨ç±»å‹</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fn add(i: i32, j: i32) -&gt; i32 &#123;</span><br><span class=\"line\">   i + j</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://pic2.zhimg.com/80/v2-54b3a6d435d2482243edc4be9ab98153_1440w.png\" alt=\"img\"></p>\n<h3 id=\"è¿”å›å€¼ï¼š\"><a href=\"#è¿”å›å€¼ï¼š\" class=\"headerlink\" title=\"è¿”å›å€¼ï¼š\"></a>è¿”å›å€¼ï¼š</h3><p>â€‹\t<a href=\"https://course.rs/basic/base-type/function.html#%E6%97%A0%E8%BF%94%E5%9B%9E%E5%80%BC\">æ— è¿”å›å€¼<code>()</code></a></p>\n<ul>\n<li>å‡½æ•°æ²¡æœ‰è¿”å›å€¼ï¼Œé‚£ä¹ˆè¿”å›ä¸€ä¸ª <code>()</code></li>\n<li>é€šè¿‡ <code>;</code> ç»“å°¾çš„è¡¨è¾¾å¼è¿”å›ä¸€ä¸ª <code>()</code></li>\n</ul>\n<p>â€‹    <a href=\"https://course.rs/basic/base-type/function.html#%E6%B0%B8%E4%B8%8D%E8%BF%94%E5%9B%9E%E7%9A%84%E5%8F%91%E6%95%A3%E5%87%BD%E6%95%B0-\">æ°¸ä¸è¿”å›çš„å‘æ•£å‡½æ•° <code>!</code></a></p>\n<p>â€‹\t\tå½“ç”¨ <code>!</code> ä½œå‡½æ•°è¿”å›ç±»å‹çš„æ—¶å€™ï¼Œè¡¨ç¤ºè¯¥å‡½æ•°æ°¸ä¸è¿”å›( diverge function )ï¼Œç‰¹åˆ«çš„ï¼Œè¿™ç§è¯­æ³•å¾€å¾€ç”¨åšä¼šå¯¼è‡´ç¨‹åºå´©æºƒçš„å‡½æ•°ï¼š</p>\n<h2 id=\"6-ç»ƒä¹ \"><a href=\"#6-ç»ƒä¹ \" class=\"headerlink\" title=\"6.ç»ƒä¹ \"></a>6.ç»ƒä¹ </h2><p><a href=\"https://zh.practice.rs/basic-types/numbers.html\">æ•°å€¼ç±»å‹ - Rust By Practice( Rust ç»ƒä¹ å®è·µ )</a></p>\n<figure class=\"highlight plaintext\"><figcaption><span>å¡«ç©º</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let v: u16 = 38_u8 as u16; //ä»8ä½æ— ç¬¦å·æ•´æ•°ï¼ˆu8ï¼‰åˆ°16ä½æ— ç¬¦å·æ•´æ•°ï¼ˆu16ï¼‰çš„ç±»å‹è½¬æ¢</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">// ä¿®æ”¹ `assert_eq!` è®©ä»£ç å·¥ä½œ</span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let x = 5;\t\t//i32</span><br><span class=\"line\">    assert_eq!(&quot;i32&quot;.to_string(), type_of(&amp;x)); //</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// ä»¥ä¸‹å‡½æ•°å¯ä»¥è·å–ä¼ å…¥å‚æ•°çš„ç±»å‹ï¼Œå¹¶è¿”å›ç±»å‹çš„å­—ç¬¦ä¸²å½¢å¼ï¼Œä¾‹å¦‚  &quot;i8&quot;, &quot;u8&quot;, &quot;i32&quot;, &quot;u32&quot;</span><br><span class=\"line\">fn type_of&lt;T&gt;(_: &amp;T) -&gt; String &#123;</span><br><span class=\"line\">    format!(&quot;&#123;&#125;&quot;, std::any::type_name::&lt;T&gt;())</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    assert_eq!(i8::MAX, 127); </span><br><span class=\"line\">    assert_eq!(u8::MAX, 255); </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">// è§£å†³ä»£ç ä¸­çš„é”™è¯¯å’Œ `panic`</span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">   let v1 = 251_u8.wrapping_add(8);</span><br><span class=\"line\">   let v2 = match u8::checked_add(251, 8) &#123;</span><br><span class=\"line\">        Some(value) =&gt; value,</span><br><span class=\"line\">        None =&gt; &#123;</span><br><span class=\"line\">            println!(&quot;Overflow occurred.&quot;);</span><br><span class=\"line\">            0</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">   println!(&quot;&#123;&#125;,&#123;&#125;&quot;,v1,v2);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let x = 1_000.000_1; // f64</span><br><span class=\"line\">    let y: f32 = 0.12; // f32</span><br><span class=\"line\">    let z = 0.01_f64; // f64</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#ä½¿ç”¨ä¸¤ç§æ–¹æ³•æ¥è®©ä¸‹é¢ä»£ç å·¥ä½œ</span><br><span class=\"line\">fn <span class=\"title function_\">main</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    assert!(<span class=\"number\">0.1</span>+<span class=\"number\">0.2</span>==<span class=\"number\">0.3</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> fn <span class=\"title function_\">main</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">     assert!(<span class=\"number\">0.1</span>_f32+<span class=\"number\">0.2</span>_f32==<span class=\"number\">0.3</span>_f32);</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"><span class=\"comment\">//é™ä½ç²¾åº¦</span></span><br><span class=\"line\">fn <span class=\"title function_\">main</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    let eps=<span class=\"number\">0.001</span>;</span><br><span class=\"line\">    assert!((<span class=\"number\">0.1</span>_f64+ <span class=\"number\">0.2</span> - <span class=\"number\">0.3</span>).<span class=\"built_in\">abs</span>() &lt; eps);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//è®¾ç½®å…è®¸è¯¯å·®</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"åºåˆ—Range\"><a href=\"#åºåˆ—Range\" class=\"headerlink\" title=\"åºåˆ—Range\"></a><a href=\"https://zh.practice.rs/basic-types/numbers.html#%E5%BA%8F%E5%88%97range\">åºåˆ—Range</a></h3><ol>\n<li>ğŸŒŸğŸŒŸ ä¸¤ä¸ªç›®æ ‡: 1. ä¿®æ”¹ <code>assert!</code> è®©å®ƒå·¥ä½œ 2. è®© <code>println!</code> è¾“å‡º: 97 - 122</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let mut sum = 0;</span><br><span class=\"line\">    for i in -3..2 &#123;</span><br><span class=\"line\">        sum += i</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    assert!(sum == -5);</span><br><span class=\"line\"></span><br><span class=\"line\">    for c in &#x27;a&#x27;..=&#x27;z&#x27; &#123;</span><br><span class=\"line\">        println!(&quot;&#123;&#125;&quot;,c as u8);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><figcaption><span>å¡«ç©º</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">use std::ops::&#123;Range, RangeInclusive&#125;;</span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    assert_eq!((1..5), Range&#123; start: 1, end: 5 &#125;);</span><br><span class=\"line\">    assert_eq!((1..=5), RangeInclusive::new(1, 5));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">///RangeInclusive::new(1, 5) åˆ›å»ºçš„æ˜¯ä¸€ä¸ªé—­åŒºé—´ï¼Œè¡¨ç¤ºä» 1 åˆ° 5ï¼ˆåŒ…æ‹¬ 5ï¼‰çš„èŒƒå›´ã€‚è‹¥ (1..5) åˆ›å»ºçš„æ˜¯ä¸€ä¸ªåŠå¼€åŒºé—´ï¼Œè¡¨ç¤ºä» 1 åˆ° 5ï¼ˆä¸åŒ…æ‹¬ 5ï¼‰çš„èŒƒå›´ã€‚</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">use std::mem::size_of_val;</span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let unit: () = ();</span><br><span class=\"line\">    assert!(size_of_val(&amp;unit) == 0);\t\t//å•å…ƒç±»å‹å ç”¨çš„å†…å­˜å¤§å° 0</span><br><span class=\"line\"></span><br><span class=\"line\">    println!(&quot;Success!&quot;)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"è¯­å¥ä¸è¡¨è¾¾å¼\"><a href=\"#è¯­å¥ä¸è¡¨è¾¾å¼\" class=\"headerlink\" title=\"è¯­å¥ä¸è¡¨è¾¾å¼\"></a><a href=\"https://zh.practice.rs/basic-types/statements-expressions.html#%E8%AF%AD%E5%8F%A5%E4%B8%8E%E8%A1%A8%E8%BE%BE%E5%BC%8F\">è¯­å¥ä¸è¡¨è¾¾å¼</a></h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">   let v = &#123;</span><br><span class=\"line\">       let mut x = 1;</span><br><span class=\"line\">       x += 2\t\t// æ²¡æœ‰è¿”å›å€¼  </span><br><span class=\"line\">   &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">   assert_eq!(v, 3);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">æ­£ç¡®çš„åšæ³•</span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">   let v = &#123;</span><br><span class=\"line\">       let mut x = 1;</span><br><span class=\"line\">       x += 2;</span><br><span class=\"line\">       x</span><br><span class=\"line\">   &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">   assert_eq!(v, 3);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">let z = &#123;</span><br><span class=\"line\">\t// åˆ†å·è®©è¡¨è¾¾å¼å˜æˆäº†è¯­å¥ï¼Œå› æ­¤è¿”å›çš„ä¸å†æ˜¯è¡¨è¾¾å¼ `2 * x` çš„å€¼ï¼Œè€Œæ˜¯è¯­å¥çš„å€¼ `()`</span><br><span class=\"line\">\t2 * x;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">   let v = &#123; let x = 3; x&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">   assert!(v == 3);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"å‡½æ•°\"><a href=\"#å‡½æ•°\" class=\"headerlink\" title=\"å‡½æ•°\"></a><a href=\"https://zh.practice.rs/basic-types/functions.html#%E5%87%BD%E6%95%B0\">å‡½æ•°</a></h3><h2 id=\"7-æ€»ç»“ï¼š\"><a href=\"#7-æ€»ç»“ï¼š\" class=\"headerlink\" title=\"7.æ€»ç»“ï¼š\"></a>7.æ€»ç»“ï¼š</h2><p>1.<code>let x = 2.0; // f64</code></p>\n<p>2.æ¯”è¾ƒæµ®ç‚¹æ•°<code>(0.1_f64 + 0.2 - 0.3).abs() &lt; 0.00001</code></p>\n<p>3.<code>ç¼–è¯‘å™¨ä¼šè¿›è¡Œè‡ªåŠ¨æ¨å¯¼ï¼Œç»™äºˆtwenty i32çš„ç±»å‹  let twenty = 20;</code></p>\n<p>4.æŒ‰ç…§è¡¥ç å¾ªç¯æº¢å‡ºè§„åˆ™å¤„ç†<code>et b = 255_u8.wrapping_add(20);  // 19</code>  <code>åœ¨ u8 çš„æƒ…å†µä¸‹ï¼Œ256 å˜æˆ 0ï¼Œ257 å˜æˆ 1ï¼Œ</code></p>\n<p>5.<code>(1..5)  è¡¨ç¤ºä» 1 åˆ° 5ï¼ˆä¸åŒ…æ‹¬ 5ï¼‰åŠå¼€åŒºé—´çš„èŒƒå›´</code></p>\n<p>6.<code>(1..=5)  è¡¨ç¤ºä» 1 åˆ° 5ï¼ˆåŒ…æ‹¬ 5ï¼‰åŠé—­åŒºé—´çš„èŒƒå›´</code></p>\n<p>6.<strong>è¡¨è¾¾å¼ä¸èƒ½åŒ…å«åˆ†å·</strong>ã€‚<code>è¡¨è¾¾å¼æ€»è¦è¿”å›å€¼</code></p>\n<p>7.è¿”å›å€¼ä¸ºï¼çš„è¡¨è¾¾å¼</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">loop &#123;&#125;  </span><br><span class=\"line\">panic!(&quot;Never return&quot;);  </span><br><span class=\"line\">todo!();  </span><br><span class=\"line\">unimplemented!();  //æœªå®ç°çš„å ä½ç¬¦å‡½æ•°</span><br><span class=\"line\"> </span><br></pre></td></tr></table></figure>\n"},{"title":"03-rustå¤åˆç±»å‹","date":"2023-08-28T13:58:27.000Z","categories":["rust"],"tags":["rustå¤åˆç±»å‹","rust"],"_content":"\n\n\n\n\n# 1.å­—ç¬¦ä¸²å’Œåˆ‡ç‰‡\n\n## [ä»€ä¹ˆæ˜¯å­—ç¬¦ä¸²?](https://course.rs/basic/compound-type/string-slice.html#ä»€ä¹ˆæ˜¯å­—ç¬¦ä¸²)\n\n**Rust ä¸­çš„å­—ç¬¦æ˜¯ Unicode ç±»å‹ï¼Œå› æ­¤æ¯ä¸ªå­—ç¬¦å æ® 4 ä¸ªå­—èŠ‚å†…å­˜ç©ºé—´ï¼Œä½†æ˜¯åœ¨å­—ç¬¦ä¸²ä¸­ä¸ä¸€æ ·ï¼Œå­—ç¬¦ä¸²æ˜¯ UTF-8 ç¼–ç ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦æ‰€å çš„å­—èŠ‚æ•°æ˜¯å˜åŒ–çš„(1 - 4)**\n\n`str` ç±»å‹æ˜¯ç¡¬ç¼–ç è¿›å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¹Ÿæ— æ³•è¢«ä¿®æ”¹ï¼Œä½†æ˜¯ `String` åˆ™æ˜¯ä¸€ä¸ªå¯å¢é•¿ã€å¯æ”¹å˜ä¸”å…·æœ‰æ‰€æœ‰æƒçš„ UTF-8 ç¼–ç å­—ç¬¦ä¸²ï¼Œ**å½“ Rust ç”¨æˆ·æåˆ°å­—ç¬¦ä¸²æ—¶ï¼Œå¾€å¾€æŒ‡çš„å°±æ˜¯ `String` ç±»å‹å’Œ `&str` å­—ç¬¦ä¸²åˆ‡ç‰‡ç±»å‹ï¼Œè¿™ä¸¤ä¸ªç±»å‹éƒ½æ˜¯ UTF-8 ç¼–ç **ã€‚\n\n```\nlet a = [1, 2, 3, 4, 5];\n\nlet slice = &a[1..3];\n\nassert_eq!(slice, &[2, 3]);\n\n```\n\n\n\n## [String ä¸ &str çš„è½¬æ¢](https://course.rs/basic/compound-type/string-slice.html#string-ä¸-str-çš„è½¬æ¢)\n\n```\nfn main() {\n    let s = String::from(\"hello,world!\");\n    say_hello(&s);\n    say_hello(&s[..]);\n    say_hello(s.as_str());\n}\n\nfn say_hello(s: &str) {\n    println!(\"{}\",s);\n}\n```\n\n## [å­—ç¬¦ä¸²ç´¢å¼•](https://course.rs/basic/compound-type/string-slice.html#å­—ç¬¦ä¸²ç´¢å¼•)\n\n## [å­—ç¬¦ä¸²åˆ‡ç‰‡](https://course.rs/basic/compound-type/string-slice.html#å­—ç¬¦ä¸²åˆ‡ç‰‡)\n\né€šè¿‡ç´¢å¼•åŒºé—´æ¥è®¿é—®å­—ç¬¦ä¸²æ—¶ï¼Œ**éœ€è¦æ ¼å¤–çš„å°å¿ƒ**ï¼Œä¸€ä¸æ³¨æ„ï¼Œå°±ä¼šå¯¼è‡´ä½ ç¨‹åºçš„å´©æºƒï¼\n\n## [æ“ä½œå­—ç¬¦ä¸²](https://course.rs/basic/compound-type/string-slice.html#æ“ä½œå­—ç¬¦ä¸²)\n\n#### [è¿½åŠ  (Push)](https://course.rs/basic/compound-type/string-slice.html#è¿½åŠ -push)\n\n\n\n#### [æ’å…¥ (Insert)](https://course.rs/basic/compound-type/string-slice.html#æ’å…¥-insert)\n\n#### [æ›¿æ¢ (Replace)](https://course.rs/basic/compound-type/string-slice.html#æ›¿æ¢-replace)\n\n#### [åˆ é™¤ (Delete)](https://course.rs/basic/compound-type/string-slice.html#åˆ é™¤-delete)\n\n#### [è¿æ¥ (Concatenate)](https://course.rs/basic/compound-type/string-slice.html#è¿æ¥-concatenate)\n\n## [å­—ç¬¦ä¸²è½¬ä¹‰](https://course.rs/basic/compound-type/string-slice.html#å­—ç¬¦ä¸²è½¬ä¹‰)\n\n```\nfn main() {\n    println!(\"{}\", \"hello \\\\x52\\\\x75\\\\x73\\\\x74\");\n    let raw_str = r\"Escapes don't work here: \\x3F \\u{211D}\";\n    println!(\"{}\", raw_str);\n\n    // å¦‚æœå­—ç¬¦ä¸²åŒ…å«åŒå¼•å·ï¼Œå¯ä»¥åœ¨å¼€å¤´å’Œç»“å°¾åŠ  #\n    let quotes = r#\"And then I said: \"There is no escape!\"\"#;\n    println!(\"{}\", quotes);\n\n    // å¦‚æœè¿˜æ˜¯æœ‰æ­§ä¹‰ï¼Œå¯ä»¥ç»§ç»­å¢åŠ ï¼Œæ²¡æœ‰é™åˆ¶\n    let longer_delimiter = r###\"A string with \"# in it. And even \"##!\"###;\n    println!(\"{}\", longer_delimiter);\n}\n```\n\n## [æ“ä½œ UTF-8 å­—ç¬¦ä¸²](https://course.rs/basic/compound-type/string-slice.html#æ“ä½œ-utf-8-å­—ç¬¦ä¸²)\n\n[å­—ç¬¦ä¸²ä¸åˆ‡ç‰‡ - Rustè¯­è¨€åœ£ç»(Rust Course)](https://course.rs/basic/compound-type/string-slice.html#è¯¾åç»ƒä¹ )\n\n```\nfor c in \"ä¸­å›½äºº\".chars() {\n    println!(\"{}\", c);\n}\n```\n\n## [è¯¾åç»ƒä¹ ](https://course.rs/basic/compound-type/string-slice.html#è¯¾åç»ƒä¹ )\n\n> Rust By Practiceï¼Œæ”¯æŒä»£ç åœ¨çº¿ç¼–è¾‘å’Œè¿è¡Œï¼Œå¹¶æä¾›è¯¦ç»†çš„ä¹ é¢˜è§£ç­”ã€‚\n>\n> - [å­—ç¬¦ä¸²](https://zh.practice.rs/compound-types/string.html)\n>   - [ä¹ é¢˜è§£ç­”](https://github.com/sunface/rust-by-practice/blob/master/solutions/compound-types/string.md)\n> - [åˆ‡ç‰‡](https://zh.practice.rs/compound-types/slice.html)\n>   - [ä¹ é¢˜è§£ç­”](https://github.com/sunface/rust-by-practice/blob/master/solutions/compound-types/slice.md)\n> - [String](https://zh.practice.rs/collections/String.html)\n>   - [ä¹ é¢˜è§£ç­”](https://github.com/sunface/rust-by-practice/blob/master/solutions/collections/String.md)\n\n```\n\n// å¡«ç©ºå¹¶ä¿®å¤é”™è¯¯\nfn main() {\n    let s = String::from(\"hello, ä¸–ç•Œ\");\n    let slice1 = &s[0..1]; //æç¤º: `h` åœ¨ UTF-8 ç¼–ç ä¸­åªå ç”¨ 1 ä¸ªå­—èŠ‚\n    assert_eq!(slice1, \"h\");\n\n    let slice2 = &s[7..10];// æç¤º: `ä¸–` åœ¨ UTF-8 ç¼–ç ä¸­å ç”¨ 3 ä¸ªå­—èŠ‚\n    assert_eq!(slice2, \"ä¸–\");\n    \n    // è¿­ä»£ s ä¸­çš„æ‰€æœ‰å­—ç¬¦\n    for (i, c) in s.chars().enumerate() {\n        if i == 7 {\n            assert_eq!(c, 'ä¸–')\n        }\n    }\n\n    println!(\"Success!\")\n}\n\n\n\n// å¡«ç©º\nfn main() {\n    let mut s = String::new();\n     s.push_str(\"hello\");\n\n    let v = vec![104, 101, 108, 108, 111];\n\n    // å°†å­—èŠ‚æ•°ç»„è½¬æ¢æˆ String\n    let s1 = String::from_utf8(v).unwrap();\n    \n    \n    assert_eq!(s, s1);\n\n    println!(\"Success!\")\n}\n\n\n\n// å¡«ç©º\nuse std::mem;\n\nfn main() {\n    let story = String::from(\"Rust By Practice\");\n\n    // é˜»æ­¢ String çš„æ•°æ®è¢«è‡ªåŠ¨ drop\n    let mut story = mem::ManuallyDrop::new(story);\n\n    let ptr = story.as_mut_ptr();\n    let len = story.len();\n    let capacity = story.capacity();\n\n    assert_eq!(16, len);\n\n    // æˆ‘ä»¬å¯ä»¥åŸºäº ptr æŒ‡é’ˆã€é•¿åº¦å’Œå®¹é‡æ¥é‡æ–°æ„å»º String. \n    // è¿™ç§æ“ä½œå¿…é¡»æ ‡è®°ä¸º unsafeï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦è‡ªå·±æ¥ç¡®ä¿è¿™é‡Œçš„æ“ä½œæ˜¯å®‰å…¨çš„\n    let s = unsafe { String::from_raw_parts(ptr, len, capacity) };\n\n    assert_eq!(*story, s);\n\n    println!(\"Success!\")\n}\n\n```\n\n\n\n# 2.[å…ƒç»„](https://course.rs/basic/compound-type/tuple.html#å…ƒç»„)\n\n# 3. å…ƒç»„\n# 4. test\n\nå¾…ç»­ã€‚ã€‚ã€‚\n","source":"back_posts/03-rustå¤åˆç±»å‹.md","raw":"---\ntitle: 03-rustå¤åˆç±»å‹\ndate: 2023-08-28 21:58:27\ncategories:\n- rust\ntags:\n- rustå¤åˆç±»å‹\n- rust\n---\n\n\n\n\n\n# 1.å­—ç¬¦ä¸²å’Œåˆ‡ç‰‡\n\n## [ä»€ä¹ˆæ˜¯å­—ç¬¦ä¸²?](https://course.rs/basic/compound-type/string-slice.html#ä»€ä¹ˆæ˜¯å­—ç¬¦ä¸²)\n\n**Rust ä¸­çš„å­—ç¬¦æ˜¯ Unicode ç±»å‹ï¼Œå› æ­¤æ¯ä¸ªå­—ç¬¦å æ® 4 ä¸ªå­—èŠ‚å†…å­˜ç©ºé—´ï¼Œä½†æ˜¯åœ¨å­—ç¬¦ä¸²ä¸­ä¸ä¸€æ ·ï¼Œå­—ç¬¦ä¸²æ˜¯ UTF-8 ç¼–ç ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦æ‰€å çš„å­—èŠ‚æ•°æ˜¯å˜åŒ–çš„(1 - 4)**\n\n`str` ç±»å‹æ˜¯ç¡¬ç¼–ç è¿›å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¹Ÿæ— æ³•è¢«ä¿®æ”¹ï¼Œä½†æ˜¯ `String` åˆ™æ˜¯ä¸€ä¸ªå¯å¢é•¿ã€å¯æ”¹å˜ä¸”å…·æœ‰æ‰€æœ‰æƒçš„ UTF-8 ç¼–ç å­—ç¬¦ä¸²ï¼Œ**å½“ Rust ç”¨æˆ·æåˆ°å­—ç¬¦ä¸²æ—¶ï¼Œå¾€å¾€æŒ‡çš„å°±æ˜¯ `String` ç±»å‹å’Œ `&str` å­—ç¬¦ä¸²åˆ‡ç‰‡ç±»å‹ï¼Œè¿™ä¸¤ä¸ªç±»å‹éƒ½æ˜¯ UTF-8 ç¼–ç **ã€‚\n\n```\nlet a = [1, 2, 3, 4, 5];\n\nlet slice = &a[1..3];\n\nassert_eq!(slice, &[2, 3]);\n\n```\n\n\n\n## [String ä¸ &str çš„è½¬æ¢](https://course.rs/basic/compound-type/string-slice.html#string-ä¸-str-çš„è½¬æ¢)\n\n```\nfn main() {\n    let s = String::from(\"hello,world!\");\n    say_hello(&s);\n    say_hello(&s[..]);\n    say_hello(s.as_str());\n}\n\nfn say_hello(s: &str) {\n    println!(\"{}\",s);\n}\n```\n\n## [å­—ç¬¦ä¸²ç´¢å¼•](https://course.rs/basic/compound-type/string-slice.html#å­—ç¬¦ä¸²ç´¢å¼•)\n\n## [å­—ç¬¦ä¸²åˆ‡ç‰‡](https://course.rs/basic/compound-type/string-slice.html#å­—ç¬¦ä¸²åˆ‡ç‰‡)\n\né€šè¿‡ç´¢å¼•åŒºé—´æ¥è®¿é—®å­—ç¬¦ä¸²æ—¶ï¼Œ**éœ€è¦æ ¼å¤–çš„å°å¿ƒ**ï¼Œä¸€ä¸æ³¨æ„ï¼Œå°±ä¼šå¯¼è‡´ä½ ç¨‹åºçš„å´©æºƒï¼\n\n## [æ“ä½œå­—ç¬¦ä¸²](https://course.rs/basic/compound-type/string-slice.html#æ“ä½œå­—ç¬¦ä¸²)\n\n#### [è¿½åŠ  (Push)](https://course.rs/basic/compound-type/string-slice.html#è¿½åŠ -push)\n\n\n\n#### [æ’å…¥ (Insert)](https://course.rs/basic/compound-type/string-slice.html#æ’å…¥-insert)\n\n#### [æ›¿æ¢ (Replace)](https://course.rs/basic/compound-type/string-slice.html#æ›¿æ¢-replace)\n\n#### [åˆ é™¤ (Delete)](https://course.rs/basic/compound-type/string-slice.html#åˆ é™¤-delete)\n\n#### [è¿æ¥ (Concatenate)](https://course.rs/basic/compound-type/string-slice.html#è¿æ¥-concatenate)\n\n## [å­—ç¬¦ä¸²è½¬ä¹‰](https://course.rs/basic/compound-type/string-slice.html#å­—ç¬¦ä¸²è½¬ä¹‰)\n\n```\nfn main() {\n    println!(\"{}\", \"hello \\\\x52\\\\x75\\\\x73\\\\x74\");\n    let raw_str = r\"Escapes don't work here: \\x3F \\u{211D}\";\n    println!(\"{}\", raw_str);\n\n    // å¦‚æœå­—ç¬¦ä¸²åŒ…å«åŒå¼•å·ï¼Œå¯ä»¥åœ¨å¼€å¤´å’Œç»“å°¾åŠ  #\n    let quotes = r#\"And then I said: \"There is no escape!\"\"#;\n    println!(\"{}\", quotes);\n\n    // å¦‚æœè¿˜æ˜¯æœ‰æ­§ä¹‰ï¼Œå¯ä»¥ç»§ç»­å¢åŠ ï¼Œæ²¡æœ‰é™åˆ¶\n    let longer_delimiter = r###\"A string with \"# in it. And even \"##!\"###;\n    println!(\"{}\", longer_delimiter);\n}\n```\n\n## [æ“ä½œ UTF-8 å­—ç¬¦ä¸²](https://course.rs/basic/compound-type/string-slice.html#æ“ä½œ-utf-8-å­—ç¬¦ä¸²)\n\n[å­—ç¬¦ä¸²ä¸åˆ‡ç‰‡ - Rustè¯­è¨€åœ£ç»(Rust Course)](https://course.rs/basic/compound-type/string-slice.html#è¯¾åç»ƒä¹ )\n\n```\nfor c in \"ä¸­å›½äºº\".chars() {\n    println!(\"{}\", c);\n}\n```\n\n## [è¯¾åç»ƒä¹ ](https://course.rs/basic/compound-type/string-slice.html#è¯¾åç»ƒä¹ )\n\n> Rust By Practiceï¼Œæ”¯æŒä»£ç åœ¨çº¿ç¼–è¾‘å’Œè¿è¡Œï¼Œå¹¶æä¾›è¯¦ç»†çš„ä¹ é¢˜è§£ç­”ã€‚\n>\n> - [å­—ç¬¦ä¸²](https://zh.practice.rs/compound-types/string.html)\n>   - [ä¹ é¢˜è§£ç­”](https://github.com/sunface/rust-by-practice/blob/master/solutions/compound-types/string.md)\n> - [åˆ‡ç‰‡](https://zh.practice.rs/compound-types/slice.html)\n>   - [ä¹ é¢˜è§£ç­”](https://github.com/sunface/rust-by-practice/blob/master/solutions/compound-types/slice.md)\n> - [String](https://zh.practice.rs/collections/String.html)\n>   - [ä¹ é¢˜è§£ç­”](https://github.com/sunface/rust-by-practice/blob/master/solutions/collections/String.md)\n\n```\n\n// å¡«ç©ºå¹¶ä¿®å¤é”™è¯¯\nfn main() {\n    let s = String::from(\"hello, ä¸–ç•Œ\");\n    let slice1 = &s[0..1]; //æç¤º: `h` åœ¨ UTF-8 ç¼–ç ä¸­åªå ç”¨ 1 ä¸ªå­—èŠ‚\n    assert_eq!(slice1, \"h\");\n\n    let slice2 = &s[7..10];// æç¤º: `ä¸–` åœ¨ UTF-8 ç¼–ç ä¸­å ç”¨ 3 ä¸ªå­—èŠ‚\n    assert_eq!(slice2, \"ä¸–\");\n    \n    // è¿­ä»£ s ä¸­çš„æ‰€æœ‰å­—ç¬¦\n    for (i, c) in s.chars().enumerate() {\n        if i == 7 {\n            assert_eq!(c, 'ä¸–')\n        }\n    }\n\n    println!(\"Success!\")\n}\n\n\n\n// å¡«ç©º\nfn main() {\n    let mut s = String::new();\n     s.push_str(\"hello\");\n\n    let v = vec![104, 101, 108, 108, 111];\n\n    // å°†å­—èŠ‚æ•°ç»„è½¬æ¢æˆ String\n    let s1 = String::from_utf8(v).unwrap();\n    \n    \n    assert_eq!(s, s1);\n\n    println!(\"Success!\")\n}\n\n\n\n// å¡«ç©º\nuse std::mem;\n\nfn main() {\n    let story = String::from(\"Rust By Practice\");\n\n    // é˜»æ­¢ String çš„æ•°æ®è¢«è‡ªåŠ¨ drop\n    let mut story = mem::ManuallyDrop::new(story);\n\n    let ptr = story.as_mut_ptr();\n    let len = story.len();\n    let capacity = story.capacity();\n\n    assert_eq!(16, len);\n\n    // æˆ‘ä»¬å¯ä»¥åŸºäº ptr æŒ‡é’ˆã€é•¿åº¦å’Œå®¹é‡æ¥é‡æ–°æ„å»º String. \n    // è¿™ç§æ“ä½œå¿…é¡»æ ‡è®°ä¸º unsafeï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦è‡ªå·±æ¥ç¡®ä¿è¿™é‡Œçš„æ“ä½œæ˜¯å®‰å…¨çš„\n    let s = unsafe { String::from_raw_parts(ptr, len, capacity) };\n\n    assert_eq!(*story, s);\n\n    println!(\"Success!\")\n}\n\n```\n\n\n\n# 2.[å…ƒç»„](https://course.rs/basic/compound-type/tuple.html#å…ƒç»„)\n\n# 3. å…ƒç»„\n# 4. test\n\nå¾…ç»­ã€‚ã€‚ã€‚\n","updated":"2024-05-15T06:11:08.981Z","path":"back_posts/03-rustå¤åˆç±»å‹.html","comments":1,"layout":"page","_id":"clw7fflkn0002x2w069iu77y8","content":"<h1 id=\"1-å­—ç¬¦ä¸²å’Œåˆ‡ç‰‡\"><a href=\"#1-å­—ç¬¦ä¸²å’Œåˆ‡ç‰‡\" class=\"headerlink\" title=\"1.å­—ç¬¦ä¸²å’Œåˆ‡ç‰‡\"></a>1.å­—ç¬¦ä¸²å’Œåˆ‡ç‰‡</h1><h2 id=\"ä»€ä¹ˆæ˜¯å­—ç¬¦ä¸²\"><a href=\"#ä»€ä¹ˆæ˜¯å­—ç¬¦ä¸²\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯å­—ç¬¦ä¸²?\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E4%BB%80%E4%B9%88%E6%98%AF%E5%AD%97%E7%AC%A6%E4%B8%B2\">ä»€ä¹ˆæ˜¯å­—ç¬¦ä¸²?</a></h2><p><strong>Rust ä¸­çš„å­—ç¬¦æ˜¯ Unicode ç±»å‹ï¼Œå› æ­¤æ¯ä¸ªå­—ç¬¦å æ® 4 ä¸ªå­—èŠ‚å†…å­˜ç©ºé—´ï¼Œä½†æ˜¯åœ¨å­—ç¬¦ä¸²ä¸­ä¸ä¸€æ ·ï¼Œå­—ç¬¦ä¸²æ˜¯ UTF-8 ç¼–ç ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦æ‰€å çš„å­—èŠ‚æ•°æ˜¯å˜åŒ–çš„(1 - 4)</strong></p>\n<p><code>str</code> ç±»å‹æ˜¯ç¡¬ç¼–ç è¿›å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¹Ÿæ— æ³•è¢«ä¿®æ”¹ï¼Œä½†æ˜¯ <code>String</code> åˆ™æ˜¯ä¸€ä¸ªå¯å¢é•¿ã€å¯æ”¹å˜ä¸”å…·æœ‰æ‰€æœ‰æƒçš„ UTF-8 ç¼–ç å­—ç¬¦ä¸²ï¼Œ<strong>å½“ Rust ç”¨æˆ·æåˆ°å­—ç¬¦ä¸²æ—¶ï¼Œå¾€å¾€æŒ‡çš„å°±æ˜¯ <code>String</code> ç±»å‹å’Œ <code>&amp;str</code> å­—ç¬¦ä¸²åˆ‡ç‰‡ç±»å‹ï¼Œè¿™ä¸¤ä¸ªç±»å‹éƒ½æ˜¯ UTF-8 ç¼–ç </strong>ã€‚</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">let a = [1, 2, 3, 4, 5];</span><br><span class=\"line\"></span><br><span class=\"line\">let slice = &amp;a[1..3];</span><br><span class=\"line\"></span><br><span class=\"line\">assert_eq!(slice, &amp;[2, 3]);</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"String-ä¸-str-çš„è½¬æ¢\"><a href=\"#String-ä¸-str-çš„è½¬æ¢\" class=\"headerlink\" title=\"String ä¸ &amp;str çš„è½¬æ¢\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#string-%E4%B8%8E-str-%E7%9A%84%E8%BD%AC%E6%8D%A2\">String ä¸ &amp;str çš„è½¬æ¢</a></h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let s = String::from(&quot;hello,world!&quot;);</span><br><span class=\"line\">    say_hello(&amp;s);</span><br><span class=\"line\">    say_hello(&amp;s[..]);</span><br><span class=\"line\">    say_hello(s.as_str());</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">fn say_hello(s: &amp;str) &#123;</span><br><span class=\"line\">    println!(&quot;&#123;&#125;&quot;,s);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"å­—ç¬¦ä¸²ç´¢å¼•\"><a href=\"#å­—ç¬¦ä¸²ç´¢å¼•\" class=\"headerlink\" title=\"å­—ç¬¦ä¸²ç´¢å¼•\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B4%A2%E5%BC%95\">å­—ç¬¦ä¸²ç´¢å¼•</a></h2><h2 id=\"å­—ç¬¦ä¸²åˆ‡ç‰‡\"><a href=\"#å­—ç¬¦ä¸²åˆ‡ç‰‡\" class=\"headerlink\" title=\"å­—ç¬¦ä¸²åˆ‡ç‰‡\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%88%87%E7%89%87\">å­—ç¬¦ä¸²åˆ‡ç‰‡</a></h2><p>é€šè¿‡ç´¢å¼•åŒºé—´æ¥è®¿é—®å­—ç¬¦ä¸²æ—¶ï¼Œ<strong>éœ€è¦æ ¼å¤–çš„å°å¿ƒ</strong>ï¼Œä¸€ä¸æ³¨æ„ï¼Œå°±ä¼šå¯¼è‡´ä½ ç¨‹åºçš„å´©æºƒï¼</p>\n<h2 id=\"æ“ä½œå­—ç¬¦ä¸²\"><a href=\"#æ“ä½œå­—ç¬¦ä¸²\" class=\"headerlink\" title=\"æ“ä½œå­—ç¬¦ä¸²\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E6%93%8D%E4%BD%9C%E5%AD%97%E7%AC%A6%E4%B8%B2\">æ“ä½œå­—ç¬¦ä¸²</a></h2><h4 id=\"è¿½åŠ -Push\"><a href=\"#è¿½åŠ -Push\" class=\"headerlink\" title=\"è¿½åŠ  (Push)\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E8%BF%BD%E5%8A%A0-push\">è¿½åŠ  (Push)</a></h4><h4 id=\"æ’å…¥-Insert\"><a href=\"#æ’å…¥-Insert\" class=\"headerlink\" title=\"æ’å…¥ (Insert)\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E6%8F%92%E5%85%A5-insert\">æ’å…¥ (Insert)</a></h4><h4 id=\"æ›¿æ¢-Replace\"><a href=\"#æ›¿æ¢-Replace\" class=\"headerlink\" title=\"æ›¿æ¢ (Replace)\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E6%9B%BF%E6%8D%A2-replace\">æ›¿æ¢ (Replace)</a></h4><h4 id=\"åˆ é™¤-Delete\"><a href=\"#åˆ é™¤-Delete\" class=\"headerlink\" title=\"åˆ é™¤ (Delete)\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E5%88%A0%E9%99%A4-delete\">åˆ é™¤ (Delete)</a></h4><h4 id=\"è¿æ¥-Concatenate\"><a href=\"#è¿æ¥-Concatenate\" class=\"headerlink\" title=\"è¿æ¥ (Concatenate)\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E8%BF%9E%E6%8E%A5-concatenate\">è¿æ¥ (Concatenate)</a></h4><h2 id=\"å­—ç¬¦ä¸²è½¬ä¹‰\"><a href=\"#å­—ç¬¦ä¸²è½¬ä¹‰\" class=\"headerlink\" title=\"å­—ç¬¦ä¸²è½¬ä¹‰\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BD%AC%E4%B9%89\">å­—ç¬¦ä¸²è½¬ä¹‰</a></h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    println!(&quot;&#123;&#125;&quot;, &quot;hello \\\\x52\\\\x75\\\\x73\\\\x74&quot;);</span><br><span class=\"line\">    let raw_str = r&quot;Escapes don&#x27;t work here: \\x3F \\u&#123;211D&#125;&quot;;</span><br><span class=\"line\">    println!(&quot;&#123;&#125;&quot;, raw_str);</span><br><span class=\"line\"></span><br><span class=\"line\">    // å¦‚æœå­—ç¬¦ä¸²åŒ…å«åŒå¼•å·ï¼Œå¯ä»¥åœ¨å¼€å¤´å’Œç»“å°¾åŠ  #</span><br><span class=\"line\">    let quotes = r#&quot;And then I said: &quot;There is no escape!&quot;&quot;#;</span><br><span class=\"line\">    println!(&quot;&#123;&#125;&quot;, quotes);</span><br><span class=\"line\"></span><br><span class=\"line\">    // å¦‚æœè¿˜æ˜¯æœ‰æ­§ä¹‰ï¼Œå¯ä»¥ç»§ç»­å¢åŠ ï¼Œæ²¡æœ‰é™åˆ¶</span><br><span class=\"line\">    let longer_delimiter = r###&quot;A string with &quot;# in it. And even &quot;##!&quot;###;</span><br><span class=\"line\">    println!(&quot;&#123;&#125;&quot;, longer_delimiter);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"æ“ä½œ-UTF-8-å­—ç¬¦ä¸²\"><a href=\"#æ“ä½œ-UTF-8-å­—ç¬¦ä¸²\" class=\"headerlink\" title=\"æ“ä½œ UTF-8 å­—ç¬¦ä¸²\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E6%93%8D%E4%BD%9C-utf-8-%E5%AD%97%E7%AC%A6%E4%B8%B2\">æ“ä½œ UTF-8 å­—ç¬¦ä¸²</a></h2><p><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E8%AF%BE%E5%90%8E%E7%BB%83%E4%B9%A0\">å­—ç¬¦ä¸²ä¸åˆ‡ç‰‡ - Rustè¯­è¨€åœ£ç»(Rust Course)</a></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">for c in &quot;ä¸­å›½äºº&quot;.chars() &#123;</span><br><span class=\"line\">    println!(&quot;&#123;&#125;&quot;, c);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"è¯¾åç»ƒä¹ \"><a href=\"#è¯¾åç»ƒä¹ \" class=\"headerlink\" title=\"è¯¾åç»ƒä¹ \"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E8%AF%BE%E5%90%8E%E7%BB%83%E4%B9%A0\">è¯¾åç»ƒä¹ </a></h2><blockquote>\n<p>Rust By Practiceï¼Œæ”¯æŒä»£ç åœ¨çº¿ç¼–è¾‘å’Œè¿è¡Œï¼Œå¹¶æä¾›è¯¦ç»†çš„ä¹ é¢˜è§£ç­”ã€‚</p>\n<ul>\n<li><a href=\"https://zh.practice.rs/compound-types/string.html\">å­—ç¬¦ä¸²</a><ul>\n<li><a href=\"https://github.com/sunface/rust-by-practice/blob/master/solutions/compound-types/string.md\">ä¹ é¢˜è§£ç­”</a></li>\n</ul>\n</li>\n<li><a href=\"https://zh.practice.rs/compound-types/slice.html\">åˆ‡ç‰‡</a><ul>\n<li><a href=\"https://github.com/sunface/rust-by-practice/blob/master/solutions/compound-types/slice.md\">ä¹ é¢˜è§£ç­”</a></li>\n</ul>\n</li>\n<li><a href=\"https://zh.practice.rs/collections/String.html\">String</a><ul>\n<li><a href=\"https://github.com/sunface/rust-by-practice/blob/master/solutions/collections/String.md\">ä¹ é¢˜è§£ç­”</a></li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">// å¡«ç©ºå¹¶ä¿®å¤é”™è¯¯</span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let s = String::from(&quot;hello, ä¸–ç•Œ&quot;);</span><br><span class=\"line\">    let slice1 = &amp;s[0..1]; //æç¤º: `h` åœ¨ UTF-8 ç¼–ç ä¸­åªå ç”¨ 1 ä¸ªå­—èŠ‚</span><br><span class=\"line\">    assert_eq!(slice1, &quot;h&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">    let slice2 = &amp;s[7..10];// æç¤º: `ä¸–` åœ¨ UTF-8 ç¼–ç ä¸­å ç”¨ 3 ä¸ªå­—èŠ‚</span><br><span class=\"line\">    assert_eq!(slice2, &quot;ä¸–&quot;);</span><br><span class=\"line\">    </span><br><span class=\"line\">    // è¿­ä»£ s ä¸­çš„æ‰€æœ‰å­—ç¬¦</span><br><span class=\"line\">    for (i, c) in s.chars().enumerate() &#123;</span><br><span class=\"line\">        if i == 7 &#123;</span><br><span class=\"line\">            assert_eq!(c, &#x27;ä¸–&#x27;)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    println!(&quot;Success!&quot;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">// å¡«ç©º</span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let mut s = String::new();</span><br><span class=\"line\">     s.push_str(&quot;hello&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">    let v = vec![104, 101, 108, 108, 111];</span><br><span class=\"line\"></span><br><span class=\"line\">    // å°†å­—èŠ‚æ•°ç»„è½¬æ¢æˆ String</span><br><span class=\"line\">    let s1 = String::from_utf8(v).unwrap();</span><br><span class=\"line\">    </span><br><span class=\"line\">    </span><br><span class=\"line\">    assert_eq!(s, s1);</span><br><span class=\"line\"></span><br><span class=\"line\">    println!(&quot;Success!&quot;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">// å¡«ç©º</span><br><span class=\"line\">use std::mem;</span><br><span class=\"line\"></span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let story = String::from(&quot;Rust By Practice&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">    // é˜»æ­¢ String çš„æ•°æ®è¢«è‡ªåŠ¨ drop</span><br><span class=\"line\">    let mut story = mem::ManuallyDrop::new(story);</span><br><span class=\"line\"></span><br><span class=\"line\">    let ptr = story.as_mut_ptr();</span><br><span class=\"line\">    let len = story.len();</span><br><span class=\"line\">    let capacity = story.capacity();</span><br><span class=\"line\"></span><br><span class=\"line\">    assert_eq!(16, len);</span><br><span class=\"line\"></span><br><span class=\"line\">    // æˆ‘ä»¬å¯ä»¥åŸºäº ptr æŒ‡é’ˆã€é•¿åº¦å’Œå®¹é‡æ¥é‡æ–°æ„å»º String. </span><br><span class=\"line\">    // è¿™ç§æ“ä½œå¿…é¡»æ ‡è®°ä¸º unsafeï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦è‡ªå·±æ¥ç¡®ä¿è¿™é‡Œçš„æ“ä½œæ˜¯å®‰å…¨çš„</span><br><span class=\"line\">    let s = unsafe &#123; String::from_raw_parts(ptr, len, capacity) &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    assert_eq!(*story, s);</span><br><span class=\"line\"></span><br><span class=\"line\">    println!(&quot;Success!&quot;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"2-å…ƒç»„\"><a href=\"#2-å…ƒç»„\" class=\"headerlink\" title=\"2.å…ƒç»„\"></a>2.<a href=\"https://course.rs/basic/compound-type/tuple.html#%E5%85%83%E7%BB%84\">å…ƒç»„</a></h1><h1 id=\"3-å…ƒç»„\"><a href=\"#3-å…ƒç»„\" class=\"headerlink\" title=\"3. å…ƒç»„\"></a>3. å…ƒç»„</h1><h1 id=\"4-test\"><a href=\"#4-test\" class=\"headerlink\" title=\"4. test\"></a>4. test</h1><p>å¾…ç»­ã€‚ã€‚ã€‚</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"1-å­—ç¬¦ä¸²å’Œåˆ‡ç‰‡\"><a href=\"#1-å­—ç¬¦ä¸²å’Œåˆ‡ç‰‡\" class=\"headerlink\" title=\"1.å­—ç¬¦ä¸²å’Œåˆ‡ç‰‡\"></a>1.å­—ç¬¦ä¸²å’Œåˆ‡ç‰‡</h1><h2 id=\"ä»€ä¹ˆæ˜¯å­—ç¬¦ä¸²\"><a href=\"#ä»€ä¹ˆæ˜¯å­—ç¬¦ä¸²\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯å­—ç¬¦ä¸²?\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E4%BB%80%E4%B9%88%E6%98%AF%E5%AD%97%E7%AC%A6%E4%B8%B2\">ä»€ä¹ˆæ˜¯å­—ç¬¦ä¸²?</a></h2><p><strong>Rust ä¸­çš„å­—ç¬¦æ˜¯ Unicode ç±»å‹ï¼Œå› æ­¤æ¯ä¸ªå­—ç¬¦å æ® 4 ä¸ªå­—èŠ‚å†…å­˜ç©ºé—´ï¼Œä½†æ˜¯åœ¨å­—ç¬¦ä¸²ä¸­ä¸ä¸€æ ·ï¼Œå­—ç¬¦ä¸²æ˜¯ UTF-8 ç¼–ç ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦æ‰€å çš„å­—èŠ‚æ•°æ˜¯å˜åŒ–çš„(1 - 4)</strong></p>\n<p><code>str</code> ç±»å‹æ˜¯ç¡¬ç¼–ç è¿›å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¹Ÿæ— æ³•è¢«ä¿®æ”¹ï¼Œä½†æ˜¯ <code>String</code> åˆ™æ˜¯ä¸€ä¸ªå¯å¢é•¿ã€å¯æ”¹å˜ä¸”å…·æœ‰æ‰€æœ‰æƒçš„ UTF-8 ç¼–ç å­—ç¬¦ä¸²ï¼Œ<strong>å½“ Rust ç”¨æˆ·æåˆ°å­—ç¬¦ä¸²æ—¶ï¼Œå¾€å¾€æŒ‡çš„å°±æ˜¯ <code>String</code> ç±»å‹å’Œ <code>&amp;str</code> å­—ç¬¦ä¸²åˆ‡ç‰‡ç±»å‹ï¼Œè¿™ä¸¤ä¸ªç±»å‹éƒ½æ˜¯ UTF-8 ç¼–ç </strong>ã€‚</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">let a = [1, 2, 3, 4, 5];</span><br><span class=\"line\"></span><br><span class=\"line\">let slice = &amp;a[1..3];</span><br><span class=\"line\"></span><br><span class=\"line\">assert_eq!(slice, &amp;[2, 3]);</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"String-ä¸-str-çš„è½¬æ¢\"><a href=\"#String-ä¸-str-çš„è½¬æ¢\" class=\"headerlink\" title=\"String ä¸ &amp;str çš„è½¬æ¢\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#string-%E4%B8%8E-str-%E7%9A%84%E8%BD%AC%E6%8D%A2\">String ä¸ &amp;str çš„è½¬æ¢</a></h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let s = String::from(&quot;hello,world!&quot;);</span><br><span class=\"line\">    say_hello(&amp;s);</span><br><span class=\"line\">    say_hello(&amp;s[..]);</span><br><span class=\"line\">    say_hello(s.as_str());</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">fn say_hello(s: &amp;str) &#123;</span><br><span class=\"line\">    println!(&quot;&#123;&#125;&quot;,s);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"å­—ç¬¦ä¸²ç´¢å¼•\"><a href=\"#å­—ç¬¦ä¸²ç´¢å¼•\" class=\"headerlink\" title=\"å­—ç¬¦ä¸²ç´¢å¼•\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B4%A2%E5%BC%95\">å­—ç¬¦ä¸²ç´¢å¼•</a></h2><h2 id=\"å­—ç¬¦ä¸²åˆ‡ç‰‡\"><a href=\"#å­—ç¬¦ä¸²åˆ‡ç‰‡\" class=\"headerlink\" title=\"å­—ç¬¦ä¸²åˆ‡ç‰‡\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%88%87%E7%89%87\">å­—ç¬¦ä¸²åˆ‡ç‰‡</a></h2><p>é€šè¿‡ç´¢å¼•åŒºé—´æ¥è®¿é—®å­—ç¬¦ä¸²æ—¶ï¼Œ<strong>éœ€è¦æ ¼å¤–çš„å°å¿ƒ</strong>ï¼Œä¸€ä¸æ³¨æ„ï¼Œå°±ä¼šå¯¼è‡´ä½ ç¨‹åºçš„å´©æºƒï¼</p>\n<h2 id=\"æ“ä½œå­—ç¬¦ä¸²\"><a href=\"#æ“ä½œå­—ç¬¦ä¸²\" class=\"headerlink\" title=\"æ“ä½œå­—ç¬¦ä¸²\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E6%93%8D%E4%BD%9C%E5%AD%97%E7%AC%A6%E4%B8%B2\">æ“ä½œå­—ç¬¦ä¸²</a></h2><h4 id=\"è¿½åŠ -Push\"><a href=\"#è¿½åŠ -Push\" class=\"headerlink\" title=\"è¿½åŠ  (Push)\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E8%BF%BD%E5%8A%A0-push\">è¿½åŠ  (Push)</a></h4><h4 id=\"æ’å…¥-Insert\"><a href=\"#æ’å…¥-Insert\" class=\"headerlink\" title=\"æ’å…¥ (Insert)\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E6%8F%92%E5%85%A5-insert\">æ’å…¥ (Insert)</a></h4><h4 id=\"æ›¿æ¢-Replace\"><a href=\"#æ›¿æ¢-Replace\" class=\"headerlink\" title=\"æ›¿æ¢ (Replace)\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E6%9B%BF%E6%8D%A2-replace\">æ›¿æ¢ (Replace)</a></h4><h4 id=\"åˆ é™¤-Delete\"><a href=\"#åˆ é™¤-Delete\" class=\"headerlink\" title=\"åˆ é™¤ (Delete)\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E5%88%A0%E9%99%A4-delete\">åˆ é™¤ (Delete)</a></h4><h4 id=\"è¿æ¥-Concatenate\"><a href=\"#è¿æ¥-Concatenate\" class=\"headerlink\" title=\"è¿æ¥ (Concatenate)\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E8%BF%9E%E6%8E%A5-concatenate\">è¿æ¥ (Concatenate)</a></h4><h2 id=\"å­—ç¬¦ä¸²è½¬ä¹‰\"><a href=\"#å­—ç¬¦ä¸²è½¬ä¹‰\" class=\"headerlink\" title=\"å­—ç¬¦ä¸²è½¬ä¹‰\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BD%AC%E4%B9%89\">å­—ç¬¦ä¸²è½¬ä¹‰</a></h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    println!(&quot;&#123;&#125;&quot;, &quot;hello \\\\x52\\\\x75\\\\x73\\\\x74&quot;);</span><br><span class=\"line\">    let raw_str = r&quot;Escapes don&#x27;t work here: \\x3F \\u&#123;211D&#125;&quot;;</span><br><span class=\"line\">    println!(&quot;&#123;&#125;&quot;, raw_str);</span><br><span class=\"line\"></span><br><span class=\"line\">    // å¦‚æœå­—ç¬¦ä¸²åŒ…å«åŒå¼•å·ï¼Œå¯ä»¥åœ¨å¼€å¤´å’Œç»“å°¾åŠ  #</span><br><span class=\"line\">    let quotes = r#&quot;And then I said: &quot;There is no escape!&quot;&quot;#;</span><br><span class=\"line\">    println!(&quot;&#123;&#125;&quot;, quotes);</span><br><span class=\"line\"></span><br><span class=\"line\">    // å¦‚æœè¿˜æ˜¯æœ‰æ­§ä¹‰ï¼Œå¯ä»¥ç»§ç»­å¢åŠ ï¼Œæ²¡æœ‰é™åˆ¶</span><br><span class=\"line\">    let longer_delimiter = r###&quot;A string with &quot;# in it. And even &quot;##!&quot;###;</span><br><span class=\"line\">    println!(&quot;&#123;&#125;&quot;, longer_delimiter);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"æ“ä½œ-UTF-8-å­—ç¬¦ä¸²\"><a href=\"#æ“ä½œ-UTF-8-å­—ç¬¦ä¸²\" class=\"headerlink\" title=\"æ“ä½œ UTF-8 å­—ç¬¦ä¸²\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E6%93%8D%E4%BD%9C-utf-8-%E5%AD%97%E7%AC%A6%E4%B8%B2\">æ“ä½œ UTF-8 å­—ç¬¦ä¸²</a></h2><p><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E8%AF%BE%E5%90%8E%E7%BB%83%E4%B9%A0\">å­—ç¬¦ä¸²ä¸åˆ‡ç‰‡ - Rustè¯­è¨€åœ£ç»(Rust Course)</a></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">for c in &quot;ä¸­å›½äºº&quot;.chars() &#123;</span><br><span class=\"line\">    println!(&quot;&#123;&#125;&quot;, c);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"è¯¾åç»ƒä¹ \"><a href=\"#è¯¾åç»ƒä¹ \" class=\"headerlink\" title=\"è¯¾åç»ƒä¹ \"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E8%AF%BE%E5%90%8E%E7%BB%83%E4%B9%A0\">è¯¾åç»ƒä¹ </a></h2><blockquote>\n<p>Rust By Practiceï¼Œæ”¯æŒä»£ç åœ¨çº¿ç¼–è¾‘å’Œè¿è¡Œï¼Œå¹¶æä¾›è¯¦ç»†çš„ä¹ é¢˜è§£ç­”ã€‚</p>\n<ul>\n<li><a href=\"https://zh.practice.rs/compound-types/string.html\">å­—ç¬¦ä¸²</a><ul>\n<li><a href=\"https://github.com/sunface/rust-by-practice/blob/master/solutions/compound-types/string.md\">ä¹ é¢˜è§£ç­”</a></li>\n</ul>\n</li>\n<li><a href=\"https://zh.practice.rs/compound-types/slice.html\">åˆ‡ç‰‡</a><ul>\n<li><a href=\"https://github.com/sunface/rust-by-practice/blob/master/solutions/compound-types/slice.md\">ä¹ é¢˜è§£ç­”</a></li>\n</ul>\n</li>\n<li><a href=\"https://zh.practice.rs/collections/String.html\">String</a><ul>\n<li><a href=\"https://github.com/sunface/rust-by-practice/blob/master/solutions/collections/String.md\">ä¹ é¢˜è§£ç­”</a></li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">// å¡«ç©ºå¹¶ä¿®å¤é”™è¯¯</span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let s = String::from(&quot;hello, ä¸–ç•Œ&quot;);</span><br><span class=\"line\">    let slice1 = &amp;s[0..1]; //æç¤º: `h` åœ¨ UTF-8 ç¼–ç ä¸­åªå ç”¨ 1 ä¸ªå­—èŠ‚</span><br><span class=\"line\">    assert_eq!(slice1, &quot;h&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">    let slice2 = &amp;s[7..10];// æç¤º: `ä¸–` åœ¨ UTF-8 ç¼–ç ä¸­å ç”¨ 3 ä¸ªå­—èŠ‚</span><br><span class=\"line\">    assert_eq!(slice2, &quot;ä¸–&quot;);</span><br><span class=\"line\">    </span><br><span class=\"line\">    // è¿­ä»£ s ä¸­çš„æ‰€æœ‰å­—ç¬¦</span><br><span class=\"line\">    for (i, c) in s.chars().enumerate() &#123;</span><br><span class=\"line\">        if i == 7 &#123;</span><br><span class=\"line\">            assert_eq!(c, &#x27;ä¸–&#x27;)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    println!(&quot;Success!&quot;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">// å¡«ç©º</span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let mut s = String::new();</span><br><span class=\"line\">     s.push_str(&quot;hello&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">    let v = vec![104, 101, 108, 108, 111];</span><br><span class=\"line\"></span><br><span class=\"line\">    // å°†å­—èŠ‚æ•°ç»„è½¬æ¢æˆ String</span><br><span class=\"line\">    let s1 = String::from_utf8(v).unwrap();</span><br><span class=\"line\">    </span><br><span class=\"line\">    </span><br><span class=\"line\">    assert_eq!(s, s1);</span><br><span class=\"line\"></span><br><span class=\"line\">    println!(&quot;Success!&quot;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">// å¡«ç©º</span><br><span class=\"line\">use std::mem;</span><br><span class=\"line\"></span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let story = String::from(&quot;Rust By Practice&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">    // é˜»æ­¢ String çš„æ•°æ®è¢«è‡ªåŠ¨ drop</span><br><span class=\"line\">    let mut story = mem::ManuallyDrop::new(story);</span><br><span class=\"line\"></span><br><span class=\"line\">    let ptr = story.as_mut_ptr();</span><br><span class=\"line\">    let len = story.len();</span><br><span class=\"line\">    let capacity = story.capacity();</span><br><span class=\"line\"></span><br><span class=\"line\">    assert_eq!(16, len);</span><br><span class=\"line\"></span><br><span class=\"line\">    // æˆ‘ä»¬å¯ä»¥åŸºäº ptr æŒ‡é’ˆã€é•¿åº¦å’Œå®¹é‡æ¥é‡æ–°æ„å»º String. </span><br><span class=\"line\">    // è¿™ç§æ“ä½œå¿…é¡»æ ‡è®°ä¸º unsafeï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦è‡ªå·±æ¥ç¡®ä¿è¿™é‡Œçš„æ“ä½œæ˜¯å®‰å…¨çš„</span><br><span class=\"line\">    let s = unsafe &#123; String::from_raw_parts(ptr, len, capacity) &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    assert_eq!(*story, s);</span><br><span class=\"line\"></span><br><span class=\"line\">    println!(&quot;Success!&quot;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"2-å…ƒç»„\"><a href=\"#2-å…ƒç»„\" class=\"headerlink\" title=\"2.å…ƒç»„\"></a>2.<a href=\"https://course.rs/basic/compound-type/tuple.html#%E5%85%83%E7%BB%84\">å…ƒç»„</a></h1><h1 id=\"3-å…ƒç»„\"><a href=\"#3-å…ƒç»„\" class=\"headerlink\" title=\"3. å…ƒç»„\"></a>3. å…ƒç»„</h1><h1 id=\"4-test\"><a href=\"#4-test\" class=\"headerlink\" title=\"4. test\"></a>4. test</h1><p>å¾…ç»­ã€‚ã€‚ã€‚</p>\n"},{"title":"01-rustç¯å¢ƒæ­å»º","date":"2023-08-26T09:03:59.000Z","categories":["rust"],"tags":["rustç¯å¢ƒæ­å»º","rust"],"_content":"\n\n\n\n\n\n\n\n\n\n\nå½“å‰ç¯å¢ƒï¼šwin11+wsl+vscode\n\n## 1.å®‰è£…rustup\n\n```\ncurl --proto '=https' --tlsv1.2 https://sh.rustup.rs -sSf | sh\nsudo apt install build-essential\nrustc -V \ncargo -V\n```\n\n## 2.å®‰è£…vsocodeæ’ä»¶\n\n```\nrust-analyzer ï¼ŒRust è¯­è¨€æ’ä»¶\nEven Better TOMLï¼Œæ”¯æŒ .toml æ–‡ä»¶å®Œæ•´ç‰¹æ€§\nError Lens, æ›´å¥½çš„è·å¾—é”™è¯¯å±•ç¤º\nOne Dark Pro, éå¸¸å¥½çœ‹çš„ VSCode ä¸»é¢˜\nCodeLLDB, Debugger ç¨‹åº\n```\n\n## 3.è¿è¡Œhello world!\n\n```\ncargo new world_hello\ncd world_hello\ncargo run\n#ç¼–è¯‘\ncargo build\n#è¿è¡Œ\n./target/debug/world_hello\nHello, world!\n#å¿«é€Ÿçš„æ£€æŸ¥ä¸€ä¸‹ä»£ç èƒ½å¦ç¼–è¯‘é€šè¿‡\ncargo check\n```\n\n## 4.ä¿®æ”¹ Rust çš„ä¸‹è½½é•œåƒä¸ºå›½å†…çš„é•œåƒåœ°å€\n\n```\n#åœ¨ $HOME/.cargo/config.toml æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š\n\n[source.crates-io]\nreplace-with = 'ustc'\n\n[source.ustc]\nregistry = \"git://mirrors.ustc.edu.cn/crates.io-index\"\n```\n\n","source":"back_posts/01-rustç¯å¢ƒæ­å»º.md","raw":"---\ntitle: 01-rustç¯å¢ƒæ­å»º\ndate: 2023-08-26 17:03:59\ncategories:\n- rust\ntags:\n- rustç¯å¢ƒæ­å»º\n- rust\n---\n\n\n\n\n\n\n\n\n\n\n\nå½“å‰ç¯å¢ƒï¼šwin11+wsl+vscode\n\n## 1.å®‰è£…rustup\n\n```\ncurl --proto '=https' --tlsv1.2 https://sh.rustup.rs -sSf | sh\nsudo apt install build-essential\nrustc -V \ncargo -V\n```\n\n## 2.å®‰è£…vsocodeæ’ä»¶\n\n```\nrust-analyzer ï¼ŒRust è¯­è¨€æ’ä»¶\nEven Better TOMLï¼Œæ”¯æŒ .toml æ–‡ä»¶å®Œæ•´ç‰¹æ€§\nError Lens, æ›´å¥½çš„è·å¾—é”™è¯¯å±•ç¤º\nOne Dark Pro, éå¸¸å¥½çœ‹çš„ VSCode ä¸»é¢˜\nCodeLLDB, Debugger ç¨‹åº\n```\n\n## 3.è¿è¡Œhello world!\n\n```\ncargo new world_hello\ncd world_hello\ncargo run\n#ç¼–è¯‘\ncargo build\n#è¿è¡Œ\n./target/debug/world_hello\nHello, world!\n#å¿«é€Ÿçš„æ£€æŸ¥ä¸€ä¸‹ä»£ç èƒ½å¦ç¼–è¯‘é€šè¿‡\ncargo check\n```\n\n## 4.ä¿®æ”¹ Rust çš„ä¸‹è½½é•œåƒä¸ºå›½å†…çš„é•œåƒåœ°å€\n\n```\n#åœ¨ $HOME/.cargo/config.toml æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š\n\n[source.crates-io]\nreplace-with = 'ustc'\n\n[source.ustc]\nregistry = \"git://mirrors.ustc.edu.cn/crates.io-index\"\n```\n\n","updated":"2024-05-15T06:11:08.969Z","path":"back_posts/01-rustç¯å¢ƒæ­å»º.html","comments":1,"layout":"page","_id":"clw7fflkp0004x2w09qqu8rpq","content":"<p>å½“å‰ç¯å¢ƒï¼šwin11+wsl+vscode</p>\n<h2 id=\"1-å®‰è£…rustup\"><a href=\"#1-å®‰è£…rustup\" class=\"headerlink\" title=\"1.å®‰è£…rustup\"></a>1.å®‰è£…rustup</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl --proto &#x27;=https&#x27; --tlsv1.2 https://sh.rustup.rs -sSf | sh</span><br><span class=\"line\">sudo apt install build-essential</span><br><span class=\"line\">rustc -V </span><br><span class=\"line\">cargo -V</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2-å®‰è£…vsocodeæ’ä»¶\"><a href=\"#2-å®‰è£…vsocodeæ’ä»¶\" class=\"headerlink\" title=\"2.å®‰è£…vsocodeæ’ä»¶\"></a>2.å®‰è£…vsocodeæ’ä»¶</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rust-analyzer ï¼ŒRust è¯­è¨€æ’ä»¶</span><br><span class=\"line\">Even Better TOMLï¼Œæ”¯æŒ .toml æ–‡ä»¶å®Œæ•´ç‰¹æ€§</span><br><span class=\"line\">Error Lens, æ›´å¥½çš„è·å¾—é”™è¯¯å±•ç¤º</span><br><span class=\"line\">One Dark Pro, éå¸¸å¥½çœ‹çš„ VSCode ä¸»é¢˜</span><br><span class=\"line\">CodeLLDB, Debugger ç¨‹åº</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3-è¿è¡Œhello-world\"><a href=\"#3-è¿è¡Œhello-world\" class=\"headerlink\" title=\"3.è¿è¡Œhello world!\"></a>3.è¿è¡Œhello world!</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cargo new world_hello</span><br><span class=\"line\">cd world_hello</span><br><span class=\"line\">cargo run</span><br><span class=\"line\">#ç¼–è¯‘</span><br><span class=\"line\">cargo build</span><br><span class=\"line\">#è¿è¡Œ</span><br><span class=\"line\">./target/debug/world_hello</span><br><span class=\"line\">Hello, world!</span><br><span class=\"line\">#å¿«é€Ÿçš„æ£€æŸ¥ä¸€ä¸‹ä»£ç èƒ½å¦ç¼–è¯‘é€šè¿‡</span><br><span class=\"line\">cargo check</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"4-ä¿®æ”¹-Rust-çš„ä¸‹è½½é•œåƒä¸ºå›½å†…çš„é•œåƒåœ°å€\"><a href=\"#4-ä¿®æ”¹-Rust-çš„ä¸‹è½½é•œåƒä¸ºå›½å†…çš„é•œåƒåœ°å€\" class=\"headerlink\" title=\"4.ä¿®æ”¹ Rust çš„ä¸‹è½½é•œåƒä¸ºå›½å†…çš„é•œåƒåœ°å€\"></a>4.ä¿®æ”¹ Rust çš„ä¸‹è½½é•œåƒä¸ºå›½å†…çš„é•œåƒåœ°å€</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#åœ¨ $HOME/.cargo/config.toml æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</span><br><span class=\"line\"></span><br><span class=\"line\">[source.crates-io]</span><br><span class=\"line\">replace-with = &#x27;ustc&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">[source.ustc]</span><br><span class=\"line\">registry = &quot;git://mirrors.ustc.edu.cn/crates.io-index&quot;</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<p>å½“å‰ç¯å¢ƒï¼šwin11+wsl+vscode</p>\n<h2 id=\"1-å®‰è£…rustup\"><a href=\"#1-å®‰è£…rustup\" class=\"headerlink\" title=\"1.å®‰è£…rustup\"></a>1.å®‰è£…rustup</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl --proto &#x27;=https&#x27; --tlsv1.2 https://sh.rustup.rs -sSf | sh</span><br><span class=\"line\">sudo apt install build-essential</span><br><span class=\"line\">rustc -V </span><br><span class=\"line\">cargo -V</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2-å®‰è£…vsocodeæ’ä»¶\"><a href=\"#2-å®‰è£…vsocodeæ’ä»¶\" class=\"headerlink\" title=\"2.å®‰è£…vsocodeæ’ä»¶\"></a>2.å®‰è£…vsocodeæ’ä»¶</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rust-analyzer ï¼ŒRust è¯­è¨€æ’ä»¶</span><br><span class=\"line\">Even Better TOMLï¼Œæ”¯æŒ .toml æ–‡ä»¶å®Œæ•´ç‰¹æ€§</span><br><span class=\"line\">Error Lens, æ›´å¥½çš„è·å¾—é”™è¯¯å±•ç¤º</span><br><span class=\"line\">One Dark Pro, éå¸¸å¥½çœ‹çš„ VSCode ä¸»é¢˜</span><br><span class=\"line\">CodeLLDB, Debugger ç¨‹åº</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3-è¿è¡Œhello-world\"><a href=\"#3-è¿è¡Œhello-world\" class=\"headerlink\" title=\"3.è¿è¡Œhello world!\"></a>3.è¿è¡Œhello world!</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cargo new world_hello</span><br><span class=\"line\">cd world_hello</span><br><span class=\"line\">cargo run</span><br><span class=\"line\">#ç¼–è¯‘</span><br><span class=\"line\">cargo build</span><br><span class=\"line\">#è¿è¡Œ</span><br><span class=\"line\">./target/debug/world_hello</span><br><span class=\"line\">Hello, world!</span><br><span class=\"line\">#å¿«é€Ÿçš„æ£€æŸ¥ä¸€ä¸‹ä»£ç èƒ½å¦ç¼–è¯‘é€šè¿‡</span><br><span class=\"line\">cargo check</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"4-ä¿®æ”¹-Rust-çš„ä¸‹è½½é•œåƒä¸ºå›½å†…çš„é•œåƒåœ°å€\"><a href=\"#4-ä¿®æ”¹-Rust-çš„ä¸‹è½½é•œåƒä¸ºå›½å†…çš„é•œåƒåœ°å€\" class=\"headerlink\" title=\"4.ä¿®æ”¹ Rust çš„ä¸‹è½½é•œåƒä¸ºå›½å†…çš„é•œåƒåœ°å€\"></a>4.ä¿®æ”¹ Rust çš„ä¸‹è½½é•œåƒä¸ºå›½å†…çš„é•œåƒåœ°å€</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#åœ¨ $HOME/.cargo/config.toml æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</span><br><span class=\"line\"></span><br><span class=\"line\">[source.crates-io]</span><br><span class=\"line\">replace-with = &#x27;ustc&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">[source.ustc]</span><br><span class=\"line\">registry = &quot;git://mirrors.ustc.edu.cn/crates.io-index&quot;</span><br></pre></td></tr></table></figure>\n\n"},{"title":"cpufreq","date":"2024-04-28T09:04:13.000Z","categories":["kernel"],"tags":["power","cpufreq"],"_content":"\n[toc]\n\n# cpufreq\n\n\n\nCPUFreqæ¡†æ¶æ˜¯å†…æ ¸çš„CPUè°ƒé¢‘æ¡†æ¶ï¼Œæ•´ä¸ªè°ƒé¢‘æ¡†æ¶ç”±ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ç»„æˆï¼š\n\n- cpufreq driver\n- cpufreq framework (core)\n- cpufreq governor\n\nä¸€äº›åŸºæœ¬æ¦‚å¿µï¼š\n\nP-state: voltage and frequency point\n\næ€»ä½“ä¸Šï¼ŒCPU Freqä¸»è¦åœ¨sysfså‘userspaceæä¾›äº†è°ƒé¢‘æ“ä½œå’Œç­–ç•¥è®¾ç½®èŠ‚ç‚¹ã€‚å½“ä½¿ç”¨ä¸€äº›è‡ªåŠ¨è°ƒé¢‘çš„governoræ—¶ï¼Œå…è®¸governorä»ç³»ç»Ÿè·å–ä¿¡æ¯ï¼Œè‡ªåŠ¨è§¦å‘è°ƒé¢‘åŠ¨ä½œã€‚\n\nå¦å¤–ï¼Œè¿˜å‘å…¶ä»–æ¨¡å—æä¾›äº†qosé¢‘ç‡æŠ•ç¥¨ï¼Œä»¥åŠè°ƒé¢‘äº‹ä»¶çš„notifieræœºåˆ¶ã€‚\n\nä¸‹é¢åˆ†å¼€æ¥çœ‹æ¯ä¸ªéƒ¨åˆ†ã€‚\n\n## Driver\n\n\n\nCpufreq Driverä¸»è¦è´Ÿè´£åº•å±‚è°ƒé¢‘çš„æ“ä½œï¼Œæ ¸å¿ƒæ˜¯å®ç° `cpufreq_dirver` å¯¹è±¡ï¼Œå¹¶é€šè¿‡ `cpufreq_register_driver` å°†é©±åŠ¨æ³¨å†Œåˆ°ç³»ç»Ÿï¼Œä¾›coreéƒ¨åˆ†ä½¿ç”¨ã€‚\n\nå…¶ä¸­ï¼Œæœ€æ ¸å¿ƒçš„å‡ ä¸ªå›è°ƒåŒ…æ‹¬ï¼š\n\n- online: hotplug callback\n- offline: hotplug callback\n- target_index: set freq\n- set_boost: enter into boost mode\n\nä»¥ `mediatek-cpufreq-hw.c` ä¸ºä¾‹ï¼Œå…¶freq tableä¿å­˜åœ¨ç¡¬ä»¶å¯„å­˜å™¨ä¸­ï¼Œdriveråˆå§‹åŒ–æ—¶ï¼Œä»ç¡¬ä»¶ä¸­è¯»å‡ºfreq tableï¼Œå¹¶å®ç°ç›¸å…³è°ƒé¢‘å›è°ƒï¼Œæœ€ç»ˆæ³¨å†Œåˆ°coreã€‚\n\ndb845cä½¿ç”¨çš„ `qcom-cpufreq-hw.c` ä¸ºä¾‹ï¼Œå…¶freq tableä¿å­˜åœ¨dtsä¸­ï¼Œdriverä½¿ç”¨OPPæ¡†æ¶æ¥è¯»å–è¿™äº›é…ç½®ï¼Œå¹¶å®ç°cpufreqå›è°ƒã€‚\n\n\\* OPPï¼ˆOperating Performance Pointï¼Œæä¾›dtsçš„freq-valt-tableé…ç½®ï¼ŒåŠè·å–æ¥å£ã€‚\n\n## Core\n\n\n\nCoreéƒ¨åˆ†æ ¸å¿ƒæ–‡ä»¶æ˜¯ `/drivers/cpufreq/cpufreq.c`\n\nè¿™ä¸ªæ–‡ä»¶ä¸»è¦å®ç°äº†BOOSTï¼ŒDRIVERï¼ŒSYSFSï¼ŒFREQï¼ŒNOTIFIERï¼ŒGOVERNORï¼ŒPOLICYç›¸å…³åŠŸèƒ½çš„æ“ä½œæ¥å£ã€‚\n\n`cpufreq_register_driver` (cpufreq_driver* cpufreq_driver)\n\n`cpufreq_register_governor` (cpufreq_governor_list)\n\n`cpufreq_register_notifier` (cpufreq_transition_notifier_list)\n\n`cpufreq_policy_alloc` (cpufreq_policy* PERCPU:cpufreq_cpu_data)\n\n`cpufreq_policy` æ˜¯ä¸€ä¸ªè°ƒé¢‘å®ä½“ï¼Œå¯¹åº”ä¸€ä¸ªè°ƒé¢‘åŸŸï¼ˆfreq domainï¼‰ï¼Œä¸€èˆ¬ä¸ºä¸€ä¸ªclusterï¼Œè¿™ä¸ªç»“æ„ä¿å­˜äº†æ¯ä¸ªè°ƒé¢‘å®ä½“ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªclusterï¼‰è°ƒé¢‘ç›¸å…³çš„æ‰€æœ‰ç§æœ‰ä¿¡æ¯ã€‚åŒæ—¶ï¼Œä»–ä½œä¸ºè°ƒé¢‘æ“ä½œçš„å¥æŸ„ï¼Œcpufreqé¡¶å±‚æ“ä½œæ¥å£ä½¿ç”¨policyæ¥å¯¹ä¸€ä¸ªè°ƒé¢‘å®ä½“è¿›è¡Œæ“ä½œã€‚\n\næ¯ä¸ªCPUæœ‰ä¸€ä¸ªpercpuçš„æŒ‡é’ˆæŒ‡å‘å…¶æ‰€å±çš„policyï¼Œclusterä¸­çš„å¤šä¸ªCPUå…±äº«ä¸€ä¸ªpolicyã€‚ï¼ˆ`cpufreq_cpu_data`ï¼‰\n\nMainflowï¼š\n\n1ã€cpufreq driveræ³¨å†Œ\n\n2ã€governoræ³¨å†Œï¼ˆæ¯ä¸ªpolicyåˆå§‹åŒ–è‡ªå·±çš„governorï¼‰\n\n3ã€cpu hotplug state: \"cpufreq:online\"ï¼Œ`cpuhp_cpufreq_online`ã€`cpuhp_cpufreq_offline`ï¼Œåˆ›å»ºå‡ºpercpu policyï¼Œç»‘å®šdriverã€governor\n\n4ã€å‘sysfsåˆ›å»ºèŠ‚ç‚¹ï¼Œæä¾›åŠŸèƒ½\n\n5ã€governorå¼€å§‹å·¥ä½œï¼Œé€šè¿‡ `__cpufreq_driver_target` è¿›è¡Œè°ƒé¢‘ã€‚\n\n- Qosæ˜¯è°ƒé¢‘æŠ•ç¥¨æœºåˆ¶ï¼Œç”¨æ¥å®ç°max_freqã€min_freq limitationã€‚(`cpufreq_notifier_min` `cpufreq_notifier_max`)ï¼Œåœ¨å…¶ä»–moduleæœ‰éœ€æ±‚æŠ•ç¥¨åï¼Œfreq constrantsä¼šè¢«æ›´æ–°ã€‚\n\n## Sysfs\n\n\n\n```\n/sys/devices/system/cpu/cpu0/cpufreq/policyX\nscaling_driver\t\t\tr\t# cpufreq driver name\naffected_cpus\t\t\tr\t# cpu\nrelated_cpus\t\t\tr\t# <?>\nscaling_cur_freq\t\trw\t# cur freq\nscaling_min_freq\t\trw\t# min freq limit\nscaling_max_freq\t\trw\t# max freq limit\nscaling_governor\t\trw\t# selected governor\nscaling_available_governors\tr\t# available governors\nscaling_setspeed\t\tr\t# <not supported>\ncpuinfo_min_freq\t\tr\t# hardware min freq\ncpuinfo_max_freq\t\tr\t# hardware max freq\ncpuinfo_transition_latency\tr\t# hardware latency\n```\n\n\n\n## Governors\n\n\n\nGovernorè´Ÿè´£ä»ç³»ç»Ÿæ”¶é›†ä¿¡æ¯ï¼Œå¹¶è§¦å‘è°ƒé¢‘åŠ¨ä½œã€‚\n\n**powersave**\n\nalways lowest frequency\n\n**performance**\n\nalways highest frequency\n\n**schedutil**\n\nuses CPU utilization data from scheduler to determine target frequence\n\nå¾…å®Œæˆ\n\n**userspace**\n\nallow user space set the frequency\n\n**ondemand**\n\nuses CPU load as a CPU frequency selection metric\n\nit reaches the target by CPU load, 0->min, 100->max\n\n**conservative**\n\nuses CPU load as a CPU frequency selection metric\n\nit reaches the target step by step, up_threshold->up, down_threshold->down\n\n## Files\n\n\n\n```\n- /drivers/cpufreq/cpufreq.c\n- /drivers/cpufreq/cpufreq-dt.c\n- /drivers/cpufreq/cpufreq_stats.c\n- /drivers/cpufreq/cpufreq_conservative.c\n- /drivers/cpufreq/cpufreq_governor.c\n- /drivers/cpufreq/cpufreq_ondemand.c\n- /drivers/cpufreq/cpufreq_powersave.c\n- /drivers/cpufreq/cpufreq_performance.c\n- /drivers/cpufreq/cpufreq_userspace.c\n- /kernel/sched/cpufreq_schedutil.c\n- /kernel/power/qos.c\n```\n\n\n\n## Reference\n\n\n\nhttps://www.kernel.org/doc/html/latest/admin-guide/pm/cpufreq.html\n\nhttps://docs.kernel.org/scheduler/schedutil.html\n\nhttp://www.wowotech.net/pm_subsystem/cpufreq_overview.html\n\nhttp://www.wowotech.net/pm_subsystem/cpufreq_driver.html\n\nhttp://www.wowotech.net/pm_subsystem/cpufreq_core.html\n\nhttp://www.wowotech.net/pm_subsystem/cpufreq_governor.html","source":"back_posts/cpufreq.md","raw":"---\ntitle: cpufreq\ndate: 2024-04-28 17:04:13\ncategories:\n- kernel\ntags:\n- power\n- cpufreq\n---\n\n[toc]\n\n# cpufreq\n\n\n\nCPUFreqæ¡†æ¶æ˜¯å†…æ ¸çš„CPUè°ƒé¢‘æ¡†æ¶ï¼Œæ•´ä¸ªè°ƒé¢‘æ¡†æ¶ç”±ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ç»„æˆï¼š\n\n- cpufreq driver\n- cpufreq framework (core)\n- cpufreq governor\n\nä¸€äº›åŸºæœ¬æ¦‚å¿µï¼š\n\nP-state: voltage and frequency point\n\næ€»ä½“ä¸Šï¼ŒCPU Freqä¸»è¦åœ¨sysfså‘userspaceæä¾›äº†è°ƒé¢‘æ“ä½œå’Œç­–ç•¥è®¾ç½®èŠ‚ç‚¹ã€‚å½“ä½¿ç”¨ä¸€äº›è‡ªåŠ¨è°ƒé¢‘çš„governoræ—¶ï¼Œå…è®¸governorä»ç³»ç»Ÿè·å–ä¿¡æ¯ï¼Œè‡ªåŠ¨è§¦å‘è°ƒé¢‘åŠ¨ä½œã€‚\n\nå¦å¤–ï¼Œè¿˜å‘å…¶ä»–æ¨¡å—æä¾›äº†qosé¢‘ç‡æŠ•ç¥¨ï¼Œä»¥åŠè°ƒé¢‘äº‹ä»¶çš„notifieræœºåˆ¶ã€‚\n\nä¸‹é¢åˆ†å¼€æ¥çœ‹æ¯ä¸ªéƒ¨åˆ†ã€‚\n\n## Driver\n\n\n\nCpufreq Driverä¸»è¦è´Ÿè´£åº•å±‚è°ƒé¢‘çš„æ“ä½œï¼Œæ ¸å¿ƒæ˜¯å®ç° `cpufreq_dirver` å¯¹è±¡ï¼Œå¹¶é€šè¿‡ `cpufreq_register_driver` å°†é©±åŠ¨æ³¨å†Œåˆ°ç³»ç»Ÿï¼Œä¾›coreéƒ¨åˆ†ä½¿ç”¨ã€‚\n\nå…¶ä¸­ï¼Œæœ€æ ¸å¿ƒçš„å‡ ä¸ªå›è°ƒåŒ…æ‹¬ï¼š\n\n- online: hotplug callback\n- offline: hotplug callback\n- target_index: set freq\n- set_boost: enter into boost mode\n\nä»¥ `mediatek-cpufreq-hw.c` ä¸ºä¾‹ï¼Œå…¶freq tableä¿å­˜åœ¨ç¡¬ä»¶å¯„å­˜å™¨ä¸­ï¼Œdriveråˆå§‹åŒ–æ—¶ï¼Œä»ç¡¬ä»¶ä¸­è¯»å‡ºfreq tableï¼Œå¹¶å®ç°ç›¸å…³è°ƒé¢‘å›è°ƒï¼Œæœ€ç»ˆæ³¨å†Œåˆ°coreã€‚\n\ndb845cä½¿ç”¨çš„ `qcom-cpufreq-hw.c` ä¸ºä¾‹ï¼Œå…¶freq tableä¿å­˜åœ¨dtsä¸­ï¼Œdriverä½¿ç”¨OPPæ¡†æ¶æ¥è¯»å–è¿™äº›é…ç½®ï¼Œå¹¶å®ç°cpufreqå›è°ƒã€‚\n\n\\* OPPï¼ˆOperating Performance Pointï¼Œæä¾›dtsçš„freq-valt-tableé…ç½®ï¼ŒåŠè·å–æ¥å£ã€‚\n\n## Core\n\n\n\nCoreéƒ¨åˆ†æ ¸å¿ƒæ–‡ä»¶æ˜¯ `/drivers/cpufreq/cpufreq.c`\n\nè¿™ä¸ªæ–‡ä»¶ä¸»è¦å®ç°äº†BOOSTï¼ŒDRIVERï¼ŒSYSFSï¼ŒFREQï¼ŒNOTIFIERï¼ŒGOVERNORï¼ŒPOLICYç›¸å…³åŠŸèƒ½çš„æ“ä½œæ¥å£ã€‚\n\n`cpufreq_register_driver` (cpufreq_driver* cpufreq_driver)\n\n`cpufreq_register_governor` (cpufreq_governor_list)\n\n`cpufreq_register_notifier` (cpufreq_transition_notifier_list)\n\n`cpufreq_policy_alloc` (cpufreq_policy* PERCPU:cpufreq_cpu_data)\n\n`cpufreq_policy` æ˜¯ä¸€ä¸ªè°ƒé¢‘å®ä½“ï¼Œå¯¹åº”ä¸€ä¸ªè°ƒé¢‘åŸŸï¼ˆfreq domainï¼‰ï¼Œä¸€èˆ¬ä¸ºä¸€ä¸ªclusterï¼Œè¿™ä¸ªç»“æ„ä¿å­˜äº†æ¯ä¸ªè°ƒé¢‘å®ä½“ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªclusterï¼‰è°ƒé¢‘ç›¸å…³çš„æ‰€æœ‰ç§æœ‰ä¿¡æ¯ã€‚åŒæ—¶ï¼Œä»–ä½œä¸ºè°ƒé¢‘æ“ä½œçš„å¥æŸ„ï¼Œcpufreqé¡¶å±‚æ“ä½œæ¥å£ä½¿ç”¨policyæ¥å¯¹ä¸€ä¸ªè°ƒé¢‘å®ä½“è¿›è¡Œæ“ä½œã€‚\n\næ¯ä¸ªCPUæœ‰ä¸€ä¸ªpercpuçš„æŒ‡é’ˆæŒ‡å‘å…¶æ‰€å±çš„policyï¼Œclusterä¸­çš„å¤šä¸ªCPUå…±äº«ä¸€ä¸ªpolicyã€‚ï¼ˆ`cpufreq_cpu_data`ï¼‰\n\nMainflowï¼š\n\n1ã€cpufreq driveræ³¨å†Œ\n\n2ã€governoræ³¨å†Œï¼ˆæ¯ä¸ªpolicyåˆå§‹åŒ–è‡ªå·±çš„governorï¼‰\n\n3ã€cpu hotplug state: \"cpufreq:online\"ï¼Œ`cpuhp_cpufreq_online`ã€`cpuhp_cpufreq_offline`ï¼Œåˆ›å»ºå‡ºpercpu policyï¼Œç»‘å®šdriverã€governor\n\n4ã€å‘sysfsåˆ›å»ºèŠ‚ç‚¹ï¼Œæä¾›åŠŸèƒ½\n\n5ã€governorå¼€å§‹å·¥ä½œï¼Œé€šè¿‡ `__cpufreq_driver_target` è¿›è¡Œè°ƒé¢‘ã€‚\n\n- Qosæ˜¯è°ƒé¢‘æŠ•ç¥¨æœºåˆ¶ï¼Œç”¨æ¥å®ç°max_freqã€min_freq limitationã€‚(`cpufreq_notifier_min` `cpufreq_notifier_max`)ï¼Œåœ¨å…¶ä»–moduleæœ‰éœ€æ±‚æŠ•ç¥¨åï¼Œfreq constrantsä¼šè¢«æ›´æ–°ã€‚\n\n## Sysfs\n\n\n\n```\n/sys/devices/system/cpu/cpu0/cpufreq/policyX\nscaling_driver\t\t\tr\t# cpufreq driver name\naffected_cpus\t\t\tr\t# cpu\nrelated_cpus\t\t\tr\t# <?>\nscaling_cur_freq\t\trw\t# cur freq\nscaling_min_freq\t\trw\t# min freq limit\nscaling_max_freq\t\trw\t# max freq limit\nscaling_governor\t\trw\t# selected governor\nscaling_available_governors\tr\t# available governors\nscaling_setspeed\t\tr\t# <not supported>\ncpuinfo_min_freq\t\tr\t# hardware min freq\ncpuinfo_max_freq\t\tr\t# hardware max freq\ncpuinfo_transition_latency\tr\t# hardware latency\n```\n\n\n\n## Governors\n\n\n\nGovernorè´Ÿè´£ä»ç³»ç»Ÿæ”¶é›†ä¿¡æ¯ï¼Œå¹¶è§¦å‘è°ƒé¢‘åŠ¨ä½œã€‚\n\n**powersave**\n\nalways lowest frequency\n\n**performance**\n\nalways highest frequency\n\n**schedutil**\n\nuses CPU utilization data from scheduler to determine target frequence\n\nå¾…å®Œæˆ\n\n**userspace**\n\nallow user space set the frequency\n\n**ondemand**\n\nuses CPU load as a CPU frequency selection metric\n\nit reaches the target by CPU load, 0->min, 100->max\n\n**conservative**\n\nuses CPU load as a CPU frequency selection metric\n\nit reaches the target step by step, up_threshold->up, down_threshold->down\n\n## Files\n\n\n\n```\n- /drivers/cpufreq/cpufreq.c\n- /drivers/cpufreq/cpufreq-dt.c\n- /drivers/cpufreq/cpufreq_stats.c\n- /drivers/cpufreq/cpufreq_conservative.c\n- /drivers/cpufreq/cpufreq_governor.c\n- /drivers/cpufreq/cpufreq_ondemand.c\n- /drivers/cpufreq/cpufreq_powersave.c\n- /drivers/cpufreq/cpufreq_performance.c\n- /drivers/cpufreq/cpufreq_userspace.c\n- /kernel/sched/cpufreq_schedutil.c\n- /kernel/power/qos.c\n```\n\n\n\n## Reference\n\n\n\nhttps://www.kernel.org/doc/html/latest/admin-guide/pm/cpufreq.html\n\nhttps://docs.kernel.org/scheduler/schedutil.html\n\nhttp://www.wowotech.net/pm_subsystem/cpufreq_overview.html\n\nhttp://www.wowotech.net/pm_subsystem/cpufreq_driver.html\n\nhttp://www.wowotech.net/pm_subsystem/cpufreq_core.html\n\nhttp://www.wowotech.net/pm_subsystem/cpufreq_governor.html","updated":"2024-05-15T06:11:08.989Z","path":"back_posts/cpufreq.html","comments":1,"layout":"page","_id":"clw7fflkq0006x2w02d4x52gy","content":"<p>[toc]</p>\n<h1 id=\"cpufreq\"><a href=\"#cpufreq\" class=\"headerlink\" title=\"cpufreq\"></a>cpufreq</h1><p>CPUFreqæ¡†æ¶æ˜¯å†…æ ¸çš„CPUè°ƒé¢‘æ¡†æ¶ï¼Œæ•´ä¸ªè°ƒé¢‘æ¡†æ¶ç”±ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ç»„æˆï¼š</p>\n<ul>\n<li>cpufreq driver</li>\n<li>cpufreq framework (core)</li>\n<li>cpufreq governor</li>\n</ul>\n<p>ä¸€äº›åŸºæœ¬æ¦‚å¿µï¼š</p>\n<p>P-state: voltage and frequency point</p>\n<p>æ€»ä½“ä¸Šï¼ŒCPU Freqä¸»è¦åœ¨sysfså‘userspaceæä¾›äº†è°ƒé¢‘æ“ä½œå’Œç­–ç•¥è®¾ç½®èŠ‚ç‚¹ã€‚å½“ä½¿ç”¨ä¸€äº›è‡ªåŠ¨è°ƒé¢‘çš„governoræ—¶ï¼Œå…è®¸governorä»ç³»ç»Ÿè·å–ä¿¡æ¯ï¼Œè‡ªåŠ¨è§¦å‘è°ƒé¢‘åŠ¨ä½œã€‚</p>\n<p>å¦å¤–ï¼Œè¿˜å‘å…¶ä»–æ¨¡å—æä¾›äº†qosé¢‘ç‡æŠ•ç¥¨ï¼Œä»¥åŠè°ƒé¢‘äº‹ä»¶çš„notifieræœºåˆ¶ã€‚</p>\n<p>ä¸‹é¢åˆ†å¼€æ¥çœ‹æ¯ä¸ªéƒ¨åˆ†ã€‚</p>\n<h2 id=\"Driver\"><a href=\"#Driver\" class=\"headerlink\" title=\"Driver\"></a>Driver</h2><p>Cpufreq Driverä¸»è¦è´Ÿè´£åº•å±‚è°ƒé¢‘çš„æ“ä½œï¼Œæ ¸å¿ƒæ˜¯å®ç° <code>cpufreq_dirver</code> å¯¹è±¡ï¼Œå¹¶é€šè¿‡ <code>cpufreq_register_driver</code> å°†é©±åŠ¨æ³¨å†Œåˆ°ç³»ç»Ÿï¼Œä¾›coreéƒ¨åˆ†ä½¿ç”¨ã€‚</p>\n<p>å…¶ä¸­ï¼Œæœ€æ ¸å¿ƒçš„å‡ ä¸ªå›è°ƒåŒ…æ‹¬ï¼š</p>\n<ul>\n<li>online: hotplug callback</li>\n<li>offline: hotplug callback</li>\n<li>target_index: set freq</li>\n<li>set_boost: enter into boost mode</li>\n</ul>\n<p>ä»¥ <code>mediatek-cpufreq-hw.c</code> ä¸ºä¾‹ï¼Œå…¶freq tableä¿å­˜åœ¨ç¡¬ä»¶å¯„å­˜å™¨ä¸­ï¼Œdriveråˆå§‹åŒ–æ—¶ï¼Œä»ç¡¬ä»¶ä¸­è¯»å‡ºfreq tableï¼Œå¹¶å®ç°ç›¸å…³è°ƒé¢‘å›è°ƒï¼Œæœ€ç»ˆæ³¨å†Œåˆ°coreã€‚</p>\n<p>db845cä½¿ç”¨çš„ <code>qcom-cpufreq-hw.c</code> ä¸ºä¾‹ï¼Œå…¶freq tableä¿å­˜åœ¨dtsä¸­ï¼Œdriverä½¿ç”¨OPPæ¡†æ¶æ¥è¯»å–è¿™äº›é…ç½®ï¼Œå¹¶å®ç°cpufreqå›è°ƒã€‚</p>\n<p>* OPPï¼ˆOperating Performance Pointï¼Œæä¾›dtsçš„freq-valt-tableé…ç½®ï¼ŒåŠè·å–æ¥å£ã€‚</p>\n<h2 id=\"Core\"><a href=\"#Core\" class=\"headerlink\" title=\"Core\"></a>Core</h2><p>Coreéƒ¨åˆ†æ ¸å¿ƒæ–‡ä»¶æ˜¯ <code>/drivers/cpufreq/cpufreq.c</code></p>\n<p>è¿™ä¸ªæ–‡ä»¶ä¸»è¦å®ç°äº†BOOSTï¼ŒDRIVERï¼ŒSYSFSï¼ŒFREQï¼ŒNOTIFIERï¼ŒGOVERNORï¼ŒPOLICYç›¸å…³åŠŸèƒ½çš„æ“ä½œæ¥å£ã€‚</p>\n<p><code>cpufreq_register_driver</code> (cpufreq_driver* cpufreq_driver)</p>\n<p><code>cpufreq_register_governor</code> (cpufreq_governor_list)</p>\n<p><code>cpufreq_register_notifier</code> (cpufreq_transition_notifier_list)</p>\n<p><code>cpufreq_policy_alloc</code> (cpufreq_policy* PERCPU:cpufreq_cpu_data)</p>\n<p><code>cpufreq_policy</code> æ˜¯ä¸€ä¸ªè°ƒé¢‘å®ä½“ï¼Œå¯¹åº”ä¸€ä¸ªè°ƒé¢‘åŸŸï¼ˆfreq domainï¼‰ï¼Œä¸€èˆ¬ä¸ºä¸€ä¸ªclusterï¼Œè¿™ä¸ªç»“æ„ä¿å­˜äº†æ¯ä¸ªè°ƒé¢‘å®ä½“ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªclusterï¼‰è°ƒé¢‘ç›¸å…³çš„æ‰€æœ‰ç§æœ‰ä¿¡æ¯ã€‚åŒæ—¶ï¼Œä»–ä½œä¸ºè°ƒé¢‘æ“ä½œçš„å¥æŸ„ï¼Œcpufreqé¡¶å±‚æ“ä½œæ¥å£ä½¿ç”¨policyæ¥å¯¹ä¸€ä¸ªè°ƒé¢‘å®ä½“è¿›è¡Œæ“ä½œã€‚</p>\n<p>æ¯ä¸ªCPUæœ‰ä¸€ä¸ªpercpuçš„æŒ‡é’ˆæŒ‡å‘å…¶æ‰€å±çš„policyï¼Œclusterä¸­çš„å¤šä¸ªCPUå…±äº«ä¸€ä¸ªpolicyã€‚ï¼ˆ<code>cpufreq_cpu_data</code>ï¼‰</p>\n<p>Mainflowï¼š</p>\n<p>1ã€cpufreq driveræ³¨å†Œ</p>\n<p>2ã€governoræ³¨å†Œï¼ˆæ¯ä¸ªpolicyåˆå§‹åŒ–è‡ªå·±çš„governorï¼‰</p>\n<p>3ã€cpu hotplug state: â€œcpufreq:onlineâ€ï¼Œ<code>cpuhp_cpufreq_online</code>ã€<code>cpuhp_cpufreq_offline</code>ï¼Œåˆ›å»ºå‡ºpercpu policyï¼Œç»‘å®šdriverã€governor</p>\n<p>4ã€å‘sysfsåˆ›å»ºèŠ‚ç‚¹ï¼Œæä¾›åŠŸèƒ½</p>\n<p>5ã€governorå¼€å§‹å·¥ä½œï¼Œé€šè¿‡ <code>__cpufreq_driver_target</code> è¿›è¡Œè°ƒé¢‘ã€‚</p>\n<ul>\n<li>Qosæ˜¯è°ƒé¢‘æŠ•ç¥¨æœºåˆ¶ï¼Œç”¨æ¥å®ç°max_freqã€min_freq limitationã€‚(<code>cpufreq_notifier_min</code> <code>cpufreq_notifier_max</code>)ï¼Œåœ¨å…¶ä»–moduleæœ‰éœ€æ±‚æŠ•ç¥¨åï¼Œfreq constrantsä¼šè¢«æ›´æ–°ã€‚</li>\n</ul>\n<h2 id=\"Sysfs\"><a href=\"#Sysfs\" class=\"headerlink\" title=\"Sysfs\"></a>Sysfs</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/sys/devices/system/cpu/cpu0/cpufreq/policyX</span><br><span class=\"line\">scaling_driver\t\t\tr\t# cpufreq driver name</span><br><span class=\"line\">affected_cpus\t\t\tr\t# cpu</span><br><span class=\"line\">related_cpus\t\t\tr\t# &lt;?&gt;</span><br><span class=\"line\">scaling_cur_freq\t\trw\t# cur freq</span><br><span class=\"line\">scaling_min_freq\t\trw\t# min freq limit</span><br><span class=\"line\">scaling_max_freq\t\trw\t# max freq limit</span><br><span class=\"line\">scaling_governor\t\trw\t# selected governor</span><br><span class=\"line\">scaling_available_governors\tr\t# available governors</span><br><span class=\"line\">scaling_setspeed\t\tr\t# &lt;not supported&gt;</span><br><span class=\"line\">cpuinfo_min_freq\t\tr\t# hardware min freq</span><br><span class=\"line\">cpuinfo_max_freq\t\tr\t# hardware max freq</span><br><span class=\"line\">cpuinfo_transition_latency\tr\t# hardware latency</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"Governors\"><a href=\"#Governors\" class=\"headerlink\" title=\"Governors\"></a>Governors</h2><p>Governorè´Ÿè´£ä»ç³»ç»Ÿæ”¶é›†ä¿¡æ¯ï¼Œå¹¶è§¦å‘è°ƒé¢‘åŠ¨ä½œã€‚</p>\n<p><strong>powersave</strong></p>\n<p>always lowest frequency</p>\n<p><strong>performance</strong></p>\n<p>always highest frequency</p>\n<p><strong>schedutil</strong></p>\n<p>uses CPU utilization data from scheduler to determine target frequence</p>\n<p>å¾…å®Œæˆ</p>\n<p><strong>userspace</strong></p>\n<p>allow user space set the frequency</p>\n<p><strong>ondemand</strong></p>\n<p>uses CPU load as a CPU frequency selection metric</p>\n<p>it reaches the target by CPU load, 0-&gt;min, 100-&gt;max</p>\n<p><strong>conservative</strong></p>\n<p>uses CPU load as a CPU frequency selection metric</p>\n<p>it reaches the target step by step, up_threshold-&gt;up, down_threshold-&gt;down</p>\n<h2 id=\"Files\"><a href=\"#Files\" class=\"headerlink\" title=\"Files\"></a>Files</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- /drivers/cpufreq/cpufreq.c</span><br><span class=\"line\">- /drivers/cpufreq/cpufreq-dt.c</span><br><span class=\"line\">- /drivers/cpufreq/cpufreq_stats.c</span><br><span class=\"line\">- /drivers/cpufreq/cpufreq_conservative.c</span><br><span class=\"line\">- /drivers/cpufreq/cpufreq_governor.c</span><br><span class=\"line\">- /drivers/cpufreq/cpufreq_ondemand.c</span><br><span class=\"line\">- /drivers/cpufreq/cpufreq_powersave.c</span><br><span class=\"line\">- /drivers/cpufreq/cpufreq_performance.c</span><br><span class=\"line\">- /drivers/cpufreq/cpufreq_userspace.c</span><br><span class=\"line\">- /kernel/sched/cpufreq_schedutil.c</span><br><span class=\"line\">- /kernel/power/qos.c</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"Reference\"><a href=\"#Reference\" class=\"headerlink\" title=\"Reference\"></a>Reference</h2><p><a href=\"https://www.kernel.org/doc/html/latest/admin-guide/pm/cpufreq.html\">https://www.kernel.org/doc/html/latest/admin-guide/pm/cpufreq.html</a></p>\n<p><a href=\"https://docs.kernel.org/scheduler/schedutil.html\">https://docs.kernel.org/scheduler/schedutil.html</a></p>\n<p><a href=\"http://www.wowotech.net/pm_subsystem/cpufreq_overview.html\">http://www.wowotech.net/pm_subsystem/cpufreq_overview.html</a></p>\n<p><a href=\"http://www.wowotech.net/pm_subsystem/cpufreq_driver.html\">http://www.wowotech.net/pm_subsystem/cpufreq_driver.html</a></p>\n<p><a href=\"http://www.wowotech.net/pm_subsystem/cpufreq_core.html\">http://www.wowotech.net/pm_subsystem/cpufreq_core.html</a></p>\n<p><a href=\"http://www.wowotech.net/pm_subsystem/cpufreq_governor.html\">http://www.wowotech.net/pm_subsystem/cpufreq_governor.html</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p>[toc]</p>\n<h1 id=\"cpufreq\"><a href=\"#cpufreq\" class=\"headerlink\" title=\"cpufreq\"></a>cpufreq</h1><p>CPUFreqæ¡†æ¶æ˜¯å†…æ ¸çš„CPUè°ƒé¢‘æ¡†æ¶ï¼Œæ•´ä¸ªè°ƒé¢‘æ¡†æ¶ç”±ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ç»„æˆï¼š</p>\n<ul>\n<li>cpufreq driver</li>\n<li>cpufreq framework (core)</li>\n<li>cpufreq governor</li>\n</ul>\n<p>ä¸€äº›åŸºæœ¬æ¦‚å¿µï¼š</p>\n<p>P-state: voltage and frequency point</p>\n<p>æ€»ä½“ä¸Šï¼ŒCPU Freqä¸»è¦åœ¨sysfså‘userspaceæä¾›äº†è°ƒé¢‘æ“ä½œå’Œç­–ç•¥è®¾ç½®èŠ‚ç‚¹ã€‚å½“ä½¿ç”¨ä¸€äº›è‡ªåŠ¨è°ƒé¢‘çš„governoræ—¶ï¼Œå…è®¸governorä»ç³»ç»Ÿè·å–ä¿¡æ¯ï¼Œè‡ªåŠ¨è§¦å‘è°ƒé¢‘åŠ¨ä½œã€‚</p>\n<p>å¦å¤–ï¼Œè¿˜å‘å…¶ä»–æ¨¡å—æä¾›äº†qosé¢‘ç‡æŠ•ç¥¨ï¼Œä»¥åŠè°ƒé¢‘äº‹ä»¶çš„notifieræœºåˆ¶ã€‚</p>\n<p>ä¸‹é¢åˆ†å¼€æ¥çœ‹æ¯ä¸ªéƒ¨åˆ†ã€‚</p>\n<h2 id=\"Driver\"><a href=\"#Driver\" class=\"headerlink\" title=\"Driver\"></a>Driver</h2><p>Cpufreq Driverä¸»è¦è´Ÿè´£åº•å±‚è°ƒé¢‘çš„æ“ä½œï¼Œæ ¸å¿ƒæ˜¯å®ç° <code>cpufreq_dirver</code> å¯¹è±¡ï¼Œå¹¶é€šè¿‡ <code>cpufreq_register_driver</code> å°†é©±åŠ¨æ³¨å†Œåˆ°ç³»ç»Ÿï¼Œä¾›coreéƒ¨åˆ†ä½¿ç”¨ã€‚</p>\n<p>å…¶ä¸­ï¼Œæœ€æ ¸å¿ƒçš„å‡ ä¸ªå›è°ƒåŒ…æ‹¬ï¼š</p>\n<ul>\n<li>online: hotplug callback</li>\n<li>offline: hotplug callback</li>\n<li>target_index: set freq</li>\n<li>set_boost: enter into boost mode</li>\n</ul>\n<p>ä»¥ <code>mediatek-cpufreq-hw.c</code> ä¸ºä¾‹ï¼Œå…¶freq tableä¿å­˜åœ¨ç¡¬ä»¶å¯„å­˜å™¨ä¸­ï¼Œdriveråˆå§‹åŒ–æ—¶ï¼Œä»ç¡¬ä»¶ä¸­è¯»å‡ºfreq tableï¼Œå¹¶å®ç°ç›¸å…³è°ƒé¢‘å›è°ƒï¼Œæœ€ç»ˆæ³¨å†Œåˆ°coreã€‚</p>\n<p>db845cä½¿ç”¨çš„ <code>qcom-cpufreq-hw.c</code> ä¸ºä¾‹ï¼Œå…¶freq tableä¿å­˜åœ¨dtsä¸­ï¼Œdriverä½¿ç”¨OPPæ¡†æ¶æ¥è¯»å–è¿™äº›é…ç½®ï¼Œå¹¶å®ç°cpufreqå›è°ƒã€‚</p>\n<p>* OPPï¼ˆOperating Performance Pointï¼Œæä¾›dtsçš„freq-valt-tableé…ç½®ï¼ŒåŠè·å–æ¥å£ã€‚</p>\n<h2 id=\"Core\"><a href=\"#Core\" class=\"headerlink\" title=\"Core\"></a>Core</h2><p>Coreéƒ¨åˆ†æ ¸å¿ƒæ–‡ä»¶æ˜¯ <code>/drivers/cpufreq/cpufreq.c</code></p>\n<p>è¿™ä¸ªæ–‡ä»¶ä¸»è¦å®ç°äº†BOOSTï¼ŒDRIVERï¼ŒSYSFSï¼ŒFREQï¼ŒNOTIFIERï¼ŒGOVERNORï¼ŒPOLICYç›¸å…³åŠŸèƒ½çš„æ“ä½œæ¥å£ã€‚</p>\n<p><code>cpufreq_register_driver</code> (cpufreq_driver* cpufreq_driver)</p>\n<p><code>cpufreq_register_governor</code> (cpufreq_governor_list)</p>\n<p><code>cpufreq_register_notifier</code> (cpufreq_transition_notifier_list)</p>\n<p><code>cpufreq_policy_alloc</code> (cpufreq_policy* PERCPU:cpufreq_cpu_data)</p>\n<p><code>cpufreq_policy</code> æ˜¯ä¸€ä¸ªè°ƒé¢‘å®ä½“ï¼Œå¯¹åº”ä¸€ä¸ªè°ƒé¢‘åŸŸï¼ˆfreq domainï¼‰ï¼Œä¸€èˆ¬ä¸ºä¸€ä¸ªclusterï¼Œè¿™ä¸ªç»“æ„ä¿å­˜äº†æ¯ä¸ªè°ƒé¢‘å®ä½“ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªclusterï¼‰è°ƒé¢‘ç›¸å…³çš„æ‰€æœ‰ç§æœ‰ä¿¡æ¯ã€‚åŒæ—¶ï¼Œä»–ä½œä¸ºè°ƒé¢‘æ“ä½œçš„å¥æŸ„ï¼Œcpufreqé¡¶å±‚æ“ä½œæ¥å£ä½¿ç”¨policyæ¥å¯¹ä¸€ä¸ªè°ƒé¢‘å®ä½“è¿›è¡Œæ“ä½œã€‚</p>\n<p>æ¯ä¸ªCPUæœ‰ä¸€ä¸ªpercpuçš„æŒ‡é’ˆæŒ‡å‘å…¶æ‰€å±çš„policyï¼Œclusterä¸­çš„å¤šä¸ªCPUå…±äº«ä¸€ä¸ªpolicyã€‚ï¼ˆ<code>cpufreq_cpu_data</code>ï¼‰</p>\n<p>Mainflowï¼š</p>\n<p>1ã€cpufreq driveræ³¨å†Œ</p>\n<p>2ã€governoræ³¨å†Œï¼ˆæ¯ä¸ªpolicyåˆå§‹åŒ–è‡ªå·±çš„governorï¼‰</p>\n<p>3ã€cpu hotplug state: â€œcpufreq:onlineâ€ï¼Œ<code>cpuhp_cpufreq_online</code>ã€<code>cpuhp_cpufreq_offline</code>ï¼Œåˆ›å»ºå‡ºpercpu policyï¼Œç»‘å®šdriverã€governor</p>\n<p>4ã€å‘sysfsåˆ›å»ºèŠ‚ç‚¹ï¼Œæä¾›åŠŸèƒ½</p>\n<p>5ã€governorå¼€å§‹å·¥ä½œï¼Œé€šè¿‡ <code>__cpufreq_driver_target</code> è¿›è¡Œè°ƒé¢‘ã€‚</p>\n<ul>\n<li>Qosæ˜¯è°ƒé¢‘æŠ•ç¥¨æœºåˆ¶ï¼Œç”¨æ¥å®ç°max_freqã€min_freq limitationã€‚(<code>cpufreq_notifier_min</code> <code>cpufreq_notifier_max</code>)ï¼Œåœ¨å…¶ä»–moduleæœ‰éœ€æ±‚æŠ•ç¥¨åï¼Œfreq constrantsä¼šè¢«æ›´æ–°ã€‚</li>\n</ul>\n<h2 id=\"Sysfs\"><a href=\"#Sysfs\" class=\"headerlink\" title=\"Sysfs\"></a>Sysfs</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/sys/devices/system/cpu/cpu0/cpufreq/policyX</span><br><span class=\"line\">scaling_driver\t\t\tr\t# cpufreq driver name</span><br><span class=\"line\">affected_cpus\t\t\tr\t# cpu</span><br><span class=\"line\">related_cpus\t\t\tr\t# &lt;?&gt;</span><br><span class=\"line\">scaling_cur_freq\t\trw\t# cur freq</span><br><span class=\"line\">scaling_min_freq\t\trw\t# min freq limit</span><br><span class=\"line\">scaling_max_freq\t\trw\t# max freq limit</span><br><span class=\"line\">scaling_governor\t\trw\t# selected governor</span><br><span class=\"line\">scaling_available_governors\tr\t# available governors</span><br><span class=\"line\">scaling_setspeed\t\tr\t# &lt;not supported&gt;</span><br><span class=\"line\">cpuinfo_min_freq\t\tr\t# hardware min freq</span><br><span class=\"line\">cpuinfo_max_freq\t\tr\t# hardware max freq</span><br><span class=\"line\">cpuinfo_transition_latency\tr\t# hardware latency</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"Governors\"><a href=\"#Governors\" class=\"headerlink\" title=\"Governors\"></a>Governors</h2><p>Governorè´Ÿè´£ä»ç³»ç»Ÿæ”¶é›†ä¿¡æ¯ï¼Œå¹¶è§¦å‘è°ƒé¢‘åŠ¨ä½œã€‚</p>\n<p><strong>powersave</strong></p>\n<p>always lowest frequency</p>\n<p><strong>performance</strong></p>\n<p>always highest frequency</p>\n<p><strong>schedutil</strong></p>\n<p>uses CPU utilization data from scheduler to determine target frequence</p>\n<p>å¾…å®Œæˆ</p>\n<p><strong>userspace</strong></p>\n<p>allow user space set the frequency</p>\n<p><strong>ondemand</strong></p>\n<p>uses CPU load as a CPU frequency selection metric</p>\n<p>it reaches the target by CPU load, 0-&gt;min, 100-&gt;max</p>\n<p><strong>conservative</strong></p>\n<p>uses CPU load as a CPU frequency selection metric</p>\n<p>it reaches the target step by step, up_threshold-&gt;up, down_threshold-&gt;down</p>\n<h2 id=\"Files\"><a href=\"#Files\" class=\"headerlink\" title=\"Files\"></a>Files</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- /drivers/cpufreq/cpufreq.c</span><br><span class=\"line\">- /drivers/cpufreq/cpufreq-dt.c</span><br><span class=\"line\">- /drivers/cpufreq/cpufreq_stats.c</span><br><span class=\"line\">- /drivers/cpufreq/cpufreq_conservative.c</span><br><span class=\"line\">- /drivers/cpufreq/cpufreq_governor.c</span><br><span class=\"line\">- /drivers/cpufreq/cpufreq_ondemand.c</span><br><span class=\"line\">- /drivers/cpufreq/cpufreq_powersave.c</span><br><span class=\"line\">- /drivers/cpufreq/cpufreq_performance.c</span><br><span class=\"line\">- /drivers/cpufreq/cpufreq_userspace.c</span><br><span class=\"line\">- /kernel/sched/cpufreq_schedutil.c</span><br><span class=\"line\">- /kernel/power/qos.c</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"Reference\"><a href=\"#Reference\" class=\"headerlink\" title=\"Reference\"></a>Reference</h2><p><a href=\"https://www.kernel.org/doc/html/latest/admin-guide/pm/cpufreq.html\">https://www.kernel.org/doc/html/latest/admin-guide/pm/cpufreq.html</a></p>\n<p><a href=\"https://docs.kernel.org/scheduler/schedutil.html\">https://docs.kernel.org/scheduler/schedutil.html</a></p>\n<p><a href=\"http://www.wowotech.net/pm_subsystem/cpufreq_overview.html\">http://www.wowotech.net/pm_subsystem/cpufreq_overview.html</a></p>\n<p><a href=\"http://www.wowotech.net/pm_subsystem/cpufreq_driver.html\">http://www.wowotech.net/pm_subsystem/cpufreq_driver.html</a></p>\n<p><a href=\"http://www.wowotech.net/pm_subsystem/cpufreq_core.html\">http://www.wowotech.net/pm_subsystem/cpufreq_core.html</a></p>\n<p><a href=\"http://www.wowotech.net/pm_subsystem/cpufreq_governor.html\">http://www.wowotech.net/pm_subsystem/cpufreq_governor.html</a></p>\n"},{"title":"github+hexo åšå®¢æ­å»º","date":"2023-08-25T11:32:35.000Z","categories":["test"],"tags":["test"],"_content":"\n\n@[toc]\nç¯å¢ƒï¼šwin11+wsl\n## 1.å®‰è£…Node.jsã€Gitå’ŒHexo\næ‰“å¼€ç»ˆç«¯å®‰è£…ä»¥ä¸‹è½¯ä»¶\n```\nsudo apt update\nsudo apt-get install git\n\nsudo apt install nodejs\nsudo apt install npm        #Node.js çš„åŒ…ç®¡ç†å™¨\nsudo npm install -g hexo-cli        #å®‰è£…hexo\n```\n## 2.åˆ›å»º GitHub ä»“åº“å¹¶é…ç½®ssh\nç™»å½•ä½ çš„ GitHub å¸å·ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„ä»“åº“ï¼Œä»“åº“åæ˜¯ `<username>.github.io`ï¼Œå…¶ä¸­ `<username>` æ˜¯ä½ çš„ GitHub ç”¨æˆ·åã€‚å°†è¯¥ä»“åº“è®¾ç½®ä¸ºå…¬å¼€ä»“åº“ã€‚\nè®¾ç½®ssh\n```\nssh-keygen -t rsa -C 'xxx@xxx.com'  #è‡ªå·±çš„é‚®ç®±\ncat ~/.ssh/id_rsa.pub  #å°†é‡Œé¢çš„å†…å®¹å¤åˆ¶åˆ° github ->settings ->SSH and GPC keys ->SSH keys ->New SSH keyä¸­\nssh -T git@github.com  #è¾“å…¥yesä¹‹åï¼Œè¡Œæœ«å°¾ä¼šæ˜¾ç¤ºä½ çš„ç”¨æˆ·åï¼ˆç»‘å®šæˆåŠŸé‚®ç®±ä¼šæ”¶åˆ°é‚®ä»¶æé†’ï¼‰\n#æ¥ç€åœ¨æœ¬åœ°ç»‘å®šä¸Githubçš„ç”¨æˆ·åå’Œé‚®ç®±ï¼ˆgitï¼‰\ngit config --global user.name \"<username>\"    #è‡ªå·±çš„ç”¨æˆ·å\ngit config --global user.email 'xxx@xxx.com'  #è‡ªå·±çš„é‚®ç®±\n```\n## 3.åˆå§‹åŒ–Hexo\nåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹ï¼Œç”¨äºå­˜å‚¨ä½ çš„åšå®¢é¡¹ç›®ã€‚\nåœ¨ç»ˆç«¯ä¸­ï¼Œè¿›å…¥è¯¥æ–‡ä»¶å¤¹ï¼Œå¹¶è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥åˆå§‹åŒ– Hexo\n```\nmkdir myblog\nhexo init    \n#æˆ–è€…ç›´æ¥ä¸€æ­¥åˆ°ä½ \nhexo init myblog\n```\n## 4.é…ç½®Hexo\n- è¿›å…¥ä½ çš„ Hexo é¡¹ç›®æ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ° _config.yml æ–‡ä»¶ï¼Œä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€å®ƒã€‚\n- åœ¨ _config.yml æ–‡ä»¶ä¸­ï¼Œé…ç½®ä½ çš„åšå®¢è®¾ç½®ï¼Œä¾‹å¦‚æ ‡é¢˜ã€æè¿°ã€ä½œè€…ç­‰ã€‚\n- æ ¹æ®éœ€è¦ï¼Œä½ è¿˜å¯ä»¥é…ç½®ä¸»é¢˜ã€æ’ä»¶å’Œå…¶ä»– Hexo é€‰é¡¹ã€‚\nç¼–è¾‘_config.ymlæ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ \n```\ndeploy:\n        type: git\n        repo: git@github.com: <username>/ <username>.github.io.git  #<username>ä¸ºè‡ªå·±çš„ç”¨æˆ·å\n        branch: main\n```\n```\nnpm install hexo-deployer-git    #å®‰è£… hexo-deployer-git æ’ä»¶ å°†éƒ¨ç½²è¿‡ç¨‹è‡ªåŠ¨åŒ–\n```\n## 5.åˆ›å»ºåšå®¢å†…å®¹\nåœ¨ç»ˆç«¯ä¸­ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥åˆ›å»ºæ–°çš„åšå®¢æ–‡ç« ï¼š\n```\nhexo new \"My First Post\"\n```\nè¿™å°†åœ¨ Hexo é¡¹ç›®çš„ source/_posts ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–°çš„ Markdown æ–‡ä»¶ï¼Œç”¨äºç¼–å†™ä½ çš„ç¬¬ä¸€ç¯‡åšå®¢æ–‡ç« ã€‚\n## 6.éƒ¨ç½²\n```\nhexo s    # é¢„è§ˆ\n#Hexo is running at http://localhost:4000/ . Press Ctrl+C to stop.\n#ç”¨æµè§ˆå™¨æ‰“å¼€ http://localhost:4000/\nhexo g #ç”Ÿæˆé™æ€ç½‘ç«™æ–‡ä»¶\nhexo d #å°†ç”Ÿæˆçš„é™æ€ç½‘ç«™æ–‡ä»¶éƒ¨ç½²åˆ°github\n```\n## 7.æŸ¥çœ‹\næµè§ˆå™¨æ‰“å¼€`<username>.github.io`å³å¯æŸ¥çœ‹\n\n\n## 8.å‚è€ƒï¼š\nhttps://blog.csdn.net/qq_62928039/article/details/130248518\n\n## 9.é€‰æ‹©ä¸»é¢˜ï¼š\nhttps://hexo.io/themes/\nhttps://github.com/yelog/hexo-theme-3-hexo\n```\n#åœ¨hexoæ ¹ç›®å½•ä¸‹\ngit clone https://github.com/yelog/hexo-theme-3-hexo.git themes/3-hexo\n#ä¿®æ”¹hexoæ ¹ç›®å½•çš„_config.ymlï¼Œå¦‚ä¸‹\ntheme: 3-hexo\n#åšå®¢é…ç½®\nhttp://yelog.org/2017/03/23/3-hexo-instruction/\n```\næœ€ç»ˆæ•ˆæœï¼š\nhttps://yyheroi.github.io\n","source":"back_posts/github+hexoåšå®¢æ­å»º.md","raw":"---\ntitle: github+hexo åšå®¢æ­å»º\ndate: 2023-08-25 19:32:35\ncategories:\n- test\ntags:\n- test\n---\n\n\n@[toc]\nç¯å¢ƒï¼šwin11+wsl\n## 1.å®‰è£…Node.jsã€Gitå’ŒHexo\næ‰“å¼€ç»ˆç«¯å®‰è£…ä»¥ä¸‹è½¯ä»¶\n```\nsudo apt update\nsudo apt-get install git\n\nsudo apt install nodejs\nsudo apt install npm        #Node.js çš„åŒ…ç®¡ç†å™¨\nsudo npm install -g hexo-cli        #å®‰è£…hexo\n```\n## 2.åˆ›å»º GitHub ä»“åº“å¹¶é…ç½®ssh\nç™»å½•ä½ çš„ GitHub å¸å·ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„ä»“åº“ï¼Œä»“åº“åæ˜¯ `<username>.github.io`ï¼Œå…¶ä¸­ `<username>` æ˜¯ä½ çš„ GitHub ç”¨æˆ·åã€‚å°†è¯¥ä»“åº“è®¾ç½®ä¸ºå…¬å¼€ä»“åº“ã€‚\nè®¾ç½®ssh\n```\nssh-keygen -t rsa -C 'xxx@xxx.com'  #è‡ªå·±çš„é‚®ç®±\ncat ~/.ssh/id_rsa.pub  #å°†é‡Œé¢çš„å†…å®¹å¤åˆ¶åˆ° github ->settings ->SSH and GPC keys ->SSH keys ->New SSH keyä¸­\nssh -T git@github.com  #è¾“å…¥yesä¹‹åï¼Œè¡Œæœ«å°¾ä¼šæ˜¾ç¤ºä½ çš„ç”¨æˆ·åï¼ˆç»‘å®šæˆåŠŸé‚®ç®±ä¼šæ”¶åˆ°é‚®ä»¶æé†’ï¼‰\n#æ¥ç€åœ¨æœ¬åœ°ç»‘å®šä¸Githubçš„ç”¨æˆ·åå’Œé‚®ç®±ï¼ˆgitï¼‰\ngit config --global user.name \"<username>\"    #è‡ªå·±çš„ç”¨æˆ·å\ngit config --global user.email 'xxx@xxx.com'  #è‡ªå·±çš„é‚®ç®±\n```\n## 3.åˆå§‹åŒ–Hexo\nåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹ï¼Œç”¨äºå­˜å‚¨ä½ çš„åšå®¢é¡¹ç›®ã€‚\nåœ¨ç»ˆç«¯ä¸­ï¼Œè¿›å…¥è¯¥æ–‡ä»¶å¤¹ï¼Œå¹¶è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥åˆå§‹åŒ– Hexo\n```\nmkdir myblog\nhexo init    \n#æˆ–è€…ç›´æ¥ä¸€æ­¥åˆ°ä½ \nhexo init myblog\n```\n## 4.é…ç½®Hexo\n- è¿›å…¥ä½ çš„ Hexo é¡¹ç›®æ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ° _config.yml æ–‡ä»¶ï¼Œä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€å®ƒã€‚\n- åœ¨ _config.yml æ–‡ä»¶ä¸­ï¼Œé…ç½®ä½ çš„åšå®¢è®¾ç½®ï¼Œä¾‹å¦‚æ ‡é¢˜ã€æè¿°ã€ä½œè€…ç­‰ã€‚\n- æ ¹æ®éœ€è¦ï¼Œä½ è¿˜å¯ä»¥é…ç½®ä¸»é¢˜ã€æ’ä»¶å’Œå…¶ä»– Hexo é€‰é¡¹ã€‚\nç¼–è¾‘_config.ymlæ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ \n```\ndeploy:\n        type: git\n        repo: git@github.com: <username>/ <username>.github.io.git  #<username>ä¸ºè‡ªå·±çš„ç”¨æˆ·å\n        branch: main\n```\n```\nnpm install hexo-deployer-git    #å®‰è£… hexo-deployer-git æ’ä»¶ å°†éƒ¨ç½²è¿‡ç¨‹è‡ªåŠ¨åŒ–\n```\n## 5.åˆ›å»ºåšå®¢å†…å®¹\nåœ¨ç»ˆç«¯ä¸­ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥åˆ›å»ºæ–°çš„åšå®¢æ–‡ç« ï¼š\n```\nhexo new \"My First Post\"\n```\nè¿™å°†åœ¨ Hexo é¡¹ç›®çš„ source/_posts ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–°çš„ Markdown æ–‡ä»¶ï¼Œç”¨äºç¼–å†™ä½ çš„ç¬¬ä¸€ç¯‡åšå®¢æ–‡ç« ã€‚\n## 6.éƒ¨ç½²\n```\nhexo s    # é¢„è§ˆ\n#Hexo is running at http://localhost:4000/ . Press Ctrl+C to stop.\n#ç”¨æµè§ˆå™¨æ‰“å¼€ http://localhost:4000/\nhexo g #ç”Ÿæˆé™æ€ç½‘ç«™æ–‡ä»¶\nhexo d #å°†ç”Ÿæˆçš„é™æ€ç½‘ç«™æ–‡ä»¶éƒ¨ç½²åˆ°github\n```\n## 7.æŸ¥çœ‹\næµè§ˆå™¨æ‰“å¼€`<username>.github.io`å³å¯æŸ¥çœ‹\n\n\n## 8.å‚è€ƒï¼š\nhttps://blog.csdn.net/qq_62928039/article/details/130248518\n\n## 9.é€‰æ‹©ä¸»é¢˜ï¼š\nhttps://hexo.io/themes/\nhttps://github.com/yelog/hexo-theme-3-hexo\n```\n#åœ¨hexoæ ¹ç›®å½•ä¸‹\ngit clone https://github.com/yelog/hexo-theme-3-hexo.git themes/3-hexo\n#ä¿®æ”¹hexoæ ¹ç›®å½•çš„_config.ymlï¼Œå¦‚ä¸‹\ntheme: 3-hexo\n#åšå®¢é…ç½®\nhttp://yelog.org/2017/03/23/3-hexo-instruction/\n```\næœ€ç»ˆæ•ˆæœï¼š\nhttps://yyheroi.github.io\n","updated":"2024-05-15T06:11:08.990Z","path":"back_posts/github+hexoåšå®¢æ­å»º.html","comments":1,"layout":"page","_id":"clw7fflkr0007x2w07k697mbm","content":"<p>@[toc]<br>ç¯å¢ƒï¼šwin11+wsl</p>\n<h2 id=\"1-å®‰è£…Node-jsã€Gitå’ŒHexo\"><a href=\"#1-å®‰è£…Node-jsã€Gitå’ŒHexo\" class=\"headerlink\" title=\"1.å®‰è£…Node.jsã€Gitå’ŒHexo\"></a>1.å®‰è£…Node.jsã€Gitå’ŒHexo</h2><p>æ‰“å¼€ç»ˆç«¯å®‰è£…ä»¥ä¸‹è½¯ä»¶</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt update</span><br><span class=\"line\">sudo apt-get install git</span><br><span class=\"line\"></span><br><span class=\"line\">sudo apt install nodejs</span><br><span class=\"line\">sudo apt install npm        #Node.js çš„åŒ…ç®¡ç†å™¨</span><br><span class=\"line\">sudo npm install -g hexo-cli        #å®‰è£…hexo</span><br></pre></td></tr></table></figure>\n<h2 id=\"2-åˆ›å»º-GitHub-ä»“åº“å¹¶é…ç½®ssh\"><a href=\"#2-åˆ›å»º-GitHub-ä»“åº“å¹¶é…ç½®ssh\" class=\"headerlink\" title=\"2.åˆ›å»º GitHub ä»“åº“å¹¶é…ç½®ssh\"></a>2.åˆ›å»º GitHub ä»“åº“å¹¶é…ç½®ssh</h2><p>ç™»å½•ä½ çš„ GitHub å¸å·ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„ä»“åº“ï¼Œä»“åº“åæ˜¯ <code>&lt;username&gt;.github.io</code>ï¼Œå…¶ä¸­ <code>&lt;username&gt;</code> æ˜¯ä½ çš„ GitHub ç”¨æˆ·åã€‚å°†è¯¥ä»“åº“è®¾ç½®ä¸ºå…¬å¼€ä»“åº“ã€‚<br>è®¾ç½®ssh</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa -C &#x27;xxx@xxx.com&#x27;  #è‡ªå·±çš„é‚®ç®±</span><br><span class=\"line\">cat ~/.ssh/id_rsa.pub  #å°†é‡Œé¢çš„å†…å®¹å¤åˆ¶åˆ° github -&gt;settings -&gt;SSH and GPC keys -&gt;SSH keys -&gt;New SSH keyä¸­</span><br><span class=\"line\">ssh -T git@github.com  #è¾“å…¥yesä¹‹åï¼Œè¡Œæœ«å°¾ä¼šæ˜¾ç¤ºä½ çš„ç”¨æˆ·åï¼ˆç»‘å®šæˆåŠŸé‚®ç®±ä¼šæ”¶åˆ°é‚®ä»¶æé†’ï¼‰</span><br><span class=\"line\">#æ¥ç€åœ¨æœ¬åœ°ç»‘å®šä¸Githubçš„ç”¨æˆ·åå’Œé‚®ç®±ï¼ˆgitï¼‰</span><br><span class=\"line\">git config --global user.name &quot;&lt;username&gt;&quot;    #è‡ªå·±çš„ç”¨æˆ·å</span><br><span class=\"line\">git config --global user.email &#x27;xxx@xxx.com&#x27;  #è‡ªå·±çš„é‚®ç®±</span><br></pre></td></tr></table></figure>\n<h2 id=\"3-åˆå§‹åŒ–Hexo\"><a href=\"#3-åˆå§‹åŒ–Hexo\" class=\"headerlink\" title=\"3.åˆå§‹åŒ–Hexo\"></a>3.åˆå§‹åŒ–Hexo</h2><p>åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹ï¼Œç”¨äºå­˜å‚¨ä½ çš„åšå®¢é¡¹ç›®ã€‚<br>åœ¨ç»ˆç«¯ä¸­ï¼Œè¿›å…¥è¯¥æ–‡ä»¶å¤¹ï¼Œå¹¶è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥åˆå§‹åŒ– Hexo</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir myblog</span><br><span class=\"line\">hexo init    </span><br><span class=\"line\">#æˆ–è€…ç›´æ¥ä¸€æ­¥åˆ°ä½ </span><br><span class=\"line\">hexo init myblog</span><br></pre></td></tr></table></figure>\n<h2 id=\"4-é…ç½®Hexo\"><a href=\"#4-é…ç½®Hexo\" class=\"headerlink\" title=\"4.é…ç½®Hexo\"></a>4.é…ç½®Hexo</h2><ul>\n<li>è¿›å…¥ä½ çš„ Hexo é¡¹ç›®æ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ° _config.yml æ–‡ä»¶ï¼Œä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€å®ƒã€‚</li>\n<li>åœ¨ _config.yml æ–‡ä»¶ä¸­ï¼Œé…ç½®ä½ çš„åšå®¢è®¾ç½®ï¼Œä¾‹å¦‚æ ‡é¢˜ã€æè¿°ã€ä½œè€…ç­‰ã€‚</li>\n<li>æ ¹æ®éœ€è¦ï¼Œä½ è¿˜å¯ä»¥é…ç½®ä¸»é¢˜ã€æ’ä»¶å’Œå…¶ä»– Hexo é€‰é¡¹ã€‚<br>ç¼–è¾‘_config.ymlæ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">deploy:</span><br><span class=\"line\">        type: git</span><br><span class=\"line\">        repo: git@github.com: &lt;username&gt;/ &lt;username&gt;.github.io.git  #&lt;username&gt;ä¸ºè‡ªå·±çš„ç”¨æˆ·å</span><br><span class=\"line\">        branch: main</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install hexo-deployer-git    #å®‰è£… hexo-deployer-git æ’ä»¶ å°†éƒ¨ç½²è¿‡ç¨‹è‡ªåŠ¨åŒ–</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h2 id=\"5-åˆ›å»ºåšå®¢å†…å®¹\"><a href=\"#5-åˆ›å»ºåšå®¢å†…å®¹\" class=\"headerlink\" title=\"5.åˆ›å»ºåšå®¢å†…å®¹\"></a>5.åˆ›å»ºåšå®¢å†…å®¹</h2><p>åœ¨ç»ˆç«¯ä¸­ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥åˆ›å»ºæ–°çš„åšå®¢æ–‡ç« ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo new &quot;My First Post&quot;</span><br></pre></td></tr></table></figure>\n<p>è¿™å°†åœ¨ Hexo é¡¹ç›®çš„ source&#x2F;_posts ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–°çš„ Markdown æ–‡ä»¶ï¼Œç”¨äºç¼–å†™ä½ çš„ç¬¬ä¸€ç¯‡åšå®¢æ–‡ç« ã€‚</p>\n<h2 id=\"6-éƒ¨ç½²\"><a href=\"#6-éƒ¨ç½²\" class=\"headerlink\" title=\"6.éƒ¨ç½²\"></a>6.éƒ¨ç½²</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo s    # é¢„è§ˆ</span><br><span class=\"line\">#Hexo is running at http://localhost:4000/ . Press Ctrl+C to stop.</span><br><span class=\"line\">#ç”¨æµè§ˆå™¨æ‰“å¼€ http://localhost:4000/</span><br><span class=\"line\">hexo g #ç”Ÿæˆé™æ€ç½‘ç«™æ–‡ä»¶</span><br><span class=\"line\">hexo d #å°†ç”Ÿæˆçš„é™æ€ç½‘ç«™æ–‡ä»¶éƒ¨ç½²åˆ°github</span><br></pre></td></tr></table></figure>\n<h2 id=\"7-æŸ¥çœ‹\"><a href=\"#7-æŸ¥çœ‹\" class=\"headerlink\" title=\"7.æŸ¥çœ‹\"></a>7.æŸ¥çœ‹</h2><p>æµè§ˆå™¨æ‰“å¼€<code>&lt;username&gt;.github.io</code>å³å¯æŸ¥çœ‹</p>\n<h2 id=\"8-å‚è€ƒï¼š\"><a href=\"#8-å‚è€ƒï¼š\" class=\"headerlink\" title=\"8.å‚è€ƒï¼š\"></a>8.å‚è€ƒï¼š</h2><p><a href=\"https://blog.csdn.net/qq_62928039/article/details/130248518\">https://blog.csdn.net/qq_62928039/article/details/130248518</a></p>\n<h2 id=\"9-é€‰æ‹©ä¸»é¢˜ï¼š\"><a href=\"#9-é€‰æ‹©ä¸»é¢˜ï¼š\" class=\"headerlink\" title=\"9.é€‰æ‹©ä¸»é¢˜ï¼š\"></a>9.é€‰æ‹©ä¸»é¢˜ï¼š</h2><p><a href=\"https://hexo.io/themes/\">https://hexo.io/themes/</a><br><a href=\"https://github.com/yelog/hexo-theme-3-hexo\">https://github.com/yelog/hexo-theme-3-hexo</a></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#åœ¨hexoæ ¹ç›®å½•ä¸‹</span><br><span class=\"line\">git clone https://github.com/yelog/hexo-theme-3-hexo.git themes/3-hexo</span><br><span class=\"line\">#ä¿®æ”¹hexoæ ¹ç›®å½•çš„_config.ymlï¼Œå¦‚ä¸‹</span><br><span class=\"line\">theme: 3-hexo</span><br><span class=\"line\">#åšå®¢é…ç½®</span><br><span class=\"line\">http://yelog.org/2017/03/23/3-hexo-instruction/</span><br></pre></td></tr></table></figure>\n<p>æœ€ç»ˆæ•ˆæœï¼š<br><a href=\"https://yyheroi.github.io/\">https://yyheroi.github.io</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p>@[toc]<br>ç¯å¢ƒï¼šwin11+wsl</p>\n<h2 id=\"1-å®‰è£…Node-jsã€Gitå’ŒHexo\"><a href=\"#1-å®‰è£…Node-jsã€Gitå’ŒHexo\" class=\"headerlink\" title=\"1.å®‰è£…Node.jsã€Gitå’ŒHexo\"></a>1.å®‰è£…Node.jsã€Gitå’ŒHexo</h2><p>æ‰“å¼€ç»ˆç«¯å®‰è£…ä»¥ä¸‹è½¯ä»¶</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt update</span><br><span class=\"line\">sudo apt-get install git</span><br><span class=\"line\"></span><br><span class=\"line\">sudo apt install nodejs</span><br><span class=\"line\">sudo apt install npm        #Node.js çš„åŒ…ç®¡ç†å™¨</span><br><span class=\"line\">sudo npm install -g hexo-cli        #å®‰è£…hexo</span><br></pre></td></tr></table></figure>\n<h2 id=\"2-åˆ›å»º-GitHub-ä»“åº“å¹¶é…ç½®ssh\"><a href=\"#2-åˆ›å»º-GitHub-ä»“åº“å¹¶é…ç½®ssh\" class=\"headerlink\" title=\"2.åˆ›å»º GitHub ä»“åº“å¹¶é…ç½®ssh\"></a>2.åˆ›å»º GitHub ä»“åº“å¹¶é…ç½®ssh</h2><p>ç™»å½•ä½ çš„ GitHub å¸å·ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„ä»“åº“ï¼Œä»“åº“åæ˜¯ <code>&lt;username&gt;.github.io</code>ï¼Œå…¶ä¸­ <code>&lt;username&gt;</code> æ˜¯ä½ çš„ GitHub ç”¨æˆ·åã€‚å°†è¯¥ä»“åº“è®¾ç½®ä¸ºå…¬å¼€ä»“åº“ã€‚<br>è®¾ç½®ssh</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa -C &#x27;xxx@xxx.com&#x27;  #è‡ªå·±çš„é‚®ç®±</span><br><span class=\"line\">cat ~/.ssh/id_rsa.pub  #å°†é‡Œé¢çš„å†…å®¹å¤åˆ¶åˆ° github -&gt;settings -&gt;SSH and GPC keys -&gt;SSH keys -&gt;New SSH keyä¸­</span><br><span class=\"line\">ssh -T git@github.com  #è¾“å…¥yesä¹‹åï¼Œè¡Œæœ«å°¾ä¼šæ˜¾ç¤ºä½ çš„ç”¨æˆ·åï¼ˆç»‘å®šæˆåŠŸé‚®ç®±ä¼šæ”¶åˆ°é‚®ä»¶æé†’ï¼‰</span><br><span class=\"line\">#æ¥ç€åœ¨æœ¬åœ°ç»‘å®šä¸Githubçš„ç”¨æˆ·åå’Œé‚®ç®±ï¼ˆgitï¼‰</span><br><span class=\"line\">git config --global user.name &quot;&lt;username&gt;&quot;    #è‡ªå·±çš„ç”¨æˆ·å</span><br><span class=\"line\">git config --global user.email &#x27;xxx@xxx.com&#x27;  #è‡ªå·±çš„é‚®ç®±</span><br></pre></td></tr></table></figure>\n<h2 id=\"3-åˆå§‹åŒ–Hexo\"><a href=\"#3-åˆå§‹åŒ–Hexo\" class=\"headerlink\" title=\"3.åˆå§‹åŒ–Hexo\"></a>3.åˆå§‹åŒ–Hexo</h2><p>åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹ï¼Œç”¨äºå­˜å‚¨ä½ çš„åšå®¢é¡¹ç›®ã€‚<br>åœ¨ç»ˆç«¯ä¸­ï¼Œè¿›å…¥è¯¥æ–‡ä»¶å¤¹ï¼Œå¹¶è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥åˆå§‹åŒ– Hexo</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir myblog</span><br><span class=\"line\">hexo init    </span><br><span class=\"line\">#æˆ–è€…ç›´æ¥ä¸€æ­¥åˆ°ä½ </span><br><span class=\"line\">hexo init myblog</span><br></pre></td></tr></table></figure>\n<h2 id=\"4-é…ç½®Hexo\"><a href=\"#4-é…ç½®Hexo\" class=\"headerlink\" title=\"4.é…ç½®Hexo\"></a>4.é…ç½®Hexo</h2><ul>\n<li>è¿›å…¥ä½ çš„ Hexo é¡¹ç›®æ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ° _config.yml æ–‡ä»¶ï¼Œä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€å®ƒã€‚</li>\n<li>åœ¨ _config.yml æ–‡ä»¶ä¸­ï¼Œé…ç½®ä½ çš„åšå®¢è®¾ç½®ï¼Œä¾‹å¦‚æ ‡é¢˜ã€æè¿°ã€ä½œè€…ç­‰ã€‚</li>\n<li>æ ¹æ®éœ€è¦ï¼Œä½ è¿˜å¯ä»¥é…ç½®ä¸»é¢˜ã€æ’ä»¶å’Œå…¶ä»– Hexo é€‰é¡¹ã€‚<br>ç¼–è¾‘_config.ymlæ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">deploy:</span><br><span class=\"line\">        type: git</span><br><span class=\"line\">        repo: git@github.com: &lt;username&gt;/ &lt;username&gt;.github.io.git  #&lt;username&gt;ä¸ºè‡ªå·±çš„ç”¨æˆ·å</span><br><span class=\"line\">        branch: main</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install hexo-deployer-git    #å®‰è£… hexo-deployer-git æ’ä»¶ å°†éƒ¨ç½²è¿‡ç¨‹è‡ªåŠ¨åŒ–</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h2 id=\"5-åˆ›å»ºåšå®¢å†…å®¹\"><a href=\"#5-åˆ›å»ºåšå®¢å†…å®¹\" class=\"headerlink\" title=\"5.åˆ›å»ºåšå®¢å†…å®¹\"></a>5.åˆ›å»ºåšå®¢å†…å®¹</h2><p>åœ¨ç»ˆç«¯ä¸­ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥åˆ›å»ºæ–°çš„åšå®¢æ–‡ç« ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo new &quot;My First Post&quot;</span><br></pre></td></tr></table></figure>\n<p>è¿™å°†åœ¨ Hexo é¡¹ç›®çš„ source&#x2F;_posts ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–°çš„ Markdown æ–‡ä»¶ï¼Œç”¨äºç¼–å†™ä½ çš„ç¬¬ä¸€ç¯‡åšå®¢æ–‡ç« ã€‚</p>\n<h2 id=\"6-éƒ¨ç½²\"><a href=\"#6-éƒ¨ç½²\" class=\"headerlink\" title=\"6.éƒ¨ç½²\"></a>6.éƒ¨ç½²</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo s    # é¢„è§ˆ</span><br><span class=\"line\">#Hexo is running at http://localhost:4000/ . Press Ctrl+C to stop.</span><br><span class=\"line\">#ç”¨æµè§ˆå™¨æ‰“å¼€ http://localhost:4000/</span><br><span class=\"line\">hexo g #ç”Ÿæˆé™æ€ç½‘ç«™æ–‡ä»¶</span><br><span class=\"line\">hexo d #å°†ç”Ÿæˆçš„é™æ€ç½‘ç«™æ–‡ä»¶éƒ¨ç½²åˆ°github</span><br></pre></td></tr></table></figure>\n<h2 id=\"7-æŸ¥çœ‹\"><a href=\"#7-æŸ¥çœ‹\" class=\"headerlink\" title=\"7.æŸ¥çœ‹\"></a>7.æŸ¥çœ‹</h2><p>æµè§ˆå™¨æ‰“å¼€<code>&lt;username&gt;.github.io</code>å³å¯æŸ¥çœ‹</p>\n<h2 id=\"8-å‚è€ƒï¼š\"><a href=\"#8-å‚è€ƒï¼š\" class=\"headerlink\" title=\"8.å‚è€ƒï¼š\"></a>8.å‚è€ƒï¼š</h2><p><a href=\"https://blog.csdn.net/qq_62928039/article/details/130248518\">https://blog.csdn.net/qq_62928039/article/details/130248518</a></p>\n<h2 id=\"9-é€‰æ‹©ä¸»é¢˜ï¼š\"><a href=\"#9-é€‰æ‹©ä¸»é¢˜ï¼š\" class=\"headerlink\" title=\"9.é€‰æ‹©ä¸»é¢˜ï¼š\"></a>9.é€‰æ‹©ä¸»é¢˜ï¼š</h2><p><a href=\"https://hexo.io/themes/\">https://hexo.io/themes/</a><br><a href=\"https://github.com/yelog/hexo-theme-3-hexo\">https://github.com/yelog/hexo-theme-3-hexo</a></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#åœ¨hexoæ ¹ç›®å½•ä¸‹</span><br><span class=\"line\">git clone https://github.com/yelog/hexo-theme-3-hexo.git themes/3-hexo</span><br><span class=\"line\">#ä¿®æ”¹hexoæ ¹ç›®å½•çš„_config.ymlï¼Œå¦‚ä¸‹</span><br><span class=\"line\">theme: 3-hexo</span><br><span class=\"line\">#åšå®¢é…ç½®</span><br><span class=\"line\">http://yelog.org/2017/03/23/3-hexo-instruction/</span><br></pre></td></tr></table></figure>\n<p>æœ€ç»ˆæ•ˆæœï¼š<br><a href=\"https://yyheroi.github.io/\">https://yyheroi.github.io</a></p>\n"},{"title":"Hello World","date":"2023-08-24T16:00:00.000Z","categories":["test"],"tags":["test"],"_content":"Welcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/one-command-deployment.html)\n","source":"back_posts/hello-world.md","raw":"---\ntitle: Hello World\ndate: 2023-08-25 00:00:00\ncategories:\n- test\ntags:\n- test\n---\nWelcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/one-command-deployment.html)\n","updated":"2024-05-15T06:11:08.991Z","path":"back_posts/hello-world.html","comments":1,"layout":"page","_id":"clw7fflks0008x2w015yo7zy7","content":"<p>Welcome to <a href=\"https://hexo.io/\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/server.html\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo generate</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo deploy</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/one-command-deployment.html\">Deployment</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p>Welcome to <a href=\"https://hexo.io/\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/server.html\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo generate</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo deploy</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/one-command-deployment.html\">Deployment</a></p>\n"},{"_content":"# å—è®¾å¤‡é©±åŠ¨\n\n\n\nå—è®¾å¤‡çš„ä¸»è¦ç‰¹ç‚¹æ˜¯ï¼Œcpuå’Œæ€»çº¿è¯»å†™æ•°æ®æ‰€èŠ±æ—¶é—´ä¸ç¡¬ç›˜ç¡¬ä»¶çš„é€Ÿåº¦ä¸åŒ¹é…ã€‚","source":"back_posts/linuxå—è®¾å¤‡é©±åŠ¨.md","raw":"# å—è®¾å¤‡é©±åŠ¨\n\n\n\nå—è®¾å¤‡çš„ä¸»è¦ç‰¹ç‚¹æ˜¯ï¼Œcpuå’Œæ€»çº¿è¯»å†™æ•°æ®æ‰€èŠ±æ—¶é—´ä¸ç¡¬ç›˜ç¡¬ä»¶çš„é€Ÿåº¦ä¸åŒ¹é…ã€‚","date":"2024-05-15T06:11:08.991Z","updated":"2024-05-15T06:11:08.991Z","path":"back_posts/linuxå—è®¾å¤‡é©±åŠ¨.html","title":"","comments":1,"layout":"page","_id":"clw7fflks0009x2w0709d7bi5","content":"<h1 id=\"å—è®¾å¤‡é©±åŠ¨\"><a href=\"#å—è®¾å¤‡é©±åŠ¨\" class=\"headerlink\" title=\"å—è®¾å¤‡é©±åŠ¨\"></a>å—è®¾å¤‡é©±åŠ¨</h1><p>å—è®¾å¤‡çš„ä¸»è¦ç‰¹ç‚¹æ˜¯ï¼Œcpuå’Œæ€»çº¿è¯»å†™æ•°æ®æ‰€èŠ±æ—¶é—´ä¸ç¡¬ç›˜ç¡¬ä»¶çš„é€Ÿåº¦ä¸åŒ¹é…ã€‚</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"å—è®¾å¤‡é©±åŠ¨\"><a href=\"#å—è®¾å¤‡é©±åŠ¨\" class=\"headerlink\" title=\"å—è®¾å¤‡é©±åŠ¨\"></a>å—è®¾å¤‡é©±åŠ¨</h1><p>å—è®¾å¤‡çš„ä¸»è¦ç‰¹ç‚¹æ˜¯ï¼Œcpuå’Œæ€»çº¿è¯»å†™æ•°æ®æ‰€èŠ±æ—¶é—´ä¸ç¡¬ç›˜ç¡¬ä»¶çš„é€Ÿåº¦ä¸åŒ¹é…ã€‚</p>\n"},{"_content":"> \n\nU-Bootå®˜ç½‘:`https://docs.u-boot.org/en/latest/`\n\nu-bootå¯åŠ¨æµç¨‹\n\n- æ¿å­ä¸Šç”µä»¥åï¼Œé¦–å…ˆæ‰§è¡Œçš„æ˜¯ROMä¸­çš„ä¸€æ®µå¯åŠ¨ä»£ç ã€‚å¯åŠ¨ä»£ç **æ ¹æ®å¯„å­˜å™¨/å¤–éƒ¨ç®¡è„šé…ç½®**ï¼Œç¡®å®šæ˜¯è¿›å…¥ä¸‹è½½æ¨¡å¼ï¼Œè¿˜æ˜¯ä»æŸä»‹è´¨(Flash/EMMC/SDå¡ç­‰å­˜å‚¨è®¾å¤‡)å¯åŠ¨u-boot\n\n> ROMä¸­çš„ä»£ç æ˜¯å›ºåŒ–çš„ï¼Œæ— æ³•ä¿®æ”¹\n\n# ä¸€ã€ä»‹ç»\n\n> FDTï¼Œflatted device treeï¼Œæ‰å¹³è®¾å¤‡æ ‘ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯å°†éƒ¨åˆ†è®¾å¤‡ä¿¡æ¯ç»“æ„å­˜æ”¾åˆ°device treeæ–‡ä»¶ä¸­ã€‚\n>\n> ubootæœ€ç»ˆå°†å…¶ç¼–è¯‘æˆdtbæ–‡ä»¶ï¼Œä½¿ç”¨è¿‡ç¨‹ä¸­é€šè¿‡è§£æè¯¥dtbæ¥è·å–æ¿çº§è®¾å¤‡ä¿¡æ¯ã€‚  \n\n> U-bootçš„dtbå’Œkernelä¸­çš„dtbæ˜¯ä¸€è‡´çš„ï¼Œæœ‰å…³fdtçš„è¯¦ç»†ä»‹ç»ï¼Œå‚è€ƒdoc/README.fdt-control\n\n### dtbåœ¨U-bootä¸­çš„ä½ç½®\n\n- dtbèƒ½å¤Ÿä»¥ä¸¤ç§å½¢å¼ç¼–è¯‘åˆ°U-bootçš„é•œåƒä¸­\n\n1. dtbå’Œu-bootçš„binæ–‡ä»¶åˆ†ç¦»(imx6qä¸­ä½¿ç”¨çš„è¿™ç§æ–¹å¼ï¼Œåœ¨.configæ–‡ä»¶ä¸­å¯ä»¥æŸ¥çœ‹åˆ°)\n\n> é€šè¿‡CONFIG_OF_SEPARATEå®å®šä¹‰ä½¿èƒ½ï¼Œdtbæœ€åä¼šè¿½åŠ åˆ°u-bootçš„binæ–‡ä»¶çš„æœ€åé¢ï¼Œé€šè¿‡u-bootçš„ç»“æŸåœ°å€ç¬¦å·_endç¬¦å·æ¥è·å–dtbçš„åœ°å€\n\n1. dtbé›†æˆåˆ°u-bootçš„binæ–‡ä»¶å†…éƒ¨\n\n> é€šè¿‡CONFIG_OF_EMBEDå®å®šä¹‰ä½¿èƒ½ï¼Œdtbä¼šä½äºu-bootçš„.dtb.init.rodataæ®µä¸­ï¼Œé€šè¿‡__dtb_dt_beginç¬¦å·æ¥è·å–dtb\n\n1. è·å–dtsæ–‡ä»¶çš„åœ°å€gd->fdt_blob\n\n```\n// å®ç”¨æ¥è¡¨ç¤ºæ˜¯å¦æŠŠdtbæ–‡ä»¶æ”¾åœ¨uboot.binçš„æ–‡ä»¶ä¸­\nCONFIG_OF_EMBED\n\n// å•ç‹¬ç¼–è¯‘dtbæ–‡ä»¶\nCONFIG_OF_SEPARATEï¼Œç¼–è¯‘å‡ºæ¥çš„dtbæ”¾åœ¨uboot.binçš„æœ€åé¢ï¼Œå°±æ˜¯dtbè¿½åŠ åˆ°ubootçš„binæ–‡ä»¶åé¢æ—¶ï¼Œé€šè¿‡_endç¬¦å·æ¥è·å–dtbåœ°å€\n\ngd->fdt_blob = (ulong *)&_end;\n\n// å¯ä»¥é€šè¿‡fdtcontroladdrç¯å¢ƒå˜é‡æ¥æŒ‡å®šfdtçš„åœ°å€\ngd->fdt_blob = (void *)getenv_ulong(\"fdtcontroladdr\", 16,\n\t\t\t\t\t\t(uintptr_t)gd->fdt_blob); \n```\n\n###  dtbè§£ææ¥å£\n\n- å®šä¹‰åœ¨lib/fdtdec.cæ–‡ä»¶ä¸­ï¼ŒèŠ‚ç‚¹å˜é‡nodeä¸­å­˜æ”¾çš„æ˜¯åç§»åœ°å€\n\n```\n// è·å¾—dtbä¸‹æŸä¸ªèŠ‚ç‚¹çš„è·¯å¾„pathçš„åç§»ï¼Œåç§»å°±ä»£è¡¨è¿™ä¸ªèŠ‚ç‚¹\nint fdt_path_offset(const void *fdt, const char *path)\negï¼šnode = fdt_path_offset(gd->fdt_blob, â€œ/aliasesâ€);\n\n// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªå­—ç¬¦ä¸²å±æ€§å€¼\nconst void *fdt_getprop(const void *fdt, int nodeoffset, const char *name, int *lenp)\negï¼š mac = fdt_getprop(gd->fdt_blob, node, â€œmac-addressâ€, &len);\n\n// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ•´å½¢æ•°ç»„å±æ€§å€¼\nint fdtdec_get_int_array(const void *blob, int node, const char *prop_name, u32 *array, int count)\negï¼š ret = fdtdec_get_int_array(blob, node, â€œinterruptsâ€, cell, ARRAY_SIZE(cell));\n\n// è·å¾—èŠ‚ç‚¹nodeçš„åœ°å€å±æ€§å€¼\nfdt_addr_t fdtdec_get_addr(const void *blob, int node, const char *prop_name)\negï¼šfdtdec_get_addr(blob, node, â€œregâ€);\n\n// è·å¾—configèŠ‚ç‚¹ä¸‹çš„æ•´å½¢å±æ€§ã€boolå±æ€§ã€å­—ç¬¦ä¸²ç­‰ç­‰\nfdtdec_get_config_intã€fdtdec_get_config_boolã€fdtdec_get_config_string\n\n// è·å¾—chosenä¸‹çš„nameèŠ‚ç‚¹çš„åç§»\nint fdtdec_get_chosen_node(const void *blob, const char *name)\n\n// è·å¾—chosenä¸‹nameå±æ€§çš„å€¼\nconst char *fdtdec_get_chosen_prop(const void *blob, const char *name)\n```\n\n- å®šä¹‰åœ¨lib/fdtdec_common.cæ–‡ä»¶ä¸­\n\n```\n// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ•´å½¢å±æ€§å€¼\nint fdtdec_get_int(const void *blob, int node, const char *prop_name, int default_val)\negï¼š bus->udelay = fdtdec_get_int(blob, node, â€œi2c-gpio,delay-usâ€, DEFAULT_UDELAY);\n\n// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ— ç¬¦å·æ•´å½¢å±æ€§å€¼\nfdtdec_get_uint\n```\n\n## fdt å‘½ä»¤\n\nå¯¹äºu-bootæä¾›äº†fdtçš„ç›¸å…³å‘½ä»¤\n\n```\nfdt - flattened device tree utility commands\n\nUsage:\nfdt addr [-c]  <addr> [<length>]   - Set the [control] fdt location to <addr>\nfdt apply <addr>                    - Apply overlay to the DT\nfdt move   <fdt> <newaddr> <length> - Copy the fdt to <addr> and make it active\nfdt resize [<extrasize>]            - Resize fdt to size + padding to 4k addr + some optional <extrasize> if needed\nfdt print  <path> [<prop>]          - Recursive print starting at <path>\nfdt list   <path> [<prop>]          - Print one level starting at <path>\nfdt get value <var> <path> <prop>   - Get <property> and store in <var>\nfdt get name <var> <path> <index>   - Get name of node <index> and store in <var>\nfdt get addr <var> <path> <prop>    - Get start address of <property> and store in <var>\nfdt get size <var> <path> [<prop>]  - Get size of [<property>] or num nodes and store in <var>\nfdt set    <path> <prop> [<val>]    - Set <property> [to <val>]\nfdt mknode <path> <node>            - Create a new node after <path>\nfdt rm     <path> [<prop>]          - Delete the node or <property>\nfdt header                          - Display header info\nfdt bootcpu <id>                    - Set boot cpuid\nfdt memory <addr> <size>            - Add/Update memory node\nfdt rsvmem print                    - Show current mem reserves\nfdt rsvmem add <addr> <size>        - Add a mem reserve\nfdt rsvmem delete <index>           - Delete a mem reserves\nfdt chosen [<start> <end>]          - Add/update the /chosen branch in the tree\n                                        <start>/<end> - initrd start/end addr\nNOTE: Dereference aliases by omitting the leading '/', e.g. fdt print ethernet0.\n```\n\nfdt printåŠ pathå‚æ•°ï¼Œåˆ™æ‰“pathå†…å®¹ï¼Œå¦‚ä¸‹(å…¶ä¸­/memoryæ˜¯path)ï¼š\n\n```c\nU-Boot> fdt print /memory\nmemory {\ndevice_type = \"memory\";\nreg = <0x70000000 0x4000000>;\n};\n\nU-Boot> fdt print #ä¸åŠ å‚æ•°æ—¶ï¼Œæ‰“å°å‡ºæ•´é¢—æ ‘\n```\n\n\n\näºŒã€u-boot è·å–GPTåˆ†åŒºè¡¨\n\nåœ¨ubootä¸­é€šè¿‡å‘½ä»¤æ‰“å°åˆ†åŒºè¡¨\n\n```\npart list mmc 0\n```\n\n3588-android-uboot\n\n```c\n#include <common.h>\n#include <command.h>\n#include <android_image.h>\n#include <mmc.h>\n#include <stdlib.h>\n#include <memalign.h>\n#include <fdtdec.h>\n\n#define PART_MAX_COUNT  128\n#define\tLAB_SIZE\t\t512\n#define\tHEADER_OFFSET\tLAB_SIZE\n#define\tENTRY_OFFSET\t(2 * LAB_SIZE)\n#define\tVAL1_OFFSET\t\tsizeof(u64)\n#define\tVAL2_OFFSET\t\t(2 * sizeof(u64))\n\nstatic u64 get_gpt_blk_cnt_and_print(struct blk_desc *dev_desc,\n\t\t\t  gpt_header *gpt_head, gpt_entry **gpt_pte) {\n\tchar efi_str[PARTNAME_SZ + 1];\n\tu64 gpt_part_size, gpt_blk_cnt = 0;\n\tgpt_entry *gpt_e;\n\tint i;\n\n\tgpt_e = *gpt_pte;\n\tfor (i = 0; i < gpt_head->num_partition_entries; i++) {\n\n\t\traite_gpt_convert_efi_name_to_char(efi_str, gpt_e[i].partition_name,\n\t\t\t\t\t     PARTNAME_SZ + 1);\n\n\t\tprintf(\"%s: part: %2d name - GPT: %16s \",\n\t\t      __func__, i, efi_str);\n\t\tgpt_part_size = le64_to_cpu(gpt_e[i].ending_lba) -\n\t\t\tle64_to_cpu(gpt_e[i].starting_lba) + 1;\n\t\tgpt_blk_cnt += gpt_part_size;\n\t\t\n\t\tif(gpt_part_size == 1) \n\t\t\tbreak;\n\t\t\n\t\tprintf(\"size(LBA) - GPT: %8llu \",\n\t\t      (unsigned long long)gpt_part_size);\n\n\t\tprintf(\"start LBA - GPT: %8llu \\n\",\n\t\t      le64_to_cpu(gpt_e[i].starting_lba));\n\t}\n\n\treturn gpt_blk_cnt + gpt_e[0].starting_lba - 1;\n}\n\nstatic int get_gpt_meta_data(u64 *data_size, void **data)\n{\n    gpt_header *pgpt_head;\n\tgpt_entry *entries;\n\tvoid *meta_data;\n\tu64 meta_data_size, gpt_entries_size;\n\tstruct blk_desc *dev_desc = NULL;\n\tstruct mmc *mmc = NULL;\n\tu64 blk_size = 0;\n\tu64 blk_cnt = 0;\n\tu64 tag = 0x55AA;\n\tlbaint_t lba;\n    \n\tif (!data_size || !data) {\n\t\tprintf(\"%s *** ERROR: Invalid Argument(s) ***\\n\", __func__);\n\t\treturn -1;\n\t}\n    \n    mmc = do_returnmmc();\n\tif (!mmc)\n\t\treturn CMD_RET_FAILURE;\n    \n    dev_desc = mmc_get_blk_desc(mmc);\n\tif (!dev_desc) {\n\t\tprintf(\"%s *** ERROR: mmc_get_blk_desc err ***\\n\", __func__);\n\t\treturn -1;\n\t}\n\n\tgpt_entries_size = sizeof(gpt_entry) * PART_MAX_COUNT;\n\tmeta_data_size = LAB_SIZE + sizeof(gpt_header) + gpt_entries_size;\n\tmeta_data = malloc(meta_data_size);\n\tif(!meta_data) {\n\t\tprintf(\"%s *** ERROR: malloc memory (gpt meta data) ***\\n\", __func__);\n\t\treturn -1;\n\t}\n    \n    memset(meta_data, 0, meta_data_size);\n\tpgpt_head = (gpt_header *)((char *)meta_data + HEADER_OFFSET);\n\tentries = (gpt_entry *)((char *)meta_data + ENTRY_OFFSET);\n\tALLOC_CACHE_ALIGN_BUFFER(legacy_mbr, mbr, dev_desc->blksz);\n\n\t/* Read MBR Header from device */\n\tlba = 0; /* MBR is always at 0 */\n\tblk_cnt = 1; /* MBR (1 block) */\n\tif (blk_dread(dev_desc, lba, blk_cnt, (ulong *)mbr) != 1) {\n\t\tprintf(\"*** ERROR: Can't read MBR header ***\\n\");\n\t\tgoto ERROR_OUT;\n\t}\n\n\t/* Read GPT Header from device */\n\tlba = GPT_PRIMARY_PARTITION_TABLE_LBA;\n\tblk_cnt = 1; /* GPT Header (1 block) */\n\tif (blk_dread(dev_desc, lba, blk_cnt, pgpt_head) != 1) {\n    \tprintf(\"%s *** ERROR: Can't read GPT header ***\\n\", __func__);\n\t\tgoto ERROR_OUT;\n\t}\n\n\tlba = GPT_PRIMARY_PARTITION_TABLE_LBA;\n\tif (validate_gpt_header(pgpt_head, lba, dev_desc->lba)) {\n\t\tprintf(\"%s *** ERROR: validate_gpt_header GPT header ***\\n\", __func__);\n\t\tgoto ERROR_OUT;\n\t}\n\n\tif (dev_desc->sig_type == SIG_TYPE_NONE) {\n\t\tefi_guid_t empty = {};\n\t\tif (memcmp(&pgpt_head->disk_guid, &empty, sizeof(empty))) {\n\t\t\tdev_desc->sig_type = SIG_TYPE_GUID;\n\t\t\tmemcpy(&dev_desc->guid_sig, &pgpt_head->disk_guid,\n\t\t\t      sizeof(empty));\n\t\t} else if (mbr->unique_mbr_signature != 0) {\n\t\t\tdev_desc->sig_type = SIG_TYPE_MBR;\n\t\t\tdev_desc->mbr_sig = mbr->unique_mbr_signature;\n\t\t}\n\t}\n\n\t/* Read GPT Entries from device */\n\tlba = le64_to_cpu(pgpt_head->partition_entry_lba);\n\tblk_cnt = BLOCK_CNT((le32_to_cpu(pgpt_head->num_partition_entries) *\n\t\t\t\t   \tle32_to_cpu(pgpt_head->sizeof_partition_entry)),\n\t\t\t\t  \tdev_desc);\n\tif (blk_dread(dev_desc, lba, blk_cnt, entries) != blk_cnt) {\n\t\tprintf(\"%s *** ERROR:read entries (lba=%llu) ***\\n\",\n\t\t\t\t__func__, pgpt_head->partition_entry_lba);\n\t\tgoto ERROR_OUT;\n\t}\n\t\n\tblk_size = dev_desc->blksz;\n\tvalidate_gpt_entries(pgpt_head, entries);\n\t\n\tdebug(\"%s read entries lba %llu (blk_cnt %llu blk_size=%llu)\\n\",\n\t\t\t\t__func__, (unsigned long long)(ulong)lba, blk_cnt, blk_size);\n\t\n\tblk_cnt = get_gpt_blk_cnt(dev_desc, pgpt_head, &entries);\n    \n    /* \n\t * build info, layout of meta_data:\n\t * u64 tag | u64 blk_size | u64 blk_cnt | 488 bytes | gpt header | gpt entries\n\t */\n\tblk_cnt = get_gpt_blk_cnt(dev_desc, pgpt_head, &entries);\n\t/*this value makes we known the reserved memory is available*/\n\tmemcpy(meta_data, (void *)&tag, sizeof(u64));\n\tmemcpy(meta_data + VAL1_OFFSET, (void *)&blk_size, sizeof(u64));\n\tmemcpy(meta_data + VAL2_OFFSET, (void *)&blk_cnt, sizeof(u64));\n\n\t*data_size = meta_data_size;\n\t*data = meta_data;\n\n\treturn 0;\n\nERROR_OUT:\n\tfree(meta_data);\n\tmeta_data = NULL;\n\treturn -1;\n}\n```\n\n\n\nå‚è€ƒï¼š\n\n[Device Treeï¼ˆå››ï¼‰ï¼šæ–‡ä»¶ç»“æ„è§£æ (wowotech.net)](http://www.wowotech.net/device_model/dt-code-file-struct-parse.html)\n\n[Linuxè®¾å¤‡æ ‘è¯­æ³•åˆ†æè¯¦è§£æ•™ç¨‹(ä¸‰)u-bootè®¾å¤‡æ ‘çš„ä¼ é€’ - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/376295326)\n\n[Linuxè®¾å¤‡æ ‘è¯­æ³•åˆ†æè¯¦è§£æ•™ç¨‹(å››)kernelçš„è§£æ - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/376296222)\n\nhttps://www.cnblogs.com/solo666/p/16518154.html","source":"back_posts/ubootä¹‹fdt.md","raw":"> \n\nU-Bootå®˜ç½‘:`https://docs.u-boot.org/en/latest/`\n\nu-bootå¯åŠ¨æµç¨‹\n\n- æ¿å­ä¸Šç”µä»¥åï¼Œé¦–å…ˆæ‰§è¡Œçš„æ˜¯ROMä¸­çš„ä¸€æ®µå¯åŠ¨ä»£ç ã€‚å¯åŠ¨ä»£ç **æ ¹æ®å¯„å­˜å™¨/å¤–éƒ¨ç®¡è„šé…ç½®**ï¼Œç¡®å®šæ˜¯è¿›å…¥ä¸‹è½½æ¨¡å¼ï¼Œè¿˜æ˜¯ä»æŸä»‹è´¨(Flash/EMMC/SDå¡ç­‰å­˜å‚¨è®¾å¤‡)å¯åŠ¨u-boot\n\n> ROMä¸­çš„ä»£ç æ˜¯å›ºåŒ–çš„ï¼Œæ— æ³•ä¿®æ”¹\n\n# ä¸€ã€ä»‹ç»\n\n> FDTï¼Œflatted device treeï¼Œæ‰å¹³è®¾å¤‡æ ‘ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯å°†éƒ¨åˆ†è®¾å¤‡ä¿¡æ¯ç»“æ„å­˜æ”¾åˆ°device treeæ–‡ä»¶ä¸­ã€‚\n>\n> ubootæœ€ç»ˆå°†å…¶ç¼–è¯‘æˆdtbæ–‡ä»¶ï¼Œä½¿ç”¨è¿‡ç¨‹ä¸­é€šè¿‡è§£æè¯¥dtbæ¥è·å–æ¿çº§è®¾å¤‡ä¿¡æ¯ã€‚  \n\n> U-bootçš„dtbå’Œkernelä¸­çš„dtbæ˜¯ä¸€è‡´çš„ï¼Œæœ‰å…³fdtçš„è¯¦ç»†ä»‹ç»ï¼Œå‚è€ƒdoc/README.fdt-control\n\n### dtbåœ¨U-bootä¸­çš„ä½ç½®\n\n- dtbèƒ½å¤Ÿä»¥ä¸¤ç§å½¢å¼ç¼–è¯‘åˆ°U-bootçš„é•œåƒä¸­\n\n1. dtbå’Œu-bootçš„binæ–‡ä»¶åˆ†ç¦»(imx6qä¸­ä½¿ç”¨çš„è¿™ç§æ–¹å¼ï¼Œåœ¨.configæ–‡ä»¶ä¸­å¯ä»¥æŸ¥çœ‹åˆ°)\n\n> é€šè¿‡CONFIG_OF_SEPARATEå®å®šä¹‰ä½¿èƒ½ï¼Œdtbæœ€åä¼šè¿½åŠ åˆ°u-bootçš„binæ–‡ä»¶çš„æœ€åé¢ï¼Œé€šè¿‡u-bootçš„ç»“æŸåœ°å€ç¬¦å·_endç¬¦å·æ¥è·å–dtbçš„åœ°å€\n\n1. dtbé›†æˆåˆ°u-bootçš„binæ–‡ä»¶å†…éƒ¨\n\n> é€šè¿‡CONFIG_OF_EMBEDå®å®šä¹‰ä½¿èƒ½ï¼Œdtbä¼šä½äºu-bootçš„.dtb.init.rodataæ®µä¸­ï¼Œé€šè¿‡__dtb_dt_beginç¬¦å·æ¥è·å–dtb\n\n1. è·å–dtsæ–‡ä»¶çš„åœ°å€gd->fdt_blob\n\n```\n// å®ç”¨æ¥è¡¨ç¤ºæ˜¯å¦æŠŠdtbæ–‡ä»¶æ”¾åœ¨uboot.binçš„æ–‡ä»¶ä¸­\nCONFIG_OF_EMBED\n\n// å•ç‹¬ç¼–è¯‘dtbæ–‡ä»¶\nCONFIG_OF_SEPARATEï¼Œç¼–è¯‘å‡ºæ¥çš„dtbæ”¾åœ¨uboot.binçš„æœ€åé¢ï¼Œå°±æ˜¯dtbè¿½åŠ åˆ°ubootçš„binæ–‡ä»¶åé¢æ—¶ï¼Œé€šè¿‡_endç¬¦å·æ¥è·å–dtbåœ°å€\n\ngd->fdt_blob = (ulong *)&_end;\n\n// å¯ä»¥é€šè¿‡fdtcontroladdrç¯å¢ƒå˜é‡æ¥æŒ‡å®šfdtçš„åœ°å€\ngd->fdt_blob = (void *)getenv_ulong(\"fdtcontroladdr\", 16,\n\t\t\t\t\t\t(uintptr_t)gd->fdt_blob); \n```\n\n###  dtbè§£ææ¥å£\n\n- å®šä¹‰åœ¨lib/fdtdec.cæ–‡ä»¶ä¸­ï¼ŒèŠ‚ç‚¹å˜é‡nodeä¸­å­˜æ”¾çš„æ˜¯åç§»åœ°å€\n\n```\n// è·å¾—dtbä¸‹æŸä¸ªèŠ‚ç‚¹çš„è·¯å¾„pathçš„åç§»ï¼Œåç§»å°±ä»£è¡¨è¿™ä¸ªèŠ‚ç‚¹\nint fdt_path_offset(const void *fdt, const char *path)\negï¼šnode = fdt_path_offset(gd->fdt_blob, â€œ/aliasesâ€);\n\n// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªå­—ç¬¦ä¸²å±æ€§å€¼\nconst void *fdt_getprop(const void *fdt, int nodeoffset, const char *name, int *lenp)\negï¼š mac = fdt_getprop(gd->fdt_blob, node, â€œmac-addressâ€, &len);\n\n// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ•´å½¢æ•°ç»„å±æ€§å€¼\nint fdtdec_get_int_array(const void *blob, int node, const char *prop_name, u32 *array, int count)\negï¼š ret = fdtdec_get_int_array(blob, node, â€œinterruptsâ€, cell, ARRAY_SIZE(cell));\n\n// è·å¾—èŠ‚ç‚¹nodeçš„åœ°å€å±æ€§å€¼\nfdt_addr_t fdtdec_get_addr(const void *blob, int node, const char *prop_name)\negï¼šfdtdec_get_addr(blob, node, â€œregâ€);\n\n// è·å¾—configèŠ‚ç‚¹ä¸‹çš„æ•´å½¢å±æ€§ã€boolå±æ€§ã€å­—ç¬¦ä¸²ç­‰ç­‰\nfdtdec_get_config_intã€fdtdec_get_config_boolã€fdtdec_get_config_string\n\n// è·å¾—chosenä¸‹çš„nameèŠ‚ç‚¹çš„åç§»\nint fdtdec_get_chosen_node(const void *blob, const char *name)\n\n// è·å¾—chosenä¸‹nameå±æ€§çš„å€¼\nconst char *fdtdec_get_chosen_prop(const void *blob, const char *name)\n```\n\n- å®šä¹‰åœ¨lib/fdtdec_common.cæ–‡ä»¶ä¸­\n\n```\n// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ•´å½¢å±æ€§å€¼\nint fdtdec_get_int(const void *blob, int node, const char *prop_name, int default_val)\negï¼š bus->udelay = fdtdec_get_int(blob, node, â€œi2c-gpio,delay-usâ€, DEFAULT_UDELAY);\n\n// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ— ç¬¦å·æ•´å½¢å±æ€§å€¼\nfdtdec_get_uint\n```\n\n## fdt å‘½ä»¤\n\nå¯¹äºu-bootæä¾›äº†fdtçš„ç›¸å…³å‘½ä»¤\n\n```\nfdt - flattened device tree utility commands\n\nUsage:\nfdt addr [-c]  <addr> [<length>]   - Set the [control] fdt location to <addr>\nfdt apply <addr>                    - Apply overlay to the DT\nfdt move   <fdt> <newaddr> <length> - Copy the fdt to <addr> and make it active\nfdt resize [<extrasize>]            - Resize fdt to size + padding to 4k addr + some optional <extrasize> if needed\nfdt print  <path> [<prop>]          - Recursive print starting at <path>\nfdt list   <path> [<prop>]          - Print one level starting at <path>\nfdt get value <var> <path> <prop>   - Get <property> and store in <var>\nfdt get name <var> <path> <index>   - Get name of node <index> and store in <var>\nfdt get addr <var> <path> <prop>    - Get start address of <property> and store in <var>\nfdt get size <var> <path> [<prop>]  - Get size of [<property>] or num nodes and store in <var>\nfdt set    <path> <prop> [<val>]    - Set <property> [to <val>]\nfdt mknode <path> <node>            - Create a new node after <path>\nfdt rm     <path> [<prop>]          - Delete the node or <property>\nfdt header                          - Display header info\nfdt bootcpu <id>                    - Set boot cpuid\nfdt memory <addr> <size>            - Add/Update memory node\nfdt rsvmem print                    - Show current mem reserves\nfdt rsvmem add <addr> <size>        - Add a mem reserve\nfdt rsvmem delete <index>           - Delete a mem reserves\nfdt chosen [<start> <end>]          - Add/update the /chosen branch in the tree\n                                        <start>/<end> - initrd start/end addr\nNOTE: Dereference aliases by omitting the leading '/', e.g. fdt print ethernet0.\n```\n\nfdt printåŠ pathå‚æ•°ï¼Œåˆ™æ‰“pathå†…å®¹ï¼Œå¦‚ä¸‹(å…¶ä¸­/memoryæ˜¯path)ï¼š\n\n```c\nU-Boot> fdt print /memory\nmemory {\ndevice_type = \"memory\";\nreg = <0x70000000 0x4000000>;\n};\n\nU-Boot> fdt print #ä¸åŠ å‚æ•°æ—¶ï¼Œæ‰“å°å‡ºæ•´é¢—æ ‘\n```\n\n\n\näºŒã€u-boot è·å–GPTåˆ†åŒºè¡¨\n\nåœ¨ubootä¸­é€šè¿‡å‘½ä»¤æ‰“å°åˆ†åŒºè¡¨\n\n```\npart list mmc 0\n```\n\n3588-android-uboot\n\n```c\n#include <common.h>\n#include <command.h>\n#include <android_image.h>\n#include <mmc.h>\n#include <stdlib.h>\n#include <memalign.h>\n#include <fdtdec.h>\n\n#define PART_MAX_COUNT  128\n#define\tLAB_SIZE\t\t512\n#define\tHEADER_OFFSET\tLAB_SIZE\n#define\tENTRY_OFFSET\t(2 * LAB_SIZE)\n#define\tVAL1_OFFSET\t\tsizeof(u64)\n#define\tVAL2_OFFSET\t\t(2 * sizeof(u64))\n\nstatic u64 get_gpt_blk_cnt_and_print(struct blk_desc *dev_desc,\n\t\t\t  gpt_header *gpt_head, gpt_entry **gpt_pte) {\n\tchar efi_str[PARTNAME_SZ + 1];\n\tu64 gpt_part_size, gpt_blk_cnt = 0;\n\tgpt_entry *gpt_e;\n\tint i;\n\n\tgpt_e = *gpt_pte;\n\tfor (i = 0; i < gpt_head->num_partition_entries; i++) {\n\n\t\traite_gpt_convert_efi_name_to_char(efi_str, gpt_e[i].partition_name,\n\t\t\t\t\t     PARTNAME_SZ + 1);\n\n\t\tprintf(\"%s: part: %2d name - GPT: %16s \",\n\t\t      __func__, i, efi_str);\n\t\tgpt_part_size = le64_to_cpu(gpt_e[i].ending_lba) -\n\t\t\tle64_to_cpu(gpt_e[i].starting_lba) + 1;\n\t\tgpt_blk_cnt += gpt_part_size;\n\t\t\n\t\tif(gpt_part_size == 1) \n\t\t\tbreak;\n\t\t\n\t\tprintf(\"size(LBA) - GPT: %8llu \",\n\t\t      (unsigned long long)gpt_part_size);\n\n\t\tprintf(\"start LBA - GPT: %8llu \\n\",\n\t\t      le64_to_cpu(gpt_e[i].starting_lba));\n\t}\n\n\treturn gpt_blk_cnt + gpt_e[0].starting_lba - 1;\n}\n\nstatic int get_gpt_meta_data(u64 *data_size, void **data)\n{\n    gpt_header *pgpt_head;\n\tgpt_entry *entries;\n\tvoid *meta_data;\n\tu64 meta_data_size, gpt_entries_size;\n\tstruct blk_desc *dev_desc = NULL;\n\tstruct mmc *mmc = NULL;\n\tu64 blk_size = 0;\n\tu64 blk_cnt = 0;\n\tu64 tag = 0x55AA;\n\tlbaint_t lba;\n    \n\tif (!data_size || !data) {\n\t\tprintf(\"%s *** ERROR: Invalid Argument(s) ***\\n\", __func__);\n\t\treturn -1;\n\t}\n    \n    mmc = do_returnmmc();\n\tif (!mmc)\n\t\treturn CMD_RET_FAILURE;\n    \n    dev_desc = mmc_get_blk_desc(mmc);\n\tif (!dev_desc) {\n\t\tprintf(\"%s *** ERROR: mmc_get_blk_desc err ***\\n\", __func__);\n\t\treturn -1;\n\t}\n\n\tgpt_entries_size = sizeof(gpt_entry) * PART_MAX_COUNT;\n\tmeta_data_size = LAB_SIZE + sizeof(gpt_header) + gpt_entries_size;\n\tmeta_data = malloc(meta_data_size);\n\tif(!meta_data) {\n\t\tprintf(\"%s *** ERROR: malloc memory (gpt meta data) ***\\n\", __func__);\n\t\treturn -1;\n\t}\n    \n    memset(meta_data, 0, meta_data_size);\n\tpgpt_head = (gpt_header *)((char *)meta_data + HEADER_OFFSET);\n\tentries = (gpt_entry *)((char *)meta_data + ENTRY_OFFSET);\n\tALLOC_CACHE_ALIGN_BUFFER(legacy_mbr, mbr, dev_desc->blksz);\n\n\t/* Read MBR Header from device */\n\tlba = 0; /* MBR is always at 0 */\n\tblk_cnt = 1; /* MBR (1 block) */\n\tif (blk_dread(dev_desc, lba, blk_cnt, (ulong *)mbr) != 1) {\n\t\tprintf(\"*** ERROR: Can't read MBR header ***\\n\");\n\t\tgoto ERROR_OUT;\n\t}\n\n\t/* Read GPT Header from device */\n\tlba = GPT_PRIMARY_PARTITION_TABLE_LBA;\n\tblk_cnt = 1; /* GPT Header (1 block) */\n\tif (blk_dread(dev_desc, lba, blk_cnt, pgpt_head) != 1) {\n    \tprintf(\"%s *** ERROR: Can't read GPT header ***\\n\", __func__);\n\t\tgoto ERROR_OUT;\n\t}\n\n\tlba = GPT_PRIMARY_PARTITION_TABLE_LBA;\n\tif (validate_gpt_header(pgpt_head, lba, dev_desc->lba)) {\n\t\tprintf(\"%s *** ERROR: validate_gpt_header GPT header ***\\n\", __func__);\n\t\tgoto ERROR_OUT;\n\t}\n\n\tif (dev_desc->sig_type == SIG_TYPE_NONE) {\n\t\tefi_guid_t empty = {};\n\t\tif (memcmp(&pgpt_head->disk_guid, &empty, sizeof(empty))) {\n\t\t\tdev_desc->sig_type = SIG_TYPE_GUID;\n\t\t\tmemcpy(&dev_desc->guid_sig, &pgpt_head->disk_guid,\n\t\t\t      sizeof(empty));\n\t\t} else if (mbr->unique_mbr_signature != 0) {\n\t\t\tdev_desc->sig_type = SIG_TYPE_MBR;\n\t\t\tdev_desc->mbr_sig = mbr->unique_mbr_signature;\n\t\t}\n\t}\n\n\t/* Read GPT Entries from device */\n\tlba = le64_to_cpu(pgpt_head->partition_entry_lba);\n\tblk_cnt = BLOCK_CNT((le32_to_cpu(pgpt_head->num_partition_entries) *\n\t\t\t\t   \tle32_to_cpu(pgpt_head->sizeof_partition_entry)),\n\t\t\t\t  \tdev_desc);\n\tif (blk_dread(dev_desc, lba, blk_cnt, entries) != blk_cnt) {\n\t\tprintf(\"%s *** ERROR:read entries (lba=%llu) ***\\n\",\n\t\t\t\t__func__, pgpt_head->partition_entry_lba);\n\t\tgoto ERROR_OUT;\n\t}\n\t\n\tblk_size = dev_desc->blksz;\n\tvalidate_gpt_entries(pgpt_head, entries);\n\t\n\tdebug(\"%s read entries lba %llu (blk_cnt %llu blk_size=%llu)\\n\",\n\t\t\t\t__func__, (unsigned long long)(ulong)lba, blk_cnt, blk_size);\n\t\n\tblk_cnt = get_gpt_blk_cnt(dev_desc, pgpt_head, &entries);\n    \n    /* \n\t * build info, layout of meta_data:\n\t * u64 tag | u64 blk_size | u64 blk_cnt | 488 bytes | gpt header | gpt entries\n\t */\n\tblk_cnt = get_gpt_blk_cnt(dev_desc, pgpt_head, &entries);\n\t/*this value makes we known the reserved memory is available*/\n\tmemcpy(meta_data, (void *)&tag, sizeof(u64));\n\tmemcpy(meta_data + VAL1_OFFSET, (void *)&blk_size, sizeof(u64));\n\tmemcpy(meta_data + VAL2_OFFSET, (void *)&blk_cnt, sizeof(u64));\n\n\t*data_size = meta_data_size;\n\t*data = meta_data;\n\n\treturn 0;\n\nERROR_OUT:\n\tfree(meta_data);\n\tmeta_data = NULL;\n\treturn -1;\n}\n```\n\n\n\nå‚è€ƒï¼š\n\n[Device Treeï¼ˆå››ï¼‰ï¼šæ–‡ä»¶ç»“æ„è§£æ (wowotech.net)](http://www.wowotech.net/device_model/dt-code-file-struct-parse.html)\n\n[Linuxè®¾å¤‡æ ‘è¯­æ³•åˆ†æè¯¦è§£æ•™ç¨‹(ä¸‰)u-bootè®¾å¤‡æ ‘çš„ä¼ é€’ - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/376295326)\n\n[Linuxè®¾å¤‡æ ‘è¯­æ³•åˆ†æè¯¦è§£æ•™ç¨‹(å››)kernelçš„è§£æ - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/376296222)\n\nhttps://www.cnblogs.com/solo666/p/16518154.html","date":"2024-05-15T06:11:08.992Z","updated":"2024-05-15T06:11:08.992Z","path":"back_posts/ubootä¹‹fdt.html","title":"","comments":1,"layout":"page","_id":"clw7fflkt000ax2w03qcob16u","content":"<blockquote>\n</blockquote>\n<p>U-Bootå®˜ç½‘:<code>https://docs.u-boot.org/en/latest/</code></p>\n<p>u-bootå¯åŠ¨æµç¨‹</p>\n<ul>\n<li>æ¿å­ä¸Šç”µä»¥åï¼Œé¦–å…ˆæ‰§è¡Œçš„æ˜¯ROMä¸­çš„ä¸€æ®µå¯åŠ¨ä»£ç ã€‚å¯åŠ¨ä»£ç <strong>æ ¹æ®å¯„å­˜å™¨&#x2F;å¤–éƒ¨ç®¡è„šé…ç½®</strong>ï¼Œç¡®å®šæ˜¯è¿›å…¥ä¸‹è½½æ¨¡å¼ï¼Œè¿˜æ˜¯ä»æŸä»‹è´¨(Flash&#x2F;EMMC&#x2F;SDå¡ç­‰å­˜å‚¨è®¾å¤‡)å¯åŠ¨u-boot</li>\n</ul>\n<blockquote>\n<p>ROMä¸­çš„ä»£ç æ˜¯å›ºåŒ–çš„ï¼Œæ— æ³•ä¿®æ”¹</p>\n</blockquote>\n<h1 id=\"ä¸€ã€ä»‹ç»\"><a href=\"#ä¸€ã€ä»‹ç»\" class=\"headerlink\" title=\"ä¸€ã€ä»‹ç»\"></a>ä¸€ã€ä»‹ç»</h1><blockquote>\n<p>FDTï¼Œflatted device treeï¼Œæ‰å¹³è®¾å¤‡æ ‘ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯å°†éƒ¨åˆ†è®¾å¤‡ä¿¡æ¯ç»“æ„å­˜æ”¾åˆ°device treeæ–‡ä»¶ä¸­ã€‚</p>\n<p>ubootæœ€ç»ˆå°†å…¶ç¼–è¯‘æˆdtbæ–‡ä»¶ï¼Œä½¿ç”¨è¿‡ç¨‹ä¸­é€šè¿‡è§£æè¯¥dtbæ¥è·å–æ¿çº§è®¾å¤‡ä¿¡æ¯ã€‚  </p>\n</blockquote>\n<blockquote>\n<p>U-bootçš„dtbå’Œkernelä¸­çš„dtbæ˜¯ä¸€è‡´çš„ï¼Œæœ‰å…³fdtçš„è¯¦ç»†ä»‹ç»ï¼Œå‚è€ƒdoc&#x2F;README.fdt-control</p>\n</blockquote>\n<h3 id=\"dtbåœ¨U-bootä¸­çš„ä½ç½®\"><a href=\"#dtbåœ¨U-bootä¸­çš„ä½ç½®\" class=\"headerlink\" title=\"dtbåœ¨U-bootä¸­çš„ä½ç½®\"></a>dtbåœ¨U-bootä¸­çš„ä½ç½®</h3><ul>\n<li>dtbèƒ½å¤Ÿä»¥ä¸¤ç§å½¢å¼ç¼–è¯‘åˆ°U-bootçš„é•œåƒä¸­</li>\n</ul>\n<ol>\n<li>dtbå’Œu-bootçš„binæ–‡ä»¶åˆ†ç¦»(imx6qä¸­ä½¿ç”¨çš„è¿™ç§æ–¹å¼ï¼Œåœ¨.configæ–‡ä»¶ä¸­å¯ä»¥æŸ¥çœ‹åˆ°)</li>\n</ol>\n<blockquote>\n<p>é€šè¿‡CONFIG_OF_SEPARATEå®å®šä¹‰ä½¿èƒ½ï¼Œdtbæœ€åä¼šè¿½åŠ åˆ°u-bootçš„binæ–‡ä»¶çš„æœ€åé¢ï¼Œé€šè¿‡u-bootçš„ç»“æŸåœ°å€ç¬¦å·_endç¬¦å·æ¥è·å–dtbçš„åœ°å€</p>\n</blockquote>\n<ol>\n<li>dtbé›†æˆåˆ°u-bootçš„binæ–‡ä»¶å†…éƒ¨</li>\n</ol>\n<blockquote>\n<p>é€šè¿‡CONFIG_OF_EMBEDå®å®šä¹‰ä½¿èƒ½ï¼Œdtbä¼šä½äºu-bootçš„.dtb.init.rodataæ®µä¸­ï¼Œé€šè¿‡__dtb_dt_beginç¬¦å·æ¥è·å–dtb</p>\n</blockquote>\n<ol>\n<li>è·å–dtsæ–‡ä»¶çš„åœ°å€gd-&gt;fdt_blob</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// å®ç”¨æ¥è¡¨ç¤ºæ˜¯å¦æŠŠdtbæ–‡ä»¶æ”¾åœ¨uboot.binçš„æ–‡ä»¶ä¸­</span><br><span class=\"line\">CONFIG_OF_EMBED</span><br><span class=\"line\"></span><br><span class=\"line\">// å•ç‹¬ç¼–è¯‘dtbæ–‡ä»¶</span><br><span class=\"line\">CONFIG_OF_SEPARATEï¼Œç¼–è¯‘å‡ºæ¥çš„dtbæ”¾åœ¨uboot.binçš„æœ€åé¢ï¼Œå°±æ˜¯dtbè¿½åŠ åˆ°ubootçš„binæ–‡ä»¶åé¢æ—¶ï¼Œé€šè¿‡_endç¬¦å·æ¥è·å–dtbåœ°å€</span><br><span class=\"line\"></span><br><span class=\"line\">gd-&gt;fdt_blob = (ulong *)&amp;_end;</span><br><span class=\"line\"></span><br><span class=\"line\">// å¯ä»¥é€šè¿‡fdtcontroladdrç¯å¢ƒå˜é‡æ¥æŒ‡å®šfdtçš„åœ°å€</span><br><span class=\"line\">gd-&gt;fdt_blob = (void *)getenv_ulong(&quot;fdtcontroladdr&quot;, 16,</span><br><span class=\"line\">\t\t\t\t\t\t(uintptr_t)gd-&gt;fdt_blob); </span><br></pre></td></tr></table></figure>\n\n<h3 id=\"dtbè§£ææ¥å£\"><a href=\"#dtbè§£ææ¥å£\" class=\"headerlink\" title=\"dtbè§£ææ¥å£\"></a>dtbè§£ææ¥å£</h3><ul>\n<li>å®šä¹‰åœ¨lib&#x2F;fdtdec.cæ–‡ä»¶ä¸­ï¼ŒèŠ‚ç‚¹å˜é‡nodeä¸­å­˜æ”¾çš„æ˜¯åç§»åœ°å€</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// è·å¾—dtbä¸‹æŸä¸ªèŠ‚ç‚¹çš„è·¯å¾„pathçš„åç§»ï¼Œåç§»å°±ä»£è¡¨è¿™ä¸ªèŠ‚ç‚¹</span><br><span class=\"line\">int fdt_path_offset(const void *fdt, const char *path)</span><br><span class=\"line\">egï¼šnode = fdt_path_offset(gd-&gt;fdt_blob, â€œ/aliasesâ€);</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªå­—ç¬¦ä¸²å±æ€§å€¼</span><br><span class=\"line\">const void *fdt_getprop(const void *fdt, int nodeoffset, const char *name, int *lenp)</span><br><span class=\"line\">egï¼š mac = fdt_getprop(gd-&gt;fdt_blob, node, â€œmac-addressâ€, &amp;len);</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ•´å½¢æ•°ç»„å±æ€§å€¼</span><br><span class=\"line\">int fdtdec_get_int_array(const void *blob, int node, const char *prop_name, u32 *array, int count)</span><br><span class=\"line\">egï¼š ret = fdtdec_get_int_array(blob, node, â€œinterruptsâ€, cell, ARRAY_SIZE(cell));</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—èŠ‚ç‚¹nodeçš„åœ°å€å±æ€§å€¼</span><br><span class=\"line\">fdt_addr_t fdtdec_get_addr(const void *blob, int node, const char *prop_name)</span><br><span class=\"line\">egï¼šfdtdec_get_addr(blob, node, â€œregâ€);</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—configèŠ‚ç‚¹ä¸‹çš„æ•´å½¢å±æ€§ã€boolå±æ€§ã€å­—ç¬¦ä¸²ç­‰ç­‰</span><br><span class=\"line\">fdtdec_get_config_intã€fdtdec_get_config_boolã€fdtdec_get_config_string</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—chosenä¸‹çš„nameèŠ‚ç‚¹çš„åç§»</span><br><span class=\"line\">int fdtdec_get_chosen_node(const void *blob, const char *name)</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—chosenä¸‹nameå±æ€§çš„å€¼</span><br><span class=\"line\">const char *fdtdec_get_chosen_prop(const void *blob, const char *name)</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>å®šä¹‰åœ¨lib&#x2F;fdtdec_common.cæ–‡ä»¶ä¸­</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ•´å½¢å±æ€§å€¼</span><br><span class=\"line\">int fdtdec_get_int(const void *blob, int node, const char *prop_name, int default_val)</span><br><span class=\"line\">egï¼š bus-&gt;udelay = fdtdec_get_int(blob, node, â€œi2c-gpio,delay-usâ€, DEFAULT_UDELAY);</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ— ç¬¦å·æ•´å½¢å±æ€§å€¼</span><br><span class=\"line\">fdtdec_get_uint</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"fdt-å‘½ä»¤\"><a href=\"#fdt-å‘½ä»¤\" class=\"headerlink\" title=\"fdt å‘½ä»¤\"></a>fdt å‘½ä»¤</h2><p>å¯¹äºu-bootæä¾›äº†fdtçš„ç›¸å…³å‘½ä»¤</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fdt - flattened device tree utility commands</span><br><span class=\"line\"></span><br><span class=\"line\">Usage:</span><br><span class=\"line\">fdt addr [-c]  &lt;addr&gt; [&lt;length&gt;]   - Set the [control] fdt location to &lt;addr&gt;</span><br><span class=\"line\">fdt apply &lt;addr&gt;                    - Apply overlay to the DT</span><br><span class=\"line\">fdt move   &lt;fdt&gt; &lt;newaddr&gt; &lt;length&gt; - Copy the fdt to &lt;addr&gt; and make it active</span><br><span class=\"line\">fdt resize [&lt;extrasize&gt;]            - Resize fdt to size + padding to 4k addr + some optional &lt;extrasize&gt; if needed</span><br><span class=\"line\">fdt print  &lt;path&gt; [&lt;prop&gt;]          - Recursive print starting at &lt;path&gt;</span><br><span class=\"line\">fdt list   &lt;path&gt; [&lt;prop&gt;]          - Print one level starting at &lt;path&gt;</span><br><span class=\"line\">fdt get value &lt;var&gt; &lt;path&gt; &lt;prop&gt;   - Get &lt;property&gt; and store in &lt;var&gt;</span><br><span class=\"line\">fdt get name &lt;var&gt; &lt;path&gt; &lt;index&gt;   - Get name of node &lt;index&gt; and store in &lt;var&gt;</span><br><span class=\"line\">fdt get addr &lt;var&gt; &lt;path&gt; &lt;prop&gt;    - Get start address of &lt;property&gt; and store in &lt;var&gt;</span><br><span class=\"line\">fdt get size &lt;var&gt; &lt;path&gt; [&lt;prop&gt;]  - Get size of [&lt;property&gt;] or num nodes and store in &lt;var&gt;</span><br><span class=\"line\">fdt set    &lt;path&gt; &lt;prop&gt; [&lt;val&gt;]    - Set &lt;property&gt; [to &lt;val&gt;]</span><br><span class=\"line\">fdt mknode &lt;path&gt; &lt;node&gt;            - Create a new node after &lt;path&gt;</span><br><span class=\"line\">fdt rm     &lt;path&gt; [&lt;prop&gt;]          - Delete the node or &lt;property&gt;</span><br><span class=\"line\">fdt header                          - Display header info</span><br><span class=\"line\">fdt bootcpu &lt;id&gt;                    - Set boot cpuid</span><br><span class=\"line\">fdt memory &lt;addr&gt; &lt;size&gt;            - Add/Update memory node</span><br><span class=\"line\">fdt rsvmem print                    - Show current mem reserves</span><br><span class=\"line\">fdt rsvmem add &lt;addr&gt; &lt;size&gt;        - Add a mem reserve</span><br><span class=\"line\">fdt rsvmem delete &lt;index&gt;           - Delete a mem reserves</span><br><span class=\"line\">fdt chosen [&lt;start&gt; &lt;end&gt;]          - Add/update the /chosen branch in the tree</span><br><span class=\"line\">                                        &lt;start&gt;/&lt;end&gt; - initrd start/end addr</span><br><span class=\"line\">NOTE: Dereference aliases by omitting the leading &#x27;/&#x27;, e.g. fdt print ethernet0.</span><br></pre></td></tr></table></figure>\n\n<p>fdt printåŠ pathå‚æ•°ï¼Œåˆ™æ‰“pathå†…å®¹ï¼Œå¦‚ä¸‹(å…¶ä¸­&#x2F;memoryæ˜¯path)ï¼š</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">U-Boot&gt; fdt print /memory</span><br><span class=\"line\">memory &#123;</span><br><span class=\"line\">device_type = <span class=\"string\">&quot;memory&quot;</span>;</span><br><span class=\"line\">reg = &lt;<span class=\"number\">0x70000000</span> <span class=\"number\">0x4000000</span>&gt;;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">U-Boot&gt; fdt print #ä¸åŠ å‚æ•°æ—¶ï¼Œæ‰“å°å‡ºæ•´é¢—æ ‘</span><br></pre></td></tr></table></figure>\n\n\n\n<p>äºŒã€u-boot è·å–GPTåˆ†åŒºè¡¨</p>\n<p>åœ¨ubootä¸­é€šè¿‡å‘½ä»¤æ‰“å°åˆ†åŒºè¡¨</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">part list mmc 0</span><br></pre></td></tr></table></figure>\n\n<p>3588-android-uboot</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;common.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;command.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;android_image.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;mmc.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;memalign.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;fdtdec.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> PART_MAX_COUNT  128</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span>\tLAB_SIZE\t\t512</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span>\tHEADER_OFFSET\tLAB_SIZE</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span>\tENTRY_OFFSET\t(2 * LAB_SIZE)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span>\tVAL1_OFFSET\t\tsizeof(u64)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span>\tVAL2_OFFSET\t\t(2 * sizeof(u64))</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">static</span> u64 <span class=\"title function_\">get_gpt_blk_cnt_and_print</span><span class=\"params\">(<span class=\"keyword\">struct</span> blk_desc *dev_desc,</span></span><br><span class=\"line\"><span class=\"params\">\t\t\t  gpt_header *gpt_head, gpt_entry **gpt_pte)</span> &#123;</span><br><span class=\"line\">\t<span class=\"type\">char</span> efi_str[PARTNAME_SZ + <span class=\"number\">1</span>];</span><br><span class=\"line\">\tu64 gpt_part_size, gpt_blk_cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\">\tgpt_entry *gpt_e;</span><br><span class=\"line\">\t<span class=\"type\">int</span> i;</span><br><span class=\"line\"></span><br><span class=\"line\">\tgpt_e = *gpt_pte;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (i = <span class=\"number\">0</span>; i &lt; gpt_head-&gt;num_partition_entries; i++) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\traite_gpt_convert_efi_name_to_char(efi_str, gpt_e[i].partition_name,</span><br><span class=\"line\">\t\t\t\t\t     PARTNAME_SZ + <span class=\"number\">1</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s: part: %2d name - GPT: %16s &quot;</span>,</span><br><span class=\"line\">\t\t      __func__, i, efi_str);</span><br><span class=\"line\">\t\tgpt_part_size = le64_to_cpu(gpt_e[i].ending_lba) -</span><br><span class=\"line\">\t\t\tle64_to_cpu(gpt_e[i].starting_lba) + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\tgpt_blk_cnt += gpt_part_size;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(gpt_part_size == <span class=\"number\">1</span>) </span><br><span class=\"line\">\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;size(LBA) - GPT: %8llu &quot;</span>,</span><br><span class=\"line\">\t\t      (<span class=\"type\">unsigned</span> <span class=\"type\">long</span> <span class=\"type\">long</span>)gpt_part_size);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;start LBA - GPT: %8llu \\n&quot;</span>,</span><br><span class=\"line\">\t\t      le64_to_cpu(gpt_e[i].starting_lba));</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> gpt_blk_cnt + gpt_e[<span class=\"number\">0</span>].starting_lba - <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">static</span> <span class=\"type\">int</span> <span class=\"title function_\">get_gpt_meta_data</span><span class=\"params\">(u64 *data_size, <span class=\"type\">void</span> **data)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    gpt_header *pgpt_head;</span><br><span class=\"line\">\tgpt_entry *entries;</span><br><span class=\"line\">\t<span class=\"type\">void</span> *meta_data;</span><br><span class=\"line\">\tu64 meta_data_size, gpt_entries_size;</span><br><span class=\"line\">\t<span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">blk_desc</span> *<span class=\"title\">dev_desc</span> =</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">\t<span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">mmc</span> *<span class=\"title\">mmc</span> =</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">\tu64 blk_size = <span class=\"number\">0</span>;</span><br><span class=\"line\">\tu64 blk_cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\">\tu64 tag = <span class=\"number\">0x55AA</span>;</span><br><span class=\"line\">\t<span class=\"type\">lbaint_t</span> lba;</span><br><span class=\"line\">    </span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (!data_size || !data) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR: Invalid Argument(s) ***\\n&quot;</span>, __func__);</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    mmc = do_returnmmc();</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (!mmc)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> CMD_RET_FAILURE;</span><br><span class=\"line\">    </span><br><span class=\"line\">    dev_desc = mmc_get_blk_desc(mmc);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (!dev_desc) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR: mmc_get_blk_desc err ***\\n&quot;</span>, __func__);</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tgpt_entries_size = <span class=\"keyword\">sizeof</span>(gpt_entry) * PART_MAX_COUNT;</span><br><span class=\"line\">\tmeta_data_size = LAB_SIZE + <span class=\"keyword\">sizeof</span>(gpt_header) + gpt_entries_size;</span><br><span class=\"line\">\tmeta_data = <span class=\"built_in\">malloc</span>(meta_data_size);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(!meta_data) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR: malloc memory (gpt meta data) ***\\n&quot;</span>, __func__);</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"built_in\">memset</span>(meta_data, <span class=\"number\">0</span>, meta_data_size);</span><br><span class=\"line\">\tpgpt_head = (gpt_header *)((<span class=\"type\">char</span> *)meta_data + HEADER_OFFSET);</span><br><span class=\"line\">\tentries = (gpt_entry *)((<span class=\"type\">char</span> *)meta_data + ENTRY_OFFSET);</span><br><span class=\"line\">\tALLOC_CACHE_ALIGN_BUFFER(legacy_mbr, mbr, dev_desc-&gt;blksz);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/* Read MBR Header from device */</span></span><br><span class=\"line\">\tlba = <span class=\"number\">0</span>; <span class=\"comment\">/* MBR is always at 0 */</span></span><br><span class=\"line\">\tblk_cnt = <span class=\"number\">1</span>; <span class=\"comment\">/* MBR (1 block) */</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (blk_dread(dev_desc, lba, blk_cnt, (ulong *)mbr) != <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;*** ERROR: Can&#x27;t read MBR header ***\\n&quot;</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">goto</span> ERROR_OUT;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/* Read GPT Header from device */</span></span><br><span class=\"line\">\tlba = GPT_PRIMARY_PARTITION_TABLE_LBA;</span><br><span class=\"line\">\tblk_cnt = <span class=\"number\">1</span>; <span class=\"comment\">/* GPT Header (1 block) */</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (blk_dread(dev_desc, lba, blk_cnt, pgpt_head) != <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">    \t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR: Can&#x27;t read GPT header ***\\n&quot;</span>, __func__);</span><br><span class=\"line\">\t\t<span class=\"keyword\">goto</span> ERROR_OUT;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tlba = GPT_PRIMARY_PARTITION_TABLE_LBA;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (validate_gpt_header(pgpt_head, lba, dev_desc-&gt;lba)) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR: validate_gpt_header GPT header ***\\n&quot;</span>, __func__);</span><br><span class=\"line\">\t\t<span class=\"keyword\">goto</span> ERROR_OUT;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (dev_desc-&gt;sig_type == SIG_TYPE_NONE) &#123;</span><br><span class=\"line\">\t\t<span class=\"type\">efi_guid_t</span> empty = &#123;&#125;;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (<span class=\"built_in\">memcmp</span>(&amp;pgpt_head-&gt;disk_guid, &amp;empty, <span class=\"keyword\">sizeof</span>(empty))) &#123;</span><br><span class=\"line\">\t\t\tdev_desc-&gt;sig_type = SIG_TYPE_GUID;</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">memcpy</span>(&amp;dev_desc-&gt;guid_sig, &amp;pgpt_head-&gt;disk_guid,</span><br><span class=\"line\">\t\t\t      <span class=\"keyword\">sizeof</span>(empty));</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (mbr-&gt;unique_mbr_signature != <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">\t\t\tdev_desc-&gt;sig_type = SIG_TYPE_MBR;</span><br><span class=\"line\">\t\t\tdev_desc-&gt;mbr_sig = mbr-&gt;unique_mbr_signature;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/* Read GPT Entries from device */</span></span><br><span class=\"line\">\tlba = le64_to_cpu(pgpt_head-&gt;partition_entry_lba);</span><br><span class=\"line\">\tblk_cnt = BLOCK_CNT((le32_to_cpu(pgpt_head-&gt;num_partition_entries) *</span><br><span class=\"line\">\t\t\t\t   \tle32_to_cpu(pgpt_head-&gt;sizeof_partition_entry)),</span><br><span class=\"line\">\t\t\t\t  \tdev_desc);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (blk_dread(dev_desc, lba, blk_cnt, entries) != blk_cnt) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR:read entries (lba=%llu) ***\\n&quot;</span>,</span><br><span class=\"line\">\t\t\t\t__func__, pgpt_head-&gt;partition_entry_lba);</span><br><span class=\"line\">\t\t<span class=\"keyword\">goto</span> ERROR_OUT;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tblk_size = dev_desc-&gt;blksz;</span><br><span class=\"line\">\tvalidate_gpt_entries(pgpt_head, entries);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tdebug(<span class=\"string\">&quot;%s read entries lba %llu (blk_cnt %llu blk_size=%llu)\\n&quot;</span>,</span><br><span class=\"line\">\t\t\t\t__func__, (<span class=\"type\">unsigned</span> <span class=\"type\">long</span> <span class=\"type\">long</span>)(ulong)lba, blk_cnt, blk_size);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tblk_cnt = get_gpt_blk_cnt(dev_desc, pgpt_head, &amp;entries);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/* </span></span><br><span class=\"line\"><span class=\"comment\">\t * build info, layout of meta_data:</span></span><br><span class=\"line\"><span class=\"comment\">\t * u64 tag | u64 blk_size | u64 blk_cnt | 488 bytes | gpt header | gpt entries</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\tblk_cnt = get_gpt_blk_cnt(dev_desc, pgpt_head, &amp;entries);</span><br><span class=\"line\">\t<span class=\"comment\">/*this value makes we known the reserved memory is available*/</span></span><br><span class=\"line\">\t<span class=\"built_in\">memcpy</span>(meta_data, (<span class=\"type\">void</span> *)&amp;tag, <span class=\"keyword\">sizeof</span>(u64));</span><br><span class=\"line\">\t<span class=\"built_in\">memcpy</span>(meta_data + VAL1_OFFSET, (<span class=\"type\">void</span> *)&amp;blk_size, <span class=\"keyword\">sizeof</span>(u64));</span><br><span class=\"line\">\t<span class=\"built_in\">memcpy</span>(meta_data + VAL2_OFFSET, (<span class=\"type\">void</span> *)&amp;blk_cnt, <span class=\"keyword\">sizeof</span>(u64));</span><br><span class=\"line\"></span><br><span class=\"line\">\t*data_size = meta_data_size;</span><br><span class=\"line\">\t*data = meta_data;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">ERROR_OUT:</span><br><span class=\"line\">\t<span class=\"built_in\">free</span>(meta_data);</span><br><span class=\"line\">\tmeta_data = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<p>å‚è€ƒï¼š</p>\n<p><a href=\"http://www.wowotech.net/device_model/dt-code-file-struct-parse.html\">Device Treeï¼ˆå››ï¼‰ï¼šæ–‡ä»¶ç»“æ„è§£æ (wowotech.net)</a></p>\n<p><a href=\"https://zhuanlan.zhihu.com/p/376295326\">Linuxè®¾å¤‡æ ‘è¯­æ³•åˆ†æè¯¦è§£æ•™ç¨‹(ä¸‰)u-bootè®¾å¤‡æ ‘çš„ä¼ é€’ - çŸ¥ä¹ (zhihu.com)</a></p>\n<p><a href=\"https://zhuanlan.zhihu.com/p/376296222\">Linuxè®¾å¤‡æ ‘è¯­æ³•åˆ†æè¯¦è§£æ•™ç¨‹(å››)kernelçš„è§£æ - çŸ¥ä¹ (zhihu.com)</a></p>\n<p><a href=\"https://www.cnblogs.com/solo666/p/16518154.html\">https://www.cnblogs.com/solo666/p/16518154.html</a></p>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n</blockquote>\n<p>U-Bootå®˜ç½‘:<code>https://docs.u-boot.org/en/latest/</code></p>\n<p>u-bootå¯åŠ¨æµç¨‹</p>\n<ul>\n<li>æ¿å­ä¸Šç”µä»¥åï¼Œé¦–å…ˆæ‰§è¡Œçš„æ˜¯ROMä¸­çš„ä¸€æ®µå¯åŠ¨ä»£ç ã€‚å¯åŠ¨ä»£ç <strong>æ ¹æ®å¯„å­˜å™¨&#x2F;å¤–éƒ¨ç®¡è„šé…ç½®</strong>ï¼Œç¡®å®šæ˜¯è¿›å…¥ä¸‹è½½æ¨¡å¼ï¼Œè¿˜æ˜¯ä»æŸä»‹è´¨(Flash&#x2F;EMMC&#x2F;SDå¡ç­‰å­˜å‚¨è®¾å¤‡)å¯åŠ¨u-boot</li>\n</ul>\n<blockquote>\n<p>ROMä¸­çš„ä»£ç æ˜¯å›ºåŒ–çš„ï¼Œæ— æ³•ä¿®æ”¹</p>\n</blockquote>\n<h1 id=\"ä¸€ã€ä»‹ç»\"><a href=\"#ä¸€ã€ä»‹ç»\" class=\"headerlink\" title=\"ä¸€ã€ä»‹ç»\"></a>ä¸€ã€ä»‹ç»</h1><blockquote>\n<p>FDTï¼Œflatted device treeï¼Œæ‰å¹³è®¾å¤‡æ ‘ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯å°†éƒ¨åˆ†è®¾å¤‡ä¿¡æ¯ç»“æ„å­˜æ”¾åˆ°device treeæ–‡ä»¶ä¸­ã€‚</p>\n<p>ubootæœ€ç»ˆå°†å…¶ç¼–è¯‘æˆdtbæ–‡ä»¶ï¼Œä½¿ç”¨è¿‡ç¨‹ä¸­é€šè¿‡è§£æè¯¥dtbæ¥è·å–æ¿çº§è®¾å¤‡ä¿¡æ¯ã€‚  </p>\n</blockquote>\n<blockquote>\n<p>U-bootçš„dtbå’Œkernelä¸­çš„dtbæ˜¯ä¸€è‡´çš„ï¼Œæœ‰å…³fdtçš„è¯¦ç»†ä»‹ç»ï¼Œå‚è€ƒdoc&#x2F;README.fdt-control</p>\n</blockquote>\n<h3 id=\"dtbåœ¨U-bootä¸­çš„ä½ç½®\"><a href=\"#dtbåœ¨U-bootä¸­çš„ä½ç½®\" class=\"headerlink\" title=\"dtbåœ¨U-bootä¸­çš„ä½ç½®\"></a>dtbåœ¨U-bootä¸­çš„ä½ç½®</h3><ul>\n<li>dtbèƒ½å¤Ÿä»¥ä¸¤ç§å½¢å¼ç¼–è¯‘åˆ°U-bootçš„é•œåƒä¸­</li>\n</ul>\n<ol>\n<li>dtbå’Œu-bootçš„binæ–‡ä»¶åˆ†ç¦»(imx6qä¸­ä½¿ç”¨çš„è¿™ç§æ–¹å¼ï¼Œåœ¨.configæ–‡ä»¶ä¸­å¯ä»¥æŸ¥çœ‹åˆ°)</li>\n</ol>\n<blockquote>\n<p>é€šè¿‡CONFIG_OF_SEPARATEå®å®šä¹‰ä½¿èƒ½ï¼Œdtbæœ€åä¼šè¿½åŠ åˆ°u-bootçš„binæ–‡ä»¶çš„æœ€åé¢ï¼Œé€šè¿‡u-bootçš„ç»“æŸåœ°å€ç¬¦å·_endç¬¦å·æ¥è·å–dtbçš„åœ°å€</p>\n</blockquote>\n<ol>\n<li>dtbé›†æˆåˆ°u-bootçš„binæ–‡ä»¶å†…éƒ¨</li>\n</ol>\n<blockquote>\n<p>é€šè¿‡CONFIG_OF_EMBEDå®å®šä¹‰ä½¿èƒ½ï¼Œdtbä¼šä½äºu-bootçš„.dtb.init.rodataæ®µä¸­ï¼Œé€šè¿‡__dtb_dt_beginç¬¦å·æ¥è·å–dtb</p>\n</blockquote>\n<ol>\n<li>è·å–dtsæ–‡ä»¶çš„åœ°å€gd-&gt;fdt_blob</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// å®ç”¨æ¥è¡¨ç¤ºæ˜¯å¦æŠŠdtbæ–‡ä»¶æ”¾åœ¨uboot.binçš„æ–‡ä»¶ä¸­</span><br><span class=\"line\">CONFIG_OF_EMBED</span><br><span class=\"line\"></span><br><span class=\"line\">// å•ç‹¬ç¼–è¯‘dtbæ–‡ä»¶</span><br><span class=\"line\">CONFIG_OF_SEPARATEï¼Œç¼–è¯‘å‡ºæ¥çš„dtbæ”¾åœ¨uboot.binçš„æœ€åé¢ï¼Œå°±æ˜¯dtbè¿½åŠ åˆ°ubootçš„binæ–‡ä»¶åé¢æ—¶ï¼Œé€šè¿‡_endç¬¦å·æ¥è·å–dtbåœ°å€</span><br><span class=\"line\"></span><br><span class=\"line\">gd-&gt;fdt_blob = (ulong *)&amp;_end;</span><br><span class=\"line\"></span><br><span class=\"line\">// å¯ä»¥é€šè¿‡fdtcontroladdrç¯å¢ƒå˜é‡æ¥æŒ‡å®šfdtçš„åœ°å€</span><br><span class=\"line\">gd-&gt;fdt_blob = (void *)getenv_ulong(&quot;fdtcontroladdr&quot;, 16,</span><br><span class=\"line\">\t\t\t\t\t\t(uintptr_t)gd-&gt;fdt_blob); </span><br></pre></td></tr></table></figure>\n\n<h3 id=\"dtbè§£ææ¥å£\"><a href=\"#dtbè§£ææ¥å£\" class=\"headerlink\" title=\"dtbè§£ææ¥å£\"></a>dtbè§£ææ¥å£</h3><ul>\n<li>å®šä¹‰åœ¨lib&#x2F;fdtdec.cæ–‡ä»¶ä¸­ï¼ŒèŠ‚ç‚¹å˜é‡nodeä¸­å­˜æ”¾çš„æ˜¯åç§»åœ°å€</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// è·å¾—dtbä¸‹æŸä¸ªèŠ‚ç‚¹çš„è·¯å¾„pathçš„åç§»ï¼Œåç§»å°±ä»£è¡¨è¿™ä¸ªèŠ‚ç‚¹</span><br><span class=\"line\">int fdt_path_offset(const void *fdt, const char *path)</span><br><span class=\"line\">egï¼šnode = fdt_path_offset(gd-&gt;fdt_blob, â€œ/aliasesâ€);</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªå­—ç¬¦ä¸²å±æ€§å€¼</span><br><span class=\"line\">const void *fdt_getprop(const void *fdt, int nodeoffset, const char *name, int *lenp)</span><br><span class=\"line\">egï¼š mac = fdt_getprop(gd-&gt;fdt_blob, node, â€œmac-addressâ€, &amp;len);</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ•´å½¢æ•°ç»„å±æ€§å€¼</span><br><span class=\"line\">int fdtdec_get_int_array(const void *blob, int node, const char *prop_name, u32 *array, int count)</span><br><span class=\"line\">egï¼š ret = fdtdec_get_int_array(blob, node, â€œinterruptsâ€, cell, ARRAY_SIZE(cell));</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—èŠ‚ç‚¹nodeçš„åœ°å€å±æ€§å€¼</span><br><span class=\"line\">fdt_addr_t fdtdec_get_addr(const void *blob, int node, const char *prop_name)</span><br><span class=\"line\">egï¼šfdtdec_get_addr(blob, node, â€œregâ€);</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—configèŠ‚ç‚¹ä¸‹çš„æ•´å½¢å±æ€§ã€boolå±æ€§ã€å­—ç¬¦ä¸²ç­‰ç­‰</span><br><span class=\"line\">fdtdec_get_config_intã€fdtdec_get_config_boolã€fdtdec_get_config_string</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—chosenä¸‹çš„nameèŠ‚ç‚¹çš„åç§»</span><br><span class=\"line\">int fdtdec_get_chosen_node(const void *blob, const char *name)</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—chosenä¸‹nameå±æ€§çš„å€¼</span><br><span class=\"line\">const char *fdtdec_get_chosen_prop(const void *blob, const char *name)</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>å®šä¹‰åœ¨lib&#x2F;fdtdec_common.cæ–‡ä»¶ä¸­</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ•´å½¢å±æ€§å€¼</span><br><span class=\"line\">int fdtdec_get_int(const void *blob, int node, const char *prop_name, int default_val)</span><br><span class=\"line\">egï¼š bus-&gt;udelay = fdtdec_get_int(blob, node, â€œi2c-gpio,delay-usâ€, DEFAULT_UDELAY);</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ— ç¬¦å·æ•´å½¢å±æ€§å€¼</span><br><span class=\"line\">fdtdec_get_uint</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"fdt-å‘½ä»¤\"><a href=\"#fdt-å‘½ä»¤\" class=\"headerlink\" title=\"fdt å‘½ä»¤\"></a>fdt å‘½ä»¤</h2><p>å¯¹äºu-bootæä¾›äº†fdtçš„ç›¸å…³å‘½ä»¤</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fdt - flattened device tree utility commands</span><br><span class=\"line\"></span><br><span class=\"line\">Usage:</span><br><span class=\"line\">fdt addr [-c]  &lt;addr&gt; [&lt;length&gt;]   - Set the [control] fdt location to &lt;addr&gt;</span><br><span class=\"line\">fdt apply &lt;addr&gt;                    - Apply overlay to the DT</span><br><span class=\"line\">fdt move   &lt;fdt&gt; &lt;newaddr&gt; &lt;length&gt; - Copy the fdt to &lt;addr&gt; and make it active</span><br><span class=\"line\">fdt resize [&lt;extrasize&gt;]            - Resize fdt to size + padding to 4k addr + some optional &lt;extrasize&gt; if needed</span><br><span class=\"line\">fdt print  &lt;path&gt; [&lt;prop&gt;]          - Recursive print starting at &lt;path&gt;</span><br><span class=\"line\">fdt list   &lt;path&gt; [&lt;prop&gt;]          - Print one level starting at &lt;path&gt;</span><br><span class=\"line\">fdt get value &lt;var&gt; &lt;path&gt; &lt;prop&gt;   - Get &lt;property&gt; and store in &lt;var&gt;</span><br><span class=\"line\">fdt get name &lt;var&gt; &lt;path&gt; &lt;index&gt;   - Get name of node &lt;index&gt; and store in &lt;var&gt;</span><br><span class=\"line\">fdt get addr &lt;var&gt; &lt;path&gt; &lt;prop&gt;    - Get start address of &lt;property&gt; and store in &lt;var&gt;</span><br><span class=\"line\">fdt get size &lt;var&gt; &lt;path&gt; [&lt;prop&gt;]  - Get size of [&lt;property&gt;] or num nodes and store in &lt;var&gt;</span><br><span class=\"line\">fdt set    &lt;path&gt; &lt;prop&gt; [&lt;val&gt;]    - Set &lt;property&gt; [to &lt;val&gt;]</span><br><span class=\"line\">fdt mknode &lt;path&gt; &lt;node&gt;            - Create a new node after &lt;path&gt;</span><br><span class=\"line\">fdt rm     &lt;path&gt; [&lt;prop&gt;]          - Delete the node or &lt;property&gt;</span><br><span class=\"line\">fdt header                          - Display header info</span><br><span class=\"line\">fdt bootcpu &lt;id&gt;                    - Set boot cpuid</span><br><span class=\"line\">fdt memory &lt;addr&gt; &lt;size&gt;            - Add/Update memory node</span><br><span class=\"line\">fdt rsvmem print                    - Show current mem reserves</span><br><span class=\"line\">fdt rsvmem add &lt;addr&gt; &lt;size&gt;        - Add a mem reserve</span><br><span class=\"line\">fdt rsvmem delete &lt;index&gt;           - Delete a mem reserves</span><br><span class=\"line\">fdt chosen [&lt;start&gt; &lt;end&gt;]          - Add/update the /chosen branch in the tree</span><br><span class=\"line\">                                        &lt;start&gt;/&lt;end&gt; - initrd start/end addr</span><br><span class=\"line\">NOTE: Dereference aliases by omitting the leading &#x27;/&#x27;, e.g. fdt print ethernet0.</span><br></pre></td></tr></table></figure>\n\n<p>fdt printåŠ pathå‚æ•°ï¼Œåˆ™æ‰“pathå†…å®¹ï¼Œå¦‚ä¸‹(å…¶ä¸­&#x2F;memoryæ˜¯path)ï¼š</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">U-Boot&gt; fdt print /memory</span><br><span class=\"line\">memory &#123;</span><br><span class=\"line\">device_type = <span class=\"string\">&quot;memory&quot;</span>;</span><br><span class=\"line\">reg = &lt;<span class=\"number\">0x70000000</span> <span class=\"number\">0x4000000</span>&gt;;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">U-Boot&gt; fdt print #ä¸åŠ å‚æ•°æ—¶ï¼Œæ‰“å°å‡ºæ•´é¢—æ ‘</span><br></pre></td></tr></table></figure>\n\n\n\n<p>äºŒã€u-boot è·å–GPTåˆ†åŒºè¡¨</p>\n<p>åœ¨ubootä¸­é€šè¿‡å‘½ä»¤æ‰“å°åˆ†åŒºè¡¨</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">part list mmc 0</span><br></pre></td></tr></table></figure>\n\n<p>3588-android-uboot</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;common.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;command.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;android_image.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;mmc.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;memalign.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;fdtdec.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> PART_MAX_COUNT  128</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span>\tLAB_SIZE\t\t512</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span>\tHEADER_OFFSET\tLAB_SIZE</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span>\tENTRY_OFFSET\t(2 * LAB_SIZE)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span>\tVAL1_OFFSET\t\tsizeof(u64)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span>\tVAL2_OFFSET\t\t(2 * sizeof(u64))</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">static</span> u64 <span class=\"title function_\">get_gpt_blk_cnt_and_print</span><span class=\"params\">(<span class=\"keyword\">struct</span> blk_desc *dev_desc,</span></span><br><span class=\"line\"><span class=\"params\">\t\t\t  gpt_header *gpt_head, gpt_entry **gpt_pte)</span> &#123;</span><br><span class=\"line\">\t<span class=\"type\">char</span> efi_str[PARTNAME_SZ + <span class=\"number\">1</span>];</span><br><span class=\"line\">\tu64 gpt_part_size, gpt_blk_cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\">\tgpt_entry *gpt_e;</span><br><span class=\"line\">\t<span class=\"type\">int</span> i;</span><br><span class=\"line\"></span><br><span class=\"line\">\tgpt_e = *gpt_pte;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (i = <span class=\"number\">0</span>; i &lt; gpt_head-&gt;num_partition_entries; i++) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\traite_gpt_convert_efi_name_to_char(efi_str, gpt_e[i].partition_name,</span><br><span class=\"line\">\t\t\t\t\t     PARTNAME_SZ + <span class=\"number\">1</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s: part: %2d name - GPT: %16s &quot;</span>,</span><br><span class=\"line\">\t\t      __func__, i, efi_str);</span><br><span class=\"line\">\t\tgpt_part_size = le64_to_cpu(gpt_e[i].ending_lba) -</span><br><span class=\"line\">\t\t\tle64_to_cpu(gpt_e[i].starting_lba) + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\tgpt_blk_cnt += gpt_part_size;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(gpt_part_size == <span class=\"number\">1</span>) </span><br><span class=\"line\">\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;size(LBA) - GPT: %8llu &quot;</span>,</span><br><span class=\"line\">\t\t      (<span class=\"type\">unsigned</span> <span class=\"type\">long</span> <span class=\"type\">long</span>)gpt_part_size);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;start LBA - GPT: %8llu \\n&quot;</span>,</span><br><span class=\"line\">\t\t      le64_to_cpu(gpt_e[i].starting_lba));</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> gpt_blk_cnt + gpt_e[<span class=\"number\">0</span>].starting_lba - <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">static</span> <span class=\"type\">int</span> <span class=\"title function_\">get_gpt_meta_data</span><span class=\"params\">(u64 *data_size, <span class=\"type\">void</span> **data)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    gpt_header *pgpt_head;</span><br><span class=\"line\">\tgpt_entry *entries;</span><br><span class=\"line\">\t<span class=\"type\">void</span> *meta_data;</span><br><span class=\"line\">\tu64 meta_data_size, gpt_entries_size;</span><br><span class=\"line\">\t<span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">blk_desc</span> *<span class=\"title\">dev_desc</span> =</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">\t<span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">mmc</span> *<span class=\"title\">mmc</span> =</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">\tu64 blk_size = <span class=\"number\">0</span>;</span><br><span class=\"line\">\tu64 blk_cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\">\tu64 tag = <span class=\"number\">0x55AA</span>;</span><br><span class=\"line\">\t<span class=\"type\">lbaint_t</span> lba;</span><br><span class=\"line\">    </span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (!data_size || !data) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR: Invalid Argument(s) ***\\n&quot;</span>, __func__);</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    mmc = do_returnmmc();</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (!mmc)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> CMD_RET_FAILURE;</span><br><span class=\"line\">    </span><br><span class=\"line\">    dev_desc = mmc_get_blk_desc(mmc);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (!dev_desc) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR: mmc_get_blk_desc err ***\\n&quot;</span>, __func__);</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tgpt_entries_size = <span class=\"keyword\">sizeof</span>(gpt_entry) * PART_MAX_COUNT;</span><br><span class=\"line\">\tmeta_data_size = LAB_SIZE + <span class=\"keyword\">sizeof</span>(gpt_header) + gpt_entries_size;</span><br><span class=\"line\">\tmeta_data = <span class=\"built_in\">malloc</span>(meta_data_size);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(!meta_data) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR: malloc memory (gpt meta data) ***\\n&quot;</span>, __func__);</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"built_in\">memset</span>(meta_data, <span class=\"number\">0</span>, meta_data_size);</span><br><span class=\"line\">\tpgpt_head = (gpt_header *)((<span class=\"type\">char</span> *)meta_data + HEADER_OFFSET);</span><br><span class=\"line\">\tentries = (gpt_entry *)((<span class=\"type\">char</span> *)meta_data + ENTRY_OFFSET);</span><br><span class=\"line\">\tALLOC_CACHE_ALIGN_BUFFER(legacy_mbr, mbr, dev_desc-&gt;blksz);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/* Read MBR Header from device */</span></span><br><span class=\"line\">\tlba = <span class=\"number\">0</span>; <span class=\"comment\">/* MBR is always at 0 */</span></span><br><span class=\"line\">\tblk_cnt = <span class=\"number\">1</span>; <span class=\"comment\">/* MBR (1 block) */</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (blk_dread(dev_desc, lba, blk_cnt, (ulong *)mbr) != <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;*** ERROR: Can&#x27;t read MBR header ***\\n&quot;</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">goto</span> ERROR_OUT;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/* Read GPT Header from device */</span></span><br><span class=\"line\">\tlba = GPT_PRIMARY_PARTITION_TABLE_LBA;</span><br><span class=\"line\">\tblk_cnt = <span class=\"number\">1</span>; <span class=\"comment\">/* GPT Header (1 block) */</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (blk_dread(dev_desc, lba, blk_cnt, pgpt_head) != <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">    \t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR: Can&#x27;t read GPT header ***\\n&quot;</span>, __func__);</span><br><span class=\"line\">\t\t<span class=\"keyword\">goto</span> ERROR_OUT;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tlba = GPT_PRIMARY_PARTITION_TABLE_LBA;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (validate_gpt_header(pgpt_head, lba, dev_desc-&gt;lba)) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR: validate_gpt_header GPT header ***\\n&quot;</span>, __func__);</span><br><span class=\"line\">\t\t<span class=\"keyword\">goto</span> ERROR_OUT;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (dev_desc-&gt;sig_type == SIG_TYPE_NONE) &#123;</span><br><span class=\"line\">\t\t<span class=\"type\">efi_guid_t</span> empty = &#123;&#125;;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (<span class=\"built_in\">memcmp</span>(&amp;pgpt_head-&gt;disk_guid, &amp;empty, <span class=\"keyword\">sizeof</span>(empty))) &#123;</span><br><span class=\"line\">\t\t\tdev_desc-&gt;sig_type = SIG_TYPE_GUID;</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">memcpy</span>(&amp;dev_desc-&gt;guid_sig, &amp;pgpt_head-&gt;disk_guid,</span><br><span class=\"line\">\t\t\t      <span class=\"keyword\">sizeof</span>(empty));</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (mbr-&gt;unique_mbr_signature != <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">\t\t\tdev_desc-&gt;sig_type = SIG_TYPE_MBR;</span><br><span class=\"line\">\t\t\tdev_desc-&gt;mbr_sig = mbr-&gt;unique_mbr_signature;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/* Read GPT Entries from device */</span></span><br><span class=\"line\">\tlba = le64_to_cpu(pgpt_head-&gt;partition_entry_lba);</span><br><span class=\"line\">\tblk_cnt = BLOCK_CNT((le32_to_cpu(pgpt_head-&gt;num_partition_entries) *</span><br><span class=\"line\">\t\t\t\t   \tle32_to_cpu(pgpt_head-&gt;sizeof_partition_entry)),</span><br><span class=\"line\">\t\t\t\t  \tdev_desc);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (blk_dread(dev_desc, lba, blk_cnt, entries) != blk_cnt) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR:read entries (lba=%llu) ***\\n&quot;</span>,</span><br><span class=\"line\">\t\t\t\t__func__, pgpt_head-&gt;partition_entry_lba);</span><br><span class=\"line\">\t\t<span class=\"keyword\">goto</span> ERROR_OUT;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tblk_size = dev_desc-&gt;blksz;</span><br><span class=\"line\">\tvalidate_gpt_entries(pgpt_head, entries);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tdebug(<span class=\"string\">&quot;%s read entries lba %llu (blk_cnt %llu blk_size=%llu)\\n&quot;</span>,</span><br><span class=\"line\">\t\t\t\t__func__, (<span class=\"type\">unsigned</span> <span class=\"type\">long</span> <span class=\"type\">long</span>)(ulong)lba, blk_cnt, blk_size);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tblk_cnt = get_gpt_blk_cnt(dev_desc, pgpt_head, &amp;entries);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/* </span></span><br><span class=\"line\"><span class=\"comment\">\t * build info, layout of meta_data:</span></span><br><span class=\"line\"><span class=\"comment\">\t * u64 tag | u64 blk_size | u64 blk_cnt | 488 bytes | gpt header | gpt entries</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\tblk_cnt = get_gpt_blk_cnt(dev_desc, pgpt_head, &amp;entries);</span><br><span class=\"line\">\t<span class=\"comment\">/*this value makes we known the reserved memory is available*/</span></span><br><span class=\"line\">\t<span class=\"built_in\">memcpy</span>(meta_data, (<span class=\"type\">void</span> *)&amp;tag, <span class=\"keyword\">sizeof</span>(u64));</span><br><span class=\"line\">\t<span class=\"built_in\">memcpy</span>(meta_data + VAL1_OFFSET, (<span class=\"type\">void</span> *)&amp;blk_size, <span class=\"keyword\">sizeof</span>(u64));</span><br><span class=\"line\">\t<span class=\"built_in\">memcpy</span>(meta_data + VAL2_OFFSET, (<span class=\"type\">void</span> *)&amp;blk_cnt, <span class=\"keyword\">sizeof</span>(u64));</span><br><span class=\"line\"></span><br><span class=\"line\">\t*data_size = meta_data_size;</span><br><span class=\"line\">\t*data = meta_data;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">ERROR_OUT:</span><br><span class=\"line\">\t<span class=\"built_in\">free</span>(meta_data);</span><br><span class=\"line\">\tmeta_data = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<p>å‚è€ƒï¼š</p>\n<p><a href=\"http://www.wowotech.net/device_model/dt-code-file-struct-parse.html\">Device Treeï¼ˆå››ï¼‰ï¼šæ–‡ä»¶ç»“æ„è§£æ (wowotech.net)</a></p>\n<p><a href=\"https://zhuanlan.zhihu.com/p/376295326\">Linuxè®¾å¤‡æ ‘è¯­æ³•åˆ†æè¯¦è§£æ•™ç¨‹(ä¸‰)u-bootè®¾å¤‡æ ‘çš„ä¼ é€’ - çŸ¥ä¹ (zhihu.com)</a></p>\n<p><a href=\"https://zhuanlan.zhihu.com/p/376296222\">Linuxè®¾å¤‡æ ‘è¯­æ³•åˆ†æè¯¦è§£æ•™ç¨‹(å››)kernelçš„è§£æ - çŸ¥ä¹ (zhihu.com)</a></p>\n<p><a href=\"https://www.cnblogs.com/solo666/p/16518154.html\">https://www.cnblogs.com/solo666/p/16518154.html</a></p>\n"},{"_content":"https://pages.cs.wisc.edu/~remzi/OSTEP/Chinese/40.pdf\n\nç£ç›˜ä¸Šçš„å“ªäº›ç»“æ„å­˜å‚¨æ–‡ä»¶ç³»ç»Ÿçš„æ•°æ®å’Œå…ƒæ•°æ®ï¼Ÿ\n\nå½“ä¸€ä¸ªè¿›ç¨‹æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ\n\nåœ¨è¯»å–æˆ–å†™å…¥æœŸé—´è®¿é—®å“ªäº›ç£ç›˜ç»“æ„ï¼Ÿ","source":"back_posts/OSTEP-40-æ–‡ä»¶ç³»ç»Ÿå®ç°.md","raw":"https://pages.cs.wisc.edu/~remzi/OSTEP/Chinese/40.pdf\n\nç£ç›˜ä¸Šçš„å“ªäº›ç»“æ„å­˜å‚¨æ–‡ä»¶ç³»ç»Ÿçš„æ•°æ®å’Œå…ƒæ•°æ®ï¼Ÿ\n\nå½“ä¸€ä¸ªè¿›ç¨‹æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ\n\nåœ¨è¯»å–æˆ–å†™å…¥æœŸé—´è®¿é—®å“ªäº›ç£ç›˜ç»“æ„ï¼Ÿ","date":"2024-05-15T06:11:08.982Z","updated":"2024-05-15T06:11:08.982Z","path":"back_posts/OSTEP-40-æ–‡ä»¶ç³»ç»Ÿå®ç°.html","title":"","comments":1,"layout":"page","_id":"clw7fflkt000bx2w0bmaie0nz","content":"<p><a href=\"https://pages.cs.wisc.edu/~remzi/OSTEP/Chinese/40.pdf\">https://pages.cs.wisc.edu/~remzi/OSTEP/Chinese/40.pdf</a></p>\n<p>ç£ç›˜ä¸Šçš„å“ªäº›ç»“æ„å­˜å‚¨æ–‡ä»¶ç³»ç»Ÿçš„æ•°æ®å’Œå…ƒæ•°æ®ï¼Ÿ</p>\n<p>å½“ä¸€ä¸ªè¿›ç¨‹æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p>\n<p>åœ¨è¯»å–æˆ–å†™å…¥æœŸé—´è®¿é—®å“ªäº›ç£ç›˜ç»“æ„ï¼Ÿ</p>\n","site":{"data":{}},"excerpt":"","more":"<p><a href=\"https://pages.cs.wisc.edu/~remzi/OSTEP/Chinese/40.pdf\">https://pages.cs.wisc.edu/~remzi/OSTEP/Chinese/40.pdf</a></p>\n<p>ç£ç›˜ä¸Šçš„å“ªäº›ç»“æ„å­˜å‚¨æ–‡ä»¶ç³»ç»Ÿçš„æ•°æ®å’Œå…ƒæ•°æ®ï¼Ÿ</p>\n<p>å½“ä¸€ä¸ªè¿›ç¨‹æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p>\n<p>åœ¨è¯»å–æˆ–å†™å…¥æœŸé—´è®¿é—®å“ªäº›ç£ç›˜ç»“æ„ï¼Ÿ</p>\n"},{"title":"Hexoåœ¨å¤šå°ç”µè„‘ä¸Šæäº¤å’Œæ›´æ–°","date":"2023-09-13T07:35:30.000Z","categories":["test"],"tags":["test"],"_content":"\n[toc]\n\n\n\n# 1.åšå®¢æ­å»º\n\nhttps://yyheroi.github.io/2023/08/25/github+hexo%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/\n\n# 2.åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¤¹newï¼Œç”¨äºä¸Šä¼ hexoåšå®¢ç›®å½•\n\nå°†ä»¥ä¸‹ç›®å½•ï¼ˆé™¤äº†çº¢è‰²æ–¹æ¡†çš„ç›®å½•ï¼‰æ‹·è´åˆ°æ–°ç›®å½•ä¸­\n\n![image-20230913154437526](../imgs/image-20230913154437526.png)\n\nå‚è€ƒï¼šhttps://blog.csdn.net/K1052176873/article/details/122879462 \n\n# 3.githubä¸Šåˆ›å»ºhexoåˆ†æ”¯å¹¶è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯\n\n## åˆ›å»ºhexoåˆ†æ”¯\n\n![image-20230913154510439](../imgs/image-20230913154510439.png)\n\n## å°†hexoåˆ†æ”¯è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯\n\n![image-20230913154524492](../imgs/image-20230913154524492.png)\n\n# 4.è¿›å…¥æ–°å»ºçš„æ–‡ä»¶å¤¹ä¸­git cloneï¼Œå†ä¸Šä¼ ç›¸å…³æ–‡ä»¶è‡³hexoåˆ†æ”¯\n\nåŸºæœ¬åŸç†ï¼šgithubä»“åº“å¼€ä¸¤ä¸ªåˆ†æ”¯ï¼Œmainåˆ†æ”¯å­˜æ”¾çš„æ˜¯hexoç”Ÿæˆçš„é™æ€é¡µé¢ï¼Œhexoåˆ†æ”¯å­˜æ”¾åŸºæœ¬çš„ Hexo åšå®¢é¡¹ç›®çš„ç»“æ„å’Œé»˜è®¤é…ç½®æ–‡ä»¶ï¼Œå¦‚æ–‡ç« ï¼Œä¸»é¢˜\nå½“éœ€è¦é‡æ–°æ­å»ºç¯å¢ƒæ—¶ï¼Œç›´æ¥æ‹‰å–hexoåˆ†æ”¯ä¸­Hexoåšå®¢ç›®å½•ä»¥åŠç›¸å…³é…ç½®æ–‡ä»¶ï¼Œå½“éœ€è¦æ›´æ–°åšå®¢æ—¶ç›´æ¥\n\n```\ncd new\ngit clone git@github.com:<username>/<username>.github.io.git #<username> ç”¨æˆ·å\ngit branch    #æŸ¥çœ‹åˆ†æ”¯ï¼Œæ˜¾ç¤º * hexo\n```\n\n\n\n## 1.cloneä¸‹æ¥çš„æ–‡ä»¶å¤¹å†…åº”è¯¥æœ‰ä¸ª.gitignoreæ–‡ä»¶ï¼Œç”¨æ¥å¿½ç•¥ä¸€äº›ä¸éœ€è¦çš„æ–‡ä»¶ï¼Œè¡¨ç¤ºè¿™äº›ç±»å‹æ–‡ä»¶ä¸éœ€è¦gitã€‚å¦‚æœæ²¡æœ‰ï¼Œå³é”®æ–°å»ºï¼Œå†…å®¹å¦‚ä¸‹ï¼š\n\n```\n.DS_Store\nThumbs.db\ndb.json\n*.log\nnode_modules/\npublic/\n.deploy*/\n```\n\n## 2.å¦‚æœå·²ç»cloneè¿‡ä¸»é¢˜æ–‡ä»¶ï¼Œé‚£ä¹ˆéœ€è¦æŠŠthemeä¸»é¢˜æ–‡ä»¶å¤¹é‡Œçš„ .git ä¹Ÿåˆ é™¤ï¼Œæˆ‘è¿™é‡Œå·²ç»åˆ é™¤äº†themeä¸»é¢˜çš„.gitç›®å½•\n\n![image-20230913154559571](../imgs/image-20230913154559571.png)\n\n## 3.é€newç›®å½•ä¸­çš„ç›¸å…³æ–‡ä»¶åˆ°è¿œç¨‹ä»“åº“ hexoåˆ†æ”¯\n\n```\ngit add .\ngit commit â€“m add_branch\ngit push        \n\n```\n\n\n\n# 5.ï¼æ–°ç¯å¢ƒä¸­å¿«é€Ÿæ­å»ºåšå®¢ç¯å¢ƒï¼\n\n## 1.è®¾ç½®ssh\n\nå‚è€ƒï¼šhttps://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent\n\n```\nssh-keygen -t ed25519 -C \"your_email@gmail.com\"\ncat ~/.ssh/id_ed25519.pub  #å°†é‡Œé¢çš„å†…å®¹å¤åˆ¶åˆ° github ->settings ->SSH and GPC keys ->SSH keys ->New SSH keyä¸­\nssh -T git@github.com  #è¾“å…¥yesä¹‹åï¼Œè¡Œæœ«å°¾ä¼šæ˜¾ç¤ºä½ çš„ç”¨æˆ·åï¼ˆç»‘å®šæˆåŠŸé‚®ç®±ä¼šæ”¶åˆ°é‚®ä»¶æé†’ï¼‰\n#æ¥ç€åœ¨æœ¬åœ°ç»‘å®šä¸Githubçš„ç”¨æˆ·åå’Œé‚®ç®±ï¼ˆgitï¼‰\ngit config --global user.name \"<username>\"    #è‡ªå·±çš„ç”¨æˆ·å\ngit config --global user.email 'xxx@xxx.com'  #è‡ªå·±çš„é‚®ç®±\n```\n\n## 2.å®‰è£…nodejså’Œhexo\n\n```\nsudo apt update\nsudo apt-get install git\n\nsudo apt install nodejs\nsudo apt install npm  \n```\n\n## 3.æ‹‰å–hexoåšå®¢ç›®å½•\n\n```\ngit clone git@github.com:<username>/<username>.github.io.git #<username> ç”¨æˆ·å\ngit branch    #æŸ¥çœ‹åˆ†æ”¯ï¼Œæ˜¾ç¤º * hexo\nnpm install hexo\nnpm install\nnpm install hexo-deployer-git        #ä¸éœ€è¦hexo initè¿™æ¡æŒ‡ä»¤\nnpm i hexo-renderer-marked\n\n\n#æ›´æ–°åšå®¢ æ·»åŠ æ–°æ–‡ç«  hello-world\nhexo new \"hello-world\"\ngit add .        #å°†æ–‡ç« å¤‡ä»½è‡³ hexoåˆ†æ”¯  æˆ–è€…git add source/_posts/hello-world \ngit commit â€“m \"hello-world\"\ngit push         #æˆ–è€…git push origin hexo\n\nhexo g        #ç”Ÿæˆé™æ€é¡µé¢\nhexo s        #å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨ é¢„è§ˆ\nhexo d        #å°†ç”Ÿæˆçš„åšå®¢æ–‡ä»¶éƒ¨ç½²åˆ° github mainåˆ†æ”¯ï¼ŒHexoåšå®¢é¡¹ç›®é…ç½®æ–‡ä»¶ä¸­_config.ymlå·²è®¾ç½®å¥½\n```\n\n# 6.é‡åˆ°çš„é—®é¢˜\n\n## é—®é¢˜1.nodejsç‰ˆæœ¬è¿‡ä½\n\nnpm WARN notsup Unsupported engine for hexo@6.3.0: wanted: {\"node\":\">=12.13.0\"} (current: {\"node\":\"10.19.0\",\"npm\":\"6.14.4\"})\nnpm WARN notsup Not compatible with your version of node/npm: hexo@6.3.0\nnpm WARN notsup Unsupported engine for hexo-front-matter@3.0.0: wanted: {\"node\":\">=12.13.0\"} (current: {\"node\":\"10.19.0\",\"npm\":\"6.14.4\"})\nnpm WARN notsup Not compatible with your version of node/npm: hexo-front-matter@3.0.0\nnpm WARN notsup Unsupported engine for hexo-cli@4.3.1: wanted: {\"node\":\">=14\"} (current: {\"node\":\"10.19.0\",\"npm\":\"6.14.4\"})\nnpm WARN notsup Not compatible with your version of node/npm: hexo-cli@4.3.1\nnpm WARN notsup Unsupported engine for hexo-log@3.2.0: wanted: {\"node\":\">=12.4.0\"} (current: {\"node\":\"10.19.0\",\"npm\":\"6.14.4\"})\nnpm WARN notsup Not compatible with your version of node/npm: hexo-log@3.2.0\nnpm WARN notsup Unsupported engine for abbrev@2.0.0: wanted: {\"node\":\"^14.17.0 || ^16.13.0 || >=18.0.0\"} (current: {\"node\":\"10.19.0\",\"npm\":\"6.14.4\"})\nnpm WARN notsup Not compatible with your version of node/npm: abbrev@2.0.0\nnpm WARN notsup Unsupported engine for hexo-fs@4.1.1: wanted: {\"node\":\">=14\"} (current: {\"node\":\"10.19.0\",\"npm\":\"6.14.4\"})\nnpm WARN notsup Not compatible with your version of node/npm: hexo-fs@4.1.1\nnpm WARN notsup Unsupported engine for hexo-log@4.1.0: wanted: {\"node\":\">=14\"} (current: {\"node\":\"10.19.0\",\"npm\":\"6.14.4\"})\nnpm WARN notsup Not compatible with your version of node/npm: hexo-log@4.1.0\nnpm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@2.3.3 (node_modules/fsevents):\nnpm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for fsevents@2.3.3: wanted {\"os\":\"darwin\",\"arch\":\"any\"} (current: {\"os\":\"linux\",\"arch\":\"x64\"})\n\n## å‡çº§nodejs\n\n```\nwget -qO- https://raw.githubusercontent.com/nvm-sh/nvm/v0.38.0/install.sh | bash         #å®‰è£… nvm\nsource ~/.bashrc            #åŠ è½½ nvm\nnvm install node            #ä½¿ç”¨ nvm å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ Node.js\nnode -v                     #éªŒè¯ Node.js ç‰ˆæœ¬\n```\n\n\n\n\n\n## é—®é¢˜2.hexoåšå®¢å›¾ç‰‡ä¸æ˜¾ç¤º\n\nhttps://blog.csdn.net/QRLYLETITBE/article/details/127737904 \n\n```\nnpm i hexo-renderer-marked\n\n```\n\n## æ–°å»ºimgsæ–‡ä»¶å¤¹\n\n![image-20230913161638961](../imgs/image-20230913161638961.png)\n\n```\nmarked:\n  prependRoot: true\n  postAsset: true\n\n```\n## ä¿®æ”¹å›¾ç‰‡è·¯å¾„\n\n![image-20230913161842174](../imgs/image-20230913161842174.png)\n","source":"back_posts/Hexoåœ¨å¤šå°ç”µè„‘ä¸Šæäº¤å’Œæ›´æ–°.md","raw":"---\ntitle: Hexoåœ¨å¤šå°ç”µè„‘ä¸Šæäº¤å’Œæ›´æ–°\ndate: 2023-09-13 15:35:30\ncategories:\n- test\ntags:\n- test\n---\n\n[toc]\n\n\n\n# 1.åšå®¢æ­å»º\n\nhttps://yyheroi.github.io/2023/08/25/github+hexo%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/\n\n# 2.åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¤¹newï¼Œç”¨äºä¸Šä¼ hexoåšå®¢ç›®å½•\n\nå°†ä»¥ä¸‹ç›®å½•ï¼ˆé™¤äº†çº¢è‰²æ–¹æ¡†çš„ç›®å½•ï¼‰æ‹·è´åˆ°æ–°ç›®å½•ä¸­\n\n![image-20230913154437526](../imgs/image-20230913154437526.png)\n\nå‚è€ƒï¼šhttps://blog.csdn.net/K1052176873/article/details/122879462 \n\n# 3.githubä¸Šåˆ›å»ºhexoåˆ†æ”¯å¹¶è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯\n\n## åˆ›å»ºhexoåˆ†æ”¯\n\n![image-20230913154510439](../imgs/image-20230913154510439.png)\n\n## å°†hexoåˆ†æ”¯è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯\n\n![image-20230913154524492](../imgs/image-20230913154524492.png)\n\n# 4.è¿›å…¥æ–°å»ºçš„æ–‡ä»¶å¤¹ä¸­git cloneï¼Œå†ä¸Šä¼ ç›¸å…³æ–‡ä»¶è‡³hexoåˆ†æ”¯\n\nåŸºæœ¬åŸç†ï¼šgithubä»“åº“å¼€ä¸¤ä¸ªåˆ†æ”¯ï¼Œmainåˆ†æ”¯å­˜æ”¾çš„æ˜¯hexoç”Ÿæˆçš„é™æ€é¡µé¢ï¼Œhexoåˆ†æ”¯å­˜æ”¾åŸºæœ¬çš„ Hexo åšå®¢é¡¹ç›®çš„ç»“æ„å’Œé»˜è®¤é…ç½®æ–‡ä»¶ï¼Œå¦‚æ–‡ç« ï¼Œä¸»é¢˜\nå½“éœ€è¦é‡æ–°æ­å»ºç¯å¢ƒæ—¶ï¼Œç›´æ¥æ‹‰å–hexoåˆ†æ”¯ä¸­Hexoåšå®¢ç›®å½•ä»¥åŠç›¸å…³é…ç½®æ–‡ä»¶ï¼Œå½“éœ€è¦æ›´æ–°åšå®¢æ—¶ç›´æ¥\n\n```\ncd new\ngit clone git@github.com:<username>/<username>.github.io.git #<username> ç”¨æˆ·å\ngit branch    #æŸ¥çœ‹åˆ†æ”¯ï¼Œæ˜¾ç¤º * hexo\n```\n\n\n\n## 1.cloneä¸‹æ¥çš„æ–‡ä»¶å¤¹å†…åº”è¯¥æœ‰ä¸ª.gitignoreæ–‡ä»¶ï¼Œç”¨æ¥å¿½ç•¥ä¸€äº›ä¸éœ€è¦çš„æ–‡ä»¶ï¼Œè¡¨ç¤ºè¿™äº›ç±»å‹æ–‡ä»¶ä¸éœ€è¦gitã€‚å¦‚æœæ²¡æœ‰ï¼Œå³é”®æ–°å»ºï¼Œå†…å®¹å¦‚ä¸‹ï¼š\n\n```\n.DS_Store\nThumbs.db\ndb.json\n*.log\nnode_modules/\npublic/\n.deploy*/\n```\n\n## 2.å¦‚æœå·²ç»cloneè¿‡ä¸»é¢˜æ–‡ä»¶ï¼Œé‚£ä¹ˆéœ€è¦æŠŠthemeä¸»é¢˜æ–‡ä»¶å¤¹é‡Œçš„ .git ä¹Ÿåˆ é™¤ï¼Œæˆ‘è¿™é‡Œå·²ç»åˆ é™¤äº†themeä¸»é¢˜çš„.gitç›®å½•\n\n![image-20230913154559571](../imgs/image-20230913154559571.png)\n\n## 3.é€newç›®å½•ä¸­çš„ç›¸å…³æ–‡ä»¶åˆ°è¿œç¨‹ä»“åº“ hexoåˆ†æ”¯\n\n```\ngit add .\ngit commit â€“m add_branch\ngit push        \n\n```\n\n\n\n# 5.ï¼æ–°ç¯å¢ƒä¸­å¿«é€Ÿæ­å»ºåšå®¢ç¯å¢ƒï¼\n\n## 1.è®¾ç½®ssh\n\nå‚è€ƒï¼šhttps://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent\n\n```\nssh-keygen -t ed25519 -C \"your_email@gmail.com\"\ncat ~/.ssh/id_ed25519.pub  #å°†é‡Œé¢çš„å†…å®¹å¤åˆ¶åˆ° github ->settings ->SSH and GPC keys ->SSH keys ->New SSH keyä¸­\nssh -T git@github.com  #è¾“å…¥yesä¹‹åï¼Œè¡Œæœ«å°¾ä¼šæ˜¾ç¤ºä½ çš„ç”¨æˆ·åï¼ˆç»‘å®šæˆåŠŸé‚®ç®±ä¼šæ”¶åˆ°é‚®ä»¶æé†’ï¼‰\n#æ¥ç€åœ¨æœ¬åœ°ç»‘å®šä¸Githubçš„ç”¨æˆ·åå’Œé‚®ç®±ï¼ˆgitï¼‰\ngit config --global user.name \"<username>\"    #è‡ªå·±çš„ç”¨æˆ·å\ngit config --global user.email 'xxx@xxx.com'  #è‡ªå·±çš„é‚®ç®±\n```\n\n## 2.å®‰è£…nodejså’Œhexo\n\n```\nsudo apt update\nsudo apt-get install git\n\nsudo apt install nodejs\nsudo apt install npm  \n```\n\n## 3.æ‹‰å–hexoåšå®¢ç›®å½•\n\n```\ngit clone git@github.com:<username>/<username>.github.io.git #<username> ç”¨æˆ·å\ngit branch    #æŸ¥çœ‹åˆ†æ”¯ï¼Œæ˜¾ç¤º * hexo\nnpm install hexo\nnpm install\nnpm install hexo-deployer-git        #ä¸éœ€è¦hexo initè¿™æ¡æŒ‡ä»¤\nnpm i hexo-renderer-marked\n\n\n#æ›´æ–°åšå®¢ æ·»åŠ æ–°æ–‡ç«  hello-world\nhexo new \"hello-world\"\ngit add .        #å°†æ–‡ç« å¤‡ä»½è‡³ hexoåˆ†æ”¯  æˆ–è€…git add source/_posts/hello-world \ngit commit â€“m \"hello-world\"\ngit push         #æˆ–è€…git push origin hexo\n\nhexo g        #ç”Ÿæˆé™æ€é¡µé¢\nhexo s        #å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨ é¢„è§ˆ\nhexo d        #å°†ç”Ÿæˆçš„åšå®¢æ–‡ä»¶éƒ¨ç½²åˆ° github mainåˆ†æ”¯ï¼ŒHexoåšå®¢é¡¹ç›®é…ç½®æ–‡ä»¶ä¸­_config.ymlå·²è®¾ç½®å¥½\n```\n\n# 6.é‡åˆ°çš„é—®é¢˜\n\n## é—®é¢˜1.nodejsç‰ˆæœ¬è¿‡ä½\n\nnpm WARN notsup Unsupported engine for hexo@6.3.0: wanted: {\"node\":\">=12.13.0\"} (current: {\"node\":\"10.19.0\",\"npm\":\"6.14.4\"})\nnpm WARN notsup Not compatible with your version of node/npm: hexo@6.3.0\nnpm WARN notsup Unsupported engine for hexo-front-matter@3.0.0: wanted: {\"node\":\">=12.13.0\"} (current: {\"node\":\"10.19.0\",\"npm\":\"6.14.4\"})\nnpm WARN notsup Not compatible with your version of node/npm: hexo-front-matter@3.0.0\nnpm WARN notsup Unsupported engine for hexo-cli@4.3.1: wanted: {\"node\":\">=14\"} (current: {\"node\":\"10.19.0\",\"npm\":\"6.14.4\"})\nnpm WARN notsup Not compatible with your version of node/npm: hexo-cli@4.3.1\nnpm WARN notsup Unsupported engine for hexo-log@3.2.0: wanted: {\"node\":\">=12.4.0\"} (current: {\"node\":\"10.19.0\",\"npm\":\"6.14.4\"})\nnpm WARN notsup Not compatible with your version of node/npm: hexo-log@3.2.0\nnpm WARN notsup Unsupported engine for abbrev@2.0.0: wanted: {\"node\":\"^14.17.0 || ^16.13.0 || >=18.0.0\"} (current: {\"node\":\"10.19.0\",\"npm\":\"6.14.4\"})\nnpm WARN notsup Not compatible with your version of node/npm: abbrev@2.0.0\nnpm WARN notsup Unsupported engine for hexo-fs@4.1.1: wanted: {\"node\":\">=14\"} (current: {\"node\":\"10.19.0\",\"npm\":\"6.14.4\"})\nnpm WARN notsup Not compatible with your version of node/npm: hexo-fs@4.1.1\nnpm WARN notsup Unsupported engine for hexo-log@4.1.0: wanted: {\"node\":\">=14\"} (current: {\"node\":\"10.19.0\",\"npm\":\"6.14.4\"})\nnpm WARN notsup Not compatible with your version of node/npm: hexo-log@4.1.0\nnpm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@2.3.3 (node_modules/fsevents):\nnpm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for fsevents@2.3.3: wanted {\"os\":\"darwin\",\"arch\":\"any\"} (current: {\"os\":\"linux\",\"arch\":\"x64\"})\n\n## å‡çº§nodejs\n\n```\nwget -qO- https://raw.githubusercontent.com/nvm-sh/nvm/v0.38.0/install.sh | bash         #å®‰è£… nvm\nsource ~/.bashrc            #åŠ è½½ nvm\nnvm install node            #ä½¿ç”¨ nvm å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ Node.js\nnode -v                     #éªŒè¯ Node.js ç‰ˆæœ¬\n```\n\n\n\n\n\n## é—®é¢˜2.hexoåšå®¢å›¾ç‰‡ä¸æ˜¾ç¤º\n\nhttps://blog.csdn.net/QRLYLETITBE/article/details/127737904 \n\n```\nnpm i hexo-renderer-marked\n\n```\n\n## æ–°å»ºimgsæ–‡ä»¶å¤¹\n\n![image-20230913161638961](../imgs/image-20230913161638961.png)\n\n```\nmarked:\n  prependRoot: true\n  postAsset: true\n\n```\n## ä¿®æ”¹å›¾ç‰‡è·¯å¾„\n\n![image-20230913161842174](../imgs/image-20230913161842174.png)\n","updated":"2024-05-15T06:11:08.981Z","path":"back_posts/Hexoåœ¨å¤šå°ç”µè„‘ä¸Šæäº¤å’Œæ›´æ–°.html","comments":1,"layout":"page","_id":"clw7fflku000cx2w08gypa6ej","content":"<p>[toc]</p>\n<h1 id=\"1-åšå®¢æ­å»º\"><a href=\"#1-åšå®¢æ­å»º\" class=\"headerlink\" title=\"1.åšå®¢æ­å»º\"></a>1.åšå®¢æ­å»º</h1><p><a href=\"https://yyheroi.github.io/2023/08/25/github+hexo%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/\">https://yyheroi.github.io/2023/08/25/github+hexo%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/</a></p>\n<h1 id=\"2-åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¤¹newï¼Œç”¨äºä¸Šä¼ hexoåšå®¢ç›®å½•\"><a href=\"#2-åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¤¹newï¼Œç”¨äºä¸Šä¼ hexoåšå®¢ç›®å½•\" class=\"headerlink\" title=\"2.åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¤¹newï¼Œç”¨äºä¸Šä¼ hexoåšå®¢ç›®å½•\"></a>2.åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¤¹newï¼Œç”¨äºä¸Šä¼ hexoåšå®¢ç›®å½•</h1><p>å°†ä»¥ä¸‹ç›®å½•ï¼ˆé™¤äº†çº¢è‰²æ–¹æ¡†çš„ç›®å½•ï¼‰æ‹·è´åˆ°æ–°ç›®å½•ä¸­</p>\n<p><img src=\"/../imgs/image-20230913154437526.png\" alt=\"image-20230913154437526\"></p>\n<p>å‚è€ƒï¼š<a href=\"https://blog.csdn.net/K1052176873/article/details/122879462\">https://blog.csdn.net/K1052176873/article/details/122879462</a> </p>\n<h1 id=\"3-githubä¸Šåˆ›å»ºhexoåˆ†æ”¯å¹¶è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯\"><a href=\"#3-githubä¸Šåˆ›å»ºhexoåˆ†æ”¯å¹¶è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯\" class=\"headerlink\" title=\"3.githubä¸Šåˆ›å»ºhexoåˆ†æ”¯å¹¶è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯\"></a>3.githubä¸Šåˆ›å»ºhexoåˆ†æ”¯å¹¶è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯</h1><h2 id=\"åˆ›å»ºhexoåˆ†æ”¯\"><a href=\"#åˆ›å»ºhexoåˆ†æ”¯\" class=\"headerlink\" title=\"åˆ›å»ºhexoåˆ†æ”¯\"></a>åˆ›å»ºhexoåˆ†æ”¯</h2><p><img src=\"/../imgs/image-20230913154510439.png\" alt=\"image-20230913154510439\"></p>\n<h2 id=\"å°†hexoåˆ†æ”¯è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯\"><a href=\"#å°†hexoåˆ†æ”¯è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯\" class=\"headerlink\" title=\"å°†hexoåˆ†æ”¯è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯\"></a>å°†hexoåˆ†æ”¯è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯</h2><p><img src=\"/../imgs/image-20230913154524492.png\" alt=\"image-20230913154524492\"></p>\n<h1 id=\"4-è¿›å…¥æ–°å»ºçš„æ–‡ä»¶å¤¹ä¸­git-cloneï¼Œå†ä¸Šä¼ ç›¸å…³æ–‡ä»¶è‡³hexoåˆ†æ”¯\"><a href=\"#4-è¿›å…¥æ–°å»ºçš„æ–‡ä»¶å¤¹ä¸­git-cloneï¼Œå†ä¸Šä¼ ç›¸å…³æ–‡ä»¶è‡³hexoåˆ†æ”¯\" class=\"headerlink\" title=\"4.è¿›å…¥æ–°å»ºçš„æ–‡ä»¶å¤¹ä¸­git cloneï¼Œå†ä¸Šä¼ ç›¸å…³æ–‡ä»¶è‡³hexoåˆ†æ”¯\"></a>4.è¿›å…¥æ–°å»ºçš„æ–‡ä»¶å¤¹ä¸­git cloneï¼Œå†ä¸Šä¼ ç›¸å…³æ–‡ä»¶è‡³hexoåˆ†æ”¯</h1><p>åŸºæœ¬åŸç†ï¼šgithubä»“åº“å¼€ä¸¤ä¸ªåˆ†æ”¯ï¼Œmainåˆ†æ”¯å­˜æ”¾çš„æ˜¯hexoç”Ÿæˆçš„é™æ€é¡µé¢ï¼Œhexoåˆ†æ”¯å­˜æ”¾åŸºæœ¬çš„ Hexo åšå®¢é¡¹ç›®çš„ç»“æ„å’Œé»˜è®¤é…ç½®æ–‡ä»¶ï¼Œå¦‚æ–‡ç« ï¼Œä¸»é¢˜<br>å½“éœ€è¦é‡æ–°æ­å»ºç¯å¢ƒæ—¶ï¼Œç›´æ¥æ‹‰å–hexoåˆ†æ”¯ä¸­Hexoåšå®¢ç›®å½•ä»¥åŠç›¸å…³é…ç½®æ–‡ä»¶ï¼Œå½“éœ€è¦æ›´æ–°åšå®¢æ—¶ç›´æ¥</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd new</span><br><span class=\"line\">git clone git@github.com:&lt;username&gt;/&lt;username&gt;.github.io.git #&lt;username&gt; ç”¨æˆ·å</span><br><span class=\"line\">git branch    #æŸ¥çœ‹åˆ†æ”¯ï¼Œæ˜¾ç¤º * hexo</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"1-cloneä¸‹æ¥çš„æ–‡ä»¶å¤¹å†…åº”è¯¥æœ‰ä¸ª-gitignoreæ–‡ä»¶ï¼Œç”¨æ¥å¿½ç•¥ä¸€äº›ä¸éœ€è¦çš„æ–‡ä»¶ï¼Œè¡¨ç¤ºè¿™äº›ç±»å‹æ–‡ä»¶ä¸éœ€è¦gitã€‚å¦‚æœæ²¡æœ‰ï¼Œå³é”®æ–°å»ºï¼Œå†…å®¹å¦‚ä¸‹ï¼š\"><a href=\"#1-cloneä¸‹æ¥çš„æ–‡ä»¶å¤¹å†…åº”è¯¥æœ‰ä¸ª-gitignoreæ–‡ä»¶ï¼Œç”¨æ¥å¿½ç•¥ä¸€äº›ä¸éœ€è¦çš„æ–‡ä»¶ï¼Œè¡¨ç¤ºè¿™äº›ç±»å‹æ–‡ä»¶ä¸éœ€è¦gitã€‚å¦‚æœæ²¡æœ‰ï¼Œå³é”®æ–°å»ºï¼Œå†…å®¹å¦‚ä¸‹ï¼š\" class=\"headerlink\" title=\"1.cloneä¸‹æ¥çš„æ–‡ä»¶å¤¹å†…åº”è¯¥æœ‰ä¸ª.gitignoreæ–‡ä»¶ï¼Œç”¨æ¥å¿½ç•¥ä¸€äº›ä¸éœ€è¦çš„æ–‡ä»¶ï¼Œè¡¨ç¤ºè¿™äº›ç±»å‹æ–‡ä»¶ä¸éœ€è¦gitã€‚å¦‚æœæ²¡æœ‰ï¼Œå³é”®æ–°å»ºï¼Œå†…å®¹å¦‚ä¸‹ï¼š\"></a>1.cloneä¸‹æ¥çš„æ–‡ä»¶å¤¹å†…åº”è¯¥æœ‰ä¸ª.gitignoreæ–‡ä»¶ï¼Œç”¨æ¥å¿½ç•¥ä¸€äº›ä¸éœ€è¦çš„æ–‡ä»¶ï¼Œè¡¨ç¤ºè¿™äº›ç±»å‹æ–‡ä»¶ä¸éœ€è¦gitã€‚å¦‚æœæ²¡æœ‰ï¼Œå³é”®æ–°å»ºï¼Œå†…å®¹å¦‚ä¸‹ï¼š</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.DS_Store</span><br><span class=\"line\">Thumbs.db</span><br><span class=\"line\">db.json</span><br><span class=\"line\">*.log</span><br><span class=\"line\">node_modules/</span><br><span class=\"line\">public/</span><br><span class=\"line\">.deploy*/</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2-å¦‚æœå·²ç»cloneè¿‡ä¸»é¢˜æ–‡ä»¶ï¼Œé‚£ä¹ˆéœ€è¦æŠŠthemeä¸»é¢˜æ–‡ä»¶å¤¹é‡Œçš„-git-ä¹Ÿåˆ é™¤ï¼Œæˆ‘è¿™é‡Œå·²ç»åˆ é™¤äº†themeä¸»é¢˜çš„-gitç›®å½•\"><a href=\"#2-å¦‚æœå·²ç»cloneè¿‡ä¸»é¢˜æ–‡ä»¶ï¼Œé‚£ä¹ˆéœ€è¦æŠŠthemeä¸»é¢˜æ–‡ä»¶å¤¹é‡Œçš„-git-ä¹Ÿåˆ é™¤ï¼Œæˆ‘è¿™é‡Œå·²ç»åˆ é™¤äº†themeä¸»é¢˜çš„-gitç›®å½•\" class=\"headerlink\" title=\"2.å¦‚æœå·²ç»cloneè¿‡ä¸»é¢˜æ–‡ä»¶ï¼Œé‚£ä¹ˆéœ€è¦æŠŠthemeä¸»é¢˜æ–‡ä»¶å¤¹é‡Œçš„ .git ä¹Ÿåˆ é™¤ï¼Œæˆ‘è¿™é‡Œå·²ç»åˆ é™¤äº†themeä¸»é¢˜çš„.gitç›®å½•\"></a>2.å¦‚æœå·²ç»cloneè¿‡ä¸»é¢˜æ–‡ä»¶ï¼Œé‚£ä¹ˆéœ€è¦æŠŠthemeä¸»é¢˜æ–‡ä»¶å¤¹é‡Œçš„ .git ä¹Ÿåˆ é™¤ï¼Œæˆ‘è¿™é‡Œå·²ç»åˆ é™¤äº†themeä¸»é¢˜çš„.gitç›®å½•</h2><p><img src=\"/../imgs/image-20230913154559571.png\" alt=\"image-20230913154559571\"></p>\n<h2 id=\"3-é€newç›®å½•ä¸­çš„ç›¸å…³æ–‡ä»¶åˆ°è¿œç¨‹ä»“åº“-hexoåˆ†æ”¯\"><a href=\"#3-é€newç›®å½•ä¸­çš„ç›¸å…³æ–‡ä»¶åˆ°è¿œç¨‹ä»“åº“-hexoåˆ†æ”¯\" class=\"headerlink\" title=\"3.é€newç›®å½•ä¸­çš„ç›¸å…³æ–‡ä»¶åˆ°è¿œç¨‹ä»“åº“ hexoåˆ†æ”¯\"></a>3.é€newç›®å½•ä¸­çš„ç›¸å…³æ–‡ä»¶åˆ°è¿œç¨‹ä»“åº“ hexoåˆ†æ”¯</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git add .</span><br><span class=\"line\">git commit â€“m add_branch</span><br><span class=\"line\">git push        </span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"5-ï¼æ–°ç¯å¢ƒä¸­å¿«é€Ÿæ­å»ºåšå®¢ç¯å¢ƒï¼\"><a href=\"#5-ï¼æ–°ç¯å¢ƒä¸­å¿«é€Ÿæ­å»ºåšå®¢ç¯å¢ƒï¼\" class=\"headerlink\" title=\"5.ï¼æ–°ç¯å¢ƒä¸­å¿«é€Ÿæ­å»ºåšå®¢ç¯å¢ƒï¼\"></a>5.ï¼æ–°ç¯å¢ƒä¸­å¿«é€Ÿæ­å»ºåšå®¢ç¯å¢ƒï¼</h1><h2 id=\"1-è®¾ç½®ssh\"><a href=\"#1-è®¾ç½®ssh\" class=\"headerlink\" title=\"1.è®¾ç½®ssh\"></a>1.è®¾ç½®ssh</h2><p>å‚è€ƒï¼š<a href=\"https://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent\">https://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent</a></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t ed25519 -C &quot;your_email@gmail.com&quot;</span><br><span class=\"line\">cat ~/.ssh/id_ed25519.pub  #å°†é‡Œé¢çš„å†…å®¹å¤åˆ¶åˆ° github -&gt;settings -&gt;SSH and GPC keys -&gt;SSH keys -&gt;New SSH keyä¸­</span><br><span class=\"line\">ssh -T git@github.com  #è¾“å…¥yesä¹‹åï¼Œè¡Œæœ«å°¾ä¼šæ˜¾ç¤ºä½ çš„ç”¨æˆ·åï¼ˆç»‘å®šæˆåŠŸé‚®ç®±ä¼šæ”¶åˆ°é‚®ä»¶æé†’ï¼‰</span><br><span class=\"line\">#æ¥ç€åœ¨æœ¬åœ°ç»‘å®šä¸Githubçš„ç”¨æˆ·åå’Œé‚®ç®±ï¼ˆgitï¼‰</span><br><span class=\"line\">git config --global user.name &quot;&lt;username&gt;&quot;    #è‡ªå·±çš„ç”¨æˆ·å</span><br><span class=\"line\">git config --global user.email &#x27;xxx@xxx.com&#x27;  #è‡ªå·±çš„é‚®ç®±</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2-å®‰è£…nodejså’Œhexo\"><a href=\"#2-å®‰è£…nodejså’Œhexo\" class=\"headerlink\" title=\"2.å®‰è£…nodejså’Œhexo\"></a>2.å®‰è£…nodejså’Œhexo</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt update</span><br><span class=\"line\">sudo apt-get install git</span><br><span class=\"line\"></span><br><span class=\"line\">sudo apt install nodejs</span><br><span class=\"line\">sudo apt install npm  </span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3-æ‹‰å–hexoåšå®¢ç›®å½•\"><a href=\"#3-æ‹‰å–hexoåšå®¢ç›®å½•\" class=\"headerlink\" title=\"3.æ‹‰å–hexoåšå®¢ç›®å½•\"></a>3.æ‹‰å–hexoåšå®¢ç›®å½•</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git clone git@github.com:&lt;username&gt;/&lt;username&gt;.github.io.git #&lt;username&gt; ç”¨æˆ·å</span><br><span class=\"line\">git branch    #æŸ¥çœ‹åˆ†æ”¯ï¼Œæ˜¾ç¤º * hexo</span><br><span class=\"line\">npm install hexo</span><br><span class=\"line\">npm install</span><br><span class=\"line\">npm install hexo-deployer-git        #ä¸éœ€è¦hexo initè¿™æ¡æŒ‡ä»¤</span><br><span class=\"line\">npm i hexo-renderer-marked</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">#æ›´æ–°åšå®¢ æ·»åŠ æ–°æ–‡ç«  hello-world</span><br><span class=\"line\">hexo new &quot;hello-world&quot;</span><br><span class=\"line\">git add .        #å°†æ–‡ç« å¤‡ä»½è‡³ hexoåˆ†æ”¯  æˆ–è€…git add source/_posts/hello-world </span><br><span class=\"line\">git commit â€“m &quot;hello-world&quot;</span><br><span class=\"line\">git push         #æˆ–è€…git push origin hexo</span><br><span class=\"line\"></span><br><span class=\"line\">hexo g        #ç”Ÿæˆé™æ€é¡µé¢</span><br><span class=\"line\">hexo s        #å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨ é¢„è§ˆ</span><br><span class=\"line\">hexo d        #å°†ç”Ÿæˆçš„åšå®¢æ–‡ä»¶éƒ¨ç½²åˆ° github mainåˆ†æ”¯ï¼ŒHexoåšå®¢é¡¹ç›®é…ç½®æ–‡ä»¶ä¸­_config.ymlå·²è®¾ç½®å¥½</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"6-é‡åˆ°çš„é—®é¢˜\"><a href=\"#6-é‡åˆ°çš„é—®é¢˜\" class=\"headerlink\" title=\"6.é‡åˆ°çš„é—®é¢˜\"></a>6.é‡åˆ°çš„é—®é¢˜</h1><h2 id=\"é—®é¢˜1-nodejsç‰ˆæœ¬è¿‡ä½\"><a href=\"#é—®é¢˜1-nodejsç‰ˆæœ¬è¿‡ä½\" class=\"headerlink\" title=\"é—®é¢˜1.nodejsç‰ˆæœ¬è¿‡ä½\"></a>é—®é¢˜1.nodejsç‰ˆæœ¬è¿‡ä½</h2><p>npm WARN notsup Unsupported engine for <a href=\"mailto:&#x68;&#x65;&#x78;&#x6f;&#64;&#x36;&#46;&#51;&#x2e;&#48;\">&#x68;&#x65;&#x78;&#x6f;&#64;&#x36;&#46;&#51;&#x2e;&#48;</a>: wanted: {â€œnodeâ€:â€&gt;&#x3D;12.13.0â€} (current: {â€œnodeâ€:â€10.19.0â€,â€npmâ€:â€6.14.4â€})<br>npm WARN notsup Not compatible with your version of node&#x2F;npm: <a href=\"mailto:&#x68;&#101;&#x78;&#x6f;&#x40;&#54;&#46;&#x33;&#x2e;&#x30;\">&#x68;&#101;&#x78;&#x6f;&#x40;&#54;&#46;&#x33;&#x2e;&#x30;</a><br>npm WARN notsup Unsupported engine for <a href=\"mailto:&#x68;&#101;&#120;&#111;&#45;&#102;&#114;&#111;&#x6e;&#116;&#x2d;&#109;&#x61;&#116;&#x74;&#x65;&#114;&#64;&#x33;&#x2e;&#x30;&#46;&#x30;\">&#x68;&#101;&#120;&#111;&#45;&#102;&#114;&#111;&#x6e;&#116;&#x2d;&#109;&#x61;&#116;&#x74;&#x65;&#114;&#64;&#x33;&#x2e;&#x30;&#46;&#x30;</a>: wanted: {â€œnodeâ€:â€&gt;&#x3D;12.13.0â€} (current: {â€œnodeâ€:â€10.19.0â€,â€npmâ€:â€6.14.4â€})<br>npm WARN notsup Not compatible with your version of node&#x2F;npm: <a href=\"mailto:&#x68;&#x65;&#120;&#111;&#x2d;&#x66;&#114;&#x6f;&#x6e;&#x74;&#x2d;&#109;&#97;&#116;&#x74;&#101;&#114;&#x40;&#x33;&#x2e;&#x30;&#x2e;&#x30;\">&#x68;&#x65;&#120;&#111;&#x2d;&#x66;&#114;&#x6f;&#x6e;&#x74;&#x2d;&#109;&#97;&#116;&#x74;&#101;&#114;&#x40;&#x33;&#x2e;&#x30;&#x2e;&#x30;</a><br>npm WARN notsup Unsupported engine for <a href=\"mailto:&#104;&#x65;&#120;&#x6f;&#45;&#99;&#108;&#105;&#x40;&#52;&#x2e;&#51;&#x2e;&#x31;\">&#104;&#x65;&#120;&#x6f;&#45;&#99;&#108;&#105;&#x40;&#52;&#x2e;&#51;&#x2e;&#x31;</a>: wanted: {â€œnodeâ€:â€&gt;&#x3D;14â€} (current: {â€œnodeâ€:â€10.19.0â€,â€npmâ€:â€6.14.4â€})<br>npm WARN notsup Not compatible with your version of node&#x2F;npm: <a href=\"mailto:&#x68;&#x65;&#x78;&#x6f;&#45;&#99;&#x6c;&#x69;&#x40;&#x34;&#x2e;&#51;&#x2e;&#x31;\">&#x68;&#x65;&#x78;&#x6f;&#45;&#99;&#x6c;&#x69;&#x40;&#x34;&#x2e;&#51;&#x2e;&#x31;</a><br>npm WARN notsup Unsupported engine for <a href=\"mailto:&#x68;&#x65;&#120;&#x6f;&#45;&#x6c;&#x6f;&#x67;&#x40;&#x33;&#46;&#x32;&#46;&#48;\">&#x68;&#x65;&#120;&#x6f;&#45;&#x6c;&#x6f;&#x67;&#x40;&#x33;&#46;&#x32;&#46;&#48;</a>: wanted: {â€œnodeâ€:â€&gt;&#x3D;12.4.0â€} (current: {â€œnodeâ€:â€10.19.0â€,â€npmâ€:â€6.14.4â€})<br>npm WARN notsup Not compatible with your version of node&#x2F;npm: <a href=\"mailto:&#104;&#x65;&#x78;&#111;&#x2d;&#108;&#111;&#103;&#x40;&#x33;&#x2e;&#x32;&#46;&#x30;\">&#104;&#x65;&#x78;&#111;&#x2d;&#108;&#111;&#103;&#x40;&#x33;&#x2e;&#x32;&#46;&#x30;</a><br>npm WARN notsup Unsupported engine for <a href=\"mailto:&#x61;&#x62;&#x62;&#114;&#101;&#118;&#64;&#50;&#x2e;&#x30;&#46;&#x30;\">&#x61;&#x62;&#x62;&#114;&#101;&#118;&#64;&#50;&#x2e;&#x30;&#46;&#x30;</a>: wanted: {â€œnodeâ€:â€^14.17.0 || ^16.13.0 || &gt;&#x3D;18.0.0â€} (current: {â€œnodeâ€:â€10.19.0â€,â€npmâ€:â€6.14.4â€})<br>npm WARN notsup Not compatible with your version of node&#x2F;npm: <a href=\"mailto:&#97;&#98;&#x62;&#114;&#101;&#x76;&#x40;&#50;&#46;&#x30;&#46;&#48;\">&#97;&#98;&#x62;&#114;&#101;&#x76;&#x40;&#50;&#46;&#x30;&#46;&#48;</a><br>npm WARN notsup Unsupported engine for <a href=\"mailto:&#104;&#101;&#120;&#x6f;&#45;&#x66;&#x73;&#x40;&#x34;&#x2e;&#x31;&#x2e;&#x31;\">&#104;&#101;&#120;&#x6f;&#45;&#x66;&#x73;&#x40;&#x34;&#x2e;&#x31;&#x2e;&#x31;</a>: wanted: {â€œnodeâ€:â€&gt;&#x3D;14â€} (current: {â€œnodeâ€:â€10.19.0â€,â€npmâ€:â€6.14.4â€})<br>npm WARN notsup Not compatible with your version of node&#x2F;npm: <a href=\"mailto:&#x68;&#101;&#x78;&#111;&#x2d;&#102;&#x73;&#64;&#x34;&#46;&#49;&#46;&#49;\">&#x68;&#101;&#x78;&#111;&#x2d;&#102;&#x73;&#64;&#x34;&#46;&#49;&#46;&#49;</a><br>npm WARN notsup Unsupported engine for <a href=\"mailto:&#x68;&#x65;&#x78;&#111;&#x2d;&#108;&#x6f;&#x67;&#64;&#52;&#46;&#x31;&#46;&#48;\">&#x68;&#x65;&#x78;&#111;&#x2d;&#108;&#x6f;&#x67;&#64;&#52;&#46;&#x31;&#46;&#48;</a>: wanted: {â€œnodeâ€:â€&gt;&#x3D;14â€} (current: {â€œnodeâ€:â€10.19.0â€,â€npmâ€:â€6.14.4â€})<br>npm WARN notsup Not compatible with your version of node&#x2F;npm: <a href=\"mailto:&#104;&#x65;&#120;&#111;&#x2d;&#x6c;&#111;&#103;&#x40;&#52;&#46;&#x31;&#x2e;&#48;\">&#104;&#x65;&#120;&#111;&#x2d;&#x6c;&#111;&#103;&#x40;&#52;&#46;&#x31;&#x2e;&#48;</a><br>npm WARN optional SKIPPING OPTIONAL DEPENDENCY: <a href=\"mailto:&#102;&#x73;&#x65;&#118;&#x65;&#x6e;&#x74;&#x73;&#64;&#x32;&#x2e;&#51;&#46;&#x33;\">&#102;&#x73;&#x65;&#118;&#x65;&#x6e;&#x74;&#x73;&#64;&#x32;&#x2e;&#51;&#46;&#x33;</a> (node_modules&#x2F;fsevents):<br>npm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for <a href=\"mailto:&#102;&#x73;&#101;&#118;&#101;&#x6e;&#x74;&#115;&#x40;&#x32;&#46;&#51;&#x2e;&#51;\">&#102;&#x73;&#101;&#118;&#101;&#x6e;&#x74;&#115;&#x40;&#x32;&#46;&#51;&#x2e;&#51;</a>: wanted {â€œosâ€:â€darwinâ€,â€archâ€:â€anyâ€} (current: {â€œosâ€:â€linuxâ€,â€archâ€:â€x64â€})</p>\n<h2 id=\"å‡çº§nodejs\"><a href=\"#å‡çº§nodejs\" class=\"headerlink\" title=\"å‡çº§nodejs\"></a>å‡çº§nodejs</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget -qO- https://raw.githubusercontent.com/nvm-sh/nvm/v0.38.0/install.sh | bash         #å®‰è£… nvm</span><br><span class=\"line\">source ~/.bashrc            #åŠ è½½ nvm</span><br><span class=\"line\">nvm install node            #ä½¿ç”¨ nvm å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ Node.js</span><br><span class=\"line\">node -v                     #éªŒè¯ Node.js ç‰ˆæœ¬</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<h2 id=\"é—®é¢˜2-hexoåšå®¢å›¾ç‰‡ä¸æ˜¾ç¤º\"><a href=\"#é—®é¢˜2-hexoåšå®¢å›¾ç‰‡ä¸æ˜¾ç¤º\" class=\"headerlink\" title=\"é—®é¢˜2.hexoåšå®¢å›¾ç‰‡ä¸æ˜¾ç¤º\"></a>é—®é¢˜2.hexoåšå®¢å›¾ç‰‡ä¸æ˜¾ç¤º</h2><p><a href=\"https://blog.csdn.net/QRLYLETITBE/article/details/127737904\">https://blog.csdn.net/QRLYLETITBE/article/details/127737904</a> </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i hexo-renderer-marked</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"æ–°å»ºimgsæ–‡ä»¶å¤¹\"><a href=\"#æ–°å»ºimgsæ–‡ä»¶å¤¹\" class=\"headerlink\" title=\"æ–°å»ºimgsæ–‡ä»¶å¤¹\"></a>æ–°å»ºimgsæ–‡ä»¶å¤¹</h2><p><img src=\"/../imgs/image-20230913161638961.png\" alt=\"image-20230913161638961\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">marked:</span><br><span class=\"line\">  prependRoot: true</span><br><span class=\"line\">  postAsset: true</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h2 id=\"ä¿®æ”¹å›¾ç‰‡è·¯å¾„\"><a href=\"#ä¿®æ”¹å›¾ç‰‡è·¯å¾„\" class=\"headerlink\" title=\"ä¿®æ”¹å›¾ç‰‡è·¯å¾„\"></a>ä¿®æ”¹å›¾ç‰‡è·¯å¾„</h2><p><img src=\"/../imgs/image-20230913161842174.png\" alt=\"image-20230913161842174\"></p>\n","site":{"data":{}},"excerpt":"","more":"<p>[toc]</p>\n<h1 id=\"1-åšå®¢æ­å»º\"><a href=\"#1-åšå®¢æ­å»º\" class=\"headerlink\" title=\"1.åšå®¢æ­å»º\"></a>1.åšå®¢æ­å»º</h1><p><a href=\"https://yyheroi.github.io/2023/08/25/github+hexo%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/\">https://yyheroi.github.io/2023/08/25/github+hexo%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/</a></p>\n<h1 id=\"2-åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¤¹newï¼Œç”¨äºä¸Šä¼ hexoåšå®¢ç›®å½•\"><a href=\"#2-åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¤¹newï¼Œç”¨äºä¸Šä¼ hexoåšå®¢ç›®å½•\" class=\"headerlink\" title=\"2.åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¤¹newï¼Œç”¨äºä¸Šä¼ hexoåšå®¢ç›®å½•\"></a>2.åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¤¹newï¼Œç”¨äºä¸Šä¼ hexoåšå®¢ç›®å½•</h1><p>å°†ä»¥ä¸‹ç›®å½•ï¼ˆé™¤äº†çº¢è‰²æ–¹æ¡†çš„ç›®å½•ï¼‰æ‹·è´åˆ°æ–°ç›®å½•ä¸­</p>\n<p><img src=\"/../imgs/image-20230913154437526.png\" alt=\"image-20230913154437526\"></p>\n<p>å‚è€ƒï¼š<a href=\"https://blog.csdn.net/K1052176873/article/details/122879462\">https://blog.csdn.net/K1052176873/article/details/122879462</a> </p>\n<h1 id=\"3-githubä¸Šåˆ›å»ºhexoåˆ†æ”¯å¹¶è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯\"><a href=\"#3-githubä¸Šåˆ›å»ºhexoåˆ†æ”¯å¹¶è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯\" class=\"headerlink\" title=\"3.githubä¸Šåˆ›å»ºhexoåˆ†æ”¯å¹¶è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯\"></a>3.githubä¸Šåˆ›å»ºhexoåˆ†æ”¯å¹¶è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯</h1><h2 id=\"åˆ›å»ºhexoåˆ†æ”¯\"><a href=\"#åˆ›å»ºhexoåˆ†æ”¯\" class=\"headerlink\" title=\"åˆ›å»ºhexoåˆ†æ”¯\"></a>åˆ›å»ºhexoåˆ†æ”¯</h2><p><img src=\"/../imgs/image-20230913154510439.png\" alt=\"image-20230913154510439\"></p>\n<h2 id=\"å°†hexoåˆ†æ”¯è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯\"><a href=\"#å°†hexoåˆ†æ”¯è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯\" class=\"headerlink\" title=\"å°†hexoåˆ†æ”¯è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯\"></a>å°†hexoåˆ†æ”¯è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯</h2><p><img src=\"/../imgs/image-20230913154524492.png\" alt=\"image-20230913154524492\"></p>\n<h1 id=\"4-è¿›å…¥æ–°å»ºçš„æ–‡ä»¶å¤¹ä¸­git-cloneï¼Œå†ä¸Šä¼ ç›¸å…³æ–‡ä»¶è‡³hexoåˆ†æ”¯\"><a href=\"#4-è¿›å…¥æ–°å»ºçš„æ–‡ä»¶å¤¹ä¸­git-cloneï¼Œå†ä¸Šä¼ ç›¸å…³æ–‡ä»¶è‡³hexoåˆ†æ”¯\" class=\"headerlink\" title=\"4.è¿›å…¥æ–°å»ºçš„æ–‡ä»¶å¤¹ä¸­git cloneï¼Œå†ä¸Šä¼ ç›¸å…³æ–‡ä»¶è‡³hexoåˆ†æ”¯\"></a>4.è¿›å…¥æ–°å»ºçš„æ–‡ä»¶å¤¹ä¸­git cloneï¼Œå†ä¸Šä¼ ç›¸å…³æ–‡ä»¶è‡³hexoåˆ†æ”¯</h1><p>åŸºæœ¬åŸç†ï¼šgithubä»“åº“å¼€ä¸¤ä¸ªåˆ†æ”¯ï¼Œmainåˆ†æ”¯å­˜æ”¾çš„æ˜¯hexoç”Ÿæˆçš„é™æ€é¡µé¢ï¼Œhexoåˆ†æ”¯å­˜æ”¾åŸºæœ¬çš„ Hexo åšå®¢é¡¹ç›®çš„ç»“æ„å’Œé»˜è®¤é…ç½®æ–‡ä»¶ï¼Œå¦‚æ–‡ç« ï¼Œä¸»é¢˜<br>å½“éœ€è¦é‡æ–°æ­å»ºç¯å¢ƒæ—¶ï¼Œç›´æ¥æ‹‰å–hexoåˆ†æ”¯ä¸­Hexoåšå®¢ç›®å½•ä»¥åŠç›¸å…³é…ç½®æ–‡ä»¶ï¼Œå½“éœ€è¦æ›´æ–°åšå®¢æ—¶ç›´æ¥</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd new</span><br><span class=\"line\">git clone git@github.com:&lt;username&gt;/&lt;username&gt;.github.io.git #&lt;username&gt; ç”¨æˆ·å</span><br><span class=\"line\">git branch    #æŸ¥çœ‹åˆ†æ”¯ï¼Œæ˜¾ç¤º * hexo</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"1-cloneä¸‹æ¥çš„æ–‡ä»¶å¤¹å†…åº”è¯¥æœ‰ä¸ª-gitignoreæ–‡ä»¶ï¼Œç”¨æ¥å¿½ç•¥ä¸€äº›ä¸éœ€è¦çš„æ–‡ä»¶ï¼Œè¡¨ç¤ºè¿™äº›ç±»å‹æ–‡ä»¶ä¸éœ€è¦gitã€‚å¦‚æœæ²¡æœ‰ï¼Œå³é”®æ–°å»ºï¼Œå†…å®¹å¦‚ä¸‹ï¼š\"><a href=\"#1-cloneä¸‹æ¥çš„æ–‡ä»¶å¤¹å†…åº”è¯¥æœ‰ä¸ª-gitignoreæ–‡ä»¶ï¼Œç”¨æ¥å¿½ç•¥ä¸€äº›ä¸éœ€è¦çš„æ–‡ä»¶ï¼Œè¡¨ç¤ºè¿™äº›ç±»å‹æ–‡ä»¶ä¸éœ€è¦gitã€‚å¦‚æœæ²¡æœ‰ï¼Œå³é”®æ–°å»ºï¼Œå†…å®¹å¦‚ä¸‹ï¼š\" class=\"headerlink\" title=\"1.cloneä¸‹æ¥çš„æ–‡ä»¶å¤¹å†…åº”è¯¥æœ‰ä¸ª.gitignoreæ–‡ä»¶ï¼Œç”¨æ¥å¿½ç•¥ä¸€äº›ä¸éœ€è¦çš„æ–‡ä»¶ï¼Œè¡¨ç¤ºè¿™äº›ç±»å‹æ–‡ä»¶ä¸éœ€è¦gitã€‚å¦‚æœæ²¡æœ‰ï¼Œå³é”®æ–°å»ºï¼Œå†…å®¹å¦‚ä¸‹ï¼š\"></a>1.cloneä¸‹æ¥çš„æ–‡ä»¶å¤¹å†…åº”è¯¥æœ‰ä¸ª.gitignoreæ–‡ä»¶ï¼Œç”¨æ¥å¿½ç•¥ä¸€äº›ä¸éœ€è¦çš„æ–‡ä»¶ï¼Œè¡¨ç¤ºè¿™äº›ç±»å‹æ–‡ä»¶ä¸éœ€è¦gitã€‚å¦‚æœæ²¡æœ‰ï¼Œå³é”®æ–°å»ºï¼Œå†…å®¹å¦‚ä¸‹ï¼š</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.DS_Store</span><br><span class=\"line\">Thumbs.db</span><br><span class=\"line\">db.json</span><br><span class=\"line\">*.log</span><br><span class=\"line\">node_modules/</span><br><span class=\"line\">public/</span><br><span class=\"line\">.deploy*/</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2-å¦‚æœå·²ç»cloneè¿‡ä¸»é¢˜æ–‡ä»¶ï¼Œé‚£ä¹ˆéœ€è¦æŠŠthemeä¸»é¢˜æ–‡ä»¶å¤¹é‡Œçš„-git-ä¹Ÿåˆ é™¤ï¼Œæˆ‘è¿™é‡Œå·²ç»åˆ é™¤äº†themeä¸»é¢˜çš„-gitç›®å½•\"><a href=\"#2-å¦‚æœå·²ç»cloneè¿‡ä¸»é¢˜æ–‡ä»¶ï¼Œé‚£ä¹ˆéœ€è¦æŠŠthemeä¸»é¢˜æ–‡ä»¶å¤¹é‡Œçš„-git-ä¹Ÿåˆ é™¤ï¼Œæˆ‘è¿™é‡Œå·²ç»åˆ é™¤äº†themeä¸»é¢˜çš„-gitç›®å½•\" class=\"headerlink\" title=\"2.å¦‚æœå·²ç»cloneè¿‡ä¸»é¢˜æ–‡ä»¶ï¼Œé‚£ä¹ˆéœ€è¦æŠŠthemeä¸»é¢˜æ–‡ä»¶å¤¹é‡Œçš„ .git ä¹Ÿåˆ é™¤ï¼Œæˆ‘è¿™é‡Œå·²ç»åˆ é™¤äº†themeä¸»é¢˜çš„.gitç›®å½•\"></a>2.å¦‚æœå·²ç»cloneè¿‡ä¸»é¢˜æ–‡ä»¶ï¼Œé‚£ä¹ˆéœ€è¦æŠŠthemeä¸»é¢˜æ–‡ä»¶å¤¹é‡Œçš„ .git ä¹Ÿåˆ é™¤ï¼Œæˆ‘è¿™é‡Œå·²ç»åˆ é™¤äº†themeä¸»é¢˜çš„.gitç›®å½•</h2><p><img src=\"/../imgs/image-20230913154559571.png\" alt=\"image-20230913154559571\"></p>\n<h2 id=\"3-é€newç›®å½•ä¸­çš„ç›¸å…³æ–‡ä»¶åˆ°è¿œç¨‹ä»“åº“-hexoåˆ†æ”¯\"><a href=\"#3-é€newç›®å½•ä¸­çš„ç›¸å…³æ–‡ä»¶åˆ°è¿œç¨‹ä»“åº“-hexoåˆ†æ”¯\" class=\"headerlink\" title=\"3.é€newç›®å½•ä¸­çš„ç›¸å…³æ–‡ä»¶åˆ°è¿œç¨‹ä»“åº“ hexoåˆ†æ”¯\"></a>3.é€newç›®å½•ä¸­çš„ç›¸å…³æ–‡ä»¶åˆ°è¿œç¨‹ä»“åº“ hexoåˆ†æ”¯</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git add .</span><br><span class=\"line\">git commit â€“m add_branch</span><br><span class=\"line\">git push        </span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"5-ï¼æ–°ç¯å¢ƒä¸­å¿«é€Ÿæ­å»ºåšå®¢ç¯å¢ƒï¼\"><a href=\"#5-ï¼æ–°ç¯å¢ƒä¸­å¿«é€Ÿæ­å»ºåšå®¢ç¯å¢ƒï¼\" class=\"headerlink\" title=\"5.ï¼æ–°ç¯å¢ƒä¸­å¿«é€Ÿæ­å»ºåšå®¢ç¯å¢ƒï¼\"></a>5.ï¼æ–°ç¯å¢ƒä¸­å¿«é€Ÿæ­å»ºåšå®¢ç¯å¢ƒï¼</h1><h2 id=\"1-è®¾ç½®ssh\"><a href=\"#1-è®¾ç½®ssh\" class=\"headerlink\" title=\"1.è®¾ç½®ssh\"></a>1.è®¾ç½®ssh</h2><p>å‚è€ƒï¼š<a href=\"https://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent\">https://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent</a></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t ed25519 -C &quot;your_email@gmail.com&quot;</span><br><span class=\"line\">cat ~/.ssh/id_ed25519.pub  #å°†é‡Œé¢çš„å†…å®¹å¤åˆ¶åˆ° github -&gt;settings -&gt;SSH and GPC keys -&gt;SSH keys -&gt;New SSH keyä¸­</span><br><span class=\"line\">ssh -T git@github.com  #è¾“å…¥yesä¹‹åï¼Œè¡Œæœ«å°¾ä¼šæ˜¾ç¤ºä½ çš„ç”¨æˆ·åï¼ˆç»‘å®šæˆåŠŸé‚®ç®±ä¼šæ”¶åˆ°é‚®ä»¶æé†’ï¼‰</span><br><span class=\"line\">#æ¥ç€åœ¨æœ¬åœ°ç»‘å®šä¸Githubçš„ç”¨æˆ·åå’Œé‚®ç®±ï¼ˆgitï¼‰</span><br><span class=\"line\">git config --global user.name &quot;&lt;username&gt;&quot;    #è‡ªå·±çš„ç”¨æˆ·å</span><br><span class=\"line\">git config --global user.email &#x27;xxx@xxx.com&#x27;  #è‡ªå·±çš„é‚®ç®±</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2-å®‰è£…nodejså’Œhexo\"><a href=\"#2-å®‰è£…nodejså’Œhexo\" class=\"headerlink\" title=\"2.å®‰è£…nodejså’Œhexo\"></a>2.å®‰è£…nodejså’Œhexo</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt update</span><br><span class=\"line\">sudo apt-get install git</span><br><span class=\"line\"></span><br><span class=\"line\">sudo apt install nodejs</span><br><span class=\"line\">sudo apt install npm  </span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3-æ‹‰å–hexoåšå®¢ç›®å½•\"><a href=\"#3-æ‹‰å–hexoåšå®¢ç›®å½•\" class=\"headerlink\" title=\"3.æ‹‰å–hexoåšå®¢ç›®å½•\"></a>3.æ‹‰å–hexoåšå®¢ç›®å½•</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git clone git@github.com:&lt;username&gt;/&lt;username&gt;.github.io.git #&lt;username&gt; ç”¨æˆ·å</span><br><span class=\"line\">git branch    #æŸ¥çœ‹åˆ†æ”¯ï¼Œæ˜¾ç¤º * hexo</span><br><span class=\"line\">npm install hexo</span><br><span class=\"line\">npm install</span><br><span class=\"line\">npm install hexo-deployer-git        #ä¸éœ€è¦hexo initè¿™æ¡æŒ‡ä»¤</span><br><span class=\"line\">npm i hexo-renderer-marked</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">#æ›´æ–°åšå®¢ æ·»åŠ æ–°æ–‡ç«  hello-world</span><br><span class=\"line\">hexo new &quot;hello-world&quot;</span><br><span class=\"line\">git add .        #å°†æ–‡ç« å¤‡ä»½è‡³ hexoåˆ†æ”¯  æˆ–è€…git add source/_posts/hello-world </span><br><span class=\"line\">git commit â€“m &quot;hello-world&quot;</span><br><span class=\"line\">git push         #æˆ–è€…git push origin hexo</span><br><span class=\"line\"></span><br><span class=\"line\">hexo g        #ç”Ÿæˆé™æ€é¡µé¢</span><br><span class=\"line\">hexo s        #å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨ é¢„è§ˆ</span><br><span class=\"line\">hexo d        #å°†ç”Ÿæˆçš„åšå®¢æ–‡ä»¶éƒ¨ç½²åˆ° github mainåˆ†æ”¯ï¼ŒHexoåšå®¢é¡¹ç›®é…ç½®æ–‡ä»¶ä¸­_config.ymlå·²è®¾ç½®å¥½</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"6-é‡åˆ°çš„é—®é¢˜\"><a href=\"#6-é‡åˆ°çš„é—®é¢˜\" class=\"headerlink\" title=\"6.é‡åˆ°çš„é—®é¢˜\"></a>6.é‡åˆ°çš„é—®é¢˜</h1><h2 id=\"é—®é¢˜1-nodejsç‰ˆæœ¬è¿‡ä½\"><a href=\"#é—®é¢˜1-nodejsç‰ˆæœ¬è¿‡ä½\" class=\"headerlink\" title=\"é—®é¢˜1.nodejsç‰ˆæœ¬è¿‡ä½\"></a>é—®é¢˜1.nodejsç‰ˆæœ¬è¿‡ä½</h2><p>npm WARN notsup Unsupported engine for <a href=\"mailto:&#x68;&#x65;&#x78;&#x6f;&#64;&#x36;&#46;&#51;&#x2e;&#48;\">&#x68;&#x65;&#x78;&#x6f;&#64;&#x36;&#46;&#51;&#x2e;&#48;</a>: wanted: {â€œnodeâ€:â€&gt;&#x3D;12.13.0â€} (current: {â€œnodeâ€:â€10.19.0â€,â€npmâ€:â€6.14.4â€})<br>npm WARN notsup Not compatible with your version of node&#x2F;npm: <a href=\"mailto:&#x68;&#101;&#x78;&#x6f;&#x40;&#54;&#46;&#x33;&#x2e;&#x30;\">&#x68;&#101;&#x78;&#x6f;&#x40;&#54;&#46;&#x33;&#x2e;&#x30;</a><br>npm WARN notsup Unsupported engine for <a href=\"mailto:&#x68;&#101;&#120;&#111;&#45;&#102;&#114;&#111;&#x6e;&#116;&#x2d;&#109;&#x61;&#116;&#x74;&#x65;&#114;&#64;&#x33;&#x2e;&#x30;&#46;&#x30;\">&#x68;&#101;&#120;&#111;&#45;&#102;&#114;&#111;&#x6e;&#116;&#x2d;&#109;&#x61;&#116;&#x74;&#x65;&#114;&#64;&#x33;&#x2e;&#x30;&#46;&#x30;</a>: wanted: {â€œnodeâ€:â€&gt;&#x3D;12.13.0â€} (current: {â€œnodeâ€:â€10.19.0â€,â€npmâ€:â€6.14.4â€})<br>npm WARN notsup Not compatible with your version of node&#x2F;npm: <a href=\"mailto:&#x68;&#x65;&#120;&#111;&#x2d;&#x66;&#114;&#x6f;&#x6e;&#x74;&#x2d;&#109;&#97;&#116;&#x74;&#101;&#114;&#x40;&#x33;&#x2e;&#x30;&#x2e;&#x30;\">&#x68;&#x65;&#120;&#111;&#x2d;&#x66;&#114;&#x6f;&#x6e;&#x74;&#x2d;&#109;&#97;&#116;&#x74;&#101;&#114;&#x40;&#x33;&#x2e;&#x30;&#x2e;&#x30;</a><br>npm WARN notsup Unsupported engine for <a href=\"mailto:&#104;&#x65;&#120;&#x6f;&#45;&#99;&#108;&#105;&#x40;&#52;&#x2e;&#51;&#x2e;&#x31;\">&#104;&#x65;&#120;&#x6f;&#45;&#99;&#108;&#105;&#x40;&#52;&#x2e;&#51;&#x2e;&#x31;</a>: wanted: {â€œnodeâ€:â€&gt;&#x3D;14â€} (current: {â€œnodeâ€:â€10.19.0â€,â€npmâ€:â€6.14.4â€})<br>npm WARN notsup Not compatible with your version of node&#x2F;npm: <a href=\"mailto:&#x68;&#x65;&#x78;&#x6f;&#45;&#99;&#x6c;&#x69;&#x40;&#x34;&#x2e;&#51;&#x2e;&#x31;\">&#x68;&#x65;&#x78;&#x6f;&#45;&#99;&#x6c;&#x69;&#x40;&#x34;&#x2e;&#51;&#x2e;&#x31;</a><br>npm WARN notsup Unsupported engine for <a href=\"mailto:&#x68;&#x65;&#120;&#x6f;&#45;&#x6c;&#x6f;&#x67;&#x40;&#x33;&#46;&#x32;&#46;&#48;\">&#x68;&#x65;&#120;&#x6f;&#45;&#x6c;&#x6f;&#x67;&#x40;&#x33;&#46;&#x32;&#46;&#48;</a>: wanted: {â€œnodeâ€:â€&gt;&#x3D;12.4.0â€} (current: {â€œnodeâ€:â€10.19.0â€,â€npmâ€:â€6.14.4â€})<br>npm WARN notsup Not compatible with your version of node&#x2F;npm: <a href=\"mailto:&#104;&#x65;&#x78;&#111;&#x2d;&#108;&#111;&#103;&#x40;&#x33;&#x2e;&#x32;&#46;&#x30;\">&#104;&#x65;&#x78;&#111;&#x2d;&#108;&#111;&#103;&#x40;&#x33;&#x2e;&#x32;&#46;&#x30;</a><br>npm WARN notsup Unsupported engine for <a href=\"mailto:&#x61;&#x62;&#x62;&#114;&#101;&#118;&#64;&#50;&#x2e;&#x30;&#46;&#x30;\">&#x61;&#x62;&#x62;&#114;&#101;&#118;&#64;&#50;&#x2e;&#x30;&#46;&#x30;</a>: wanted: {â€œnodeâ€:â€^14.17.0 || ^16.13.0 || &gt;&#x3D;18.0.0â€} (current: {â€œnodeâ€:â€10.19.0â€,â€npmâ€:â€6.14.4â€})<br>npm WARN notsup Not compatible with your version of node&#x2F;npm: <a href=\"mailto:&#97;&#98;&#x62;&#114;&#101;&#x76;&#x40;&#50;&#46;&#x30;&#46;&#48;\">&#97;&#98;&#x62;&#114;&#101;&#x76;&#x40;&#50;&#46;&#x30;&#46;&#48;</a><br>npm WARN notsup Unsupported engine for <a href=\"mailto:&#104;&#101;&#120;&#x6f;&#45;&#x66;&#x73;&#x40;&#x34;&#x2e;&#x31;&#x2e;&#x31;\">&#104;&#101;&#120;&#x6f;&#45;&#x66;&#x73;&#x40;&#x34;&#x2e;&#x31;&#x2e;&#x31;</a>: wanted: {â€œnodeâ€:â€&gt;&#x3D;14â€} (current: {â€œnodeâ€:â€10.19.0â€,â€npmâ€:â€6.14.4â€})<br>npm WARN notsup Not compatible with your version of node&#x2F;npm: <a href=\"mailto:&#x68;&#101;&#x78;&#111;&#x2d;&#102;&#x73;&#64;&#x34;&#46;&#49;&#46;&#49;\">&#x68;&#101;&#x78;&#111;&#x2d;&#102;&#x73;&#64;&#x34;&#46;&#49;&#46;&#49;</a><br>npm WARN notsup Unsupported engine for <a href=\"mailto:&#x68;&#x65;&#x78;&#111;&#x2d;&#108;&#x6f;&#x67;&#64;&#52;&#46;&#x31;&#46;&#48;\">&#x68;&#x65;&#x78;&#111;&#x2d;&#108;&#x6f;&#x67;&#64;&#52;&#46;&#x31;&#46;&#48;</a>: wanted: {â€œnodeâ€:â€&gt;&#x3D;14â€} (current: {â€œnodeâ€:â€10.19.0â€,â€npmâ€:â€6.14.4â€})<br>npm WARN notsup Not compatible with your version of node&#x2F;npm: <a href=\"mailto:&#104;&#x65;&#120;&#111;&#x2d;&#x6c;&#111;&#103;&#x40;&#52;&#46;&#x31;&#x2e;&#48;\">&#104;&#x65;&#120;&#111;&#x2d;&#x6c;&#111;&#103;&#x40;&#52;&#46;&#x31;&#x2e;&#48;</a><br>npm WARN optional SKIPPING OPTIONAL DEPENDENCY: <a href=\"mailto:&#102;&#x73;&#x65;&#118;&#x65;&#x6e;&#x74;&#x73;&#64;&#x32;&#x2e;&#51;&#46;&#x33;\">&#102;&#x73;&#x65;&#118;&#x65;&#x6e;&#x74;&#x73;&#64;&#x32;&#x2e;&#51;&#46;&#x33;</a> (node_modules&#x2F;fsevents):<br>npm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for <a href=\"mailto:&#102;&#x73;&#101;&#118;&#101;&#x6e;&#x74;&#115;&#x40;&#x32;&#46;&#51;&#x2e;&#51;\">&#102;&#x73;&#101;&#118;&#101;&#x6e;&#x74;&#115;&#x40;&#x32;&#46;&#51;&#x2e;&#51;</a>: wanted {â€œosâ€:â€darwinâ€,â€archâ€:â€anyâ€} (current: {â€œosâ€:â€linuxâ€,â€archâ€:â€x64â€})</p>\n<h2 id=\"å‡çº§nodejs\"><a href=\"#å‡çº§nodejs\" class=\"headerlink\" title=\"å‡çº§nodejs\"></a>å‡çº§nodejs</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget -qO- https://raw.githubusercontent.com/nvm-sh/nvm/v0.38.0/install.sh | bash         #å®‰è£… nvm</span><br><span class=\"line\">source ~/.bashrc            #åŠ è½½ nvm</span><br><span class=\"line\">nvm install node            #ä½¿ç”¨ nvm å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ Node.js</span><br><span class=\"line\">node -v                     #éªŒè¯ Node.js ç‰ˆæœ¬</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<h2 id=\"é—®é¢˜2-hexoåšå®¢å›¾ç‰‡ä¸æ˜¾ç¤º\"><a href=\"#é—®é¢˜2-hexoåšå®¢å›¾ç‰‡ä¸æ˜¾ç¤º\" class=\"headerlink\" title=\"é—®é¢˜2.hexoåšå®¢å›¾ç‰‡ä¸æ˜¾ç¤º\"></a>é—®é¢˜2.hexoåšå®¢å›¾ç‰‡ä¸æ˜¾ç¤º</h2><p><a href=\"https://blog.csdn.net/QRLYLETITBE/article/details/127737904\">https://blog.csdn.net/QRLYLETITBE/article/details/127737904</a> </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i hexo-renderer-marked</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"æ–°å»ºimgsæ–‡ä»¶å¤¹\"><a href=\"#æ–°å»ºimgsæ–‡ä»¶å¤¹\" class=\"headerlink\" title=\"æ–°å»ºimgsæ–‡ä»¶å¤¹\"></a>æ–°å»ºimgsæ–‡ä»¶å¤¹</h2><p><img src=\"/../imgs/image-20230913161638961.png\" alt=\"image-20230913161638961\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">marked:</span><br><span class=\"line\">  prependRoot: true</span><br><span class=\"line\">  postAsset: true</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h2 id=\"ä¿®æ”¹å›¾ç‰‡è·¯å¾„\"><a href=\"#ä¿®æ”¹å›¾ç‰‡è·¯å¾„\" class=\"headerlink\" title=\"ä¿®æ”¹å›¾ç‰‡è·¯å¾„\"></a>ä¿®æ”¹å›¾ç‰‡è·¯å¾„</h2><p><img src=\"/../imgs/image-20230913161842174.png\" alt=\"image-20230913161842174\"></p>\n"},{"title":"00-rustå­¦ä¹ ç½‘ç«™","date":"2023-08-26T08:08:57.000Z","categories":["rust"],"tags":["å­¦ä¹ ç½‘ç«™","rust"],"_content":"\n\n\n# ç›¸å…³ç½‘ç«™\n\n[GitHub-rust](https://github.com/sunface/rust-course)\n\n[å…³äºæœ¬ä¹¦ - Rustè¯­è¨€åœ£ç»(Rust Course)](https://course.rs/about-book.html)\n","source":"back_posts/00-rustå­¦ä¹ ç½‘ç«™.md","raw":"---\ntitle: 00-rustå­¦ä¹ ç½‘ç«™\ndate: 2023-08-26 16:08:57\ncategories:\n- rust\ntags:\n- å­¦ä¹ ç½‘ç«™\n- rust\n---\n\n\n\n# ç›¸å…³ç½‘ç«™\n\n[GitHub-rust](https://github.com/sunface/rust-course)\n\n[å…³äºæœ¬ä¹¦ - Rustè¯­è¨€åœ£ç»(Rust Course)](https://course.rs/about-book.html)\n","updated":"2024-05-15T06:54:20.707Z","path":"back_posts/00-rustå­¦ä¹ ç½‘ç«™.html","_id":"clw7fflku000dx2w0bwyfbvqe","comments":1,"layout":"page","content":"<h1 id=\"ç›¸å…³ç½‘ç«™\"><a href=\"#ç›¸å…³ç½‘ç«™\" class=\"headerlink\" title=\"ç›¸å…³ç½‘ç«™\"></a>ç›¸å…³ç½‘ç«™</h1><p><a href=\"https://github.com/sunface/rust-course\">GitHub-rust</a></p>\n<p><a href=\"https://course.rs/about-book.html\">å…³äºæœ¬ä¹¦ - Rustè¯­è¨€åœ£ç»(Rust Course)</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"ç›¸å…³ç½‘ç«™\"><a href=\"#ç›¸å…³ç½‘ç«™\" class=\"headerlink\" title=\"ç›¸å…³ç½‘ç«™\"></a>ç›¸å…³ç½‘ç«™</h1><p><a href=\"https://github.com/sunface/rust-course\">GitHub-rust</a></p>\n<p><a href=\"https://course.rs/about-book.html\">å…³äºæœ¬ä¹¦ - Rustè¯­è¨€åœ£ç»(Rust Course)</a></p>\n"},{"title":"OSTEP-40-VSFS","date":"2024-05-15T06:40:25.000Z","categories":["OSTEP"],"tags":["vsfs"],"_content":"\nhttps://pages.cs.wisc.edu/~remzi/OSTEP/Chinese/40.pdf\n\nç£ç›˜ä¸Šçš„å“ªäº›ç»“æ„å­˜å‚¨æ–‡ä»¶ç³»ç»Ÿçš„æ•°æ®å’Œå…ƒæ•°æ®ï¼Ÿ\n\nå½“ä¸€ä¸ªè¿›ç¨‹æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ\n\nåœ¨è¯»å–æˆ–å†™å…¥æœŸé—´è®¿é—®å“ªäº›ç£ç›˜ç»“æ„ï¼Ÿ\n","source":"back_posts/OSTEP-40-VSFS.md","raw":"---\ntitle: OSTEP-40-VSFS\ndate: 2024-05-15 14:40:25\ncategories:\n- OSTEP\ntags:\n- vsfs\n---\n\nhttps://pages.cs.wisc.edu/~remzi/OSTEP/Chinese/40.pdf\n\nç£ç›˜ä¸Šçš„å“ªäº›ç»“æ„å­˜å‚¨æ–‡ä»¶ç³»ç»Ÿçš„æ•°æ®å’Œå…ƒæ•°æ®ï¼Ÿ\n\nå½“ä¸€ä¸ªè¿›ç¨‹æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ\n\nåœ¨è¯»å–æˆ–å†™å…¥æœŸé—´è®¿é—®å“ªäº›ç£ç›˜ç»“æ„ï¼Ÿ\n","updated":"2024-05-15T06:54:20.710Z","path":"back_posts/OSTEP-40-VSFS.html","comments":1,"layout":"page","_id":"clw7h6af400007sw0at5heevw","content":"<p><a href=\"https://pages.cs.wisc.edu/~remzi/OSTEP/Chinese/40.pdf\">https://pages.cs.wisc.edu/~remzi/OSTEP/Chinese/40.pdf</a></p>\n<p>ç£ç›˜ä¸Šçš„å“ªäº›ç»“æ„å­˜å‚¨æ–‡ä»¶ç³»ç»Ÿçš„æ•°æ®å’Œå…ƒæ•°æ®ï¼Ÿ</p>\n<p>å½“ä¸€ä¸ªè¿›ç¨‹æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p>\n<p>åœ¨è¯»å–æˆ–å†™å…¥æœŸé—´è®¿é—®å“ªäº›ç£ç›˜ç»“æ„ï¼Ÿ</p>\n","site":{"data":{}},"excerpt":"","more":"<p><a href=\"https://pages.cs.wisc.edu/~remzi/OSTEP/Chinese/40.pdf\">https://pages.cs.wisc.edu/~remzi/OSTEP/Chinese/40.pdf</a></p>\n<p>ç£ç›˜ä¸Šçš„å“ªäº›ç»“æ„å­˜å‚¨æ–‡ä»¶ç³»ç»Ÿçš„æ•°æ®å’Œå…ƒæ•°æ®ï¼Ÿ</p>\n<p>å½“ä¸€ä¸ªè¿›ç¨‹æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p>\n<p>åœ¨è¯»å–æˆ–å†™å…¥æœŸé—´è®¿é—®å“ªäº›ç£ç›˜ç»“æ„ï¼Ÿ</p>\n"},{"title":"linux-block","date":"2024-05-15T06:36:36.000Z","categories":["driver"],"tags":["block"],"_content":"\n# å—è®¾å¤‡é©±åŠ¨\n\n\n\nå—è®¾å¤‡çš„ä¸»è¦ç‰¹ç‚¹æ˜¯ï¼Œcpuå’Œæ€»çº¿è¯»å†™æ•°æ®æ‰€èŠ±æ—¶é—´ä¸ç¡¬ç›˜ç¡¬ä»¶çš„é€Ÿåº¦ä¸åŒ¹é…ã€‚\n","source":"back_posts/linux-block.md","raw":"---\ntitle: linux-block\ndate: 2024-05-15 14:36:36\ncategories:\n- driver\ntags:\n- block\n\n---\n\n# å—è®¾å¤‡é©±åŠ¨\n\n\n\nå—è®¾å¤‡çš„ä¸»è¦ç‰¹ç‚¹æ˜¯ï¼Œcpuå’Œæ€»çº¿è¯»å†™æ•°æ®æ‰€èŠ±æ—¶é—´ä¸ç¡¬ç›˜ç¡¬ä»¶çš„é€Ÿåº¦ä¸åŒ¹é…ã€‚\n","updated":"2024-05-15T06:54:20.713Z","path":"back_posts/linux-block.html","comments":1,"layout":"page","_id":"clw7h6af900017sw089z24j7c","content":"<h1 id=\"å—è®¾å¤‡é©±åŠ¨\"><a href=\"#å—è®¾å¤‡é©±åŠ¨\" class=\"headerlink\" title=\"å—è®¾å¤‡é©±åŠ¨\"></a>å—è®¾å¤‡é©±åŠ¨</h1><p>å—è®¾å¤‡çš„ä¸»è¦ç‰¹ç‚¹æ˜¯ï¼Œcpuå’Œæ€»çº¿è¯»å†™æ•°æ®æ‰€èŠ±æ—¶é—´ä¸ç¡¬ç›˜ç¡¬ä»¶çš„é€Ÿåº¦ä¸åŒ¹é…ã€‚</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"å—è®¾å¤‡é©±åŠ¨\"><a href=\"#å—è®¾å¤‡é©±åŠ¨\" class=\"headerlink\" title=\"å—è®¾å¤‡é©±åŠ¨\"></a>å—è®¾å¤‡é©±åŠ¨</h1><p>å—è®¾å¤‡çš„ä¸»è¦ç‰¹ç‚¹æ˜¯ï¼Œcpuå’Œæ€»çº¿è¯»å†™æ•°æ®æ‰€èŠ±æ—¶é—´ä¸ç¡¬ç›˜ç¡¬ä»¶çš„é€Ÿåº¦ä¸åŒ¹é…ã€‚</p>\n"},{"title":"U-Boot-fdt-GPT","date":"2024-05-15T06:37:05.000Z","categories":["uboot"],"tags":["fdt","GPT","rk3588"],"_content":"\nU-Bootå®˜ç½‘:https://docs.u-boot.org/en/latest/\n\nu-bootå¯åŠ¨æµç¨‹\n\n- æ¿å­ä¸Šç”µä»¥åï¼Œé¦–å…ˆæ‰§è¡Œçš„æ˜¯ROMä¸­çš„ä¸€æ®µå¯åŠ¨ä»£ç ã€‚å¯åŠ¨ä»£ç **æ ¹æ®å¯„å­˜å™¨/å¤–éƒ¨ç®¡è„šé…ç½®**ï¼Œç¡®å®šæ˜¯è¿›å…¥ä¸‹è½½æ¨¡å¼ï¼Œè¿˜æ˜¯ä»æŸä»‹è´¨(Flash/EMMC/SDå¡ç­‰å­˜å‚¨è®¾å¤‡)å¯åŠ¨u-boot\n\n> ROMä¸­çš„ä»£ç æ˜¯å›ºåŒ–çš„ï¼Œæ— æ³•ä¿®æ”¹\n\n# ä¸€ã€ä»‹ç»\n\n> FDTï¼Œflatted device treeï¼Œæ‰å¹³è®¾å¤‡æ ‘ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯å°†éƒ¨åˆ†è®¾å¤‡ä¿¡æ¯ç»“æ„å­˜æ”¾åˆ°device treeæ–‡ä»¶ä¸­ã€‚\n>\n> ubootæœ€ç»ˆå°†å…¶ç¼–è¯‘æˆdtbæ–‡ä»¶ï¼Œä½¿ç”¨è¿‡ç¨‹ä¸­é€šè¿‡è§£æè¯¥dtbæ¥è·å–æ¿çº§è®¾å¤‡ä¿¡æ¯ã€‚  \n\n> U-bootçš„dtbå’Œkernelä¸­çš„dtbæ˜¯ä¸€è‡´çš„ï¼Œæœ‰å…³fdtçš„è¯¦ç»†ä»‹ç»ï¼Œå‚è€ƒdoc/README.fdt-control\n\n### dtbåœ¨U-bootä¸­çš„ä½ç½®\n\n- dtbèƒ½å¤Ÿä»¥ä¸¤ç§å½¢å¼ç¼–è¯‘åˆ°U-bootçš„é•œåƒä¸­\n\n1. dtbå’Œu-bootçš„binæ–‡ä»¶åˆ†ç¦»(imx6qä¸­ä½¿ç”¨çš„è¿™ç§æ–¹å¼ï¼Œåœ¨.configæ–‡ä»¶ä¸­å¯ä»¥æŸ¥çœ‹åˆ°)\n\n> é€šè¿‡CONFIG_OF_SEPARATEå®å®šä¹‰ä½¿èƒ½ï¼Œdtbæœ€åä¼šè¿½åŠ åˆ°u-bootçš„binæ–‡ä»¶çš„æœ€åé¢ï¼Œé€šè¿‡u-bootçš„ç»“æŸåœ°å€ç¬¦å·_endç¬¦å·æ¥è·å–dtbçš„åœ°å€\n\n1. dtbé›†æˆåˆ°u-bootçš„binæ–‡ä»¶å†…éƒ¨\n\n> é€šè¿‡CONFIG_OF_EMBEDå®å®šä¹‰ä½¿èƒ½ï¼Œdtbä¼šä½äºu-bootçš„.dtb.init.rodataæ®µä¸­ï¼Œé€šè¿‡__dtb_dt_beginç¬¦å·æ¥è·å–dtb\n\n1. è·å–dtsæ–‡ä»¶çš„åœ°å€gd->fdt_blob\n\n```\n// å®ç”¨æ¥è¡¨ç¤ºæ˜¯å¦æŠŠdtbæ–‡ä»¶æ”¾åœ¨uboot.binçš„æ–‡ä»¶ä¸­\nCONFIG_OF_EMBED\n\n// å•ç‹¬ç¼–è¯‘dtbæ–‡ä»¶\nCONFIG_OF_SEPARATEï¼Œç¼–è¯‘å‡ºæ¥çš„dtbæ”¾åœ¨uboot.binçš„æœ€åé¢ï¼Œå°±æ˜¯dtbè¿½åŠ åˆ°ubootçš„binæ–‡ä»¶åé¢æ—¶ï¼Œé€šè¿‡_endç¬¦å·æ¥è·å–dtbåœ°å€\n\ngd->fdt_blob = (ulong *)&_end;\n\n// å¯ä»¥é€šè¿‡fdtcontroladdrç¯å¢ƒå˜é‡æ¥æŒ‡å®šfdtçš„åœ°å€\ngd->fdt_blob = (void *)getenv_ulong(\"fdtcontroladdr\", 16,\n\t\t\t\t\t\t(uintptr_t)gd->fdt_blob); \n```\n\n###  dtbè§£ææ¥å£\n\n- å®šä¹‰åœ¨lib/fdtdec.cæ–‡ä»¶ä¸­ï¼ŒèŠ‚ç‚¹å˜é‡nodeä¸­å­˜æ”¾çš„æ˜¯åç§»åœ°å€\n\n```\n// è·å¾—dtbä¸‹æŸä¸ªèŠ‚ç‚¹çš„è·¯å¾„pathçš„åç§»ï¼Œåç§»å°±ä»£è¡¨è¿™ä¸ªèŠ‚ç‚¹\nint fdt_path_offset(const void *fdt, const char *path)\negï¼šnode = fdt_path_offset(gd->fdt_blob, â€œ/aliasesâ€);\n\n// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªå­—ç¬¦ä¸²å±æ€§å€¼\nconst void *fdt_getprop(const void *fdt, int nodeoffset, const char *name, int *lenp)\negï¼š mac = fdt_getprop(gd->fdt_blob, node, â€œmac-addressâ€, &len);\n\n// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ•´å½¢æ•°ç»„å±æ€§å€¼\nint fdtdec_get_int_array(const void *blob, int node, const char *prop_name, u32 *array, int count)\negï¼š ret = fdtdec_get_int_array(blob, node, â€œinterruptsâ€, cell, ARRAY_SIZE(cell));\n\n// è·å¾—èŠ‚ç‚¹nodeçš„åœ°å€å±æ€§å€¼\nfdt_addr_t fdtdec_get_addr(const void *blob, int node, const char *prop_name)\negï¼šfdtdec_get_addr(blob, node, â€œregâ€);\n\n// è·å¾—configèŠ‚ç‚¹ä¸‹çš„æ•´å½¢å±æ€§ã€boolå±æ€§ã€å­—ç¬¦ä¸²ç­‰ç­‰\nfdtdec_get_config_intã€fdtdec_get_config_boolã€fdtdec_get_config_string\n\n// è·å¾—chosenä¸‹çš„nameèŠ‚ç‚¹çš„åç§»\nint fdtdec_get_chosen_node(const void *blob, const char *name)\n\n// è·å¾—chosenä¸‹nameå±æ€§çš„å€¼\nconst char *fdtdec_get_chosen_prop(const void *blob, const char *name)\n```\n\n- å®šä¹‰åœ¨lib/fdtdec_common.cæ–‡ä»¶ä¸­\n\n```\n// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ•´å½¢å±æ€§å€¼\nint fdtdec_get_int(const void *blob, int node, const char *prop_name, int default_val)\negï¼š bus->udelay = fdtdec_get_int(blob, node, â€œi2c-gpio,delay-usâ€, DEFAULT_UDELAY);\n\n// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ— ç¬¦å·æ•´å½¢å±æ€§å€¼\nfdtdec_get_uint\n```\n\n## fdt å‘½ä»¤\n\nå¯¹äºu-bootæä¾›äº†fdtçš„ç›¸å…³å‘½ä»¤\n\n```\nfdt - flattened device tree utility commands\n\nUsage:\nfdt addr [-c]  <addr> [<length>]   - Set the [control] fdt location to <addr>\nfdt apply <addr>                    - Apply overlay to the DT\nfdt move   <fdt> <newaddr> <length> - Copy the fdt to <addr> and make it active\nfdt resize [<extrasize>]            - Resize fdt to size + padding to 4k addr + some optional <extrasize> if needed\nfdt print  <path> [<prop>]          - Recursive print starting at <path>\nfdt list   <path> [<prop>]          - Print one level starting at <path>\nfdt get value <var> <path> <prop>   - Get <property> and store in <var>\nfdt get name <var> <path> <index>   - Get name of node <index> and store in <var>\nfdt get addr <var> <path> <prop>    - Get start address of <property> and store in <var>\nfdt get size <var> <path> [<prop>]  - Get size of [<property>] or num nodes and store in <var>\nfdt set    <path> <prop> [<val>]    - Set <property> [to <val>]\nfdt mknode <path> <node>            - Create a new node after <path>\nfdt rm     <path> [<prop>]          - Delete the node or <property>\nfdt header                          - Display header info\nfdt bootcpu <id>                    - Set boot cpuid\nfdt memory <addr> <size>            - Add/Update memory node\nfdt rsvmem print                    - Show current mem reserves\nfdt rsvmem add <addr> <size>        - Add a mem reserve\nfdt rsvmem delete <index>           - Delete a mem reserves\nfdt chosen [<start> <end>]          - Add/update the /chosen branch in the tree\n                                        <start>/<end> - initrd start/end addr\nNOTE: Dereference aliases by omitting the leading '/', e.g. fdt print ethernet0.\n```\n\nfdt printåŠ pathå‚æ•°ï¼Œåˆ™æ‰“pathå†…å®¹ï¼Œå¦‚ä¸‹(å…¶ä¸­/memoryæ˜¯path)ï¼š\n\n```c\nU-Boot> fdt print /memory\nmemory {\ndevice_type = \"memory\";\nreg = <0x70000000 0x4000000>;\n};\n\nU-Boot> fdt print #ä¸åŠ å‚æ•°æ—¶ï¼Œæ‰“å°å‡ºæ•´é¢—æ ‘\n```\n\n\n\n# äºŒã€u-boot è·å–GPTåˆ†åŒºè¡¨\n\nåœ¨ubootä¸­é€šè¿‡å‘½ä»¤æ‰“å°åˆ†åŒºè¡¨\n\n```\npart list mmc 0\n```\n\n## 3588-android-uboot\n\n```c\n#include <common.h>\n#include <command.h>\n#include <android_image.h>\n#include <mmc.h>\n#include <stdlib.h>\n#include <memalign.h>\n#include <fdtdec.h>\n\n#define PART_MAX_COUNT  128\n#define\tLAB_SIZE\t\t512\n#define\tHEADER_OFFSET\tLAB_SIZE\n#define\tENTRY_OFFSET\t(2 * LAB_SIZE)\n#define\tVAL1_OFFSET\t\tsizeof(u64)\n#define\tVAL2_OFFSET\t\t(2 * sizeof(u64))\n\nstatic u64 get_gpt_blk_cnt_and_print(struct blk_desc *dev_desc,\n\t\t\t  gpt_header *gpt_head, gpt_entry **gpt_pte) {\n\tchar efi_str[PARTNAME_SZ + 1];\n\tu64 gpt_part_size, gpt_blk_cnt = 0;\n\tgpt_entry *gpt_e;\n\tint i;\n\n\tgpt_e = *gpt_pte;\n\tfor (i = 0; i < gpt_head->num_partition_entries; i++) {\n\n\t\traite_gpt_convert_efi_name_to_char(efi_str, gpt_e[i].partition_name,\n\t\t\t\t\t     PARTNAME_SZ + 1);\n\n\t\tprintf(\"%s: part: %2d name - GPT: %16s \",\n\t\t      __func__, i, efi_str);\n\t\tgpt_part_size = le64_to_cpu(gpt_e[i].ending_lba) -\n\t\t\tle64_to_cpu(gpt_e[i].starting_lba) + 1;\n\t\tgpt_blk_cnt += gpt_part_size;\n\t\t\n\t\tif(gpt_part_size == 1) \n\t\t\tbreak;\n\t\t\n\t\tprintf(\"size(LBA) - GPT: %8llu \",\n\t\t      (unsigned long long)gpt_part_size);\n\n\t\tprintf(\"start LBA - GPT: %8llu \\n\",\n\t\t      le64_to_cpu(gpt_e[i].starting_lba));\n\t}\n\n\treturn gpt_blk_cnt + gpt_e[0].starting_lba - 1;\n}\n\nstatic int get_gpt_meta_data(u64 *data_size, void **data)\n{\n    gpt_header *pgpt_head;\n\tgpt_entry *entries;\n\tvoid *meta_data;\n\tu64 meta_data_size, gpt_entries_size;\n\tstruct blk_desc *dev_desc = NULL;\n\tstruct mmc *mmc = NULL;\n\tu64 blk_size = 0;\n\tu64 blk_cnt = 0;\n\tu64 tag = 0x55AA;\n\tlbaint_t lba;\n    \n\tif (!data_size || !data) {\n\t\tprintf(\"%s *** ERROR: Invalid Argument(s) ***\\n\", __func__);\n\t\treturn -1;\n\t}\n    \n    mmc = do_returnmmc();\n\tif (!mmc)\n\t\treturn CMD_RET_FAILURE;\n    \n    dev_desc = mmc_get_blk_desc(mmc);\n\tif (!dev_desc) {\n\t\tprintf(\"%s *** ERROR: mmc_get_blk_desc err ***\\n\", __func__);\n\t\treturn -1;\n\t}\n\n\tgpt_entries_size = sizeof(gpt_entry) * PART_MAX_COUNT;\n\tmeta_data_size = LAB_SIZE + sizeof(gpt_header) + gpt_entries_size;\n\tmeta_data = malloc(meta_data_size);\n\tif(!meta_data) {\n\t\tprintf(\"%s *** ERROR: malloc memory (gpt meta data) ***\\n\", __func__);\n\t\treturn -1;\n\t}\n    \n    memset(meta_data, 0, meta_data_size);\n\tpgpt_head = (gpt_header *)((char *)meta_data + HEADER_OFFSET);\n\tentries = (gpt_entry *)((char *)meta_data + ENTRY_OFFSET);\n\tALLOC_CACHE_ALIGN_BUFFER(legacy_mbr, mbr, dev_desc->blksz);\n\n\t/* Read MBR Header from device */\n\tlba = 0; /* MBR is always at 0 */\n\tblk_cnt = 1; /* MBR (1 block) */\n\tif (blk_dread(dev_desc, lba, blk_cnt, (ulong *)mbr) != 1) {\n\t\tprintf(\"*** ERROR: Can't read MBR header ***\\n\");\n\t\tgoto ERROR_OUT;\n\t}\n\n\t/* Read GPT Header from device */\n\tlba = GPT_PRIMARY_PARTITION_TABLE_LBA;\n\tblk_cnt = 1; /* GPT Header (1 block) */\n\tif (blk_dread(dev_desc, lba, blk_cnt, pgpt_head) != 1) {\n    \tprintf(\"%s *** ERROR: Can't read GPT header ***\\n\", __func__);\n\t\tgoto ERROR_OUT;\n\t}\n\n\tlba = GPT_PRIMARY_PARTITION_TABLE_LBA;\n\tif (validate_gpt_header(pgpt_head, lba, dev_desc->lba)) {\n\t\tprintf(\"%s *** ERROR: validate_gpt_header GPT header ***\\n\", __func__);\n\t\tgoto ERROR_OUT;\n\t}\n\n\tif (dev_desc->sig_type == SIG_TYPE_NONE) {\n\t\tefi_guid_t empty = {};\n\t\tif (memcmp(&pgpt_head->disk_guid, &empty, sizeof(empty))) {\n\t\t\tdev_desc->sig_type = SIG_TYPE_GUID;\n\t\t\tmemcpy(&dev_desc->guid_sig, &pgpt_head->disk_guid,\n\t\t\t      sizeof(empty));\n\t\t} else if (mbr->unique_mbr_signature != 0) {\n\t\t\tdev_desc->sig_type = SIG_TYPE_MBR;\n\t\t\tdev_desc->mbr_sig = mbr->unique_mbr_signature;\n\t\t}\n\t}\n\n\t/* Read GPT Entries from device */\n\tlba = le64_to_cpu(pgpt_head->partition_entry_lba);\n\tblk_cnt = BLOCK_CNT((le32_to_cpu(pgpt_head->num_partition_entries) *\n\t\t\t\t   \tle32_to_cpu(pgpt_head->sizeof_partition_entry)),\n\t\t\t\t  \tdev_desc);\n\tif (blk_dread(dev_desc, lba, blk_cnt, entries) != blk_cnt) {\n\t\tprintf(\"%s *** ERROR:read entries (lba=%llu) ***\\n\",\n\t\t\t\t__func__, pgpt_head->partition_entry_lba);\n\t\tgoto ERROR_OUT;\n\t}\n\t\n\tblk_size = dev_desc->blksz;\n\tvalidate_gpt_entries(pgpt_head, entries);\n\t\n\tdebug(\"%s read entries lba %llu (blk_cnt %llu blk_size=%llu)\\n\",\n\t\t\t\t__func__, (unsigned long long)(ulong)lba, blk_cnt, blk_size);\n\t\n\tblk_cnt = get_gpt_blk_cnt(dev_desc, pgpt_head, &entries);\n    \n    /* \n\t * build info, layout of meta_data:\n\t * u64 tag | u64 blk_size | u64 blk_cnt | 488 bytes | gpt header | gpt entries\n\t */\n\tblk_cnt = get_gpt_blk_cnt(dev_desc, pgpt_head, &entries);\n\t/*this value makes we known the reserved memory is available*/\n\tmemcpy(meta_data, (void *)&tag, sizeof(u64));\n\tmemcpy(meta_data + VAL1_OFFSET, (void *)&blk_size, sizeof(u64));\n\tmemcpy(meta_data + VAL2_OFFSET, (void *)&blk_cnt, sizeof(u64));\n\n\t*data_size = meta_data_size;\n\t*data = meta_data;\n\n\treturn 0;\n\nERROR_OUT:\n\tfree(meta_data);\n\tmeta_data = NULL;\n\treturn -1;\n}\n```\n\n\n\nå‚è€ƒï¼š\n\n[Device Treeï¼ˆå››ï¼‰ï¼šæ–‡ä»¶ç»“æ„è§£æ (wowotech.net)](http://www.wowotech.net/device_model/dt-code-file-struct-parse.html)\n\n[Linuxè®¾å¤‡æ ‘è¯­æ³•åˆ†æè¯¦è§£æ•™ç¨‹(ä¸‰)u-bootè®¾å¤‡æ ‘çš„ä¼ é€’ - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/376295326)\n\n[Linuxè®¾å¤‡æ ‘è¯­æ³•åˆ†æè¯¦è§£æ•™ç¨‹(å››)kernelçš„è§£æ - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/376296222)\n\nhttps://www.cnblogs.com/solo666/p/16518154.html\n","source":"back_posts/U-Boot-fdt-GPT.md","raw":"---\ntitle: U-Boot-fdt-GPT\ndate: 2024-05-15 14:37:05\ncategories:\n- uboot\ntags:\n- fdt\n- GPT\n- rk3588\n---\n\nU-Bootå®˜ç½‘:https://docs.u-boot.org/en/latest/\n\nu-bootå¯åŠ¨æµç¨‹\n\n- æ¿å­ä¸Šç”µä»¥åï¼Œé¦–å…ˆæ‰§è¡Œçš„æ˜¯ROMä¸­çš„ä¸€æ®µå¯åŠ¨ä»£ç ã€‚å¯åŠ¨ä»£ç **æ ¹æ®å¯„å­˜å™¨/å¤–éƒ¨ç®¡è„šé…ç½®**ï¼Œç¡®å®šæ˜¯è¿›å…¥ä¸‹è½½æ¨¡å¼ï¼Œè¿˜æ˜¯ä»æŸä»‹è´¨(Flash/EMMC/SDå¡ç­‰å­˜å‚¨è®¾å¤‡)å¯åŠ¨u-boot\n\n> ROMä¸­çš„ä»£ç æ˜¯å›ºåŒ–çš„ï¼Œæ— æ³•ä¿®æ”¹\n\n# ä¸€ã€ä»‹ç»\n\n> FDTï¼Œflatted device treeï¼Œæ‰å¹³è®¾å¤‡æ ‘ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯å°†éƒ¨åˆ†è®¾å¤‡ä¿¡æ¯ç»“æ„å­˜æ”¾åˆ°device treeæ–‡ä»¶ä¸­ã€‚\n>\n> ubootæœ€ç»ˆå°†å…¶ç¼–è¯‘æˆdtbæ–‡ä»¶ï¼Œä½¿ç”¨è¿‡ç¨‹ä¸­é€šè¿‡è§£æè¯¥dtbæ¥è·å–æ¿çº§è®¾å¤‡ä¿¡æ¯ã€‚  \n\n> U-bootçš„dtbå’Œkernelä¸­çš„dtbæ˜¯ä¸€è‡´çš„ï¼Œæœ‰å…³fdtçš„è¯¦ç»†ä»‹ç»ï¼Œå‚è€ƒdoc/README.fdt-control\n\n### dtbåœ¨U-bootä¸­çš„ä½ç½®\n\n- dtbèƒ½å¤Ÿä»¥ä¸¤ç§å½¢å¼ç¼–è¯‘åˆ°U-bootçš„é•œåƒä¸­\n\n1. dtbå’Œu-bootçš„binæ–‡ä»¶åˆ†ç¦»(imx6qä¸­ä½¿ç”¨çš„è¿™ç§æ–¹å¼ï¼Œåœ¨.configæ–‡ä»¶ä¸­å¯ä»¥æŸ¥çœ‹åˆ°)\n\n> é€šè¿‡CONFIG_OF_SEPARATEå®å®šä¹‰ä½¿èƒ½ï¼Œdtbæœ€åä¼šè¿½åŠ åˆ°u-bootçš„binæ–‡ä»¶çš„æœ€åé¢ï¼Œé€šè¿‡u-bootçš„ç»“æŸåœ°å€ç¬¦å·_endç¬¦å·æ¥è·å–dtbçš„åœ°å€\n\n1. dtbé›†æˆåˆ°u-bootçš„binæ–‡ä»¶å†…éƒ¨\n\n> é€šè¿‡CONFIG_OF_EMBEDå®å®šä¹‰ä½¿èƒ½ï¼Œdtbä¼šä½äºu-bootçš„.dtb.init.rodataæ®µä¸­ï¼Œé€šè¿‡__dtb_dt_beginç¬¦å·æ¥è·å–dtb\n\n1. è·å–dtsæ–‡ä»¶çš„åœ°å€gd->fdt_blob\n\n```\n// å®ç”¨æ¥è¡¨ç¤ºæ˜¯å¦æŠŠdtbæ–‡ä»¶æ”¾åœ¨uboot.binçš„æ–‡ä»¶ä¸­\nCONFIG_OF_EMBED\n\n// å•ç‹¬ç¼–è¯‘dtbæ–‡ä»¶\nCONFIG_OF_SEPARATEï¼Œç¼–è¯‘å‡ºæ¥çš„dtbæ”¾åœ¨uboot.binçš„æœ€åé¢ï¼Œå°±æ˜¯dtbè¿½åŠ åˆ°ubootçš„binæ–‡ä»¶åé¢æ—¶ï¼Œé€šè¿‡_endç¬¦å·æ¥è·å–dtbåœ°å€\n\ngd->fdt_blob = (ulong *)&_end;\n\n// å¯ä»¥é€šè¿‡fdtcontroladdrç¯å¢ƒå˜é‡æ¥æŒ‡å®šfdtçš„åœ°å€\ngd->fdt_blob = (void *)getenv_ulong(\"fdtcontroladdr\", 16,\n\t\t\t\t\t\t(uintptr_t)gd->fdt_blob); \n```\n\n###  dtbè§£ææ¥å£\n\n- å®šä¹‰åœ¨lib/fdtdec.cæ–‡ä»¶ä¸­ï¼ŒèŠ‚ç‚¹å˜é‡nodeä¸­å­˜æ”¾çš„æ˜¯åç§»åœ°å€\n\n```\n// è·å¾—dtbä¸‹æŸä¸ªèŠ‚ç‚¹çš„è·¯å¾„pathçš„åç§»ï¼Œåç§»å°±ä»£è¡¨è¿™ä¸ªèŠ‚ç‚¹\nint fdt_path_offset(const void *fdt, const char *path)\negï¼šnode = fdt_path_offset(gd->fdt_blob, â€œ/aliasesâ€);\n\n// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªå­—ç¬¦ä¸²å±æ€§å€¼\nconst void *fdt_getprop(const void *fdt, int nodeoffset, const char *name, int *lenp)\negï¼š mac = fdt_getprop(gd->fdt_blob, node, â€œmac-addressâ€, &len);\n\n// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ•´å½¢æ•°ç»„å±æ€§å€¼\nint fdtdec_get_int_array(const void *blob, int node, const char *prop_name, u32 *array, int count)\negï¼š ret = fdtdec_get_int_array(blob, node, â€œinterruptsâ€, cell, ARRAY_SIZE(cell));\n\n// è·å¾—èŠ‚ç‚¹nodeçš„åœ°å€å±æ€§å€¼\nfdt_addr_t fdtdec_get_addr(const void *blob, int node, const char *prop_name)\negï¼šfdtdec_get_addr(blob, node, â€œregâ€);\n\n// è·å¾—configèŠ‚ç‚¹ä¸‹çš„æ•´å½¢å±æ€§ã€boolå±æ€§ã€å­—ç¬¦ä¸²ç­‰ç­‰\nfdtdec_get_config_intã€fdtdec_get_config_boolã€fdtdec_get_config_string\n\n// è·å¾—chosenä¸‹çš„nameèŠ‚ç‚¹çš„åç§»\nint fdtdec_get_chosen_node(const void *blob, const char *name)\n\n// è·å¾—chosenä¸‹nameå±æ€§çš„å€¼\nconst char *fdtdec_get_chosen_prop(const void *blob, const char *name)\n```\n\n- å®šä¹‰åœ¨lib/fdtdec_common.cæ–‡ä»¶ä¸­\n\n```\n// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ•´å½¢å±æ€§å€¼\nint fdtdec_get_int(const void *blob, int node, const char *prop_name, int default_val)\negï¼š bus->udelay = fdtdec_get_int(blob, node, â€œi2c-gpio,delay-usâ€, DEFAULT_UDELAY);\n\n// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ— ç¬¦å·æ•´å½¢å±æ€§å€¼\nfdtdec_get_uint\n```\n\n## fdt å‘½ä»¤\n\nå¯¹äºu-bootæä¾›äº†fdtçš„ç›¸å…³å‘½ä»¤\n\n```\nfdt - flattened device tree utility commands\n\nUsage:\nfdt addr [-c]  <addr> [<length>]   - Set the [control] fdt location to <addr>\nfdt apply <addr>                    - Apply overlay to the DT\nfdt move   <fdt> <newaddr> <length> - Copy the fdt to <addr> and make it active\nfdt resize [<extrasize>]            - Resize fdt to size + padding to 4k addr + some optional <extrasize> if needed\nfdt print  <path> [<prop>]          - Recursive print starting at <path>\nfdt list   <path> [<prop>]          - Print one level starting at <path>\nfdt get value <var> <path> <prop>   - Get <property> and store in <var>\nfdt get name <var> <path> <index>   - Get name of node <index> and store in <var>\nfdt get addr <var> <path> <prop>    - Get start address of <property> and store in <var>\nfdt get size <var> <path> [<prop>]  - Get size of [<property>] or num nodes and store in <var>\nfdt set    <path> <prop> [<val>]    - Set <property> [to <val>]\nfdt mknode <path> <node>            - Create a new node after <path>\nfdt rm     <path> [<prop>]          - Delete the node or <property>\nfdt header                          - Display header info\nfdt bootcpu <id>                    - Set boot cpuid\nfdt memory <addr> <size>            - Add/Update memory node\nfdt rsvmem print                    - Show current mem reserves\nfdt rsvmem add <addr> <size>        - Add a mem reserve\nfdt rsvmem delete <index>           - Delete a mem reserves\nfdt chosen [<start> <end>]          - Add/update the /chosen branch in the tree\n                                        <start>/<end> - initrd start/end addr\nNOTE: Dereference aliases by omitting the leading '/', e.g. fdt print ethernet0.\n```\n\nfdt printåŠ pathå‚æ•°ï¼Œåˆ™æ‰“pathå†…å®¹ï¼Œå¦‚ä¸‹(å…¶ä¸­/memoryæ˜¯path)ï¼š\n\n```c\nU-Boot> fdt print /memory\nmemory {\ndevice_type = \"memory\";\nreg = <0x70000000 0x4000000>;\n};\n\nU-Boot> fdt print #ä¸åŠ å‚æ•°æ—¶ï¼Œæ‰“å°å‡ºæ•´é¢—æ ‘\n```\n\n\n\n# äºŒã€u-boot è·å–GPTåˆ†åŒºè¡¨\n\nåœ¨ubootä¸­é€šè¿‡å‘½ä»¤æ‰“å°åˆ†åŒºè¡¨\n\n```\npart list mmc 0\n```\n\n## 3588-android-uboot\n\n```c\n#include <common.h>\n#include <command.h>\n#include <android_image.h>\n#include <mmc.h>\n#include <stdlib.h>\n#include <memalign.h>\n#include <fdtdec.h>\n\n#define PART_MAX_COUNT  128\n#define\tLAB_SIZE\t\t512\n#define\tHEADER_OFFSET\tLAB_SIZE\n#define\tENTRY_OFFSET\t(2 * LAB_SIZE)\n#define\tVAL1_OFFSET\t\tsizeof(u64)\n#define\tVAL2_OFFSET\t\t(2 * sizeof(u64))\n\nstatic u64 get_gpt_blk_cnt_and_print(struct blk_desc *dev_desc,\n\t\t\t  gpt_header *gpt_head, gpt_entry **gpt_pte) {\n\tchar efi_str[PARTNAME_SZ + 1];\n\tu64 gpt_part_size, gpt_blk_cnt = 0;\n\tgpt_entry *gpt_e;\n\tint i;\n\n\tgpt_e = *gpt_pte;\n\tfor (i = 0; i < gpt_head->num_partition_entries; i++) {\n\n\t\traite_gpt_convert_efi_name_to_char(efi_str, gpt_e[i].partition_name,\n\t\t\t\t\t     PARTNAME_SZ + 1);\n\n\t\tprintf(\"%s: part: %2d name - GPT: %16s \",\n\t\t      __func__, i, efi_str);\n\t\tgpt_part_size = le64_to_cpu(gpt_e[i].ending_lba) -\n\t\t\tle64_to_cpu(gpt_e[i].starting_lba) + 1;\n\t\tgpt_blk_cnt += gpt_part_size;\n\t\t\n\t\tif(gpt_part_size == 1) \n\t\t\tbreak;\n\t\t\n\t\tprintf(\"size(LBA) - GPT: %8llu \",\n\t\t      (unsigned long long)gpt_part_size);\n\n\t\tprintf(\"start LBA - GPT: %8llu \\n\",\n\t\t      le64_to_cpu(gpt_e[i].starting_lba));\n\t}\n\n\treturn gpt_blk_cnt + gpt_e[0].starting_lba - 1;\n}\n\nstatic int get_gpt_meta_data(u64 *data_size, void **data)\n{\n    gpt_header *pgpt_head;\n\tgpt_entry *entries;\n\tvoid *meta_data;\n\tu64 meta_data_size, gpt_entries_size;\n\tstruct blk_desc *dev_desc = NULL;\n\tstruct mmc *mmc = NULL;\n\tu64 blk_size = 0;\n\tu64 blk_cnt = 0;\n\tu64 tag = 0x55AA;\n\tlbaint_t lba;\n    \n\tif (!data_size || !data) {\n\t\tprintf(\"%s *** ERROR: Invalid Argument(s) ***\\n\", __func__);\n\t\treturn -1;\n\t}\n    \n    mmc = do_returnmmc();\n\tif (!mmc)\n\t\treturn CMD_RET_FAILURE;\n    \n    dev_desc = mmc_get_blk_desc(mmc);\n\tif (!dev_desc) {\n\t\tprintf(\"%s *** ERROR: mmc_get_blk_desc err ***\\n\", __func__);\n\t\treturn -1;\n\t}\n\n\tgpt_entries_size = sizeof(gpt_entry) * PART_MAX_COUNT;\n\tmeta_data_size = LAB_SIZE + sizeof(gpt_header) + gpt_entries_size;\n\tmeta_data = malloc(meta_data_size);\n\tif(!meta_data) {\n\t\tprintf(\"%s *** ERROR: malloc memory (gpt meta data) ***\\n\", __func__);\n\t\treturn -1;\n\t}\n    \n    memset(meta_data, 0, meta_data_size);\n\tpgpt_head = (gpt_header *)((char *)meta_data + HEADER_OFFSET);\n\tentries = (gpt_entry *)((char *)meta_data + ENTRY_OFFSET);\n\tALLOC_CACHE_ALIGN_BUFFER(legacy_mbr, mbr, dev_desc->blksz);\n\n\t/* Read MBR Header from device */\n\tlba = 0; /* MBR is always at 0 */\n\tblk_cnt = 1; /* MBR (1 block) */\n\tif (blk_dread(dev_desc, lba, blk_cnt, (ulong *)mbr) != 1) {\n\t\tprintf(\"*** ERROR: Can't read MBR header ***\\n\");\n\t\tgoto ERROR_OUT;\n\t}\n\n\t/* Read GPT Header from device */\n\tlba = GPT_PRIMARY_PARTITION_TABLE_LBA;\n\tblk_cnt = 1; /* GPT Header (1 block) */\n\tif (blk_dread(dev_desc, lba, blk_cnt, pgpt_head) != 1) {\n    \tprintf(\"%s *** ERROR: Can't read GPT header ***\\n\", __func__);\n\t\tgoto ERROR_OUT;\n\t}\n\n\tlba = GPT_PRIMARY_PARTITION_TABLE_LBA;\n\tif (validate_gpt_header(pgpt_head, lba, dev_desc->lba)) {\n\t\tprintf(\"%s *** ERROR: validate_gpt_header GPT header ***\\n\", __func__);\n\t\tgoto ERROR_OUT;\n\t}\n\n\tif (dev_desc->sig_type == SIG_TYPE_NONE) {\n\t\tefi_guid_t empty = {};\n\t\tif (memcmp(&pgpt_head->disk_guid, &empty, sizeof(empty))) {\n\t\t\tdev_desc->sig_type = SIG_TYPE_GUID;\n\t\t\tmemcpy(&dev_desc->guid_sig, &pgpt_head->disk_guid,\n\t\t\t      sizeof(empty));\n\t\t} else if (mbr->unique_mbr_signature != 0) {\n\t\t\tdev_desc->sig_type = SIG_TYPE_MBR;\n\t\t\tdev_desc->mbr_sig = mbr->unique_mbr_signature;\n\t\t}\n\t}\n\n\t/* Read GPT Entries from device */\n\tlba = le64_to_cpu(pgpt_head->partition_entry_lba);\n\tblk_cnt = BLOCK_CNT((le32_to_cpu(pgpt_head->num_partition_entries) *\n\t\t\t\t   \tle32_to_cpu(pgpt_head->sizeof_partition_entry)),\n\t\t\t\t  \tdev_desc);\n\tif (blk_dread(dev_desc, lba, blk_cnt, entries) != blk_cnt) {\n\t\tprintf(\"%s *** ERROR:read entries (lba=%llu) ***\\n\",\n\t\t\t\t__func__, pgpt_head->partition_entry_lba);\n\t\tgoto ERROR_OUT;\n\t}\n\t\n\tblk_size = dev_desc->blksz;\n\tvalidate_gpt_entries(pgpt_head, entries);\n\t\n\tdebug(\"%s read entries lba %llu (blk_cnt %llu blk_size=%llu)\\n\",\n\t\t\t\t__func__, (unsigned long long)(ulong)lba, blk_cnt, blk_size);\n\t\n\tblk_cnt = get_gpt_blk_cnt(dev_desc, pgpt_head, &entries);\n    \n    /* \n\t * build info, layout of meta_data:\n\t * u64 tag | u64 blk_size | u64 blk_cnt | 488 bytes | gpt header | gpt entries\n\t */\n\tblk_cnt = get_gpt_blk_cnt(dev_desc, pgpt_head, &entries);\n\t/*this value makes we known the reserved memory is available*/\n\tmemcpy(meta_data, (void *)&tag, sizeof(u64));\n\tmemcpy(meta_data + VAL1_OFFSET, (void *)&blk_size, sizeof(u64));\n\tmemcpy(meta_data + VAL2_OFFSET, (void *)&blk_cnt, sizeof(u64));\n\n\t*data_size = meta_data_size;\n\t*data = meta_data;\n\n\treturn 0;\n\nERROR_OUT:\n\tfree(meta_data);\n\tmeta_data = NULL;\n\treturn -1;\n}\n```\n\n\n\nå‚è€ƒï¼š\n\n[Device Treeï¼ˆå››ï¼‰ï¼šæ–‡ä»¶ç»“æ„è§£æ (wowotech.net)](http://www.wowotech.net/device_model/dt-code-file-struct-parse.html)\n\n[Linuxè®¾å¤‡æ ‘è¯­æ³•åˆ†æè¯¦è§£æ•™ç¨‹(ä¸‰)u-bootè®¾å¤‡æ ‘çš„ä¼ é€’ - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/376295326)\n\n[Linuxè®¾å¤‡æ ‘è¯­æ³•åˆ†æè¯¦è§£æ•™ç¨‹(å››)kernelçš„è§£æ - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/376296222)\n\nhttps://www.cnblogs.com/solo666/p/16518154.html\n","updated":"2024-05-15T06:54:20.711Z","path":"back_posts/U-Boot-fdt-GPT.html","comments":1,"layout":"page","_id":"clw7h6af900027sw08fk91eq1","content":"<p>U-Bootå®˜ç½‘:<a href=\"https://docs.u-boot.org/en/latest/\">https://docs.u-boot.org/en/latest/</a></p>\n<p>u-bootå¯åŠ¨æµç¨‹</p>\n<ul>\n<li>æ¿å­ä¸Šç”µä»¥åï¼Œé¦–å…ˆæ‰§è¡Œçš„æ˜¯ROMä¸­çš„ä¸€æ®µå¯åŠ¨ä»£ç ã€‚å¯åŠ¨ä»£ç <strong>æ ¹æ®å¯„å­˜å™¨&#x2F;å¤–éƒ¨ç®¡è„šé…ç½®</strong>ï¼Œç¡®å®šæ˜¯è¿›å…¥ä¸‹è½½æ¨¡å¼ï¼Œè¿˜æ˜¯ä»æŸä»‹è´¨(Flash&#x2F;EMMC&#x2F;SDå¡ç­‰å­˜å‚¨è®¾å¤‡)å¯åŠ¨u-boot</li>\n</ul>\n<blockquote>\n<p>ROMä¸­çš„ä»£ç æ˜¯å›ºåŒ–çš„ï¼Œæ— æ³•ä¿®æ”¹</p>\n</blockquote>\n<h1 id=\"ä¸€ã€ä»‹ç»\"><a href=\"#ä¸€ã€ä»‹ç»\" class=\"headerlink\" title=\"ä¸€ã€ä»‹ç»\"></a>ä¸€ã€ä»‹ç»</h1><blockquote>\n<p>FDTï¼Œflatted device treeï¼Œæ‰å¹³è®¾å¤‡æ ‘ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯å°†éƒ¨åˆ†è®¾å¤‡ä¿¡æ¯ç»“æ„å­˜æ”¾åˆ°device treeæ–‡ä»¶ä¸­ã€‚</p>\n<p>ubootæœ€ç»ˆå°†å…¶ç¼–è¯‘æˆdtbæ–‡ä»¶ï¼Œä½¿ç”¨è¿‡ç¨‹ä¸­é€šè¿‡è§£æè¯¥dtbæ¥è·å–æ¿çº§è®¾å¤‡ä¿¡æ¯ã€‚  </p>\n</blockquote>\n<blockquote>\n<p>U-bootçš„dtbå’Œkernelä¸­çš„dtbæ˜¯ä¸€è‡´çš„ï¼Œæœ‰å…³fdtçš„è¯¦ç»†ä»‹ç»ï¼Œå‚è€ƒdoc&#x2F;README.fdt-control</p>\n</blockquote>\n<h3 id=\"dtbåœ¨U-bootä¸­çš„ä½ç½®\"><a href=\"#dtbåœ¨U-bootä¸­çš„ä½ç½®\" class=\"headerlink\" title=\"dtbåœ¨U-bootä¸­çš„ä½ç½®\"></a>dtbåœ¨U-bootä¸­çš„ä½ç½®</h3><ul>\n<li>dtbèƒ½å¤Ÿä»¥ä¸¤ç§å½¢å¼ç¼–è¯‘åˆ°U-bootçš„é•œåƒä¸­</li>\n</ul>\n<ol>\n<li>dtbå’Œu-bootçš„binæ–‡ä»¶åˆ†ç¦»(imx6qä¸­ä½¿ç”¨çš„è¿™ç§æ–¹å¼ï¼Œåœ¨.configæ–‡ä»¶ä¸­å¯ä»¥æŸ¥çœ‹åˆ°)</li>\n</ol>\n<blockquote>\n<p>é€šè¿‡CONFIG_OF_SEPARATEå®å®šä¹‰ä½¿èƒ½ï¼Œdtbæœ€åä¼šè¿½åŠ åˆ°u-bootçš„binæ–‡ä»¶çš„æœ€åé¢ï¼Œé€šè¿‡u-bootçš„ç»“æŸåœ°å€ç¬¦å·_endç¬¦å·æ¥è·å–dtbçš„åœ°å€</p>\n</blockquote>\n<ol>\n<li>dtbé›†æˆåˆ°u-bootçš„binæ–‡ä»¶å†…éƒ¨</li>\n</ol>\n<blockquote>\n<p>é€šè¿‡CONFIG_OF_EMBEDå®å®šä¹‰ä½¿èƒ½ï¼Œdtbä¼šä½äºu-bootçš„.dtb.init.rodataæ®µä¸­ï¼Œé€šè¿‡__dtb_dt_beginç¬¦å·æ¥è·å–dtb</p>\n</blockquote>\n<ol>\n<li>è·å–dtsæ–‡ä»¶çš„åœ°å€gd-&gt;fdt_blob</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// å®ç”¨æ¥è¡¨ç¤ºæ˜¯å¦æŠŠdtbæ–‡ä»¶æ”¾åœ¨uboot.binçš„æ–‡ä»¶ä¸­</span><br><span class=\"line\">CONFIG_OF_EMBED</span><br><span class=\"line\"></span><br><span class=\"line\">// å•ç‹¬ç¼–è¯‘dtbæ–‡ä»¶</span><br><span class=\"line\">CONFIG_OF_SEPARATEï¼Œç¼–è¯‘å‡ºæ¥çš„dtbæ”¾åœ¨uboot.binçš„æœ€åé¢ï¼Œå°±æ˜¯dtbè¿½åŠ åˆ°ubootçš„binæ–‡ä»¶åé¢æ—¶ï¼Œé€šè¿‡_endç¬¦å·æ¥è·å–dtbåœ°å€</span><br><span class=\"line\"></span><br><span class=\"line\">gd-&gt;fdt_blob = (ulong *)&amp;_end;</span><br><span class=\"line\"></span><br><span class=\"line\">// å¯ä»¥é€šè¿‡fdtcontroladdrç¯å¢ƒå˜é‡æ¥æŒ‡å®šfdtçš„åœ°å€</span><br><span class=\"line\">gd-&gt;fdt_blob = (void *)getenv_ulong(&quot;fdtcontroladdr&quot;, 16,</span><br><span class=\"line\">\t\t\t\t\t\t(uintptr_t)gd-&gt;fdt_blob); </span><br></pre></td></tr></table></figure>\n\n<h3 id=\"dtbè§£ææ¥å£\"><a href=\"#dtbè§£ææ¥å£\" class=\"headerlink\" title=\"dtbè§£ææ¥å£\"></a>dtbè§£ææ¥å£</h3><ul>\n<li>å®šä¹‰åœ¨lib&#x2F;fdtdec.cæ–‡ä»¶ä¸­ï¼ŒèŠ‚ç‚¹å˜é‡nodeä¸­å­˜æ”¾çš„æ˜¯åç§»åœ°å€</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// è·å¾—dtbä¸‹æŸä¸ªèŠ‚ç‚¹çš„è·¯å¾„pathçš„åç§»ï¼Œåç§»å°±ä»£è¡¨è¿™ä¸ªèŠ‚ç‚¹</span><br><span class=\"line\">int fdt_path_offset(const void *fdt, const char *path)</span><br><span class=\"line\">egï¼šnode = fdt_path_offset(gd-&gt;fdt_blob, â€œ/aliasesâ€);</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªå­—ç¬¦ä¸²å±æ€§å€¼</span><br><span class=\"line\">const void *fdt_getprop(const void *fdt, int nodeoffset, const char *name, int *lenp)</span><br><span class=\"line\">egï¼š mac = fdt_getprop(gd-&gt;fdt_blob, node, â€œmac-addressâ€, &amp;len);</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ•´å½¢æ•°ç»„å±æ€§å€¼</span><br><span class=\"line\">int fdtdec_get_int_array(const void *blob, int node, const char *prop_name, u32 *array, int count)</span><br><span class=\"line\">egï¼š ret = fdtdec_get_int_array(blob, node, â€œinterruptsâ€, cell, ARRAY_SIZE(cell));</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—èŠ‚ç‚¹nodeçš„åœ°å€å±æ€§å€¼</span><br><span class=\"line\">fdt_addr_t fdtdec_get_addr(const void *blob, int node, const char *prop_name)</span><br><span class=\"line\">egï¼šfdtdec_get_addr(blob, node, â€œregâ€);</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—configèŠ‚ç‚¹ä¸‹çš„æ•´å½¢å±æ€§ã€boolå±æ€§ã€å­—ç¬¦ä¸²ç­‰ç­‰</span><br><span class=\"line\">fdtdec_get_config_intã€fdtdec_get_config_boolã€fdtdec_get_config_string</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—chosenä¸‹çš„nameèŠ‚ç‚¹çš„åç§»</span><br><span class=\"line\">int fdtdec_get_chosen_node(const void *blob, const char *name)</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—chosenä¸‹nameå±æ€§çš„å€¼</span><br><span class=\"line\">const char *fdtdec_get_chosen_prop(const void *blob, const char *name)</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>å®šä¹‰åœ¨lib&#x2F;fdtdec_common.cæ–‡ä»¶ä¸­</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ•´å½¢å±æ€§å€¼</span><br><span class=\"line\">int fdtdec_get_int(const void *blob, int node, const char *prop_name, int default_val)</span><br><span class=\"line\">egï¼š bus-&gt;udelay = fdtdec_get_int(blob, node, â€œi2c-gpio,delay-usâ€, DEFAULT_UDELAY);</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ— ç¬¦å·æ•´å½¢å±æ€§å€¼</span><br><span class=\"line\">fdtdec_get_uint</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"fdt-å‘½ä»¤\"><a href=\"#fdt-å‘½ä»¤\" class=\"headerlink\" title=\"fdt å‘½ä»¤\"></a>fdt å‘½ä»¤</h2><p>å¯¹äºu-bootæä¾›äº†fdtçš„ç›¸å…³å‘½ä»¤</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fdt - flattened device tree utility commands</span><br><span class=\"line\"></span><br><span class=\"line\">Usage:</span><br><span class=\"line\">fdt addr [-c]  &lt;addr&gt; [&lt;length&gt;]   - Set the [control] fdt location to &lt;addr&gt;</span><br><span class=\"line\">fdt apply &lt;addr&gt;                    - Apply overlay to the DT</span><br><span class=\"line\">fdt move   &lt;fdt&gt; &lt;newaddr&gt; &lt;length&gt; - Copy the fdt to &lt;addr&gt; and make it active</span><br><span class=\"line\">fdt resize [&lt;extrasize&gt;]            - Resize fdt to size + padding to 4k addr + some optional &lt;extrasize&gt; if needed</span><br><span class=\"line\">fdt print  &lt;path&gt; [&lt;prop&gt;]          - Recursive print starting at &lt;path&gt;</span><br><span class=\"line\">fdt list   &lt;path&gt; [&lt;prop&gt;]          - Print one level starting at &lt;path&gt;</span><br><span class=\"line\">fdt get value &lt;var&gt; &lt;path&gt; &lt;prop&gt;   - Get &lt;property&gt; and store in &lt;var&gt;</span><br><span class=\"line\">fdt get name &lt;var&gt; &lt;path&gt; &lt;index&gt;   - Get name of node &lt;index&gt; and store in &lt;var&gt;</span><br><span class=\"line\">fdt get addr &lt;var&gt; &lt;path&gt; &lt;prop&gt;    - Get start address of &lt;property&gt; and store in &lt;var&gt;</span><br><span class=\"line\">fdt get size &lt;var&gt; &lt;path&gt; [&lt;prop&gt;]  - Get size of [&lt;property&gt;] or num nodes and store in &lt;var&gt;</span><br><span class=\"line\">fdt set    &lt;path&gt; &lt;prop&gt; [&lt;val&gt;]    - Set &lt;property&gt; [to &lt;val&gt;]</span><br><span class=\"line\">fdt mknode &lt;path&gt; &lt;node&gt;            - Create a new node after &lt;path&gt;</span><br><span class=\"line\">fdt rm     &lt;path&gt; [&lt;prop&gt;]          - Delete the node or &lt;property&gt;</span><br><span class=\"line\">fdt header                          - Display header info</span><br><span class=\"line\">fdt bootcpu &lt;id&gt;                    - Set boot cpuid</span><br><span class=\"line\">fdt memory &lt;addr&gt; &lt;size&gt;            - Add/Update memory node</span><br><span class=\"line\">fdt rsvmem print                    - Show current mem reserves</span><br><span class=\"line\">fdt rsvmem add &lt;addr&gt; &lt;size&gt;        - Add a mem reserve</span><br><span class=\"line\">fdt rsvmem delete &lt;index&gt;           - Delete a mem reserves</span><br><span class=\"line\">fdt chosen [&lt;start&gt; &lt;end&gt;]          - Add/update the /chosen branch in the tree</span><br><span class=\"line\">                                        &lt;start&gt;/&lt;end&gt; - initrd start/end addr</span><br><span class=\"line\">NOTE: Dereference aliases by omitting the leading &#x27;/&#x27;, e.g. fdt print ethernet0.</span><br></pre></td></tr></table></figure>\n\n<p>fdt printåŠ pathå‚æ•°ï¼Œåˆ™æ‰“pathå†…å®¹ï¼Œå¦‚ä¸‹(å…¶ä¸­&#x2F;memoryæ˜¯path)ï¼š</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">U-Boot&gt; fdt print /memory</span><br><span class=\"line\">memory &#123;</span><br><span class=\"line\">device_type = <span class=\"string\">&quot;memory&quot;</span>;</span><br><span class=\"line\">reg = &lt;<span class=\"number\">0x70000000</span> <span class=\"number\">0x4000000</span>&gt;;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">U-Boot&gt; fdt print #ä¸åŠ å‚æ•°æ—¶ï¼Œæ‰“å°å‡ºæ•´é¢—æ ‘</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"äºŒã€u-boot-è·å–GPTåˆ†åŒºè¡¨\"><a href=\"#äºŒã€u-boot-è·å–GPTåˆ†åŒºè¡¨\" class=\"headerlink\" title=\"äºŒã€u-boot è·å–GPTåˆ†åŒºè¡¨\"></a>äºŒã€u-boot è·å–GPTåˆ†åŒºè¡¨</h1><p>åœ¨ubootä¸­é€šè¿‡å‘½ä»¤æ‰“å°åˆ†åŒºè¡¨</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">part list mmc 0</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3588-android-uboot\"><a href=\"#3588-android-uboot\" class=\"headerlink\" title=\"3588-android-uboot\"></a>3588-android-uboot</h2><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;common.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;command.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;android_image.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;mmc.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;memalign.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;fdtdec.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> PART_MAX_COUNT  128</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span>\tLAB_SIZE\t\t512</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span>\tHEADER_OFFSET\tLAB_SIZE</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span>\tENTRY_OFFSET\t(2 * LAB_SIZE)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span>\tVAL1_OFFSET\t\tsizeof(u64)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span>\tVAL2_OFFSET\t\t(2 * sizeof(u64))</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">static</span> u64 <span class=\"title function_\">get_gpt_blk_cnt_and_print</span><span class=\"params\">(<span class=\"keyword\">struct</span> blk_desc *dev_desc,</span></span><br><span class=\"line\"><span class=\"params\">\t\t\t  gpt_header *gpt_head, gpt_entry **gpt_pte)</span> &#123;</span><br><span class=\"line\">\t<span class=\"type\">char</span> efi_str[PARTNAME_SZ + <span class=\"number\">1</span>];</span><br><span class=\"line\">\tu64 gpt_part_size, gpt_blk_cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\">\tgpt_entry *gpt_e;</span><br><span class=\"line\">\t<span class=\"type\">int</span> i;</span><br><span class=\"line\"></span><br><span class=\"line\">\tgpt_e = *gpt_pte;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (i = <span class=\"number\">0</span>; i &lt; gpt_head-&gt;num_partition_entries; i++) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\traite_gpt_convert_efi_name_to_char(efi_str, gpt_e[i].partition_name,</span><br><span class=\"line\">\t\t\t\t\t     PARTNAME_SZ + <span class=\"number\">1</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s: part: %2d name - GPT: %16s &quot;</span>,</span><br><span class=\"line\">\t\t      __func__, i, efi_str);</span><br><span class=\"line\">\t\tgpt_part_size = le64_to_cpu(gpt_e[i].ending_lba) -</span><br><span class=\"line\">\t\t\tle64_to_cpu(gpt_e[i].starting_lba) + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\tgpt_blk_cnt += gpt_part_size;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(gpt_part_size == <span class=\"number\">1</span>) </span><br><span class=\"line\">\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;size(LBA) - GPT: %8llu &quot;</span>,</span><br><span class=\"line\">\t\t      (<span class=\"type\">unsigned</span> <span class=\"type\">long</span> <span class=\"type\">long</span>)gpt_part_size);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;start LBA - GPT: %8llu \\n&quot;</span>,</span><br><span class=\"line\">\t\t      le64_to_cpu(gpt_e[i].starting_lba));</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> gpt_blk_cnt + gpt_e[<span class=\"number\">0</span>].starting_lba - <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">static</span> <span class=\"type\">int</span> <span class=\"title function_\">get_gpt_meta_data</span><span class=\"params\">(u64 *data_size, <span class=\"type\">void</span> **data)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    gpt_header *pgpt_head;</span><br><span class=\"line\">\tgpt_entry *entries;</span><br><span class=\"line\">\t<span class=\"type\">void</span> *meta_data;</span><br><span class=\"line\">\tu64 meta_data_size, gpt_entries_size;</span><br><span class=\"line\">\t<span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">blk_desc</span> *<span class=\"title\">dev_desc</span> =</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">\t<span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">mmc</span> *<span class=\"title\">mmc</span> =</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">\tu64 blk_size = <span class=\"number\">0</span>;</span><br><span class=\"line\">\tu64 blk_cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\">\tu64 tag = <span class=\"number\">0x55AA</span>;</span><br><span class=\"line\">\t<span class=\"type\">lbaint_t</span> lba;</span><br><span class=\"line\">    </span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (!data_size || !data) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR: Invalid Argument(s) ***\\n&quot;</span>, __func__);</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    mmc = do_returnmmc();</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (!mmc)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> CMD_RET_FAILURE;</span><br><span class=\"line\">    </span><br><span class=\"line\">    dev_desc = mmc_get_blk_desc(mmc);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (!dev_desc) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR: mmc_get_blk_desc err ***\\n&quot;</span>, __func__);</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tgpt_entries_size = <span class=\"keyword\">sizeof</span>(gpt_entry) * PART_MAX_COUNT;</span><br><span class=\"line\">\tmeta_data_size = LAB_SIZE + <span class=\"keyword\">sizeof</span>(gpt_header) + gpt_entries_size;</span><br><span class=\"line\">\tmeta_data = <span class=\"built_in\">malloc</span>(meta_data_size);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(!meta_data) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR: malloc memory (gpt meta data) ***\\n&quot;</span>, __func__);</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"built_in\">memset</span>(meta_data, <span class=\"number\">0</span>, meta_data_size);</span><br><span class=\"line\">\tpgpt_head = (gpt_header *)((<span class=\"type\">char</span> *)meta_data + HEADER_OFFSET);</span><br><span class=\"line\">\tentries = (gpt_entry *)((<span class=\"type\">char</span> *)meta_data + ENTRY_OFFSET);</span><br><span class=\"line\">\tALLOC_CACHE_ALIGN_BUFFER(legacy_mbr, mbr, dev_desc-&gt;blksz);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/* Read MBR Header from device */</span></span><br><span class=\"line\">\tlba = <span class=\"number\">0</span>; <span class=\"comment\">/* MBR is always at 0 */</span></span><br><span class=\"line\">\tblk_cnt = <span class=\"number\">1</span>; <span class=\"comment\">/* MBR (1 block) */</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (blk_dread(dev_desc, lba, blk_cnt, (ulong *)mbr) != <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;*** ERROR: Can&#x27;t read MBR header ***\\n&quot;</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">goto</span> ERROR_OUT;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/* Read GPT Header from device */</span></span><br><span class=\"line\">\tlba = GPT_PRIMARY_PARTITION_TABLE_LBA;</span><br><span class=\"line\">\tblk_cnt = <span class=\"number\">1</span>; <span class=\"comment\">/* GPT Header (1 block) */</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (blk_dread(dev_desc, lba, blk_cnt, pgpt_head) != <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">    \t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR: Can&#x27;t read GPT header ***\\n&quot;</span>, __func__);</span><br><span class=\"line\">\t\t<span class=\"keyword\">goto</span> ERROR_OUT;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tlba = GPT_PRIMARY_PARTITION_TABLE_LBA;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (validate_gpt_header(pgpt_head, lba, dev_desc-&gt;lba)) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR: validate_gpt_header GPT header ***\\n&quot;</span>, __func__);</span><br><span class=\"line\">\t\t<span class=\"keyword\">goto</span> ERROR_OUT;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (dev_desc-&gt;sig_type == SIG_TYPE_NONE) &#123;</span><br><span class=\"line\">\t\t<span class=\"type\">efi_guid_t</span> empty = &#123;&#125;;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (<span class=\"built_in\">memcmp</span>(&amp;pgpt_head-&gt;disk_guid, &amp;empty, <span class=\"keyword\">sizeof</span>(empty))) &#123;</span><br><span class=\"line\">\t\t\tdev_desc-&gt;sig_type = SIG_TYPE_GUID;</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">memcpy</span>(&amp;dev_desc-&gt;guid_sig, &amp;pgpt_head-&gt;disk_guid,</span><br><span class=\"line\">\t\t\t      <span class=\"keyword\">sizeof</span>(empty));</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (mbr-&gt;unique_mbr_signature != <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">\t\t\tdev_desc-&gt;sig_type = SIG_TYPE_MBR;</span><br><span class=\"line\">\t\t\tdev_desc-&gt;mbr_sig = mbr-&gt;unique_mbr_signature;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/* Read GPT Entries from device */</span></span><br><span class=\"line\">\tlba = le64_to_cpu(pgpt_head-&gt;partition_entry_lba);</span><br><span class=\"line\">\tblk_cnt = BLOCK_CNT((le32_to_cpu(pgpt_head-&gt;num_partition_entries) *</span><br><span class=\"line\">\t\t\t\t   \tle32_to_cpu(pgpt_head-&gt;sizeof_partition_entry)),</span><br><span class=\"line\">\t\t\t\t  \tdev_desc);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (blk_dread(dev_desc, lba, blk_cnt, entries) != blk_cnt) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR:read entries (lba=%llu) ***\\n&quot;</span>,</span><br><span class=\"line\">\t\t\t\t__func__, pgpt_head-&gt;partition_entry_lba);</span><br><span class=\"line\">\t\t<span class=\"keyword\">goto</span> ERROR_OUT;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tblk_size = dev_desc-&gt;blksz;</span><br><span class=\"line\">\tvalidate_gpt_entries(pgpt_head, entries);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tdebug(<span class=\"string\">&quot;%s read entries lba %llu (blk_cnt %llu blk_size=%llu)\\n&quot;</span>,</span><br><span class=\"line\">\t\t\t\t__func__, (<span class=\"type\">unsigned</span> <span class=\"type\">long</span> <span class=\"type\">long</span>)(ulong)lba, blk_cnt, blk_size);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tblk_cnt = get_gpt_blk_cnt(dev_desc, pgpt_head, &amp;entries);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/* </span></span><br><span class=\"line\"><span class=\"comment\">\t * build info, layout of meta_data:</span></span><br><span class=\"line\"><span class=\"comment\">\t * u64 tag | u64 blk_size | u64 blk_cnt | 488 bytes | gpt header | gpt entries</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\tblk_cnt = get_gpt_blk_cnt(dev_desc, pgpt_head, &amp;entries);</span><br><span class=\"line\">\t<span class=\"comment\">/*this value makes we known the reserved memory is available*/</span></span><br><span class=\"line\">\t<span class=\"built_in\">memcpy</span>(meta_data, (<span class=\"type\">void</span> *)&amp;tag, <span class=\"keyword\">sizeof</span>(u64));</span><br><span class=\"line\">\t<span class=\"built_in\">memcpy</span>(meta_data + VAL1_OFFSET, (<span class=\"type\">void</span> *)&amp;blk_size, <span class=\"keyword\">sizeof</span>(u64));</span><br><span class=\"line\">\t<span class=\"built_in\">memcpy</span>(meta_data + VAL2_OFFSET, (<span class=\"type\">void</span> *)&amp;blk_cnt, <span class=\"keyword\">sizeof</span>(u64));</span><br><span class=\"line\"></span><br><span class=\"line\">\t*data_size = meta_data_size;</span><br><span class=\"line\">\t*data = meta_data;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">ERROR_OUT:</span><br><span class=\"line\">\t<span class=\"built_in\">free</span>(meta_data);</span><br><span class=\"line\">\tmeta_data = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<p>å‚è€ƒï¼š</p>\n<p><a href=\"http://www.wowotech.net/device_model/dt-code-file-struct-parse.html\">Device Treeï¼ˆå››ï¼‰ï¼šæ–‡ä»¶ç»“æ„è§£æ (wowotech.net)</a></p>\n<p><a href=\"https://zhuanlan.zhihu.com/p/376295326\">Linuxè®¾å¤‡æ ‘è¯­æ³•åˆ†æè¯¦è§£æ•™ç¨‹(ä¸‰)u-bootè®¾å¤‡æ ‘çš„ä¼ é€’ - çŸ¥ä¹ (zhihu.com)</a></p>\n<p><a href=\"https://zhuanlan.zhihu.com/p/376296222\">Linuxè®¾å¤‡æ ‘è¯­æ³•åˆ†æè¯¦è§£æ•™ç¨‹(å››)kernelçš„è§£æ - çŸ¥ä¹ (zhihu.com)</a></p>\n<p><a href=\"https://www.cnblogs.com/solo666/p/16518154.html\">https://www.cnblogs.com/solo666/p/16518154.html</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p>U-Bootå®˜ç½‘:<a href=\"https://docs.u-boot.org/en/latest/\">https://docs.u-boot.org/en/latest/</a></p>\n<p>u-bootå¯åŠ¨æµç¨‹</p>\n<ul>\n<li>æ¿å­ä¸Šç”µä»¥åï¼Œé¦–å…ˆæ‰§è¡Œçš„æ˜¯ROMä¸­çš„ä¸€æ®µå¯åŠ¨ä»£ç ã€‚å¯åŠ¨ä»£ç <strong>æ ¹æ®å¯„å­˜å™¨&#x2F;å¤–éƒ¨ç®¡è„šé…ç½®</strong>ï¼Œç¡®å®šæ˜¯è¿›å…¥ä¸‹è½½æ¨¡å¼ï¼Œè¿˜æ˜¯ä»æŸä»‹è´¨(Flash&#x2F;EMMC&#x2F;SDå¡ç­‰å­˜å‚¨è®¾å¤‡)å¯åŠ¨u-boot</li>\n</ul>\n<blockquote>\n<p>ROMä¸­çš„ä»£ç æ˜¯å›ºåŒ–çš„ï¼Œæ— æ³•ä¿®æ”¹</p>\n</blockquote>\n<h1 id=\"ä¸€ã€ä»‹ç»\"><a href=\"#ä¸€ã€ä»‹ç»\" class=\"headerlink\" title=\"ä¸€ã€ä»‹ç»\"></a>ä¸€ã€ä»‹ç»</h1><blockquote>\n<p>FDTï¼Œflatted device treeï¼Œæ‰å¹³è®¾å¤‡æ ‘ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯å°†éƒ¨åˆ†è®¾å¤‡ä¿¡æ¯ç»“æ„å­˜æ”¾åˆ°device treeæ–‡ä»¶ä¸­ã€‚</p>\n<p>ubootæœ€ç»ˆå°†å…¶ç¼–è¯‘æˆdtbæ–‡ä»¶ï¼Œä½¿ç”¨è¿‡ç¨‹ä¸­é€šè¿‡è§£æè¯¥dtbæ¥è·å–æ¿çº§è®¾å¤‡ä¿¡æ¯ã€‚  </p>\n</blockquote>\n<blockquote>\n<p>U-bootçš„dtbå’Œkernelä¸­çš„dtbæ˜¯ä¸€è‡´çš„ï¼Œæœ‰å…³fdtçš„è¯¦ç»†ä»‹ç»ï¼Œå‚è€ƒdoc&#x2F;README.fdt-control</p>\n</blockquote>\n<h3 id=\"dtbåœ¨U-bootä¸­çš„ä½ç½®\"><a href=\"#dtbåœ¨U-bootä¸­çš„ä½ç½®\" class=\"headerlink\" title=\"dtbåœ¨U-bootä¸­çš„ä½ç½®\"></a>dtbåœ¨U-bootä¸­çš„ä½ç½®</h3><ul>\n<li>dtbèƒ½å¤Ÿä»¥ä¸¤ç§å½¢å¼ç¼–è¯‘åˆ°U-bootçš„é•œåƒä¸­</li>\n</ul>\n<ol>\n<li>dtbå’Œu-bootçš„binæ–‡ä»¶åˆ†ç¦»(imx6qä¸­ä½¿ç”¨çš„è¿™ç§æ–¹å¼ï¼Œåœ¨.configæ–‡ä»¶ä¸­å¯ä»¥æŸ¥çœ‹åˆ°)</li>\n</ol>\n<blockquote>\n<p>é€šè¿‡CONFIG_OF_SEPARATEå®å®šä¹‰ä½¿èƒ½ï¼Œdtbæœ€åä¼šè¿½åŠ åˆ°u-bootçš„binæ–‡ä»¶çš„æœ€åé¢ï¼Œé€šè¿‡u-bootçš„ç»“æŸåœ°å€ç¬¦å·_endç¬¦å·æ¥è·å–dtbçš„åœ°å€</p>\n</blockquote>\n<ol>\n<li>dtbé›†æˆåˆ°u-bootçš„binæ–‡ä»¶å†…éƒ¨</li>\n</ol>\n<blockquote>\n<p>é€šè¿‡CONFIG_OF_EMBEDå®å®šä¹‰ä½¿èƒ½ï¼Œdtbä¼šä½äºu-bootçš„.dtb.init.rodataæ®µä¸­ï¼Œé€šè¿‡__dtb_dt_beginç¬¦å·æ¥è·å–dtb</p>\n</blockquote>\n<ol>\n<li>è·å–dtsæ–‡ä»¶çš„åœ°å€gd-&gt;fdt_blob</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// å®ç”¨æ¥è¡¨ç¤ºæ˜¯å¦æŠŠdtbæ–‡ä»¶æ”¾åœ¨uboot.binçš„æ–‡ä»¶ä¸­</span><br><span class=\"line\">CONFIG_OF_EMBED</span><br><span class=\"line\"></span><br><span class=\"line\">// å•ç‹¬ç¼–è¯‘dtbæ–‡ä»¶</span><br><span class=\"line\">CONFIG_OF_SEPARATEï¼Œç¼–è¯‘å‡ºæ¥çš„dtbæ”¾åœ¨uboot.binçš„æœ€åé¢ï¼Œå°±æ˜¯dtbè¿½åŠ åˆ°ubootçš„binæ–‡ä»¶åé¢æ—¶ï¼Œé€šè¿‡_endç¬¦å·æ¥è·å–dtbåœ°å€</span><br><span class=\"line\"></span><br><span class=\"line\">gd-&gt;fdt_blob = (ulong *)&amp;_end;</span><br><span class=\"line\"></span><br><span class=\"line\">// å¯ä»¥é€šè¿‡fdtcontroladdrç¯å¢ƒå˜é‡æ¥æŒ‡å®šfdtçš„åœ°å€</span><br><span class=\"line\">gd-&gt;fdt_blob = (void *)getenv_ulong(&quot;fdtcontroladdr&quot;, 16,</span><br><span class=\"line\">\t\t\t\t\t\t(uintptr_t)gd-&gt;fdt_blob); </span><br></pre></td></tr></table></figure>\n\n<h3 id=\"dtbè§£ææ¥å£\"><a href=\"#dtbè§£ææ¥å£\" class=\"headerlink\" title=\"dtbè§£ææ¥å£\"></a>dtbè§£ææ¥å£</h3><ul>\n<li>å®šä¹‰åœ¨lib&#x2F;fdtdec.cæ–‡ä»¶ä¸­ï¼ŒèŠ‚ç‚¹å˜é‡nodeä¸­å­˜æ”¾çš„æ˜¯åç§»åœ°å€</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// è·å¾—dtbä¸‹æŸä¸ªèŠ‚ç‚¹çš„è·¯å¾„pathçš„åç§»ï¼Œåç§»å°±ä»£è¡¨è¿™ä¸ªèŠ‚ç‚¹</span><br><span class=\"line\">int fdt_path_offset(const void *fdt, const char *path)</span><br><span class=\"line\">egï¼šnode = fdt_path_offset(gd-&gt;fdt_blob, â€œ/aliasesâ€);</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªå­—ç¬¦ä¸²å±æ€§å€¼</span><br><span class=\"line\">const void *fdt_getprop(const void *fdt, int nodeoffset, const char *name, int *lenp)</span><br><span class=\"line\">egï¼š mac = fdt_getprop(gd-&gt;fdt_blob, node, â€œmac-addressâ€, &amp;len);</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ•´å½¢æ•°ç»„å±æ€§å€¼</span><br><span class=\"line\">int fdtdec_get_int_array(const void *blob, int node, const char *prop_name, u32 *array, int count)</span><br><span class=\"line\">egï¼š ret = fdtdec_get_int_array(blob, node, â€œinterruptsâ€, cell, ARRAY_SIZE(cell));</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—èŠ‚ç‚¹nodeçš„åœ°å€å±æ€§å€¼</span><br><span class=\"line\">fdt_addr_t fdtdec_get_addr(const void *blob, int node, const char *prop_name)</span><br><span class=\"line\">egï¼šfdtdec_get_addr(blob, node, â€œregâ€);</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—configèŠ‚ç‚¹ä¸‹çš„æ•´å½¢å±æ€§ã€boolå±æ€§ã€å­—ç¬¦ä¸²ç­‰ç­‰</span><br><span class=\"line\">fdtdec_get_config_intã€fdtdec_get_config_boolã€fdtdec_get_config_string</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—chosenä¸‹çš„nameèŠ‚ç‚¹çš„åç§»</span><br><span class=\"line\">int fdtdec_get_chosen_node(const void *blob, const char *name)</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—chosenä¸‹nameå±æ€§çš„å€¼</span><br><span class=\"line\">const char *fdtdec_get_chosen_prop(const void *blob, const char *name)</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>å®šä¹‰åœ¨lib&#x2F;fdtdec_common.cæ–‡ä»¶ä¸­</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ•´å½¢å±æ€§å€¼</span><br><span class=\"line\">int fdtdec_get_int(const void *blob, int node, const char *prop_name, int default_val)</span><br><span class=\"line\">egï¼š bus-&gt;udelay = fdtdec_get_int(blob, node, â€œi2c-gpio,delay-usâ€, DEFAULT_UDELAY);</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ— ç¬¦å·æ•´å½¢å±æ€§å€¼</span><br><span class=\"line\">fdtdec_get_uint</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"fdt-å‘½ä»¤\"><a href=\"#fdt-å‘½ä»¤\" class=\"headerlink\" title=\"fdt å‘½ä»¤\"></a>fdt å‘½ä»¤</h2><p>å¯¹äºu-bootæä¾›äº†fdtçš„ç›¸å…³å‘½ä»¤</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fdt - flattened device tree utility commands</span><br><span class=\"line\"></span><br><span class=\"line\">Usage:</span><br><span class=\"line\">fdt addr [-c]  &lt;addr&gt; [&lt;length&gt;]   - Set the [control] fdt location to &lt;addr&gt;</span><br><span class=\"line\">fdt apply &lt;addr&gt;                    - Apply overlay to the DT</span><br><span class=\"line\">fdt move   &lt;fdt&gt; &lt;newaddr&gt; &lt;length&gt; - Copy the fdt to &lt;addr&gt; and make it active</span><br><span class=\"line\">fdt resize [&lt;extrasize&gt;]            - Resize fdt to size + padding to 4k addr + some optional &lt;extrasize&gt; if needed</span><br><span class=\"line\">fdt print  &lt;path&gt; [&lt;prop&gt;]          - Recursive print starting at &lt;path&gt;</span><br><span class=\"line\">fdt list   &lt;path&gt; [&lt;prop&gt;]          - Print one level starting at &lt;path&gt;</span><br><span class=\"line\">fdt get value &lt;var&gt; &lt;path&gt; &lt;prop&gt;   - Get &lt;property&gt; and store in &lt;var&gt;</span><br><span class=\"line\">fdt get name &lt;var&gt; &lt;path&gt; &lt;index&gt;   - Get name of node &lt;index&gt; and store in &lt;var&gt;</span><br><span class=\"line\">fdt get addr &lt;var&gt; &lt;path&gt; &lt;prop&gt;    - Get start address of &lt;property&gt; and store in &lt;var&gt;</span><br><span class=\"line\">fdt get size &lt;var&gt; &lt;path&gt; [&lt;prop&gt;]  - Get size of [&lt;property&gt;] or num nodes and store in &lt;var&gt;</span><br><span class=\"line\">fdt set    &lt;path&gt; &lt;prop&gt; [&lt;val&gt;]    - Set &lt;property&gt; [to &lt;val&gt;]</span><br><span class=\"line\">fdt mknode &lt;path&gt; &lt;node&gt;            - Create a new node after &lt;path&gt;</span><br><span class=\"line\">fdt rm     &lt;path&gt; [&lt;prop&gt;]          - Delete the node or &lt;property&gt;</span><br><span class=\"line\">fdt header                          - Display header info</span><br><span class=\"line\">fdt bootcpu &lt;id&gt;                    - Set boot cpuid</span><br><span class=\"line\">fdt memory &lt;addr&gt; &lt;size&gt;            - Add/Update memory node</span><br><span class=\"line\">fdt rsvmem print                    - Show current mem reserves</span><br><span class=\"line\">fdt rsvmem add &lt;addr&gt; &lt;size&gt;        - Add a mem reserve</span><br><span class=\"line\">fdt rsvmem delete &lt;index&gt;           - Delete a mem reserves</span><br><span class=\"line\">fdt chosen [&lt;start&gt; &lt;end&gt;]          - Add/update the /chosen branch in the tree</span><br><span class=\"line\">                                        &lt;start&gt;/&lt;end&gt; - initrd start/end addr</span><br><span class=\"line\">NOTE: Dereference aliases by omitting the leading &#x27;/&#x27;, e.g. fdt print ethernet0.</span><br></pre></td></tr></table></figure>\n\n<p>fdt printåŠ pathå‚æ•°ï¼Œåˆ™æ‰“pathå†…å®¹ï¼Œå¦‚ä¸‹(å…¶ä¸­&#x2F;memoryæ˜¯path)ï¼š</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">U-Boot&gt; fdt print /memory</span><br><span class=\"line\">memory &#123;</span><br><span class=\"line\">device_type = <span class=\"string\">&quot;memory&quot;</span>;</span><br><span class=\"line\">reg = &lt;<span class=\"number\">0x70000000</span> <span class=\"number\">0x4000000</span>&gt;;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">U-Boot&gt; fdt print #ä¸åŠ å‚æ•°æ—¶ï¼Œæ‰“å°å‡ºæ•´é¢—æ ‘</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"äºŒã€u-boot-è·å–GPTåˆ†åŒºè¡¨\"><a href=\"#äºŒã€u-boot-è·å–GPTåˆ†åŒºè¡¨\" class=\"headerlink\" title=\"äºŒã€u-boot è·å–GPTåˆ†åŒºè¡¨\"></a>äºŒã€u-boot è·å–GPTåˆ†åŒºè¡¨</h1><p>åœ¨ubootä¸­é€šè¿‡å‘½ä»¤æ‰“å°åˆ†åŒºè¡¨</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">part list mmc 0</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3588-android-uboot\"><a href=\"#3588-android-uboot\" class=\"headerlink\" title=\"3588-android-uboot\"></a>3588-android-uboot</h2><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;common.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;command.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;android_image.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;mmc.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;memalign.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;fdtdec.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> PART_MAX_COUNT  128</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span>\tLAB_SIZE\t\t512</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span>\tHEADER_OFFSET\tLAB_SIZE</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span>\tENTRY_OFFSET\t(2 * LAB_SIZE)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span>\tVAL1_OFFSET\t\tsizeof(u64)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span>\tVAL2_OFFSET\t\t(2 * sizeof(u64))</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">static</span> u64 <span class=\"title function_\">get_gpt_blk_cnt_and_print</span><span class=\"params\">(<span class=\"keyword\">struct</span> blk_desc *dev_desc,</span></span><br><span class=\"line\"><span class=\"params\">\t\t\t  gpt_header *gpt_head, gpt_entry **gpt_pte)</span> &#123;</span><br><span class=\"line\">\t<span class=\"type\">char</span> efi_str[PARTNAME_SZ + <span class=\"number\">1</span>];</span><br><span class=\"line\">\tu64 gpt_part_size, gpt_blk_cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\">\tgpt_entry *gpt_e;</span><br><span class=\"line\">\t<span class=\"type\">int</span> i;</span><br><span class=\"line\"></span><br><span class=\"line\">\tgpt_e = *gpt_pte;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (i = <span class=\"number\">0</span>; i &lt; gpt_head-&gt;num_partition_entries; i++) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\traite_gpt_convert_efi_name_to_char(efi_str, gpt_e[i].partition_name,</span><br><span class=\"line\">\t\t\t\t\t     PARTNAME_SZ + <span class=\"number\">1</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s: part: %2d name - GPT: %16s &quot;</span>,</span><br><span class=\"line\">\t\t      __func__, i, efi_str);</span><br><span class=\"line\">\t\tgpt_part_size = le64_to_cpu(gpt_e[i].ending_lba) -</span><br><span class=\"line\">\t\t\tle64_to_cpu(gpt_e[i].starting_lba) + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\tgpt_blk_cnt += gpt_part_size;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(gpt_part_size == <span class=\"number\">1</span>) </span><br><span class=\"line\">\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;size(LBA) - GPT: %8llu &quot;</span>,</span><br><span class=\"line\">\t\t      (<span class=\"type\">unsigned</span> <span class=\"type\">long</span> <span class=\"type\">long</span>)gpt_part_size);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;start LBA - GPT: %8llu \\n&quot;</span>,</span><br><span class=\"line\">\t\t      le64_to_cpu(gpt_e[i].starting_lba));</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> gpt_blk_cnt + gpt_e[<span class=\"number\">0</span>].starting_lba - <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">static</span> <span class=\"type\">int</span> <span class=\"title function_\">get_gpt_meta_data</span><span class=\"params\">(u64 *data_size, <span class=\"type\">void</span> **data)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    gpt_header *pgpt_head;</span><br><span class=\"line\">\tgpt_entry *entries;</span><br><span class=\"line\">\t<span class=\"type\">void</span> *meta_data;</span><br><span class=\"line\">\tu64 meta_data_size, gpt_entries_size;</span><br><span class=\"line\">\t<span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">blk_desc</span> *<span class=\"title\">dev_desc</span> =</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">\t<span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">mmc</span> *<span class=\"title\">mmc</span> =</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">\tu64 blk_size = <span class=\"number\">0</span>;</span><br><span class=\"line\">\tu64 blk_cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\">\tu64 tag = <span class=\"number\">0x55AA</span>;</span><br><span class=\"line\">\t<span class=\"type\">lbaint_t</span> lba;</span><br><span class=\"line\">    </span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (!data_size || !data) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR: Invalid Argument(s) ***\\n&quot;</span>, __func__);</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    mmc = do_returnmmc();</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (!mmc)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> CMD_RET_FAILURE;</span><br><span class=\"line\">    </span><br><span class=\"line\">    dev_desc = mmc_get_blk_desc(mmc);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (!dev_desc) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR: mmc_get_blk_desc err ***\\n&quot;</span>, __func__);</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tgpt_entries_size = <span class=\"keyword\">sizeof</span>(gpt_entry) * PART_MAX_COUNT;</span><br><span class=\"line\">\tmeta_data_size = LAB_SIZE + <span class=\"keyword\">sizeof</span>(gpt_header) + gpt_entries_size;</span><br><span class=\"line\">\tmeta_data = <span class=\"built_in\">malloc</span>(meta_data_size);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(!meta_data) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR: malloc memory (gpt meta data) ***\\n&quot;</span>, __func__);</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"built_in\">memset</span>(meta_data, <span class=\"number\">0</span>, meta_data_size);</span><br><span class=\"line\">\tpgpt_head = (gpt_header *)((<span class=\"type\">char</span> *)meta_data + HEADER_OFFSET);</span><br><span class=\"line\">\tentries = (gpt_entry *)((<span class=\"type\">char</span> *)meta_data + ENTRY_OFFSET);</span><br><span class=\"line\">\tALLOC_CACHE_ALIGN_BUFFER(legacy_mbr, mbr, dev_desc-&gt;blksz);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/* Read MBR Header from device */</span></span><br><span class=\"line\">\tlba = <span class=\"number\">0</span>; <span class=\"comment\">/* MBR is always at 0 */</span></span><br><span class=\"line\">\tblk_cnt = <span class=\"number\">1</span>; <span class=\"comment\">/* MBR (1 block) */</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (blk_dread(dev_desc, lba, blk_cnt, (ulong *)mbr) != <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;*** ERROR: Can&#x27;t read MBR header ***\\n&quot;</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">goto</span> ERROR_OUT;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/* Read GPT Header from device */</span></span><br><span class=\"line\">\tlba = GPT_PRIMARY_PARTITION_TABLE_LBA;</span><br><span class=\"line\">\tblk_cnt = <span class=\"number\">1</span>; <span class=\"comment\">/* GPT Header (1 block) */</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (blk_dread(dev_desc, lba, blk_cnt, pgpt_head) != <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">    \t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR: Can&#x27;t read GPT header ***\\n&quot;</span>, __func__);</span><br><span class=\"line\">\t\t<span class=\"keyword\">goto</span> ERROR_OUT;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tlba = GPT_PRIMARY_PARTITION_TABLE_LBA;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (validate_gpt_header(pgpt_head, lba, dev_desc-&gt;lba)) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR: validate_gpt_header GPT header ***\\n&quot;</span>, __func__);</span><br><span class=\"line\">\t\t<span class=\"keyword\">goto</span> ERROR_OUT;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (dev_desc-&gt;sig_type == SIG_TYPE_NONE) &#123;</span><br><span class=\"line\">\t\t<span class=\"type\">efi_guid_t</span> empty = &#123;&#125;;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (<span class=\"built_in\">memcmp</span>(&amp;pgpt_head-&gt;disk_guid, &amp;empty, <span class=\"keyword\">sizeof</span>(empty))) &#123;</span><br><span class=\"line\">\t\t\tdev_desc-&gt;sig_type = SIG_TYPE_GUID;</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">memcpy</span>(&amp;dev_desc-&gt;guid_sig, &amp;pgpt_head-&gt;disk_guid,</span><br><span class=\"line\">\t\t\t      <span class=\"keyword\">sizeof</span>(empty));</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (mbr-&gt;unique_mbr_signature != <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">\t\t\tdev_desc-&gt;sig_type = SIG_TYPE_MBR;</span><br><span class=\"line\">\t\t\tdev_desc-&gt;mbr_sig = mbr-&gt;unique_mbr_signature;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/* Read GPT Entries from device */</span></span><br><span class=\"line\">\tlba = le64_to_cpu(pgpt_head-&gt;partition_entry_lba);</span><br><span class=\"line\">\tblk_cnt = BLOCK_CNT((le32_to_cpu(pgpt_head-&gt;num_partition_entries) *</span><br><span class=\"line\">\t\t\t\t   \tle32_to_cpu(pgpt_head-&gt;sizeof_partition_entry)),</span><br><span class=\"line\">\t\t\t\t  \tdev_desc);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (blk_dread(dev_desc, lba, blk_cnt, entries) != blk_cnt) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR:read entries (lba=%llu) ***\\n&quot;</span>,</span><br><span class=\"line\">\t\t\t\t__func__, pgpt_head-&gt;partition_entry_lba);</span><br><span class=\"line\">\t\t<span class=\"keyword\">goto</span> ERROR_OUT;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tblk_size = dev_desc-&gt;blksz;</span><br><span class=\"line\">\tvalidate_gpt_entries(pgpt_head, entries);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tdebug(<span class=\"string\">&quot;%s read entries lba %llu (blk_cnt %llu blk_size=%llu)\\n&quot;</span>,</span><br><span class=\"line\">\t\t\t\t__func__, (<span class=\"type\">unsigned</span> <span class=\"type\">long</span> <span class=\"type\">long</span>)(ulong)lba, blk_cnt, blk_size);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tblk_cnt = get_gpt_blk_cnt(dev_desc, pgpt_head, &amp;entries);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/* </span></span><br><span class=\"line\"><span class=\"comment\">\t * build info, layout of meta_data:</span></span><br><span class=\"line\"><span class=\"comment\">\t * u64 tag | u64 blk_size | u64 blk_cnt | 488 bytes | gpt header | gpt entries</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\tblk_cnt = get_gpt_blk_cnt(dev_desc, pgpt_head, &amp;entries);</span><br><span class=\"line\">\t<span class=\"comment\">/*this value makes we known the reserved memory is available*/</span></span><br><span class=\"line\">\t<span class=\"built_in\">memcpy</span>(meta_data, (<span class=\"type\">void</span> *)&amp;tag, <span class=\"keyword\">sizeof</span>(u64));</span><br><span class=\"line\">\t<span class=\"built_in\">memcpy</span>(meta_data + VAL1_OFFSET, (<span class=\"type\">void</span> *)&amp;blk_size, <span class=\"keyword\">sizeof</span>(u64));</span><br><span class=\"line\">\t<span class=\"built_in\">memcpy</span>(meta_data + VAL2_OFFSET, (<span class=\"type\">void</span> *)&amp;blk_cnt, <span class=\"keyword\">sizeof</span>(u64));</span><br><span class=\"line\"></span><br><span class=\"line\">\t*data_size = meta_data_size;</span><br><span class=\"line\">\t*data = meta_data;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">ERROR_OUT:</span><br><span class=\"line\">\t<span class=\"built_in\">free</span>(meta_data);</span><br><span class=\"line\">\tmeta_data = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<p>å‚è€ƒï¼š</p>\n<p><a href=\"http://www.wowotech.net/device_model/dt-code-file-struct-parse.html\">Device Treeï¼ˆå››ï¼‰ï¼šæ–‡ä»¶ç»“æ„è§£æ (wowotech.net)</a></p>\n<p><a href=\"https://zhuanlan.zhihu.com/p/376295326\">Linuxè®¾å¤‡æ ‘è¯­æ³•åˆ†æè¯¦è§£æ•™ç¨‹(ä¸‰)u-bootè®¾å¤‡æ ‘çš„ä¼ é€’ - çŸ¥ä¹ (zhihu.com)</a></p>\n<p><a href=\"https://zhuanlan.zhihu.com/p/376296222\">Linuxè®¾å¤‡æ ‘è¯­æ³•åˆ†æè¯¦è§£æ•™ç¨‹(å››)kernelçš„è§£æ - çŸ¥ä¹ (zhihu.com)</a></p>\n<p><a href=\"https://www.cnblogs.com/solo666/p/16518154.html\">https://www.cnblogs.com/solo666/p/16518154.html</a></p>\n"},{"title":"cgroup","categories":["kernel"],"tags":["cgroup"],"date":"2024-05-16T07:30:33.000Z","_content":"\n[toc]\n\ncgroupæ˜¯linuxå†…æ ¸å®ç°ã€ç”¨äºæ§åˆ¶linuxç³»ç»Ÿèµ„æºçš„ç»„ä»¶ã€‚å› æ­¤è¦äº†è§£cgroupï¼Œé¦–å…ˆä»å¼•å…¥è¿™ä¸ªç»„ä»¶çš„kernelæ–‡æ¡£ä¸­å¯»æ‰¾ã€‚\n\nå»åˆ°ä¸¾ä¸–é—»åçš„www.kernel.org\n\næ‰¾åˆ°ä»‹ç»æ–‡æ¡£ï¼šDocumentation/cgroup-v1/cgroups.txt\n\n## 1 ä»€ä¹ˆæ˜¯cgroup?\n\n>cgroup ï¼Œæ§åˆ¶ç»„ï¼Œå®ƒæä¾›äº†ä¸€å¥—æœºåˆ¶ç”¨äºæ§åˆ¶ä¸€ç»„ç‰¹å®šè¿›ç¨‹å¯¹èµ„æºçš„ä½¿ç”¨ã€‚cgroupç»‘å®šä¸€ä¸ªè¿›ç¨‹é›†åˆåˆ°ä¸€ä¸ªæˆ–å¤šä¸ªå­ç³»ç»Ÿä¸Šã€‚\n>\n>subsystemï¼Œå­ç³»ç»Ÿï¼Œä¸€ä¸ªé€šè¿‡cgroupæä¾›çš„å·¥å…·å’Œæ¥å£æ¥ç®¡ç†è¿›ç¨‹é›†åˆçš„æ¨¡å—ã€‚ä¸€ä¸ªå­ç³»ç»Ÿå°±æ˜¯ä¸€ä¸ªå…¸å‹çš„â€œèµ„æºæ§åˆ¶å™¨â€ï¼Œç”¨æ¥è°ƒåº¦èµ„æºæˆ–è€…æ§åˆ¶èµ„æºä½¿ç”¨çš„ä¸Šé™ã€‚å…¶å®æ¯ç§èµ„æºå°±æ˜¯ä¸€ä¸ªå­ç³»ç»Ÿã€‚å­ç³»ç»Ÿå¯ä»¥æ˜¯ä»¥è¿›ç¨‹ä¸ºå•ä½çš„ä»»ä½•ä¸œè¥¿ï¼Œæ¯”å¦‚è™šæ‹ŸåŒ–å­ç³»ç»Ÿã€å†…å­˜å­ç³»ç»Ÿã€‚\n>\n>hierarchyï¼Œå±‚çº§æ ‘ï¼Œå¤šä¸ªcgroupçš„é›†åˆï¼Œè¿™äº›é›†åˆæ„æˆçš„æ ‘å«hierarchyã€‚å¯ä»¥è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªèµ„æºæ ‘ï¼Œé™„ç€åœ¨è¿™ä¸Šé¢çš„è¿›ç¨‹å¯ä»¥ä½¿ç”¨çš„èµ„æºä¸Šé™å¿…é¡»å—æ ‘ä¸ŠèŠ‚ç‚¹ï¼ˆcgroupï¼‰çš„æ§åˆ¶ã€‚hierarchyä¸Šçš„å±‚æ¬¡å…³ç³»é€šè¿‡cgroupfsè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿæ˜¾ç¤ºã€‚ç³»ç»Ÿå…è®¸å¤šä¸ªhierarchyåŒæ—¶å­˜åœ¨ï¼Œæ¯ä¸ªhierachyåŒ…å«ç³»ç»Ÿä¸­çš„éƒ¨åˆ†æˆ–è€…å…¨éƒ¨è¿›ç¨‹é›†åˆã€‚\n>\n>cgroupfsæ˜¯ç”¨æˆ·ç®¡ç†æ“çºµcgroupçš„ä¸»è¦æ¥å£ï¼šé€šè¿‡åœ¨cgroupfsæ–‡ä»¶ç³»ç»Ÿä¸­åˆ›å»ºç›®å½•ï¼Œå®ç°cgroupçš„åˆ›å»ºï¼›é€šè¿‡å‘ç›®å½•ä¸‹çš„å±æ€§æ–‡ä»¶å†™å…¥å†…å®¹ï¼Œè®¾ç½®cgroupå¯¹èµ„æºçš„æ§åˆ¶ï¼›å‘taskå±æ€§æ–‡ä»¶å†™å…¥è¿›ç¨‹IDï¼Œå¯ä»¥å°†è¿›ç¨‹ç»‘å®šåˆ°æŸä¸ªcgroupï¼Œä»¥æ­¤è¾¾åˆ°æ§åˆ¶è¿›ç¨‹èµ„æºä½¿ç”¨çš„ç›®çš„ï¼›ä¹Ÿå¯ä»¥åˆ—å‡ºcgroupåŒ…å«çš„è¿›ç¨‹pidã€‚è¿™äº›æ“ä½œå½±å“çš„æ˜¯sysfså…³è”çš„hierarchyï¼Œå¯¹å…¶å®ƒhierarchyæ²¡æœ‰å½±å“ã€‚\n>\n>å¯¹äºcgroupï¼Œå…¶æœ¬èº«çš„ä½œç”¨åªæ˜¯ä»»åŠ¡è·Ÿè¸ªã€‚ä½†å…¶å®ƒç³»ç»Ÿï¼ˆæ¯”å¦‚cpusetsï¼Œcpuacctï¼‰ï¼Œå¯ä»¥åˆ©ç”¨cgroupçš„è¿™ä¸ªåŠŸèƒ½å®ç°ä¸€äº›æ–°çš„å±æ€§ï¼Œæ¯”å¦‚ç»Ÿè®¡æˆ–è€…æ§åˆ¶ä¸€ä¸ªcgroupä¸­è¿›ç¨‹å¯ä»¥è®¿é—®çš„èµ„æºã€‚ä¸¾ä¸ªä¾‹å­ï¼Œcpusetså­ç³»ç»Ÿå¯ä»¥å°†è¿›ç¨‹ç»‘å®šåˆ°ç‰¹å®šçš„cpuå’Œå†…å­˜èŠ‚ç‚¹ä¸Šã€‚\n\n2 ä¸ºä»€ä¹ˆéœ€è¦cgroup?\n\n>\n>\n>è¿™ä¸ªé—®é¢˜ç›¸å½“äºé—®cgroupé‡è¦å—ï¼Ÿæœ‰å“ªäº›åœ°æ–¹ç”¨åˆ°äº†ã€‚å›ç­”æ˜¯é‡è¦ï¼Œåˆä¸é‡è¦ã€‚å¦‚æœä½ ç”¨åˆ°äº†ï¼Œé‚£å°±é‡è¦ï¼Œå¦‚æœæ²¡æœ‰ç”¨åˆ°ï¼Œé‚£å°±ä¸é‡è¦ã€‚å‘µå‘µå‘µ~~~~å…¶å®æŒºé‡è¦çš„ã€‚cgroupçš„ä¸»è¦è¿ç”¨æ˜¯èµ„æºè·Ÿè¸ªã€‚æˆ‘æ¥è§¦çš„åœºæ™¯å°±æ˜¯ç”¨cgroupæ§åˆ¶è™šæ‹Ÿæœºè¿›ç¨‹æˆ–è€…dockerè¿›ç¨‹å¯ä»¥ä½¿ç”¨çš„èµ„æºã€‚å½“ä½ æƒ³åœ¨linuxå¯¹åº”ç”¨è¿›ç¨‹åšèµ„æºè®¿é—®æ§åˆ¶çš„æ—¶å€™ï¼Œcgroupå°±æ´¾ä¸Šç”¨åœºäº†ã€‚\n\n## 3 cgroupæ€ä¹ˆå®ç°çš„ï¼Ÿ\n\n>â€”â€”    ç³»ç»Ÿä¸­çš„æ¯ä¸ªè¿›ç¨‹ï¼ˆtask_structï¼Œåé¢ç”¨taskä»£æŒ‡ï¼‰éƒ½æŒæœ‰ä¸€ä¸ªæŒ‡å‘css_setç»“æ„çš„æŒ‡é’ˆã€‚\n>\n>â€”â€”    ä¸€ä¸ªcss_setç»“æ„ä½“åŒ…å«äº†ä¸€ç»„æŒ‡å‘cgroup_subsys_stateå¯¹è±¡çš„æŒ‡é’ˆï¼ˆæ‰€ä»¥ä¸€ä¸ªtaskå¯ä»¥é™„åŠ åˆ°å¤šä¸ªcgroupä¸Šï¼‰ï¼Œæ¯ä¸ªcgroup_subsys_stateåœ¨ç³»ç»Ÿä¸­éƒ½æœ‰æ³¨å†Œã€‚taskç»“æ„ä½“æ²¡æœ‰ç›´æ¥æŒ‡å‘hierarchyä¸­ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆcgroupï¼‰çš„æŒ‡é’ˆã€‚ä½†å¯ä»¥é€šè¿‡å…¶åŒ…å«çš„cgroup_subsys_stateé—´æ¥ç¡®å®šã€‚è¿™æ ·è®¾è®¡çš„åŸå› æ˜¯cpuå¯¹subsystem stateçš„è®¿é—®å¾ˆé¢‘ç¹ï¼Œä½†æ¶‰åŠåˆ°å°†taskç»‘å®šåˆ°cgroupçš„æ“ä½œå´ä¸å¤šã€‚taskä¸­è¿˜æœ‰ä¸ªåŒå‘é“¾è¡¨cg_listï¼Œè¿™ä¸ªé“¾è¡¨ç»´æŠ¤æ‰€æœ‰åŒå±äºä¸€ä¸ªcss_setçš„tasksã€‚\n>\n>â€”â€”    ç”¨æˆ·å¯ä»¥é€šè¿‡cgroupfsæ–‡ä»¶ç³»ç»Ÿæ¥æµè§ˆcgroup hierarchyã€‚\n>\n>â€”â€”    ç”¨æˆ·å¯ä»¥åˆ—å‡ºä»»æ„ä¸€ä¸ªcgroupä¸Šé™„ç€çš„task PID\n>\n>cgroupåœ¨kernelä¸­é™¤äº†æœ¬èº«åŠŸèƒ½çš„å®ç°å¤–ï¼Œåœ¨kernelä¸­è¿˜æœ‰ä¸¤å¤„ä¿®æ”¹ï¼š\n>\n>â€”â€”    åœ¨kernelå¯åŠ¨æ—¶å¯¹root cgroupçš„åˆå§‹åŒ–å’Œcss_setç»“æ„ä½“çš„åˆå§‹åŒ–ã€‚è¿™ä¸ªåœ¨init/main.cæ–‡ä»¶ä¸­å®ç°ã€‚\n>\n>â€”â€”    åœ¨taskçš„åˆ›å»ºï¼ˆforkï¼‰å’Œé€€å‡ºï¼ˆexitï¼‰é˜¶æ®µï¼Œå¯¹åº”åœ°å°†taskä¸css_setè¿›è¡Œç»‘å®šå’Œè§£ç»‘ã€‚\n>\n>å¦å¤–ï¼Œcgroupä¸ºäº†å‘ç”¨æˆ·æä¾›æ“ä½œæ¥å£ï¼Œç‰¹åˆ«å¼€å‘äº†ä¸€ä¸ªè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿç±»å‹ï¼ˆcgroupfsï¼‰ï¼Œè¿™ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸sysfsï¼Œprocç±»ä¼¼ã€‚cgroupfsæ˜¯å‘ç”¨æˆ·å±•ç¤ºcgroupçš„hierarchyï¼Œé€šçŸ¥kernelç”¨æˆ·å¯¹cgroupæ”¹åŠ¨çš„çª—å£ã€‚æŒ‚è½½cgroupfsæ—¶é€šè¿‡é€‰é¡¹ï¼ˆ-otypeï¼‰æŒ‡å®šè¦æŒ‚è½½çš„å­ç³»ç»Ÿç±»å‹ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œé»˜è®¤æŒ‚è½½æ‰€æœ‰çš„æ³¨å†Œçš„å­ç³»ç»Ÿã€‚\n>\n>å¦‚æœæ–°æŒ‚è½½çš„cgroupå…³è”çš„hierachyä¸ç³»ç»Ÿä¸­å­˜åœ¨çš„hierarchyå®Œå…¨ä¸€æ ·ï¼Œé‚£ä¹ˆcgroupfsä¼šæ‹’ç»æŒ‚è½½ã€‚å¦‚æœæ²¡æœ‰åŒ¹é…åˆ°ç›¸åŒçš„hierarchyï¼Œä½†æ–°æŒ‚è½½hierachyå£°æ˜çš„èµ„æºæ­£åœ¨è¢«å·²ç»å­˜åœ¨çš„hierarchyä½¿ç”¨ï¼ŒæŒ‚è½½ä¼šæŠ¥-EBUSYé”™è¯¯ã€‚\n>\n>å½“å‰cgroupè¿˜æ²¡æœ‰å®ç°å‘å·²ç»å­˜åœ¨çš„cgroup hierarchyç»‘å®šæ–°å­ç³»ç»Ÿçš„æ“ä½œï¼Œå°†å­ç³»ç»Ÿä»cgroup hierachyè§£ç»‘ä¹Ÿä¸å…è®¸ã€‚è¿™äº›æ“ä½œåœ¨æœªæ¥ä¹Ÿè®¸ä¼šæ”¯æŒï¼Œä½†ä¹Ÿå¯èƒ½ä¼šè¿›ä¸€æ­¥äº§ç”Ÿé”™è¯¯æ¢å¤çš„ä¸€ç³»åˆ—é—®é¢˜ã€‚\n>\n>å¸è½½cgroupfsæ—¶ï¼Œå¦‚æœå®ƒçš„å­cgroupfsè¿˜åœ¨æ´»åŠ¨ï¼Œé‚£ä¹ˆå­cgroupfsè¿˜æ˜¯ä¼šæŒç»­ç”Ÿæ•ˆã€‚ç›´åˆ°æ‰€æœ‰çš„å­cgroupfsä¸å†æ´»åŠ¨ï¼Œå¸è½½cgroupfsæ‰ä¼šçœŸæ­£ç”Ÿæ•ˆã€‚\n>\n>cgroupfsä¸‹ä¸èƒ½å†æŒ‚è½½å…¶å®ƒç±»å‹çš„æ–‡ä»¶ç³»ç»Ÿã€‚æ‰€æœ‰å¯¹cgroupçš„æŸ¥è¯¢ä¿®æ”¹éƒ½åªé€šè¿‡cgroupfsæ–‡ä»¶ç³»ç»Ÿæ¥å®Œæˆã€‚\n>\n>ç³»ç»Ÿä¸­çš„æ‰€æœ‰taskï¼Œåœ¨/proc/pidç›®å½•ä¸‹éƒ½æœ‰ä¸€ä¸ªåä¸ºcgroupçš„æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶å±•ç¤ºäº†è¯¥taskç›¸å¯¹cgroupfs æ ¹çš„è·¯å¾„ã€‚é€šè¿‡æŸ¥çœ‹è¿™ä¸ªæ–‡ä»¶ï¼Œå¯ä»¥äº†è§£ä¸€ä¸ªè¿›ç¨‹åœ¨cgroup hierarchyçš„ä½ç½®ã€‚ä»¥æ­¤å¾—åˆ°taskå¯ä»¥ä½¿ç”¨çš„èµ„æºä¿¡æ¯ã€‚\n>\n>cgroupfsä¸­ç›®å½•è¡¨ç¤ºcgroupï¼Œæ¯ä¸ªç›®å½•åœ¨åˆ›å»ºæ—¶é»˜è®¤ç”Ÿæˆå¦‚ä¸‹çš„å±æ€§æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶æè¿°äº†cgroupçš„ä¿¡æ¯ï¼š\n>\n>â€”â€”    tasks: æ‰€æœ‰é™„å±äºè¿™ä¸ªcgroupçš„è¿›ç¨‹IDåˆ—è¡¨ã€‚tasksæ–‡ä»¶ä¸­å¢åŠ è¿›ç¨‹IDï¼Œè¡¨ç¤ºå°†è¿›ç¨‹åŠ å…¥è¿™ä¸ªcgroupï¼Œè¿›ç¨‹èƒ½å¤Ÿä½¿ç”¨çš„èµ„æºå—cgroupé™åˆ¶ã€‚\n>\n>â€”â€”    cgroup.procs: æ‰€æœ‰é™„å±äºè¿™ä¸ªcgroupçº¿ç¨‹ç»„IDï¼Œå°†TGIDå†™å…¥è¿™ä¸ªæ–‡ä»¶åï¼ŒTGIDæ‰€åœ¨è¿›ç¨‹åŒ…å«çš„æ‰€æœ‰çº¿ç¨‹éƒ½åŠ å…¥è¿™ä¸ªcgroupï¼Œè¿™äº›çº¿ç¨‹å—cgroupé™åˆ¶ã€‚\n\n> PIDï¼šè¿™æ˜¯ Linux ä¸­åœ¨å…¶å‘½åç©ºé—´ä¸­å”¯ä¸€æ ‡è¯†è¿›ç¨‹è€Œåˆ†é…ç»™å®ƒçš„ä¸€ä¸ªå·ç ï¼Œç§°åšè¿›ç¨‹IDå·ï¼Œç®€ç§°PIDã€‚åœ¨ä½¿ç”¨ fork æˆ– clone ç³»ç»Ÿè°ƒç”¨æ—¶äº§ç”Ÿçš„è¿›ç¨‹å‡ä¼šç”±å†…æ ¸åˆ†é…ä¸€ä¸ªæ–°çš„å”¯ä¸€çš„PIDå€¼ã€‚\n> TGIDï¼šåœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œå¦‚æœä»¥CLONE_THREADæ ‡å¿—æ¥è°ƒç”¨cloneå»ºç«‹çš„è¿›ç¨‹å°±æ˜¯è¯¥è¿›ç¨‹çš„ä¸€ä¸ªçº¿ç¨‹ï¼Œå®ƒä»¬å¤„äºä¸€ä¸ªçº¿ç¨‹ç»„ï¼Œè¯¥çº¿ç¨‹ç»„çš„IDå«åšTGIDã€‚å¤„äºç›¸åŒçš„çº¿ç¨‹ç»„ä¸­çš„æ‰€æœ‰è¿›ç¨‹éƒ½æœ‰ç›¸åŒçš„TGIDï¼›çº¿ç¨‹ç»„ç»„é•¿çš„TGIDä¸å…¶PIDç›¸åŒï¼›ä¸€ä¸ªè¿›ç¨‹æ²¡æœ‰ä½¿ç”¨çº¿ç¨‹ï¼Œåˆ™å…¶TGIDä¸PIDä¹Ÿç›¸åŒã€‚\n> PGIDï¼šå¦å¤–ï¼Œç‹¬ç«‹çš„è¿›ç¨‹å¯ä»¥ç»„æˆè¿›ç¨‹ç»„ï¼ˆä½¿ç”¨setpgrpç³»ç»Ÿè°ƒç”¨ï¼‰ï¼Œè¿›ç¨‹ç»„å¯ä»¥ç®€åŒ–å‘æ‰€æœ‰ç»„å†…è¿›ç¨‹å‘é€ä¿¡å·çš„æ“ä½œï¼Œä¾‹å¦‚ç”¨ç®¡é“è¿æ¥çš„è¿›ç¨‹å¤„åœ¨åŒä¸€è¿›ç¨‹ç»„å†…ã€‚è¿›ç¨‹ç»„IDå«åšPGIDï¼Œè¿›ç¨‹ç»„å†…çš„æ‰€æœ‰è¿›ç¨‹éƒ½æœ‰ç›¸åŒçš„PGIDï¼Œç­‰äºè¯¥ç»„ç»„é•¿çš„PIDã€‚\n> SIDï¼šå‡ ä¸ªè¿›ç¨‹ç»„å¯ä»¥åˆå¹¶æˆä¸€ä¸ªä¼šè¯ç»„ï¼ˆä½¿ç”¨setsidç³»ç»Ÿè°ƒç”¨ï¼‰ï¼Œå¯ä»¥ç”¨äºç»ˆç«¯ç¨‹åºè®¾è®¡ã€‚ä¼šè¯ç»„ä¸­æ‰€æœ‰è¿›ç¨‹éƒ½æœ‰ç›¸åŒçš„SIDã€‚\n> â€”â€”    notify_on_release flag: æ ‡è®°é€€å‡ºæ—¶æ˜¯å¦è¿è¡Œrelease agent\n>\n> â€”â€”    release_agent: åˆ¶å®šè¦è¿è¡Œçš„release agentçš„è·¯å¾„ï¼Œè¿™ä¸ªå±æ€§æ–‡ä»¶åªåœ¨cgroupçš„é¡¶å±‚ç›®å½•ä¸­å­˜åœ¨ã€‚\n>\n> ä»¥ä¸Šæ–‡ä»¶æ˜¯æ¯ä¸ªcgroupåŸºæœ¬çš„å±æ€§æ–‡ä»¶ï¼Œå¯¹äºä¸åŒçš„å­ç³»ç»Ÿï¼Œå¯¹åº”çš„cgroupå¯èƒ½ä¼šæœ‰å…¶å®ƒé™„åŠ çš„å±æ€§æ–‡ä»¶ï¼Œå­˜åœ¨äºå…¶å¯¹åº”çš„cgroupç›®å½•ä¹‹ä¸‹ã€‚\n>\n> é€šè¿‡mkdirå‘½ä»¤åˆ›å»ºcgroupï¼Œé€šè¿‡å‘ç›®å½•ä¸‹çš„æ–‡ä»¶å†™å…¥é€‚å½“çš„æ•°å€¼è®¾ç½®ä¿®æ”¹cgroupçš„å±æ€§ã€‚\n>\n> åµŒå¥—çš„cgroupsï¼ŒæŒ‡å®šäº†å±‚çº§ç»“æ„ï¼Œä»¥æ­¤å°†ç³»ç»Ÿèµ„æºåˆ’åˆ†æˆåµŒå¥—çš„ï¼ŒåŠ¨æ€å¯å˜çš„æ›´å°çš„èµ„æºå—ã€‚\n>\n> ä¸€ä¸ªè¿›ç¨‹å¯ä»¥é™„åŠ åˆ°å¤šä¸ªä¸åŒçš„cgroupä¸­ï¼Œåªè¦è¿™äº›cgroupä¸åœ¨åŒä¸€ä¸ªå±‚çº§æ ‘ä¸Šå³å¯ã€‚å› ä¸ºcgroupfsä¼šä¿è¯æ–°æŒ‚è½½çš„cgroupå…³è”çš„å±‚çº§æ ‘å…¨å±€å”¯ä¸€ã€‚å­è¿›ç¨‹åœ¨è¢«åˆ›å»ºåé»˜è®¤é™„åŠ åˆ°çˆ¶è¿›ç¨‹æ‰€åœ¨çš„cgroupï¼Œåé¢ç”¨æˆ·å¯ä»¥æ ¹æ®éœ€è¦å°†å…¶ç§»åŠ¨åˆ°åˆ«çš„cgroupã€‚\n>\n> å½“è¿›ç¨‹ä»ä¸€ä¸ªcgroupè¢«ç§»åŠ¨åˆ°å¦ä¸€ä¸ªcgroupã€‚è¿›ç¨‹çš„task_structä¼šè·å–ä¸€ä¸ªæ–°çš„css_setæŒ‡é’ˆï¼šå¦‚æœè¿™ä¸ªcgroupæ‰€åœ¨çš„css_setå·²ç»å­˜åœ¨å°±é‡ç”¨è¿™ä¸ªcss_setï¼Œå¦åˆ™å°±æ–°åˆ†é…ä¸€ä¸ªcss_setã€‚kernelä¼šåœ¨å…¨å±€çš„hashè¡¨ä¸­æŸ¥æ‰¾ç¡®è®¤cgroupæ‰€å±çš„css_setæ˜¯å¦å­˜åœ¨ã€‚\n\n## 4 notify_on_release æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ\n\n>å¦‚æœcgroupä¸­ä½¿èƒ½notify_on_releaseï¼Œcgroupä¸­çš„æœ€åä¸€ä¸ªè¿›ç¨‹è¢«ç§»é™¤ï¼Œæœ€åä¸€ä¸ªå­cgroupä¹Ÿè¢«åˆ é™¤æ—¶ï¼Œcgroupä¼šä¸»åŠ¨é€šçŸ¥kernelã€‚æ¥æ”¶åˆ°æ¶ˆæ¯çš„kernelä¼šæ‰§è¡Œrelease_agentæ–‡ä»¶ä¸­æŒ‡å®šçš„ç¨‹åºã€‚notify_on_releaseé»˜è®¤æ˜¯å…³é—­çš„ï¼Œrelease_agentçš„å†…å®¹é»˜è®¤ä¸ºç©ºï¼Œå­cgroupåœ¨åˆ›å»ºæ—¶ä¼šç»§æ‰¿çˆ¶cgroupä¸­notify_on_relaseå’Œrelease_agentçš„å±æ€§ã€‚æ‰€ä»¥è¿™ä¸¤ä¸ªæ–‡ä»¶åªå­˜åœ¨äºcgroupfsçš„é¡¶å±‚ç›®å½•ä¸­ã€‚\n\n\n\n## 5 clone_childrenæœ‰ä»€ä¹ˆç”¨ï¼Ÿ\n\n> clone_chilrenä»…é’ˆå¯¹cpuç»‘å®šï¼ˆcpusetï¼‰ï¼Œå¦‚æœclone_childrenä½¿èƒ½ï¼Œæ–°çš„cpuset cgroupåœ¨åˆå§‹åŒ–æ—¶ä¼šç»§æ‰¿çˆ¶cgroupçš„å±æ€§ã€‚\n\n## 6 cgroupæ€ä¹ˆç”¨ï¼Ÿ\n\n>\n>\n>å‡è®¾ç°åœ¨è¦å°†ä¸€ä¸ªæ–°çš„ä»»åŠ¡åŠ å…¥åˆ°cgroupï¼ŒåŠŸèƒ½æ˜¯å°†è¯¥ä»»åŠ¡çš„è¿›ç¨‹åœ¨æŒ‡å®šçš„cpuä¸Šè¿è¡Œï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨\"cpuset\"cgroup å­ç³»ç»Ÿï¼Œæ“ä½œçš„å¤§è‡´æ­¥éª¤å¦‚ä¸‹ï¼š\n>\n>1ï¼‰mount -t tmpfs cgroup_root /sys/fs/cgroup \n>\n>æŒ‚è½½cgroupæ ¹æ–‡ä»¶ç³»ç»Ÿï¼Œç±»å‹ä¸ºtmpfs\n>\n>2ï¼‰mkdir /sys/fs/cgroup/cpuset\n>\n>åœ¨cgroupfsæ ¹ç›®å½•ä¸‹åˆ›å»ºå­cgroupï¼Œåä¸ºcpuset\n>\n>3ï¼‰mount -t cgroup -o cpuset cpuset /sys/fs/cgroup/cpuset\n>\n>å°†åä¸ºcpusetçš„cgroupå…³è”åˆ°cpusetå­ç³»ç»Ÿ\n>\n>4ï¼‰åœ¨cpusetç›®å½•ä¸‹åˆ›å»ºç›®å½•ï¼Œç”Ÿæˆä¸€ä¸ªå­cgroupï¼Œå±æ€§æ–‡ä»¶ä¸­å†™å…¥ç›¸åº”å†…å®¹ï¼Œè®¾ç½®å±æ€§ã€‚\n>\n>5ï¼‰å¯åŠ¨éœ€è¦é™åˆ¶çš„è¿›ç¨‹ï¼ŒæŸ¥æ‰¾å…¶å¯¹åº”çš„è¿›ç¨‹IDï¼Œå°†å…¶å†™å…¥å¯¹åº”çš„taskæ–‡ä»¶ä¸­\n>\n>ä»¥ä¸‹æ“ä½œæ­¥éª¤æ˜¯åˆ›å»ºä¸€ä¸ªåä¸º\"Charlie\"çš„cgroupï¼Œè¿™ä¸ªcgroupçš„èµ„æºåŒ…å«cpu2ï¼Œcpu3å’Œå†…å­˜èŠ‚ç‚¹1ï¼Œå°†shellè¿›ç¨‹é™„åŠ åˆ°è¿™ä¸ªcgroupã€‚\n>\n>mount -t tmpfs cgroup_root /sys/fs/cgroup\n>\n>mkdir /sys/fs/cgroup/cpuset\n>\n>mount -t cgroup cpuset -o cpuset /sys/fs/cgroup/cpuset\n>\n>cd /sys/fs/cgroup/cpuset\n>\n>mkdir Charlie\n>\n>cd Charlie\n>\n>echo 2-3 > cpuset.cpus\n>\n>echo 1 > cpuset.mems\n>\n>echo $$ > tasks\n>\n>sh\n>\n>cat /proc/self/cgroup\n\nè½¬ï¼š\n\n https://blog.csdn.net/huang987246510/article/details/80765628\n","source":"back_posts/cgroup.md","raw":"---\ntitle: cgroup\ncategories:\n  - kernel\ntags:\n  - cgroup\ndate: 2024-05-16 15:30:33\n---\n\n[toc]\n\ncgroupæ˜¯linuxå†…æ ¸å®ç°ã€ç”¨äºæ§åˆ¶linuxç³»ç»Ÿèµ„æºçš„ç»„ä»¶ã€‚å› æ­¤è¦äº†è§£cgroupï¼Œé¦–å…ˆä»å¼•å…¥è¿™ä¸ªç»„ä»¶çš„kernelæ–‡æ¡£ä¸­å¯»æ‰¾ã€‚\n\nå»åˆ°ä¸¾ä¸–é—»åçš„www.kernel.org\n\næ‰¾åˆ°ä»‹ç»æ–‡æ¡£ï¼šDocumentation/cgroup-v1/cgroups.txt\n\n## 1 ä»€ä¹ˆæ˜¯cgroup?\n\n>cgroup ï¼Œæ§åˆ¶ç»„ï¼Œå®ƒæä¾›äº†ä¸€å¥—æœºåˆ¶ç”¨äºæ§åˆ¶ä¸€ç»„ç‰¹å®šè¿›ç¨‹å¯¹èµ„æºçš„ä½¿ç”¨ã€‚cgroupç»‘å®šä¸€ä¸ªè¿›ç¨‹é›†åˆåˆ°ä¸€ä¸ªæˆ–å¤šä¸ªå­ç³»ç»Ÿä¸Šã€‚\n>\n>subsystemï¼Œå­ç³»ç»Ÿï¼Œä¸€ä¸ªé€šè¿‡cgroupæä¾›çš„å·¥å…·å’Œæ¥å£æ¥ç®¡ç†è¿›ç¨‹é›†åˆçš„æ¨¡å—ã€‚ä¸€ä¸ªå­ç³»ç»Ÿå°±æ˜¯ä¸€ä¸ªå…¸å‹çš„â€œèµ„æºæ§åˆ¶å™¨â€ï¼Œç”¨æ¥è°ƒåº¦èµ„æºæˆ–è€…æ§åˆ¶èµ„æºä½¿ç”¨çš„ä¸Šé™ã€‚å…¶å®æ¯ç§èµ„æºå°±æ˜¯ä¸€ä¸ªå­ç³»ç»Ÿã€‚å­ç³»ç»Ÿå¯ä»¥æ˜¯ä»¥è¿›ç¨‹ä¸ºå•ä½çš„ä»»ä½•ä¸œè¥¿ï¼Œæ¯”å¦‚è™šæ‹ŸåŒ–å­ç³»ç»Ÿã€å†…å­˜å­ç³»ç»Ÿã€‚\n>\n>hierarchyï¼Œå±‚çº§æ ‘ï¼Œå¤šä¸ªcgroupçš„é›†åˆï¼Œè¿™äº›é›†åˆæ„æˆçš„æ ‘å«hierarchyã€‚å¯ä»¥è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªèµ„æºæ ‘ï¼Œé™„ç€åœ¨è¿™ä¸Šé¢çš„è¿›ç¨‹å¯ä»¥ä½¿ç”¨çš„èµ„æºä¸Šé™å¿…é¡»å—æ ‘ä¸ŠèŠ‚ç‚¹ï¼ˆcgroupï¼‰çš„æ§åˆ¶ã€‚hierarchyä¸Šçš„å±‚æ¬¡å…³ç³»é€šè¿‡cgroupfsè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿæ˜¾ç¤ºã€‚ç³»ç»Ÿå…è®¸å¤šä¸ªhierarchyåŒæ—¶å­˜åœ¨ï¼Œæ¯ä¸ªhierachyåŒ…å«ç³»ç»Ÿä¸­çš„éƒ¨åˆ†æˆ–è€…å…¨éƒ¨è¿›ç¨‹é›†åˆã€‚\n>\n>cgroupfsæ˜¯ç”¨æˆ·ç®¡ç†æ“çºµcgroupçš„ä¸»è¦æ¥å£ï¼šé€šè¿‡åœ¨cgroupfsæ–‡ä»¶ç³»ç»Ÿä¸­åˆ›å»ºç›®å½•ï¼Œå®ç°cgroupçš„åˆ›å»ºï¼›é€šè¿‡å‘ç›®å½•ä¸‹çš„å±æ€§æ–‡ä»¶å†™å…¥å†…å®¹ï¼Œè®¾ç½®cgroupå¯¹èµ„æºçš„æ§åˆ¶ï¼›å‘taskå±æ€§æ–‡ä»¶å†™å…¥è¿›ç¨‹IDï¼Œå¯ä»¥å°†è¿›ç¨‹ç»‘å®šåˆ°æŸä¸ªcgroupï¼Œä»¥æ­¤è¾¾åˆ°æ§åˆ¶è¿›ç¨‹èµ„æºä½¿ç”¨çš„ç›®çš„ï¼›ä¹Ÿå¯ä»¥åˆ—å‡ºcgroupåŒ…å«çš„è¿›ç¨‹pidã€‚è¿™äº›æ“ä½œå½±å“çš„æ˜¯sysfså…³è”çš„hierarchyï¼Œå¯¹å…¶å®ƒhierarchyæ²¡æœ‰å½±å“ã€‚\n>\n>å¯¹äºcgroupï¼Œå…¶æœ¬èº«çš„ä½œç”¨åªæ˜¯ä»»åŠ¡è·Ÿè¸ªã€‚ä½†å…¶å®ƒç³»ç»Ÿï¼ˆæ¯”å¦‚cpusetsï¼Œcpuacctï¼‰ï¼Œå¯ä»¥åˆ©ç”¨cgroupçš„è¿™ä¸ªåŠŸèƒ½å®ç°ä¸€äº›æ–°çš„å±æ€§ï¼Œæ¯”å¦‚ç»Ÿè®¡æˆ–è€…æ§åˆ¶ä¸€ä¸ªcgroupä¸­è¿›ç¨‹å¯ä»¥è®¿é—®çš„èµ„æºã€‚ä¸¾ä¸ªä¾‹å­ï¼Œcpusetså­ç³»ç»Ÿå¯ä»¥å°†è¿›ç¨‹ç»‘å®šåˆ°ç‰¹å®šçš„cpuå’Œå†…å­˜èŠ‚ç‚¹ä¸Šã€‚\n\n2 ä¸ºä»€ä¹ˆéœ€è¦cgroup?\n\n>\n>\n>è¿™ä¸ªé—®é¢˜ç›¸å½“äºé—®cgroupé‡è¦å—ï¼Ÿæœ‰å“ªäº›åœ°æ–¹ç”¨åˆ°äº†ã€‚å›ç­”æ˜¯é‡è¦ï¼Œåˆä¸é‡è¦ã€‚å¦‚æœä½ ç”¨åˆ°äº†ï¼Œé‚£å°±é‡è¦ï¼Œå¦‚æœæ²¡æœ‰ç”¨åˆ°ï¼Œé‚£å°±ä¸é‡è¦ã€‚å‘µå‘µå‘µ~~~~å…¶å®æŒºé‡è¦çš„ã€‚cgroupçš„ä¸»è¦è¿ç”¨æ˜¯èµ„æºè·Ÿè¸ªã€‚æˆ‘æ¥è§¦çš„åœºæ™¯å°±æ˜¯ç”¨cgroupæ§åˆ¶è™šæ‹Ÿæœºè¿›ç¨‹æˆ–è€…dockerè¿›ç¨‹å¯ä»¥ä½¿ç”¨çš„èµ„æºã€‚å½“ä½ æƒ³åœ¨linuxå¯¹åº”ç”¨è¿›ç¨‹åšèµ„æºè®¿é—®æ§åˆ¶çš„æ—¶å€™ï¼Œcgroupå°±æ´¾ä¸Šç”¨åœºäº†ã€‚\n\n## 3 cgroupæ€ä¹ˆå®ç°çš„ï¼Ÿ\n\n>â€”â€”    ç³»ç»Ÿä¸­çš„æ¯ä¸ªè¿›ç¨‹ï¼ˆtask_structï¼Œåé¢ç”¨taskä»£æŒ‡ï¼‰éƒ½æŒæœ‰ä¸€ä¸ªæŒ‡å‘css_setç»“æ„çš„æŒ‡é’ˆã€‚\n>\n>â€”â€”    ä¸€ä¸ªcss_setç»“æ„ä½“åŒ…å«äº†ä¸€ç»„æŒ‡å‘cgroup_subsys_stateå¯¹è±¡çš„æŒ‡é’ˆï¼ˆæ‰€ä»¥ä¸€ä¸ªtaskå¯ä»¥é™„åŠ åˆ°å¤šä¸ªcgroupä¸Šï¼‰ï¼Œæ¯ä¸ªcgroup_subsys_stateåœ¨ç³»ç»Ÿä¸­éƒ½æœ‰æ³¨å†Œã€‚taskç»“æ„ä½“æ²¡æœ‰ç›´æ¥æŒ‡å‘hierarchyä¸­ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆcgroupï¼‰çš„æŒ‡é’ˆã€‚ä½†å¯ä»¥é€šè¿‡å…¶åŒ…å«çš„cgroup_subsys_stateé—´æ¥ç¡®å®šã€‚è¿™æ ·è®¾è®¡çš„åŸå› æ˜¯cpuå¯¹subsystem stateçš„è®¿é—®å¾ˆé¢‘ç¹ï¼Œä½†æ¶‰åŠåˆ°å°†taskç»‘å®šåˆ°cgroupçš„æ“ä½œå´ä¸å¤šã€‚taskä¸­è¿˜æœ‰ä¸ªåŒå‘é“¾è¡¨cg_listï¼Œè¿™ä¸ªé“¾è¡¨ç»´æŠ¤æ‰€æœ‰åŒå±äºä¸€ä¸ªcss_setçš„tasksã€‚\n>\n>â€”â€”    ç”¨æˆ·å¯ä»¥é€šè¿‡cgroupfsæ–‡ä»¶ç³»ç»Ÿæ¥æµè§ˆcgroup hierarchyã€‚\n>\n>â€”â€”    ç”¨æˆ·å¯ä»¥åˆ—å‡ºä»»æ„ä¸€ä¸ªcgroupä¸Šé™„ç€çš„task PID\n>\n>cgroupåœ¨kernelä¸­é™¤äº†æœ¬èº«åŠŸèƒ½çš„å®ç°å¤–ï¼Œåœ¨kernelä¸­è¿˜æœ‰ä¸¤å¤„ä¿®æ”¹ï¼š\n>\n>â€”â€”    åœ¨kernelå¯åŠ¨æ—¶å¯¹root cgroupçš„åˆå§‹åŒ–å’Œcss_setç»“æ„ä½“çš„åˆå§‹åŒ–ã€‚è¿™ä¸ªåœ¨init/main.cæ–‡ä»¶ä¸­å®ç°ã€‚\n>\n>â€”â€”    åœ¨taskçš„åˆ›å»ºï¼ˆforkï¼‰å’Œé€€å‡ºï¼ˆexitï¼‰é˜¶æ®µï¼Œå¯¹åº”åœ°å°†taskä¸css_setè¿›è¡Œç»‘å®šå’Œè§£ç»‘ã€‚\n>\n>å¦å¤–ï¼Œcgroupä¸ºäº†å‘ç”¨æˆ·æä¾›æ“ä½œæ¥å£ï¼Œç‰¹åˆ«å¼€å‘äº†ä¸€ä¸ªè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿç±»å‹ï¼ˆcgroupfsï¼‰ï¼Œè¿™ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸sysfsï¼Œprocç±»ä¼¼ã€‚cgroupfsæ˜¯å‘ç”¨æˆ·å±•ç¤ºcgroupçš„hierarchyï¼Œé€šçŸ¥kernelç”¨æˆ·å¯¹cgroupæ”¹åŠ¨çš„çª—å£ã€‚æŒ‚è½½cgroupfsæ—¶é€šè¿‡é€‰é¡¹ï¼ˆ-otypeï¼‰æŒ‡å®šè¦æŒ‚è½½çš„å­ç³»ç»Ÿç±»å‹ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œé»˜è®¤æŒ‚è½½æ‰€æœ‰çš„æ³¨å†Œçš„å­ç³»ç»Ÿã€‚\n>\n>å¦‚æœæ–°æŒ‚è½½çš„cgroupå…³è”çš„hierachyä¸ç³»ç»Ÿä¸­å­˜åœ¨çš„hierarchyå®Œå…¨ä¸€æ ·ï¼Œé‚£ä¹ˆcgroupfsä¼šæ‹’ç»æŒ‚è½½ã€‚å¦‚æœæ²¡æœ‰åŒ¹é…åˆ°ç›¸åŒçš„hierarchyï¼Œä½†æ–°æŒ‚è½½hierachyå£°æ˜çš„èµ„æºæ­£åœ¨è¢«å·²ç»å­˜åœ¨çš„hierarchyä½¿ç”¨ï¼ŒæŒ‚è½½ä¼šæŠ¥-EBUSYé”™è¯¯ã€‚\n>\n>å½“å‰cgroupè¿˜æ²¡æœ‰å®ç°å‘å·²ç»å­˜åœ¨çš„cgroup hierarchyç»‘å®šæ–°å­ç³»ç»Ÿçš„æ“ä½œï¼Œå°†å­ç³»ç»Ÿä»cgroup hierachyè§£ç»‘ä¹Ÿä¸å…è®¸ã€‚è¿™äº›æ“ä½œåœ¨æœªæ¥ä¹Ÿè®¸ä¼šæ”¯æŒï¼Œä½†ä¹Ÿå¯èƒ½ä¼šè¿›ä¸€æ­¥äº§ç”Ÿé”™è¯¯æ¢å¤çš„ä¸€ç³»åˆ—é—®é¢˜ã€‚\n>\n>å¸è½½cgroupfsæ—¶ï¼Œå¦‚æœå®ƒçš„å­cgroupfsè¿˜åœ¨æ´»åŠ¨ï¼Œé‚£ä¹ˆå­cgroupfsè¿˜æ˜¯ä¼šæŒç»­ç”Ÿæ•ˆã€‚ç›´åˆ°æ‰€æœ‰çš„å­cgroupfsä¸å†æ´»åŠ¨ï¼Œå¸è½½cgroupfsæ‰ä¼šçœŸæ­£ç”Ÿæ•ˆã€‚\n>\n>cgroupfsä¸‹ä¸èƒ½å†æŒ‚è½½å…¶å®ƒç±»å‹çš„æ–‡ä»¶ç³»ç»Ÿã€‚æ‰€æœ‰å¯¹cgroupçš„æŸ¥è¯¢ä¿®æ”¹éƒ½åªé€šè¿‡cgroupfsæ–‡ä»¶ç³»ç»Ÿæ¥å®Œæˆã€‚\n>\n>ç³»ç»Ÿä¸­çš„æ‰€æœ‰taskï¼Œåœ¨/proc/pidç›®å½•ä¸‹éƒ½æœ‰ä¸€ä¸ªåä¸ºcgroupçš„æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶å±•ç¤ºäº†è¯¥taskç›¸å¯¹cgroupfs æ ¹çš„è·¯å¾„ã€‚é€šè¿‡æŸ¥çœ‹è¿™ä¸ªæ–‡ä»¶ï¼Œå¯ä»¥äº†è§£ä¸€ä¸ªè¿›ç¨‹åœ¨cgroup hierarchyçš„ä½ç½®ã€‚ä»¥æ­¤å¾—åˆ°taskå¯ä»¥ä½¿ç”¨çš„èµ„æºä¿¡æ¯ã€‚\n>\n>cgroupfsä¸­ç›®å½•è¡¨ç¤ºcgroupï¼Œæ¯ä¸ªç›®å½•åœ¨åˆ›å»ºæ—¶é»˜è®¤ç”Ÿæˆå¦‚ä¸‹çš„å±æ€§æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶æè¿°äº†cgroupçš„ä¿¡æ¯ï¼š\n>\n>â€”â€”    tasks: æ‰€æœ‰é™„å±äºè¿™ä¸ªcgroupçš„è¿›ç¨‹IDåˆ—è¡¨ã€‚tasksæ–‡ä»¶ä¸­å¢åŠ è¿›ç¨‹IDï¼Œè¡¨ç¤ºå°†è¿›ç¨‹åŠ å…¥è¿™ä¸ªcgroupï¼Œè¿›ç¨‹èƒ½å¤Ÿä½¿ç”¨çš„èµ„æºå—cgroupé™åˆ¶ã€‚\n>\n>â€”â€”    cgroup.procs: æ‰€æœ‰é™„å±äºè¿™ä¸ªcgroupçº¿ç¨‹ç»„IDï¼Œå°†TGIDå†™å…¥è¿™ä¸ªæ–‡ä»¶åï¼ŒTGIDæ‰€åœ¨è¿›ç¨‹åŒ…å«çš„æ‰€æœ‰çº¿ç¨‹éƒ½åŠ å…¥è¿™ä¸ªcgroupï¼Œè¿™äº›çº¿ç¨‹å—cgroupé™åˆ¶ã€‚\n\n> PIDï¼šè¿™æ˜¯ Linux ä¸­åœ¨å…¶å‘½åç©ºé—´ä¸­å”¯ä¸€æ ‡è¯†è¿›ç¨‹è€Œåˆ†é…ç»™å®ƒçš„ä¸€ä¸ªå·ç ï¼Œç§°åšè¿›ç¨‹IDå·ï¼Œç®€ç§°PIDã€‚åœ¨ä½¿ç”¨ fork æˆ– clone ç³»ç»Ÿè°ƒç”¨æ—¶äº§ç”Ÿçš„è¿›ç¨‹å‡ä¼šç”±å†…æ ¸åˆ†é…ä¸€ä¸ªæ–°çš„å”¯ä¸€çš„PIDå€¼ã€‚\n> TGIDï¼šåœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œå¦‚æœä»¥CLONE_THREADæ ‡å¿—æ¥è°ƒç”¨cloneå»ºç«‹çš„è¿›ç¨‹å°±æ˜¯è¯¥è¿›ç¨‹çš„ä¸€ä¸ªçº¿ç¨‹ï¼Œå®ƒä»¬å¤„äºä¸€ä¸ªçº¿ç¨‹ç»„ï¼Œè¯¥çº¿ç¨‹ç»„çš„IDå«åšTGIDã€‚å¤„äºç›¸åŒçš„çº¿ç¨‹ç»„ä¸­çš„æ‰€æœ‰è¿›ç¨‹éƒ½æœ‰ç›¸åŒçš„TGIDï¼›çº¿ç¨‹ç»„ç»„é•¿çš„TGIDä¸å…¶PIDç›¸åŒï¼›ä¸€ä¸ªè¿›ç¨‹æ²¡æœ‰ä½¿ç”¨çº¿ç¨‹ï¼Œåˆ™å…¶TGIDä¸PIDä¹Ÿç›¸åŒã€‚\n> PGIDï¼šå¦å¤–ï¼Œç‹¬ç«‹çš„è¿›ç¨‹å¯ä»¥ç»„æˆè¿›ç¨‹ç»„ï¼ˆä½¿ç”¨setpgrpç³»ç»Ÿè°ƒç”¨ï¼‰ï¼Œè¿›ç¨‹ç»„å¯ä»¥ç®€åŒ–å‘æ‰€æœ‰ç»„å†…è¿›ç¨‹å‘é€ä¿¡å·çš„æ“ä½œï¼Œä¾‹å¦‚ç”¨ç®¡é“è¿æ¥çš„è¿›ç¨‹å¤„åœ¨åŒä¸€è¿›ç¨‹ç»„å†…ã€‚è¿›ç¨‹ç»„IDå«åšPGIDï¼Œè¿›ç¨‹ç»„å†…çš„æ‰€æœ‰è¿›ç¨‹éƒ½æœ‰ç›¸åŒçš„PGIDï¼Œç­‰äºè¯¥ç»„ç»„é•¿çš„PIDã€‚\n> SIDï¼šå‡ ä¸ªè¿›ç¨‹ç»„å¯ä»¥åˆå¹¶æˆä¸€ä¸ªä¼šè¯ç»„ï¼ˆä½¿ç”¨setsidç³»ç»Ÿè°ƒç”¨ï¼‰ï¼Œå¯ä»¥ç”¨äºç»ˆç«¯ç¨‹åºè®¾è®¡ã€‚ä¼šè¯ç»„ä¸­æ‰€æœ‰è¿›ç¨‹éƒ½æœ‰ç›¸åŒçš„SIDã€‚\n> â€”â€”    notify_on_release flag: æ ‡è®°é€€å‡ºæ—¶æ˜¯å¦è¿è¡Œrelease agent\n>\n> â€”â€”    release_agent: åˆ¶å®šè¦è¿è¡Œçš„release agentçš„è·¯å¾„ï¼Œè¿™ä¸ªå±æ€§æ–‡ä»¶åªåœ¨cgroupçš„é¡¶å±‚ç›®å½•ä¸­å­˜åœ¨ã€‚\n>\n> ä»¥ä¸Šæ–‡ä»¶æ˜¯æ¯ä¸ªcgroupåŸºæœ¬çš„å±æ€§æ–‡ä»¶ï¼Œå¯¹äºä¸åŒçš„å­ç³»ç»Ÿï¼Œå¯¹åº”çš„cgroupå¯èƒ½ä¼šæœ‰å…¶å®ƒé™„åŠ çš„å±æ€§æ–‡ä»¶ï¼Œå­˜åœ¨äºå…¶å¯¹åº”çš„cgroupç›®å½•ä¹‹ä¸‹ã€‚\n>\n> é€šè¿‡mkdirå‘½ä»¤åˆ›å»ºcgroupï¼Œé€šè¿‡å‘ç›®å½•ä¸‹çš„æ–‡ä»¶å†™å…¥é€‚å½“çš„æ•°å€¼è®¾ç½®ä¿®æ”¹cgroupçš„å±æ€§ã€‚\n>\n> åµŒå¥—çš„cgroupsï¼ŒæŒ‡å®šäº†å±‚çº§ç»“æ„ï¼Œä»¥æ­¤å°†ç³»ç»Ÿèµ„æºåˆ’åˆ†æˆåµŒå¥—çš„ï¼ŒåŠ¨æ€å¯å˜çš„æ›´å°çš„èµ„æºå—ã€‚\n>\n> ä¸€ä¸ªè¿›ç¨‹å¯ä»¥é™„åŠ åˆ°å¤šä¸ªä¸åŒçš„cgroupä¸­ï¼Œåªè¦è¿™äº›cgroupä¸åœ¨åŒä¸€ä¸ªå±‚çº§æ ‘ä¸Šå³å¯ã€‚å› ä¸ºcgroupfsä¼šä¿è¯æ–°æŒ‚è½½çš„cgroupå…³è”çš„å±‚çº§æ ‘å…¨å±€å”¯ä¸€ã€‚å­è¿›ç¨‹åœ¨è¢«åˆ›å»ºåé»˜è®¤é™„åŠ åˆ°çˆ¶è¿›ç¨‹æ‰€åœ¨çš„cgroupï¼Œåé¢ç”¨æˆ·å¯ä»¥æ ¹æ®éœ€è¦å°†å…¶ç§»åŠ¨åˆ°åˆ«çš„cgroupã€‚\n>\n> å½“è¿›ç¨‹ä»ä¸€ä¸ªcgroupè¢«ç§»åŠ¨åˆ°å¦ä¸€ä¸ªcgroupã€‚è¿›ç¨‹çš„task_structä¼šè·å–ä¸€ä¸ªæ–°çš„css_setæŒ‡é’ˆï¼šå¦‚æœè¿™ä¸ªcgroupæ‰€åœ¨çš„css_setå·²ç»å­˜åœ¨å°±é‡ç”¨è¿™ä¸ªcss_setï¼Œå¦åˆ™å°±æ–°åˆ†é…ä¸€ä¸ªcss_setã€‚kernelä¼šåœ¨å…¨å±€çš„hashè¡¨ä¸­æŸ¥æ‰¾ç¡®è®¤cgroupæ‰€å±çš„css_setæ˜¯å¦å­˜åœ¨ã€‚\n\n## 4 notify_on_release æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ\n\n>å¦‚æœcgroupä¸­ä½¿èƒ½notify_on_releaseï¼Œcgroupä¸­çš„æœ€åä¸€ä¸ªè¿›ç¨‹è¢«ç§»é™¤ï¼Œæœ€åä¸€ä¸ªå­cgroupä¹Ÿè¢«åˆ é™¤æ—¶ï¼Œcgroupä¼šä¸»åŠ¨é€šçŸ¥kernelã€‚æ¥æ”¶åˆ°æ¶ˆæ¯çš„kernelä¼šæ‰§è¡Œrelease_agentæ–‡ä»¶ä¸­æŒ‡å®šçš„ç¨‹åºã€‚notify_on_releaseé»˜è®¤æ˜¯å…³é—­çš„ï¼Œrelease_agentçš„å†…å®¹é»˜è®¤ä¸ºç©ºï¼Œå­cgroupåœ¨åˆ›å»ºæ—¶ä¼šç»§æ‰¿çˆ¶cgroupä¸­notify_on_relaseå’Œrelease_agentçš„å±æ€§ã€‚æ‰€ä»¥è¿™ä¸¤ä¸ªæ–‡ä»¶åªå­˜åœ¨äºcgroupfsçš„é¡¶å±‚ç›®å½•ä¸­ã€‚\n\n\n\n## 5 clone_childrenæœ‰ä»€ä¹ˆç”¨ï¼Ÿ\n\n> clone_chilrenä»…é’ˆå¯¹cpuç»‘å®šï¼ˆcpusetï¼‰ï¼Œå¦‚æœclone_childrenä½¿èƒ½ï¼Œæ–°çš„cpuset cgroupåœ¨åˆå§‹åŒ–æ—¶ä¼šç»§æ‰¿çˆ¶cgroupçš„å±æ€§ã€‚\n\n## 6 cgroupæ€ä¹ˆç”¨ï¼Ÿ\n\n>\n>\n>å‡è®¾ç°åœ¨è¦å°†ä¸€ä¸ªæ–°çš„ä»»åŠ¡åŠ å…¥åˆ°cgroupï¼ŒåŠŸèƒ½æ˜¯å°†è¯¥ä»»åŠ¡çš„è¿›ç¨‹åœ¨æŒ‡å®šçš„cpuä¸Šè¿è¡Œï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨\"cpuset\"cgroup å­ç³»ç»Ÿï¼Œæ“ä½œçš„å¤§è‡´æ­¥éª¤å¦‚ä¸‹ï¼š\n>\n>1ï¼‰mount -t tmpfs cgroup_root /sys/fs/cgroup \n>\n>æŒ‚è½½cgroupæ ¹æ–‡ä»¶ç³»ç»Ÿï¼Œç±»å‹ä¸ºtmpfs\n>\n>2ï¼‰mkdir /sys/fs/cgroup/cpuset\n>\n>åœ¨cgroupfsæ ¹ç›®å½•ä¸‹åˆ›å»ºå­cgroupï¼Œåä¸ºcpuset\n>\n>3ï¼‰mount -t cgroup -o cpuset cpuset /sys/fs/cgroup/cpuset\n>\n>å°†åä¸ºcpusetçš„cgroupå…³è”åˆ°cpusetå­ç³»ç»Ÿ\n>\n>4ï¼‰åœ¨cpusetç›®å½•ä¸‹åˆ›å»ºç›®å½•ï¼Œç”Ÿæˆä¸€ä¸ªå­cgroupï¼Œå±æ€§æ–‡ä»¶ä¸­å†™å…¥ç›¸åº”å†…å®¹ï¼Œè®¾ç½®å±æ€§ã€‚\n>\n>5ï¼‰å¯åŠ¨éœ€è¦é™åˆ¶çš„è¿›ç¨‹ï¼ŒæŸ¥æ‰¾å…¶å¯¹åº”çš„è¿›ç¨‹IDï¼Œå°†å…¶å†™å…¥å¯¹åº”çš„taskæ–‡ä»¶ä¸­\n>\n>ä»¥ä¸‹æ“ä½œæ­¥éª¤æ˜¯åˆ›å»ºä¸€ä¸ªåä¸º\"Charlie\"çš„cgroupï¼Œè¿™ä¸ªcgroupçš„èµ„æºåŒ…å«cpu2ï¼Œcpu3å’Œå†…å­˜èŠ‚ç‚¹1ï¼Œå°†shellè¿›ç¨‹é™„åŠ åˆ°è¿™ä¸ªcgroupã€‚\n>\n>mount -t tmpfs cgroup_root /sys/fs/cgroup\n>\n>mkdir /sys/fs/cgroup/cpuset\n>\n>mount -t cgroup cpuset -o cpuset /sys/fs/cgroup/cpuset\n>\n>cd /sys/fs/cgroup/cpuset\n>\n>mkdir Charlie\n>\n>cd Charlie\n>\n>echo 2-3 > cpuset.cpus\n>\n>echo 1 > cpuset.mems\n>\n>echo $$ > tasks\n>\n>sh\n>\n>cat /proc/self/cgroup\n\nè½¬ï¼š\n\n https://blog.csdn.net/huang987246510/article/details/80765628\n","updated":"2024-05-16T11:01:26.743Z","path":"back_posts/cgroup.html","_id":"clw95434h0000auw06l6s63cc","comments":1,"layout":"page","content":"<p>[toc]</p>\n<p>cgroupæ˜¯linuxå†…æ ¸å®ç°ã€ç”¨äºæ§åˆ¶linuxç³»ç»Ÿèµ„æºçš„ç»„ä»¶ã€‚å› æ­¤è¦äº†è§£cgroupï¼Œé¦–å…ˆä»å¼•å…¥è¿™ä¸ªç»„ä»¶çš„kernelæ–‡æ¡£ä¸­å¯»æ‰¾ã€‚</p>\n<p>å»åˆ°ä¸¾ä¸–é—»åçš„<a href=\"http://www.kernel.org/\">www.kernel.org</a></p>\n<p>æ‰¾åˆ°ä»‹ç»æ–‡æ¡£ï¼šDocumentation&#x2F;cgroup-v1&#x2F;cgroups.txt</p>\n<h2 id=\"1-ä»€ä¹ˆæ˜¯cgroup\"><a href=\"#1-ä»€ä¹ˆæ˜¯cgroup\" class=\"headerlink\" title=\"1 ä»€ä¹ˆæ˜¯cgroup?\"></a>1 ä»€ä¹ˆæ˜¯cgroup?</h2><blockquote>\n<p>cgroup ï¼Œæ§åˆ¶ç»„ï¼Œå®ƒæä¾›äº†ä¸€å¥—æœºåˆ¶ç”¨äºæ§åˆ¶ä¸€ç»„ç‰¹å®šè¿›ç¨‹å¯¹èµ„æºçš„ä½¿ç”¨ã€‚cgroupç»‘å®šä¸€ä¸ªè¿›ç¨‹é›†åˆåˆ°ä¸€ä¸ªæˆ–å¤šä¸ªå­ç³»ç»Ÿä¸Šã€‚</p>\n<p>subsystemï¼Œå­ç³»ç»Ÿï¼Œä¸€ä¸ªé€šè¿‡cgroupæä¾›çš„å·¥å…·å’Œæ¥å£æ¥ç®¡ç†è¿›ç¨‹é›†åˆçš„æ¨¡å—ã€‚ä¸€ä¸ªå­ç³»ç»Ÿå°±æ˜¯ä¸€ä¸ªå…¸å‹çš„â€œèµ„æºæ§åˆ¶å™¨â€ï¼Œç”¨æ¥è°ƒåº¦èµ„æºæˆ–è€…æ§åˆ¶èµ„æºä½¿ç”¨çš„ä¸Šé™ã€‚å…¶å®æ¯ç§èµ„æºå°±æ˜¯ä¸€ä¸ªå­ç³»ç»Ÿã€‚å­ç³»ç»Ÿå¯ä»¥æ˜¯ä»¥è¿›ç¨‹ä¸ºå•ä½çš„ä»»ä½•ä¸œè¥¿ï¼Œæ¯”å¦‚è™šæ‹ŸåŒ–å­ç³»ç»Ÿã€å†…å­˜å­ç³»ç»Ÿã€‚</p>\n<p>hierarchyï¼Œå±‚çº§æ ‘ï¼Œå¤šä¸ªcgroupçš„é›†åˆï¼Œè¿™äº›é›†åˆæ„æˆçš„æ ‘å«hierarchyã€‚å¯ä»¥è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªèµ„æºæ ‘ï¼Œé™„ç€åœ¨è¿™ä¸Šé¢çš„è¿›ç¨‹å¯ä»¥ä½¿ç”¨çš„èµ„æºä¸Šé™å¿…é¡»å—æ ‘ä¸ŠèŠ‚ç‚¹ï¼ˆcgroupï¼‰çš„æ§åˆ¶ã€‚hierarchyä¸Šçš„å±‚æ¬¡å…³ç³»é€šè¿‡cgroupfsè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿæ˜¾ç¤ºã€‚ç³»ç»Ÿå…è®¸å¤šä¸ªhierarchyåŒæ—¶å­˜åœ¨ï¼Œæ¯ä¸ªhierachyåŒ…å«ç³»ç»Ÿä¸­çš„éƒ¨åˆ†æˆ–è€…å…¨éƒ¨è¿›ç¨‹é›†åˆã€‚</p>\n<p>cgroupfsæ˜¯ç”¨æˆ·ç®¡ç†æ“çºµcgroupçš„ä¸»è¦æ¥å£ï¼šé€šè¿‡åœ¨cgroupfsæ–‡ä»¶ç³»ç»Ÿä¸­åˆ›å»ºç›®å½•ï¼Œå®ç°cgroupçš„åˆ›å»ºï¼›é€šè¿‡å‘ç›®å½•ä¸‹çš„å±æ€§æ–‡ä»¶å†™å…¥å†…å®¹ï¼Œè®¾ç½®cgroupå¯¹èµ„æºçš„æ§åˆ¶ï¼›å‘taskå±æ€§æ–‡ä»¶å†™å…¥è¿›ç¨‹IDï¼Œå¯ä»¥å°†è¿›ç¨‹ç»‘å®šåˆ°æŸä¸ªcgroupï¼Œä»¥æ­¤è¾¾åˆ°æ§åˆ¶è¿›ç¨‹èµ„æºä½¿ç”¨çš„ç›®çš„ï¼›ä¹Ÿå¯ä»¥åˆ—å‡ºcgroupåŒ…å«çš„è¿›ç¨‹pidã€‚è¿™äº›æ“ä½œå½±å“çš„æ˜¯sysfså…³è”çš„hierarchyï¼Œå¯¹å…¶å®ƒhierarchyæ²¡æœ‰å½±å“ã€‚</p>\n<p>å¯¹äºcgroupï¼Œå…¶æœ¬èº«çš„ä½œç”¨åªæ˜¯ä»»åŠ¡è·Ÿè¸ªã€‚ä½†å…¶å®ƒç³»ç»Ÿï¼ˆæ¯”å¦‚cpusetsï¼Œcpuacctï¼‰ï¼Œå¯ä»¥åˆ©ç”¨cgroupçš„è¿™ä¸ªåŠŸèƒ½å®ç°ä¸€äº›æ–°çš„å±æ€§ï¼Œæ¯”å¦‚ç»Ÿè®¡æˆ–è€…æ§åˆ¶ä¸€ä¸ªcgroupä¸­è¿›ç¨‹å¯ä»¥è®¿é—®çš„èµ„æºã€‚ä¸¾ä¸ªä¾‹å­ï¼Œcpusetså­ç³»ç»Ÿå¯ä»¥å°†è¿›ç¨‹ç»‘å®šåˆ°ç‰¹å®šçš„cpuå’Œå†…å­˜èŠ‚ç‚¹ä¸Šã€‚</p>\n</blockquote>\n<p>2 ä¸ºä»€ä¹ˆéœ€è¦cgroup?</p>\n<blockquote>\n<p>è¿™ä¸ªé—®é¢˜ç›¸å½“äºé—®cgroupé‡è¦å—ï¼Ÿæœ‰å“ªäº›åœ°æ–¹ç”¨åˆ°äº†ã€‚å›ç­”æ˜¯é‡è¦ï¼Œåˆä¸é‡è¦ã€‚å¦‚æœä½ ç”¨åˆ°äº†ï¼Œé‚£å°±é‡è¦ï¼Œå¦‚æœæ²¡æœ‰ç”¨åˆ°ï¼Œé‚£å°±ä¸é‡è¦ã€‚å‘µå‘µå‘µ~~~~å…¶å®æŒºé‡è¦çš„ã€‚cgroupçš„ä¸»è¦è¿ç”¨æ˜¯èµ„æºè·Ÿè¸ªã€‚æˆ‘æ¥è§¦çš„åœºæ™¯å°±æ˜¯ç”¨cgroupæ§åˆ¶è™šæ‹Ÿæœºè¿›ç¨‹æˆ–è€…dockerè¿›ç¨‹å¯ä»¥ä½¿ç”¨çš„èµ„æºã€‚å½“ä½ æƒ³åœ¨linuxå¯¹åº”ç”¨è¿›ç¨‹åšèµ„æºè®¿é—®æ§åˆ¶çš„æ—¶å€™ï¼Œcgroupå°±æ´¾ä¸Šç”¨åœºäº†ã€‚</p>\n</blockquote>\n<h2 id=\"3-cgroupæ€ä¹ˆå®ç°çš„ï¼Ÿ\"><a href=\"#3-cgroupæ€ä¹ˆå®ç°çš„ï¼Ÿ\" class=\"headerlink\" title=\"3 cgroupæ€ä¹ˆå®ç°çš„ï¼Ÿ\"></a>3 cgroupæ€ä¹ˆå®ç°çš„ï¼Ÿ</h2><blockquote>\n<p>â€”â€”    ç³»ç»Ÿä¸­çš„æ¯ä¸ªè¿›ç¨‹ï¼ˆtask_structï¼Œåé¢ç”¨taskä»£æŒ‡ï¼‰éƒ½æŒæœ‰ä¸€ä¸ªæŒ‡å‘css_setç»“æ„çš„æŒ‡é’ˆã€‚</p>\n<p>â€”â€”    ä¸€ä¸ªcss_setç»“æ„ä½“åŒ…å«äº†ä¸€ç»„æŒ‡å‘cgroup_subsys_stateå¯¹è±¡çš„æŒ‡é’ˆï¼ˆæ‰€ä»¥ä¸€ä¸ªtaskå¯ä»¥é™„åŠ åˆ°å¤šä¸ªcgroupä¸Šï¼‰ï¼Œæ¯ä¸ªcgroup_subsys_stateåœ¨ç³»ç»Ÿä¸­éƒ½æœ‰æ³¨å†Œã€‚taskç»“æ„ä½“æ²¡æœ‰ç›´æ¥æŒ‡å‘hierarchyä¸­ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆcgroupï¼‰çš„æŒ‡é’ˆã€‚ä½†å¯ä»¥é€šè¿‡å…¶åŒ…å«çš„cgroup_subsys_stateé—´æ¥ç¡®å®šã€‚è¿™æ ·è®¾è®¡çš„åŸå› æ˜¯cpuå¯¹subsystem stateçš„è®¿é—®å¾ˆé¢‘ç¹ï¼Œä½†æ¶‰åŠåˆ°å°†taskç»‘å®šåˆ°cgroupçš„æ“ä½œå´ä¸å¤šã€‚taskä¸­è¿˜æœ‰ä¸ªåŒå‘é“¾è¡¨cg_listï¼Œè¿™ä¸ªé“¾è¡¨ç»´æŠ¤æ‰€æœ‰åŒå±äºä¸€ä¸ªcss_setçš„tasksã€‚</p>\n<p>â€”â€”    ç”¨æˆ·å¯ä»¥é€šè¿‡cgroupfsæ–‡ä»¶ç³»ç»Ÿæ¥æµè§ˆcgroup hierarchyã€‚</p>\n<p>â€”â€”    ç”¨æˆ·å¯ä»¥åˆ—å‡ºä»»æ„ä¸€ä¸ªcgroupä¸Šé™„ç€çš„task PID</p>\n<p>cgroupåœ¨kernelä¸­é™¤äº†æœ¬èº«åŠŸèƒ½çš„å®ç°å¤–ï¼Œåœ¨kernelä¸­è¿˜æœ‰ä¸¤å¤„ä¿®æ”¹ï¼š</p>\n<p>â€”â€”    åœ¨kernelå¯åŠ¨æ—¶å¯¹root cgroupçš„åˆå§‹åŒ–å’Œcss_setç»“æ„ä½“çš„åˆå§‹åŒ–ã€‚è¿™ä¸ªåœ¨init&#x2F;main.cæ–‡ä»¶ä¸­å®ç°ã€‚</p>\n<p>â€”â€”    åœ¨taskçš„åˆ›å»ºï¼ˆforkï¼‰å’Œé€€å‡ºï¼ˆexitï¼‰é˜¶æ®µï¼Œå¯¹åº”åœ°å°†taskä¸css_setè¿›è¡Œç»‘å®šå’Œè§£ç»‘ã€‚</p>\n<p>å¦å¤–ï¼Œcgroupä¸ºäº†å‘ç”¨æˆ·æä¾›æ“ä½œæ¥å£ï¼Œç‰¹åˆ«å¼€å‘äº†ä¸€ä¸ªè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿç±»å‹ï¼ˆcgroupfsï¼‰ï¼Œè¿™ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸sysfsï¼Œprocç±»ä¼¼ã€‚cgroupfsæ˜¯å‘ç”¨æˆ·å±•ç¤ºcgroupçš„hierarchyï¼Œé€šçŸ¥kernelç”¨æˆ·å¯¹cgroupæ”¹åŠ¨çš„çª—å£ã€‚æŒ‚è½½cgroupfsæ—¶é€šè¿‡é€‰é¡¹ï¼ˆ-otypeï¼‰æŒ‡å®šè¦æŒ‚è½½çš„å­ç³»ç»Ÿç±»å‹ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œé»˜è®¤æŒ‚è½½æ‰€æœ‰çš„æ³¨å†Œçš„å­ç³»ç»Ÿã€‚</p>\n<p>å¦‚æœæ–°æŒ‚è½½çš„cgroupå…³è”çš„hierachyä¸ç³»ç»Ÿä¸­å­˜åœ¨çš„hierarchyå®Œå…¨ä¸€æ ·ï¼Œé‚£ä¹ˆcgroupfsä¼šæ‹’ç»æŒ‚è½½ã€‚å¦‚æœæ²¡æœ‰åŒ¹é…åˆ°ç›¸åŒçš„hierarchyï¼Œä½†æ–°æŒ‚è½½hierachyå£°æ˜çš„èµ„æºæ­£åœ¨è¢«å·²ç»å­˜åœ¨çš„hierarchyä½¿ç”¨ï¼ŒæŒ‚è½½ä¼šæŠ¥-EBUSYé”™è¯¯ã€‚</p>\n<p>å½“å‰cgroupè¿˜æ²¡æœ‰å®ç°å‘å·²ç»å­˜åœ¨çš„cgroup hierarchyç»‘å®šæ–°å­ç³»ç»Ÿçš„æ“ä½œï¼Œå°†å­ç³»ç»Ÿä»cgroup hierachyè§£ç»‘ä¹Ÿä¸å…è®¸ã€‚è¿™äº›æ“ä½œåœ¨æœªæ¥ä¹Ÿè®¸ä¼šæ”¯æŒï¼Œä½†ä¹Ÿå¯èƒ½ä¼šè¿›ä¸€æ­¥äº§ç”Ÿé”™è¯¯æ¢å¤çš„ä¸€ç³»åˆ—é—®é¢˜ã€‚</p>\n<p>å¸è½½cgroupfsæ—¶ï¼Œå¦‚æœå®ƒçš„å­cgroupfsè¿˜åœ¨æ´»åŠ¨ï¼Œé‚£ä¹ˆå­cgroupfsè¿˜æ˜¯ä¼šæŒç»­ç”Ÿæ•ˆã€‚ç›´åˆ°æ‰€æœ‰çš„å­cgroupfsä¸å†æ´»åŠ¨ï¼Œå¸è½½cgroupfsæ‰ä¼šçœŸæ­£ç”Ÿæ•ˆã€‚</p>\n<p>cgroupfsä¸‹ä¸èƒ½å†æŒ‚è½½å…¶å®ƒç±»å‹çš„æ–‡ä»¶ç³»ç»Ÿã€‚æ‰€æœ‰å¯¹cgroupçš„æŸ¥è¯¢ä¿®æ”¹éƒ½åªé€šè¿‡cgroupfsæ–‡ä»¶ç³»ç»Ÿæ¥å®Œæˆã€‚</p>\n<p>ç³»ç»Ÿä¸­çš„æ‰€æœ‰taskï¼Œåœ¨&#x2F;proc&#x2F;pidç›®å½•ä¸‹éƒ½æœ‰ä¸€ä¸ªåä¸ºcgroupçš„æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶å±•ç¤ºäº†è¯¥taskç›¸å¯¹cgroupfs æ ¹çš„è·¯å¾„ã€‚é€šè¿‡æŸ¥çœ‹è¿™ä¸ªæ–‡ä»¶ï¼Œå¯ä»¥äº†è§£ä¸€ä¸ªè¿›ç¨‹åœ¨cgroup hierarchyçš„ä½ç½®ã€‚ä»¥æ­¤å¾—åˆ°taskå¯ä»¥ä½¿ç”¨çš„èµ„æºä¿¡æ¯ã€‚</p>\n<p>cgroupfsä¸­ç›®å½•è¡¨ç¤ºcgroupï¼Œæ¯ä¸ªç›®å½•åœ¨åˆ›å»ºæ—¶é»˜è®¤ç”Ÿæˆå¦‚ä¸‹çš„å±æ€§æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶æè¿°äº†cgroupçš„ä¿¡æ¯ï¼š</p>\n<p>â€”â€”    tasks: æ‰€æœ‰é™„å±äºè¿™ä¸ªcgroupçš„è¿›ç¨‹IDåˆ—è¡¨ã€‚tasksæ–‡ä»¶ä¸­å¢åŠ è¿›ç¨‹IDï¼Œè¡¨ç¤ºå°†è¿›ç¨‹åŠ å…¥è¿™ä¸ªcgroupï¼Œè¿›ç¨‹èƒ½å¤Ÿä½¿ç”¨çš„èµ„æºå—cgroupé™åˆ¶ã€‚</p>\n<p>â€”â€”    cgroup.procs: æ‰€æœ‰é™„å±äºè¿™ä¸ªcgroupçº¿ç¨‹ç»„IDï¼Œå°†TGIDå†™å…¥è¿™ä¸ªæ–‡ä»¶åï¼ŒTGIDæ‰€åœ¨è¿›ç¨‹åŒ…å«çš„æ‰€æœ‰çº¿ç¨‹éƒ½åŠ å…¥è¿™ä¸ªcgroupï¼Œè¿™äº›çº¿ç¨‹å—cgroupé™åˆ¶ã€‚</p>\n</blockquote>\n<blockquote>\n<p>PIDï¼šè¿™æ˜¯ Linux ä¸­åœ¨å…¶å‘½åç©ºé—´ä¸­å”¯ä¸€æ ‡è¯†è¿›ç¨‹è€Œåˆ†é…ç»™å®ƒçš„ä¸€ä¸ªå·ç ï¼Œç§°åšè¿›ç¨‹IDå·ï¼Œç®€ç§°PIDã€‚åœ¨ä½¿ç”¨ fork æˆ– clone ç³»ç»Ÿè°ƒç”¨æ—¶äº§ç”Ÿçš„è¿›ç¨‹å‡ä¼šç”±å†…æ ¸åˆ†é…ä¸€ä¸ªæ–°çš„å”¯ä¸€çš„PIDå€¼ã€‚<br>TGIDï¼šåœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œå¦‚æœä»¥CLONE_THREADæ ‡å¿—æ¥è°ƒç”¨cloneå»ºç«‹çš„è¿›ç¨‹å°±æ˜¯è¯¥è¿›ç¨‹çš„ä¸€ä¸ªçº¿ç¨‹ï¼Œå®ƒä»¬å¤„äºä¸€ä¸ªçº¿ç¨‹ç»„ï¼Œè¯¥çº¿ç¨‹ç»„çš„IDå«åšTGIDã€‚å¤„äºç›¸åŒçš„çº¿ç¨‹ç»„ä¸­çš„æ‰€æœ‰è¿›ç¨‹éƒ½æœ‰ç›¸åŒçš„TGIDï¼›çº¿ç¨‹ç»„ç»„é•¿çš„TGIDä¸å…¶PIDç›¸åŒï¼›ä¸€ä¸ªè¿›ç¨‹æ²¡æœ‰ä½¿ç”¨çº¿ç¨‹ï¼Œåˆ™å…¶TGIDä¸PIDä¹Ÿç›¸åŒã€‚<br>PGIDï¼šå¦å¤–ï¼Œç‹¬ç«‹çš„è¿›ç¨‹å¯ä»¥ç»„æˆè¿›ç¨‹ç»„ï¼ˆä½¿ç”¨setpgrpç³»ç»Ÿè°ƒç”¨ï¼‰ï¼Œè¿›ç¨‹ç»„å¯ä»¥ç®€åŒ–å‘æ‰€æœ‰ç»„å†…è¿›ç¨‹å‘é€ä¿¡å·çš„æ“ä½œï¼Œä¾‹å¦‚ç”¨ç®¡é“è¿æ¥çš„è¿›ç¨‹å¤„åœ¨åŒä¸€è¿›ç¨‹ç»„å†…ã€‚è¿›ç¨‹ç»„IDå«åšPGIDï¼Œè¿›ç¨‹ç»„å†…çš„æ‰€æœ‰è¿›ç¨‹éƒ½æœ‰ç›¸åŒçš„PGIDï¼Œç­‰äºè¯¥ç»„ç»„é•¿çš„PIDã€‚<br>SIDï¼šå‡ ä¸ªè¿›ç¨‹ç»„å¯ä»¥åˆå¹¶æˆä¸€ä¸ªä¼šè¯ç»„ï¼ˆä½¿ç”¨setsidç³»ç»Ÿè°ƒç”¨ï¼‰ï¼Œå¯ä»¥ç”¨äºç»ˆç«¯ç¨‹åºè®¾è®¡ã€‚ä¼šè¯ç»„ä¸­æ‰€æœ‰è¿›ç¨‹éƒ½æœ‰ç›¸åŒçš„SIDã€‚<br>â€”â€”    notify_on_release flag: æ ‡è®°é€€å‡ºæ—¶æ˜¯å¦è¿è¡Œrelease agent</p>\n<p>â€”â€”    release_agent: åˆ¶å®šè¦è¿è¡Œçš„release agentçš„è·¯å¾„ï¼Œè¿™ä¸ªå±æ€§æ–‡ä»¶åªåœ¨cgroupçš„é¡¶å±‚ç›®å½•ä¸­å­˜åœ¨ã€‚</p>\n<p>ä»¥ä¸Šæ–‡ä»¶æ˜¯æ¯ä¸ªcgroupåŸºæœ¬çš„å±æ€§æ–‡ä»¶ï¼Œå¯¹äºä¸åŒçš„å­ç³»ç»Ÿï¼Œå¯¹åº”çš„cgroupå¯èƒ½ä¼šæœ‰å…¶å®ƒé™„åŠ çš„å±æ€§æ–‡ä»¶ï¼Œå­˜åœ¨äºå…¶å¯¹åº”çš„cgroupç›®å½•ä¹‹ä¸‹ã€‚</p>\n<p>é€šè¿‡mkdirå‘½ä»¤åˆ›å»ºcgroupï¼Œé€šè¿‡å‘ç›®å½•ä¸‹çš„æ–‡ä»¶å†™å…¥é€‚å½“çš„æ•°å€¼è®¾ç½®ä¿®æ”¹cgroupçš„å±æ€§ã€‚</p>\n<p>åµŒå¥—çš„cgroupsï¼ŒæŒ‡å®šäº†å±‚çº§ç»“æ„ï¼Œä»¥æ­¤å°†ç³»ç»Ÿèµ„æºåˆ’åˆ†æˆåµŒå¥—çš„ï¼ŒåŠ¨æ€å¯å˜çš„æ›´å°çš„èµ„æºå—ã€‚</p>\n<p>ä¸€ä¸ªè¿›ç¨‹å¯ä»¥é™„åŠ åˆ°å¤šä¸ªä¸åŒçš„cgroupä¸­ï¼Œåªè¦è¿™äº›cgroupä¸åœ¨åŒä¸€ä¸ªå±‚çº§æ ‘ä¸Šå³å¯ã€‚å› ä¸ºcgroupfsä¼šä¿è¯æ–°æŒ‚è½½çš„cgroupå…³è”çš„å±‚çº§æ ‘å…¨å±€å”¯ä¸€ã€‚å­è¿›ç¨‹åœ¨è¢«åˆ›å»ºåé»˜è®¤é™„åŠ åˆ°çˆ¶è¿›ç¨‹æ‰€åœ¨çš„cgroupï¼Œåé¢ç”¨æˆ·å¯ä»¥æ ¹æ®éœ€è¦å°†å…¶ç§»åŠ¨åˆ°åˆ«çš„cgroupã€‚</p>\n<p>å½“è¿›ç¨‹ä»ä¸€ä¸ªcgroupè¢«ç§»åŠ¨åˆ°å¦ä¸€ä¸ªcgroupã€‚è¿›ç¨‹çš„task_structä¼šè·å–ä¸€ä¸ªæ–°çš„css_setæŒ‡é’ˆï¼šå¦‚æœè¿™ä¸ªcgroupæ‰€åœ¨çš„css_setå·²ç»å­˜åœ¨å°±é‡ç”¨è¿™ä¸ªcss_setï¼Œå¦åˆ™å°±æ–°åˆ†é…ä¸€ä¸ªcss_setã€‚kernelä¼šåœ¨å…¨å±€çš„hashè¡¨ä¸­æŸ¥æ‰¾ç¡®è®¤cgroupæ‰€å±çš„css_setæ˜¯å¦å­˜åœ¨ã€‚</p>\n</blockquote>\n<h2 id=\"4-notify-on-release-æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ\"><a href=\"#4-notify-on-release-æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ\" class=\"headerlink\" title=\"4 notify_on_release æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ\"></a>4 notify_on_release æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ</h2><blockquote>\n<p>å¦‚æœcgroupä¸­ä½¿èƒ½notify_on_releaseï¼Œcgroupä¸­çš„æœ€åä¸€ä¸ªè¿›ç¨‹è¢«ç§»é™¤ï¼Œæœ€åä¸€ä¸ªå­cgroupä¹Ÿè¢«åˆ é™¤æ—¶ï¼Œcgroupä¼šä¸»åŠ¨é€šçŸ¥kernelã€‚æ¥æ”¶åˆ°æ¶ˆæ¯çš„kernelä¼šæ‰§è¡Œrelease_agentæ–‡ä»¶ä¸­æŒ‡å®šçš„ç¨‹åºã€‚notify_on_releaseé»˜è®¤æ˜¯å…³é—­çš„ï¼Œrelease_agentçš„å†…å®¹é»˜è®¤ä¸ºç©ºï¼Œå­cgroupåœ¨åˆ›å»ºæ—¶ä¼šç»§æ‰¿çˆ¶cgroupä¸­notify_on_relaseå’Œrelease_agentçš„å±æ€§ã€‚æ‰€ä»¥è¿™ä¸¤ä¸ªæ–‡ä»¶åªå­˜åœ¨äºcgroupfsçš„é¡¶å±‚ç›®å½•ä¸­ã€‚</p>\n</blockquote>\n<h2 id=\"5-clone-childrenæœ‰ä»€ä¹ˆç”¨ï¼Ÿ\"><a href=\"#5-clone-childrenæœ‰ä»€ä¹ˆç”¨ï¼Ÿ\" class=\"headerlink\" title=\"5 clone_childrenæœ‰ä»€ä¹ˆç”¨ï¼Ÿ\"></a>5 clone_childrenæœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h2><blockquote>\n<p>clone_chilrenä»…é’ˆå¯¹cpuç»‘å®šï¼ˆcpusetï¼‰ï¼Œå¦‚æœclone_childrenä½¿èƒ½ï¼Œæ–°çš„cpuset cgroupåœ¨åˆå§‹åŒ–æ—¶ä¼šç»§æ‰¿çˆ¶cgroupçš„å±æ€§ã€‚</p>\n</blockquote>\n<h2 id=\"6-cgroupæ€ä¹ˆç”¨ï¼Ÿ\"><a href=\"#6-cgroupæ€ä¹ˆç”¨ï¼Ÿ\" class=\"headerlink\" title=\"6 cgroupæ€ä¹ˆç”¨ï¼Ÿ\"></a>6 cgroupæ€ä¹ˆç”¨ï¼Ÿ</h2><blockquote>\n<p>å‡è®¾ç°åœ¨è¦å°†ä¸€ä¸ªæ–°çš„ä»»åŠ¡åŠ å…¥åˆ°cgroupï¼ŒåŠŸèƒ½æ˜¯å°†è¯¥ä»»åŠ¡çš„è¿›ç¨‹åœ¨æŒ‡å®šçš„cpuä¸Šè¿è¡Œï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨â€cpusetâ€cgroup å­ç³»ç»Ÿï¼Œæ“ä½œçš„å¤§è‡´æ­¥éª¤å¦‚ä¸‹ï¼š</p>\n<p>1ï¼‰mount -t tmpfs cgroup_root &#x2F;sys&#x2F;fs&#x2F;cgroup </p>\n<p>æŒ‚è½½cgroupæ ¹æ–‡ä»¶ç³»ç»Ÿï¼Œç±»å‹ä¸ºtmpfs</p>\n<p>2ï¼‰mkdir &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;cpuset</p>\n<p>åœ¨cgroupfsæ ¹ç›®å½•ä¸‹åˆ›å»ºå­cgroupï¼Œåä¸ºcpuset</p>\n<p>3ï¼‰mount -t cgroup -o cpuset cpuset &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;cpuset</p>\n<p>å°†åä¸ºcpusetçš„cgroupå…³è”åˆ°cpusetå­ç³»ç»Ÿ</p>\n<p>4ï¼‰åœ¨cpusetç›®å½•ä¸‹åˆ›å»ºç›®å½•ï¼Œç”Ÿæˆä¸€ä¸ªå­cgroupï¼Œå±æ€§æ–‡ä»¶ä¸­å†™å…¥ç›¸åº”å†…å®¹ï¼Œè®¾ç½®å±æ€§ã€‚</p>\n<p>5ï¼‰å¯åŠ¨éœ€è¦é™åˆ¶çš„è¿›ç¨‹ï¼ŒæŸ¥æ‰¾å…¶å¯¹åº”çš„è¿›ç¨‹IDï¼Œå°†å…¶å†™å…¥å¯¹åº”çš„taskæ–‡ä»¶ä¸­</p>\n<p>ä»¥ä¸‹æ“ä½œæ­¥éª¤æ˜¯åˆ›å»ºä¸€ä¸ªåä¸ºâ€Charlieâ€çš„cgroupï¼Œè¿™ä¸ªcgroupçš„èµ„æºåŒ…å«cpu2ï¼Œcpu3å’Œå†…å­˜èŠ‚ç‚¹1ï¼Œå°†shellè¿›ç¨‹é™„åŠ åˆ°è¿™ä¸ªcgroupã€‚</p>\n<p>mount -t tmpfs cgroup_root &#x2F;sys&#x2F;fs&#x2F;cgroup</p>\n<p>mkdir &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;cpuset</p>\n<p>mount -t cgroup cpuset -o cpuset &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;cpuset</p>\n<p>cd &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;cpuset</p>\n<p>mkdir Charlie</p>\n<p>cd Charlie</p>\n<p>echo 2-3 &gt; cpuset.cpus</p>\n<p>echo 1 &gt; cpuset.mems</p>\n<p>echo $$ &gt; tasks</p>\n<p>sh</p>\n<p>cat &#x2F;proc&#x2F;self&#x2F;cgroup</p>\n</blockquote>\n<p>è½¬ï¼š</p>\n<p> <a href=\"https://blog.csdn.net/huang987246510/article/details/80765628\">https://blog.csdn.net/huang987246510/article/details/80765628</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p>[toc]</p>\n<p>cgroupæ˜¯linuxå†…æ ¸å®ç°ã€ç”¨äºæ§åˆ¶linuxç³»ç»Ÿèµ„æºçš„ç»„ä»¶ã€‚å› æ­¤è¦äº†è§£cgroupï¼Œé¦–å…ˆä»å¼•å…¥è¿™ä¸ªç»„ä»¶çš„kernelæ–‡æ¡£ä¸­å¯»æ‰¾ã€‚</p>\n<p>å»åˆ°ä¸¾ä¸–é—»åçš„<a href=\"http://www.kernel.org/\">www.kernel.org</a></p>\n<p>æ‰¾åˆ°ä»‹ç»æ–‡æ¡£ï¼šDocumentation&#x2F;cgroup-v1&#x2F;cgroups.txt</p>\n<h2 id=\"1-ä»€ä¹ˆæ˜¯cgroup\"><a href=\"#1-ä»€ä¹ˆæ˜¯cgroup\" class=\"headerlink\" title=\"1 ä»€ä¹ˆæ˜¯cgroup?\"></a>1 ä»€ä¹ˆæ˜¯cgroup?</h2><blockquote>\n<p>cgroup ï¼Œæ§åˆ¶ç»„ï¼Œå®ƒæä¾›äº†ä¸€å¥—æœºåˆ¶ç”¨äºæ§åˆ¶ä¸€ç»„ç‰¹å®šè¿›ç¨‹å¯¹èµ„æºçš„ä½¿ç”¨ã€‚cgroupç»‘å®šä¸€ä¸ªè¿›ç¨‹é›†åˆåˆ°ä¸€ä¸ªæˆ–å¤šä¸ªå­ç³»ç»Ÿä¸Šã€‚</p>\n<p>subsystemï¼Œå­ç³»ç»Ÿï¼Œä¸€ä¸ªé€šè¿‡cgroupæä¾›çš„å·¥å…·å’Œæ¥å£æ¥ç®¡ç†è¿›ç¨‹é›†åˆçš„æ¨¡å—ã€‚ä¸€ä¸ªå­ç³»ç»Ÿå°±æ˜¯ä¸€ä¸ªå…¸å‹çš„â€œèµ„æºæ§åˆ¶å™¨â€ï¼Œç”¨æ¥è°ƒåº¦èµ„æºæˆ–è€…æ§åˆ¶èµ„æºä½¿ç”¨çš„ä¸Šé™ã€‚å…¶å®æ¯ç§èµ„æºå°±æ˜¯ä¸€ä¸ªå­ç³»ç»Ÿã€‚å­ç³»ç»Ÿå¯ä»¥æ˜¯ä»¥è¿›ç¨‹ä¸ºå•ä½çš„ä»»ä½•ä¸œè¥¿ï¼Œæ¯”å¦‚è™šæ‹ŸåŒ–å­ç³»ç»Ÿã€å†…å­˜å­ç³»ç»Ÿã€‚</p>\n<p>hierarchyï¼Œå±‚çº§æ ‘ï¼Œå¤šä¸ªcgroupçš„é›†åˆï¼Œè¿™äº›é›†åˆæ„æˆçš„æ ‘å«hierarchyã€‚å¯ä»¥è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªèµ„æºæ ‘ï¼Œé™„ç€åœ¨è¿™ä¸Šé¢çš„è¿›ç¨‹å¯ä»¥ä½¿ç”¨çš„èµ„æºä¸Šé™å¿…é¡»å—æ ‘ä¸ŠèŠ‚ç‚¹ï¼ˆcgroupï¼‰çš„æ§åˆ¶ã€‚hierarchyä¸Šçš„å±‚æ¬¡å…³ç³»é€šè¿‡cgroupfsè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿæ˜¾ç¤ºã€‚ç³»ç»Ÿå…è®¸å¤šä¸ªhierarchyåŒæ—¶å­˜åœ¨ï¼Œæ¯ä¸ªhierachyåŒ…å«ç³»ç»Ÿä¸­çš„éƒ¨åˆ†æˆ–è€…å…¨éƒ¨è¿›ç¨‹é›†åˆã€‚</p>\n<p>cgroupfsæ˜¯ç”¨æˆ·ç®¡ç†æ“çºµcgroupçš„ä¸»è¦æ¥å£ï¼šé€šè¿‡åœ¨cgroupfsæ–‡ä»¶ç³»ç»Ÿä¸­åˆ›å»ºç›®å½•ï¼Œå®ç°cgroupçš„åˆ›å»ºï¼›é€šè¿‡å‘ç›®å½•ä¸‹çš„å±æ€§æ–‡ä»¶å†™å…¥å†…å®¹ï¼Œè®¾ç½®cgroupå¯¹èµ„æºçš„æ§åˆ¶ï¼›å‘taskå±æ€§æ–‡ä»¶å†™å…¥è¿›ç¨‹IDï¼Œå¯ä»¥å°†è¿›ç¨‹ç»‘å®šåˆ°æŸä¸ªcgroupï¼Œä»¥æ­¤è¾¾åˆ°æ§åˆ¶è¿›ç¨‹èµ„æºä½¿ç”¨çš„ç›®çš„ï¼›ä¹Ÿå¯ä»¥åˆ—å‡ºcgroupåŒ…å«çš„è¿›ç¨‹pidã€‚è¿™äº›æ“ä½œå½±å“çš„æ˜¯sysfså…³è”çš„hierarchyï¼Œå¯¹å…¶å®ƒhierarchyæ²¡æœ‰å½±å“ã€‚</p>\n<p>å¯¹äºcgroupï¼Œå…¶æœ¬èº«çš„ä½œç”¨åªæ˜¯ä»»åŠ¡è·Ÿè¸ªã€‚ä½†å…¶å®ƒç³»ç»Ÿï¼ˆæ¯”å¦‚cpusetsï¼Œcpuacctï¼‰ï¼Œå¯ä»¥åˆ©ç”¨cgroupçš„è¿™ä¸ªåŠŸèƒ½å®ç°ä¸€äº›æ–°çš„å±æ€§ï¼Œæ¯”å¦‚ç»Ÿè®¡æˆ–è€…æ§åˆ¶ä¸€ä¸ªcgroupä¸­è¿›ç¨‹å¯ä»¥è®¿é—®çš„èµ„æºã€‚ä¸¾ä¸ªä¾‹å­ï¼Œcpusetså­ç³»ç»Ÿå¯ä»¥å°†è¿›ç¨‹ç»‘å®šåˆ°ç‰¹å®šçš„cpuå’Œå†…å­˜èŠ‚ç‚¹ä¸Šã€‚</p>\n</blockquote>\n<p>2 ä¸ºä»€ä¹ˆéœ€è¦cgroup?</p>\n<blockquote>\n<p>è¿™ä¸ªé—®é¢˜ç›¸å½“äºé—®cgroupé‡è¦å—ï¼Ÿæœ‰å“ªäº›åœ°æ–¹ç”¨åˆ°äº†ã€‚å›ç­”æ˜¯é‡è¦ï¼Œåˆä¸é‡è¦ã€‚å¦‚æœä½ ç”¨åˆ°äº†ï¼Œé‚£å°±é‡è¦ï¼Œå¦‚æœæ²¡æœ‰ç”¨åˆ°ï¼Œé‚£å°±ä¸é‡è¦ã€‚å‘µå‘µå‘µ~~~~å…¶å®æŒºé‡è¦çš„ã€‚cgroupçš„ä¸»è¦è¿ç”¨æ˜¯èµ„æºè·Ÿè¸ªã€‚æˆ‘æ¥è§¦çš„åœºæ™¯å°±æ˜¯ç”¨cgroupæ§åˆ¶è™šæ‹Ÿæœºè¿›ç¨‹æˆ–è€…dockerè¿›ç¨‹å¯ä»¥ä½¿ç”¨çš„èµ„æºã€‚å½“ä½ æƒ³åœ¨linuxå¯¹åº”ç”¨è¿›ç¨‹åšèµ„æºè®¿é—®æ§åˆ¶çš„æ—¶å€™ï¼Œcgroupå°±æ´¾ä¸Šç”¨åœºäº†ã€‚</p>\n</blockquote>\n<h2 id=\"3-cgroupæ€ä¹ˆå®ç°çš„ï¼Ÿ\"><a href=\"#3-cgroupæ€ä¹ˆå®ç°çš„ï¼Ÿ\" class=\"headerlink\" title=\"3 cgroupæ€ä¹ˆå®ç°çš„ï¼Ÿ\"></a>3 cgroupæ€ä¹ˆå®ç°çš„ï¼Ÿ</h2><blockquote>\n<p>â€”â€”    ç³»ç»Ÿä¸­çš„æ¯ä¸ªè¿›ç¨‹ï¼ˆtask_structï¼Œåé¢ç”¨taskä»£æŒ‡ï¼‰éƒ½æŒæœ‰ä¸€ä¸ªæŒ‡å‘css_setç»“æ„çš„æŒ‡é’ˆã€‚</p>\n<p>â€”â€”    ä¸€ä¸ªcss_setç»“æ„ä½“åŒ…å«äº†ä¸€ç»„æŒ‡å‘cgroup_subsys_stateå¯¹è±¡çš„æŒ‡é’ˆï¼ˆæ‰€ä»¥ä¸€ä¸ªtaskå¯ä»¥é™„åŠ åˆ°å¤šä¸ªcgroupä¸Šï¼‰ï¼Œæ¯ä¸ªcgroup_subsys_stateåœ¨ç³»ç»Ÿä¸­éƒ½æœ‰æ³¨å†Œã€‚taskç»“æ„ä½“æ²¡æœ‰ç›´æ¥æŒ‡å‘hierarchyä¸­ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆcgroupï¼‰çš„æŒ‡é’ˆã€‚ä½†å¯ä»¥é€šè¿‡å…¶åŒ…å«çš„cgroup_subsys_stateé—´æ¥ç¡®å®šã€‚è¿™æ ·è®¾è®¡çš„åŸå› æ˜¯cpuå¯¹subsystem stateçš„è®¿é—®å¾ˆé¢‘ç¹ï¼Œä½†æ¶‰åŠåˆ°å°†taskç»‘å®šåˆ°cgroupçš„æ“ä½œå´ä¸å¤šã€‚taskä¸­è¿˜æœ‰ä¸ªåŒå‘é“¾è¡¨cg_listï¼Œè¿™ä¸ªé“¾è¡¨ç»´æŠ¤æ‰€æœ‰åŒå±äºä¸€ä¸ªcss_setçš„tasksã€‚</p>\n<p>â€”â€”    ç”¨æˆ·å¯ä»¥é€šè¿‡cgroupfsæ–‡ä»¶ç³»ç»Ÿæ¥æµè§ˆcgroup hierarchyã€‚</p>\n<p>â€”â€”    ç”¨æˆ·å¯ä»¥åˆ—å‡ºä»»æ„ä¸€ä¸ªcgroupä¸Šé™„ç€çš„task PID</p>\n<p>cgroupåœ¨kernelä¸­é™¤äº†æœ¬èº«åŠŸèƒ½çš„å®ç°å¤–ï¼Œåœ¨kernelä¸­è¿˜æœ‰ä¸¤å¤„ä¿®æ”¹ï¼š</p>\n<p>â€”â€”    åœ¨kernelå¯åŠ¨æ—¶å¯¹root cgroupçš„åˆå§‹åŒ–å’Œcss_setç»“æ„ä½“çš„åˆå§‹åŒ–ã€‚è¿™ä¸ªåœ¨init&#x2F;main.cæ–‡ä»¶ä¸­å®ç°ã€‚</p>\n<p>â€”â€”    åœ¨taskçš„åˆ›å»ºï¼ˆforkï¼‰å’Œé€€å‡ºï¼ˆexitï¼‰é˜¶æ®µï¼Œå¯¹åº”åœ°å°†taskä¸css_setè¿›è¡Œç»‘å®šå’Œè§£ç»‘ã€‚</p>\n<p>å¦å¤–ï¼Œcgroupä¸ºäº†å‘ç”¨æˆ·æä¾›æ“ä½œæ¥å£ï¼Œç‰¹åˆ«å¼€å‘äº†ä¸€ä¸ªè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿç±»å‹ï¼ˆcgroupfsï¼‰ï¼Œè¿™ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸sysfsï¼Œprocç±»ä¼¼ã€‚cgroupfsæ˜¯å‘ç”¨æˆ·å±•ç¤ºcgroupçš„hierarchyï¼Œé€šçŸ¥kernelç”¨æˆ·å¯¹cgroupæ”¹åŠ¨çš„çª—å£ã€‚æŒ‚è½½cgroupfsæ—¶é€šè¿‡é€‰é¡¹ï¼ˆ-otypeï¼‰æŒ‡å®šè¦æŒ‚è½½çš„å­ç³»ç»Ÿç±»å‹ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œé»˜è®¤æŒ‚è½½æ‰€æœ‰çš„æ³¨å†Œçš„å­ç³»ç»Ÿã€‚</p>\n<p>å¦‚æœæ–°æŒ‚è½½çš„cgroupå…³è”çš„hierachyä¸ç³»ç»Ÿä¸­å­˜åœ¨çš„hierarchyå®Œå…¨ä¸€æ ·ï¼Œé‚£ä¹ˆcgroupfsä¼šæ‹’ç»æŒ‚è½½ã€‚å¦‚æœæ²¡æœ‰åŒ¹é…åˆ°ç›¸åŒçš„hierarchyï¼Œä½†æ–°æŒ‚è½½hierachyå£°æ˜çš„èµ„æºæ­£åœ¨è¢«å·²ç»å­˜åœ¨çš„hierarchyä½¿ç”¨ï¼ŒæŒ‚è½½ä¼šæŠ¥-EBUSYé”™è¯¯ã€‚</p>\n<p>å½“å‰cgroupè¿˜æ²¡æœ‰å®ç°å‘å·²ç»å­˜åœ¨çš„cgroup hierarchyç»‘å®šæ–°å­ç³»ç»Ÿçš„æ“ä½œï¼Œå°†å­ç³»ç»Ÿä»cgroup hierachyè§£ç»‘ä¹Ÿä¸å…è®¸ã€‚è¿™äº›æ“ä½œåœ¨æœªæ¥ä¹Ÿè®¸ä¼šæ”¯æŒï¼Œä½†ä¹Ÿå¯èƒ½ä¼šè¿›ä¸€æ­¥äº§ç”Ÿé”™è¯¯æ¢å¤çš„ä¸€ç³»åˆ—é—®é¢˜ã€‚</p>\n<p>å¸è½½cgroupfsæ—¶ï¼Œå¦‚æœå®ƒçš„å­cgroupfsè¿˜åœ¨æ´»åŠ¨ï¼Œé‚£ä¹ˆå­cgroupfsè¿˜æ˜¯ä¼šæŒç»­ç”Ÿæ•ˆã€‚ç›´åˆ°æ‰€æœ‰çš„å­cgroupfsä¸å†æ´»åŠ¨ï¼Œå¸è½½cgroupfsæ‰ä¼šçœŸæ­£ç”Ÿæ•ˆã€‚</p>\n<p>cgroupfsä¸‹ä¸èƒ½å†æŒ‚è½½å…¶å®ƒç±»å‹çš„æ–‡ä»¶ç³»ç»Ÿã€‚æ‰€æœ‰å¯¹cgroupçš„æŸ¥è¯¢ä¿®æ”¹éƒ½åªé€šè¿‡cgroupfsæ–‡ä»¶ç³»ç»Ÿæ¥å®Œæˆã€‚</p>\n<p>ç³»ç»Ÿä¸­çš„æ‰€æœ‰taskï¼Œåœ¨&#x2F;proc&#x2F;pidç›®å½•ä¸‹éƒ½æœ‰ä¸€ä¸ªåä¸ºcgroupçš„æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶å±•ç¤ºäº†è¯¥taskç›¸å¯¹cgroupfs æ ¹çš„è·¯å¾„ã€‚é€šè¿‡æŸ¥çœ‹è¿™ä¸ªæ–‡ä»¶ï¼Œå¯ä»¥äº†è§£ä¸€ä¸ªè¿›ç¨‹åœ¨cgroup hierarchyçš„ä½ç½®ã€‚ä»¥æ­¤å¾—åˆ°taskå¯ä»¥ä½¿ç”¨çš„èµ„æºä¿¡æ¯ã€‚</p>\n<p>cgroupfsä¸­ç›®å½•è¡¨ç¤ºcgroupï¼Œæ¯ä¸ªç›®å½•åœ¨åˆ›å»ºæ—¶é»˜è®¤ç”Ÿæˆå¦‚ä¸‹çš„å±æ€§æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶æè¿°äº†cgroupçš„ä¿¡æ¯ï¼š</p>\n<p>â€”â€”    tasks: æ‰€æœ‰é™„å±äºè¿™ä¸ªcgroupçš„è¿›ç¨‹IDåˆ—è¡¨ã€‚tasksæ–‡ä»¶ä¸­å¢åŠ è¿›ç¨‹IDï¼Œè¡¨ç¤ºå°†è¿›ç¨‹åŠ å…¥è¿™ä¸ªcgroupï¼Œè¿›ç¨‹èƒ½å¤Ÿä½¿ç”¨çš„èµ„æºå—cgroupé™åˆ¶ã€‚</p>\n<p>â€”â€”    cgroup.procs: æ‰€æœ‰é™„å±äºè¿™ä¸ªcgroupçº¿ç¨‹ç»„IDï¼Œå°†TGIDå†™å…¥è¿™ä¸ªæ–‡ä»¶åï¼ŒTGIDæ‰€åœ¨è¿›ç¨‹åŒ…å«çš„æ‰€æœ‰çº¿ç¨‹éƒ½åŠ å…¥è¿™ä¸ªcgroupï¼Œè¿™äº›çº¿ç¨‹å—cgroupé™åˆ¶ã€‚</p>\n</blockquote>\n<blockquote>\n<p>PIDï¼šè¿™æ˜¯ Linux ä¸­åœ¨å…¶å‘½åç©ºé—´ä¸­å”¯ä¸€æ ‡è¯†è¿›ç¨‹è€Œåˆ†é…ç»™å®ƒçš„ä¸€ä¸ªå·ç ï¼Œç§°åšè¿›ç¨‹IDå·ï¼Œç®€ç§°PIDã€‚åœ¨ä½¿ç”¨ fork æˆ– clone ç³»ç»Ÿè°ƒç”¨æ—¶äº§ç”Ÿçš„è¿›ç¨‹å‡ä¼šç”±å†…æ ¸åˆ†é…ä¸€ä¸ªæ–°çš„å”¯ä¸€çš„PIDå€¼ã€‚<br>TGIDï¼šåœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œå¦‚æœä»¥CLONE_THREADæ ‡å¿—æ¥è°ƒç”¨cloneå»ºç«‹çš„è¿›ç¨‹å°±æ˜¯è¯¥è¿›ç¨‹çš„ä¸€ä¸ªçº¿ç¨‹ï¼Œå®ƒä»¬å¤„äºä¸€ä¸ªçº¿ç¨‹ç»„ï¼Œè¯¥çº¿ç¨‹ç»„çš„IDå«åšTGIDã€‚å¤„äºç›¸åŒçš„çº¿ç¨‹ç»„ä¸­çš„æ‰€æœ‰è¿›ç¨‹éƒ½æœ‰ç›¸åŒçš„TGIDï¼›çº¿ç¨‹ç»„ç»„é•¿çš„TGIDä¸å…¶PIDç›¸åŒï¼›ä¸€ä¸ªè¿›ç¨‹æ²¡æœ‰ä½¿ç”¨çº¿ç¨‹ï¼Œåˆ™å…¶TGIDä¸PIDä¹Ÿç›¸åŒã€‚<br>PGIDï¼šå¦å¤–ï¼Œç‹¬ç«‹çš„è¿›ç¨‹å¯ä»¥ç»„æˆè¿›ç¨‹ç»„ï¼ˆä½¿ç”¨setpgrpç³»ç»Ÿè°ƒç”¨ï¼‰ï¼Œè¿›ç¨‹ç»„å¯ä»¥ç®€åŒ–å‘æ‰€æœ‰ç»„å†…è¿›ç¨‹å‘é€ä¿¡å·çš„æ“ä½œï¼Œä¾‹å¦‚ç”¨ç®¡é“è¿æ¥çš„è¿›ç¨‹å¤„åœ¨åŒä¸€è¿›ç¨‹ç»„å†…ã€‚è¿›ç¨‹ç»„IDå«åšPGIDï¼Œè¿›ç¨‹ç»„å†…çš„æ‰€æœ‰è¿›ç¨‹éƒ½æœ‰ç›¸åŒçš„PGIDï¼Œç­‰äºè¯¥ç»„ç»„é•¿çš„PIDã€‚<br>SIDï¼šå‡ ä¸ªè¿›ç¨‹ç»„å¯ä»¥åˆå¹¶æˆä¸€ä¸ªä¼šè¯ç»„ï¼ˆä½¿ç”¨setsidç³»ç»Ÿè°ƒç”¨ï¼‰ï¼Œå¯ä»¥ç”¨äºç»ˆç«¯ç¨‹åºè®¾è®¡ã€‚ä¼šè¯ç»„ä¸­æ‰€æœ‰è¿›ç¨‹éƒ½æœ‰ç›¸åŒçš„SIDã€‚<br>â€”â€”    notify_on_release flag: æ ‡è®°é€€å‡ºæ—¶æ˜¯å¦è¿è¡Œrelease agent</p>\n<p>â€”â€”    release_agent: åˆ¶å®šè¦è¿è¡Œçš„release agentçš„è·¯å¾„ï¼Œè¿™ä¸ªå±æ€§æ–‡ä»¶åªåœ¨cgroupçš„é¡¶å±‚ç›®å½•ä¸­å­˜åœ¨ã€‚</p>\n<p>ä»¥ä¸Šæ–‡ä»¶æ˜¯æ¯ä¸ªcgroupåŸºæœ¬çš„å±æ€§æ–‡ä»¶ï¼Œå¯¹äºä¸åŒçš„å­ç³»ç»Ÿï¼Œå¯¹åº”çš„cgroupå¯èƒ½ä¼šæœ‰å…¶å®ƒé™„åŠ çš„å±æ€§æ–‡ä»¶ï¼Œå­˜åœ¨äºå…¶å¯¹åº”çš„cgroupç›®å½•ä¹‹ä¸‹ã€‚</p>\n<p>é€šè¿‡mkdirå‘½ä»¤åˆ›å»ºcgroupï¼Œé€šè¿‡å‘ç›®å½•ä¸‹çš„æ–‡ä»¶å†™å…¥é€‚å½“çš„æ•°å€¼è®¾ç½®ä¿®æ”¹cgroupçš„å±æ€§ã€‚</p>\n<p>åµŒå¥—çš„cgroupsï¼ŒæŒ‡å®šäº†å±‚çº§ç»“æ„ï¼Œä»¥æ­¤å°†ç³»ç»Ÿèµ„æºåˆ’åˆ†æˆåµŒå¥—çš„ï¼ŒåŠ¨æ€å¯å˜çš„æ›´å°çš„èµ„æºå—ã€‚</p>\n<p>ä¸€ä¸ªè¿›ç¨‹å¯ä»¥é™„åŠ åˆ°å¤šä¸ªä¸åŒçš„cgroupä¸­ï¼Œåªè¦è¿™äº›cgroupä¸åœ¨åŒä¸€ä¸ªå±‚çº§æ ‘ä¸Šå³å¯ã€‚å› ä¸ºcgroupfsä¼šä¿è¯æ–°æŒ‚è½½çš„cgroupå…³è”çš„å±‚çº§æ ‘å…¨å±€å”¯ä¸€ã€‚å­è¿›ç¨‹åœ¨è¢«åˆ›å»ºåé»˜è®¤é™„åŠ åˆ°çˆ¶è¿›ç¨‹æ‰€åœ¨çš„cgroupï¼Œåé¢ç”¨æˆ·å¯ä»¥æ ¹æ®éœ€è¦å°†å…¶ç§»åŠ¨åˆ°åˆ«çš„cgroupã€‚</p>\n<p>å½“è¿›ç¨‹ä»ä¸€ä¸ªcgroupè¢«ç§»åŠ¨åˆ°å¦ä¸€ä¸ªcgroupã€‚è¿›ç¨‹çš„task_structä¼šè·å–ä¸€ä¸ªæ–°çš„css_setæŒ‡é’ˆï¼šå¦‚æœè¿™ä¸ªcgroupæ‰€åœ¨çš„css_setå·²ç»å­˜åœ¨å°±é‡ç”¨è¿™ä¸ªcss_setï¼Œå¦åˆ™å°±æ–°åˆ†é…ä¸€ä¸ªcss_setã€‚kernelä¼šåœ¨å…¨å±€çš„hashè¡¨ä¸­æŸ¥æ‰¾ç¡®è®¤cgroupæ‰€å±çš„css_setæ˜¯å¦å­˜åœ¨ã€‚</p>\n</blockquote>\n<h2 id=\"4-notify-on-release-æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ\"><a href=\"#4-notify-on-release-æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ\" class=\"headerlink\" title=\"4 notify_on_release æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ\"></a>4 notify_on_release æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ</h2><blockquote>\n<p>å¦‚æœcgroupä¸­ä½¿èƒ½notify_on_releaseï¼Œcgroupä¸­çš„æœ€åä¸€ä¸ªè¿›ç¨‹è¢«ç§»é™¤ï¼Œæœ€åä¸€ä¸ªå­cgroupä¹Ÿè¢«åˆ é™¤æ—¶ï¼Œcgroupä¼šä¸»åŠ¨é€šçŸ¥kernelã€‚æ¥æ”¶åˆ°æ¶ˆæ¯çš„kernelä¼šæ‰§è¡Œrelease_agentæ–‡ä»¶ä¸­æŒ‡å®šçš„ç¨‹åºã€‚notify_on_releaseé»˜è®¤æ˜¯å…³é—­çš„ï¼Œrelease_agentçš„å†…å®¹é»˜è®¤ä¸ºç©ºï¼Œå­cgroupåœ¨åˆ›å»ºæ—¶ä¼šç»§æ‰¿çˆ¶cgroupä¸­notify_on_relaseå’Œrelease_agentçš„å±æ€§ã€‚æ‰€ä»¥è¿™ä¸¤ä¸ªæ–‡ä»¶åªå­˜åœ¨äºcgroupfsçš„é¡¶å±‚ç›®å½•ä¸­ã€‚</p>\n</blockquote>\n<h2 id=\"5-clone-childrenæœ‰ä»€ä¹ˆç”¨ï¼Ÿ\"><a href=\"#5-clone-childrenæœ‰ä»€ä¹ˆç”¨ï¼Ÿ\" class=\"headerlink\" title=\"5 clone_childrenæœ‰ä»€ä¹ˆç”¨ï¼Ÿ\"></a>5 clone_childrenæœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h2><blockquote>\n<p>clone_chilrenä»…é’ˆå¯¹cpuç»‘å®šï¼ˆcpusetï¼‰ï¼Œå¦‚æœclone_childrenä½¿èƒ½ï¼Œæ–°çš„cpuset cgroupåœ¨åˆå§‹åŒ–æ—¶ä¼šç»§æ‰¿çˆ¶cgroupçš„å±æ€§ã€‚</p>\n</blockquote>\n<h2 id=\"6-cgroupæ€ä¹ˆç”¨ï¼Ÿ\"><a href=\"#6-cgroupæ€ä¹ˆç”¨ï¼Ÿ\" class=\"headerlink\" title=\"6 cgroupæ€ä¹ˆç”¨ï¼Ÿ\"></a>6 cgroupæ€ä¹ˆç”¨ï¼Ÿ</h2><blockquote>\n<p>å‡è®¾ç°åœ¨è¦å°†ä¸€ä¸ªæ–°çš„ä»»åŠ¡åŠ å…¥åˆ°cgroupï¼ŒåŠŸèƒ½æ˜¯å°†è¯¥ä»»åŠ¡çš„è¿›ç¨‹åœ¨æŒ‡å®šçš„cpuä¸Šè¿è¡Œï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨â€cpusetâ€cgroup å­ç³»ç»Ÿï¼Œæ“ä½œçš„å¤§è‡´æ­¥éª¤å¦‚ä¸‹ï¼š</p>\n<p>1ï¼‰mount -t tmpfs cgroup_root &#x2F;sys&#x2F;fs&#x2F;cgroup </p>\n<p>æŒ‚è½½cgroupæ ¹æ–‡ä»¶ç³»ç»Ÿï¼Œç±»å‹ä¸ºtmpfs</p>\n<p>2ï¼‰mkdir &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;cpuset</p>\n<p>åœ¨cgroupfsæ ¹ç›®å½•ä¸‹åˆ›å»ºå­cgroupï¼Œåä¸ºcpuset</p>\n<p>3ï¼‰mount -t cgroup -o cpuset cpuset &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;cpuset</p>\n<p>å°†åä¸ºcpusetçš„cgroupå…³è”åˆ°cpusetå­ç³»ç»Ÿ</p>\n<p>4ï¼‰åœ¨cpusetç›®å½•ä¸‹åˆ›å»ºç›®å½•ï¼Œç”Ÿæˆä¸€ä¸ªå­cgroupï¼Œå±æ€§æ–‡ä»¶ä¸­å†™å…¥ç›¸åº”å†…å®¹ï¼Œè®¾ç½®å±æ€§ã€‚</p>\n<p>5ï¼‰å¯åŠ¨éœ€è¦é™åˆ¶çš„è¿›ç¨‹ï¼ŒæŸ¥æ‰¾å…¶å¯¹åº”çš„è¿›ç¨‹IDï¼Œå°†å…¶å†™å…¥å¯¹åº”çš„taskæ–‡ä»¶ä¸­</p>\n<p>ä»¥ä¸‹æ“ä½œæ­¥éª¤æ˜¯åˆ›å»ºä¸€ä¸ªåä¸ºâ€Charlieâ€çš„cgroupï¼Œè¿™ä¸ªcgroupçš„èµ„æºåŒ…å«cpu2ï¼Œcpu3å’Œå†…å­˜èŠ‚ç‚¹1ï¼Œå°†shellè¿›ç¨‹é™„åŠ åˆ°è¿™ä¸ªcgroupã€‚</p>\n<p>mount -t tmpfs cgroup_root &#x2F;sys&#x2F;fs&#x2F;cgroup</p>\n<p>mkdir &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;cpuset</p>\n<p>mount -t cgroup cpuset -o cpuset &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;cpuset</p>\n<p>cd &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;cpuset</p>\n<p>mkdir Charlie</p>\n<p>cd Charlie</p>\n<p>echo 2-3 &gt; cpuset.cpus</p>\n<p>echo 1 &gt; cpuset.mems</p>\n<p>echo $$ &gt; tasks</p>\n<p>sh</p>\n<p>cat &#x2F;proc&#x2F;self&#x2F;cgroup</p>\n</blockquote>\n<p>è½¬ï¼š</p>\n<p> <a href=\"https://blog.csdn.net/huang987246510/article/details/80765628\">https://blog.csdn.net/huang987246510/article/details/80765628</a></p>\n"},{"title":"uboot-01-æ¦‚å¿µ","categories":["uboot"],"tags":["ubootæ¦‚å¿µ"],"date":"2024-05-15T13:59:01.000Z","_content":"\nuboot(Universal Boot Loader)\n\nuboot å®˜ç½‘ä¸º http://www.denx.de/wiki/U-Boot/\n\nLinux ç³»ç»Ÿè¦å¯åŠ¨å°±å¿…é¡»éœ€è¦ä¸€ä¸ª bootloader ç¨‹åºï¼Œä¹Ÿå°±è¯´èŠ¯ç‰‡ä¸Šç”µä»¥åå…ˆè¿è¡Œä¸€æ®µ\nbootloader ç¨‹åºã€‚è¿™æ®µ bootloader ç¨‹åºä¼šå…ˆåˆå§‹åŒ–DDR ç­‰å¤–è®¾ï¼Œç„¶åå°† Linux å†…æ ¸ä» flash(NANDï¼Œ\nNOR FLASHï¼ŒSDï¼ŒMMC ç­‰)æ‹·è´åˆ° DDR ä¸­ï¼Œæœ€åå¯åŠ¨ Linux å†…æ ¸\n\nubootä¸»è¦ç›®çš„æ˜¯ä¸ºç³»ç»Ÿå¯åŠ¨åšå‡†å¤‡\n\nubootæ˜¯ä¸€ç§é€šç”¨çš„bootloaderï¼Œæ”¯æŒå¤šç§æ¶æ„\n\n\n\n\n\n\n\n# ubootå¸¸è§å‘½ä»¤\n\n\n\n\n\n","source":"back_posts/uboot-01-æ¦‚å¿µ.md","raw":"---\ntitle: uboot-01-æ¦‚å¿µ\ncategories:\n  - uboot\ntags:\n  - ubootæ¦‚å¿µ\ndate: 2024-05-15 21:59:01\n\n---\n\nuboot(Universal Boot Loader)\n\nuboot å®˜ç½‘ä¸º http://www.denx.de/wiki/U-Boot/\n\nLinux ç³»ç»Ÿè¦å¯åŠ¨å°±å¿…é¡»éœ€è¦ä¸€ä¸ª bootloader ç¨‹åºï¼Œä¹Ÿå°±è¯´èŠ¯ç‰‡ä¸Šç”µä»¥åå…ˆè¿è¡Œä¸€æ®µ\nbootloader ç¨‹åºã€‚è¿™æ®µ bootloader ç¨‹åºä¼šå…ˆåˆå§‹åŒ–DDR ç­‰å¤–è®¾ï¼Œç„¶åå°† Linux å†…æ ¸ä» flash(NANDï¼Œ\nNOR FLASHï¼ŒSDï¼ŒMMC ç­‰)æ‹·è´åˆ° DDR ä¸­ï¼Œæœ€åå¯åŠ¨ Linux å†…æ ¸\n\nubootä¸»è¦ç›®çš„æ˜¯ä¸ºç³»ç»Ÿå¯åŠ¨åšå‡†å¤‡\n\nubootæ˜¯ä¸€ç§é€šç”¨çš„bootloaderï¼Œæ”¯æŒå¤šç§æ¶æ„\n\n\n\n\n\n\n\n# ubootå¸¸è§å‘½ä»¤\n\n\n\n\n\n","updated":"2024-05-16T07:35:43.760Z","path":"back_posts/uboot-01-æ¦‚å¿µ.html","comments":1,"layout":"page","_id":"clw95434p0002auw01duxgfqw","content":"<p>uboot(Universal Boot Loader)</p>\n<p>uboot å®˜ç½‘ä¸º <a href=\"http://www.denx.de/wiki/U-Boot/\">http://www.denx.de/wiki/U-Boot/</a></p>\n<p>Linux ç³»ç»Ÿè¦å¯åŠ¨å°±å¿…é¡»éœ€è¦ä¸€ä¸ª bootloader ç¨‹åºï¼Œä¹Ÿå°±è¯´èŠ¯ç‰‡ä¸Šç”µä»¥åå…ˆè¿è¡Œä¸€æ®µ<br>bootloader ç¨‹åºã€‚è¿™æ®µ bootloader ç¨‹åºä¼šå…ˆåˆå§‹åŒ–DDR ç­‰å¤–è®¾ï¼Œç„¶åå°† Linux å†…æ ¸ä» flash(NANDï¼Œ<br>NOR FLASHï¼ŒSDï¼ŒMMC ç­‰)æ‹·è´åˆ° DDR ä¸­ï¼Œæœ€åå¯åŠ¨ Linux å†…æ ¸</p>\n<p>ubootä¸»è¦ç›®çš„æ˜¯ä¸ºç³»ç»Ÿå¯åŠ¨åšå‡†å¤‡</p>\n<p>ubootæ˜¯ä¸€ç§é€šç”¨çš„bootloaderï¼Œæ”¯æŒå¤šç§æ¶æ„</p>\n<h1 id=\"ubootå¸¸è§å‘½ä»¤\"><a href=\"#ubootå¸¸è§å‘½ä»¤\" class=\"headerlink\" title=\"ubootå¸¸è§å‘½ä»¤\"></a>ubootå¸¸è§å‘½ä»¤</h1>","site":{"data":{}},"excerpt":"","more":"<p>uboot(Universal Boot Loader)</p>\n<p>uboot å®˜ç½‘ä¸º <a href=\"http://www.denx.de/wiki/U-Boot/\">http://www.denx.de/wiki/U-Boot/</a></p>\n<p>Linux ç³»ç»Ÿè¦å¯åŠ¨å°±å¿…é¡»éœ€è¦ä¸€ä¸ª bootloader ç¨‹åºï¼Œä¹Ÿå°±è¯´èŠ¯ç‰‡ä¸Šç”µä»¥åå…ˆè¿è¡Œä¸€æ®µ<br>bootloader ç¨‹åºã€‚è¿™æ®µ bootloader ç¨‹åºä¼šå…ˆåˆå§‹åŒ–DDR ç­‰å¤–è®¾ï¼Œç„¶åå°† Linux å†…æ ¸ä» flash(NANDï¼Œ<br>NOR FLASHï¼ŒSDï¼ŒMMC ç­‰)æ‹·è´åˆ° DDR ä¸­ï¼Œæœ€åå¯åŠ¨ Linux å†…æ ¸</p>\n<p>ubootä¸»è¦ç›®çš„æ˜¯ä¸ºç³»ç»Ÿå¯åŠ¨åšå‡†å¤‡</p>\n<p>ubootæ˜¯ä¸€ç§é€šç”¨çš„bootloaderï¼Œæ”¯æŒå¤šç§æ¶æ„</p>\n<h1 id=\"ubootå¸¸è§å‘½ä»¤\"><a href=\"#ubootå¸¸è§å‘½ä»¤\" class=\"headerlink\" title=\"ubootå¸¸è§å‘½ä»¤\"></a>ubootå¸¸è§å‘½ä»¤</h1>"},{"title":"pinctrl","categories":["kernel"],"tags":["pinctrl"],"date":"2024-05-16T05:33:03.000Z","_content":"\n\n\n\n\n\n\n# \n\næŸ¥çœ‹å…·ä½“è®¾å¤‡æ ‘ä¸­çš„å®å®šä¹‰\n\ninclude/dt-bindings/gpio/gpio.h\n\ninclude/dt-bindings/pinctrl/rockchip.h\n\ndt-bindings/clock/rk3588-cru.h\n\n\n\næŸ¥çœ‹ç‰©ç†å•ç³»ç»Ÿä¸­çš„pinctrlé…ç½®ï¼Œè·å–ç‰©ç†å¤–è®¾çœŸå®çš„device name\n\n  cat /sys/kernel/debug/pinctrl/pinctrl-maps\n","source":"back_posts/pinctrl.md","raw":"---\ntitle: pinctrl\ncategories:\n  - kernel\ntags:\n  - pinctrl\ndate: 2024-05-16 13:33:03\n---\n\n\n\n\n\n\n\n# \n\næŸ¥çœ‹å…·ä½“è®¾å¤‡æ ‘ä¸­çš„å®å®šä¹‰\n\ninclude/dt-bindings/gpio/gpio.h\n\ninclude/dt-bindings/pinctrl/rockchip.h\n\ndt-bindings/clock/rk3588-cru.h\n\n\n\næŸ¥çœ‹ç‰©ç†å•ç³»ç»Ÿä¸­çš„pinctrlé…ç½®ï¼Œè·å–ç‰©ç†å¤–è®¾çœŸå®çš„device name\n\n  cat /sys/kernel/debug/pinctrl/pinctrl-maps\n","updated":"2024-05-16T07:35:43.759Z","path":"back_posts/pinctrl.html","comments":1,"layout":"page","_id":"clw95434s0004auw02e62a41x","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>æŸ¥çœ‹å…·ä½“è®¾å¤‡æ ‘ä¸­çš„å®å®šä¹‰</p>\n<p>include&#x2F;dt-bindings&#x2F;gpio&#x2F;gpio.h</p>\n<p>include&#x2F;dt-bindings&#x2F;pinctrl&#x2F;rockchip.h</p>\n<p>dt-bindings&#x2F;clock&#x2F;rk3588-cru.h</p>\n<p>æŸ¥çœ‹ç‰©ç†å•ç³»ç»Ÿä¸­çš„pinctrlé…ç½®ï¼Œè·å–ç‰©ç†å¤–è®¾çœŸå®çš„device name</p>\n<p>  cat &#x2F;sys&#x2F;kernel&#x2F;debug&#x2F;pinctrl&#x2F;pinctrl-maps</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>æŸ¥çœ‹å…·ä½“è®¾å¤‡æ ‘ä¸­çš„å®å®šä¹‰</p>\n<p>include&#x2F;dt-bindings&#x2F;gpio&#x2F;gpio.h</p>\n<p>include&#x2F;dt-bindings&#x2F;pinctrl&#x2F;rockchip.h</p>\n<p>dt-bindings&#x2F;clock&#x2F;rk3588-cru.h</p>\n<p>æŸ¥çœ‹ç‰©ç†å•ç³»ç»Ÿä¸­çš„pinctrlé…ç½®ï¼Œè·å–ç‰©ç†å¤–è®¾çœŸå®çš„device name</p>\n<p>  cat &#x2F;sys&#x2F;kernel&#x2F;debug&#x2F;pinctrl&#x2F;pinctrl-maps</p>\n"},{"title":"PHYèŠ¯ç‰‡","categories":["test"],"tags":["PHYèŠ¯ç‰‡"],"date":"2024-05-16T10:58:06.000Z","_content":"\n\n\n# PHYï¼ˆphysical Layerï¼ŒPHYï¼‰\n\n## ä»€ä¹ˆæ˜¯PHYï¼Ÿ\n\nç‰©ç†å±‚èŠ¯ç‰‡ç§°ä¸ºPHYã€æ•°æ®é“¾è·¯å±‚èŠ¯ç‰‡ç§°ä¸ºMAC\n\nå¯ä»¥çœ‹åˆ°PHYçš„æ•°æ®æ˜¯[RJ45](https://so.csdn.net/so/search?q=RJ45&spm=1001.2101.3001.7020)ç½‘ç»œæ¥å£ï¼ˆç½‘çº¿å£ï¼‰ç©¿è¿‡äº†çš„å·®åˆ†ä¿¡å·ï¼Œè€ŒPHYä½œç”¨å°±æ˜¯å°†å·®åˆ†ä¿¡å·è½¬ä¸ºæ•°å­—ä¿¡å·ï¼Œè¿™å—å†…å®¹ä¸ç”¨æ·±ç©¶ï¼Œåˆ¶é€ å•†éƒ½è®¾è®¡å¥½äº†ã€‚\n\né‚£æˆ‘ä»¬å¹²ä»€ä¹ˆå‘¢ï¼Ÿï¼ˆä¸»è¦æ˜¯å¯¹phyèŠ¯ç‰‡è¿›è¡Œæ¨¡å¼é€‰æ‹©ï¼Œæ¯”å¦‚å·¥ä½œé€Ÿç‡ï¼Œå·¥ä½œæ¨¡å¼ï¼‰\n\n## ä»€ä¹ˆæ˜¯RJ45æ¥å£ï¼Ÿ\n\nRJ45æ¥å£é€šå¸¸ç”¨äºæ•°æ®ä¼ è¾“ï¼Œæœ€å¸¸è§çš„åº”ç”¨ä¸ºç½‘å¡æ¥å£ã€‚RJ-45ç«¯å£æ˜¯æˆ‘ä»¬æœ€å¸¸è§çš„ç«¯å£ä¹‹ä¸€ï¼Œæ˜¯æ¯”è¾ƒå¸¸è§çš„[åŒç»çº¿](https://www.zhihu.com/search?q=åŒç»çº¿&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra={\"sourceType\"%3A\"answer\"%2C\"sourceId\"%3A3477234795})ä»¥å¤ªç½‘ç«¯å£ï¼Œå› ä¸ºåœ¨å¿«é€Ÿä»¥å¤ªç½‘ä¸­ä¹Ÿä¸»è¦é‡‡ç”¨åŒç»çº¿ä½œä¸ºä¼ è¾“ä»‹è´¨ã€‚\n\nRJ45å‹ç½‘çº¿æ’å¤´åˆç§°æ°´æ™¶å¤´ï¼Œå…±ç”±å…«èŠ¯åšæˆï¼Œå¹¿æ³›åº”ç”¨äºå±€åŸŸç½‘å’ŒADSLå®½å¸¦ä¸Šç½‘ç”¨æˆ·çš„ç½‘ç»œè®¾å¤‡é—´ç½‘çº¿ï¼ˆç§°ä½œäº”ç±»çº¿æˆ–åŒç»çº¿ï¼‰çš„è¿æ¥ã€‚\n\nRJ45æ¥å¤´æ ¹æ®çº¿çš„æ’åºä¸åŒä¸»è¦åˆ†ä¸¤ç§ï¼Œä¸€ç§æ˜¯æ©™ç™½ã€æ©™ã€ç»¿ç™½ã€è“ã€è“ç™½ã€ç»¿ã€æ£•ç™½ã€æ£•ï¼›å¦ä¸€ç§æ˜¯ç»¿ç™½ã€ç»¿ã€æ©™ç™½ã€è“ã€è“ç™½ã€æ©™ã€æ£•ç™½ã€æ£•ï¼›å› æ­¤ä½¿ç”¨RJ45æ¥å¤´çš„çº¿ä¹Ÿæœ‰ä¸¤ç§å³ï¼šç›´é€šçº¿ã€äº¤å‰çº¿ã€‚åˆ†åˆ«ç§°ä½œ[T568Açº¿åº](https://www.zhihu.com/search?q=T568Açº¿åº&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra={\"sourceType\"%3A\"answer\"%2C\"sourceId\"%3A3477234795})å’ŒT568Bçº¿åºã€‚\n\nRJ45æ’åº§è¿æ¥å™¨æ¥å£å†…éƒ¨æ˜¯é‡‘å±ï¼Œæ³¨æ„ä¸èƒ½å—æ½®æˆ–è€…æ¥è§¦åˆ°æ°´ï¼Œå¦åˆ™ä¼šé€ æˆçŸ­è·¯ç°è±¡ã€‚\n\n## ä¸ºä»€ä¹ˆè¦ç†Ÿæ‚‰RJ45ç½‘å£\n\nä¸Šé¢è¯´åˆ°é’ˆå¯¹phyèŠ¯ç‰‡æˆ‘ä»¬åªè¦è¿›è¡Œæ¨¡å¼é€‰æ‹©ï¼ˆä¸‹æ–‡ä¼šä»‹ç»ä½¿ç”¨[mdio](https://so.csdn.net/so/search?q=mdio&spm=1001.2101.3001.7020)æ¥å£ï¼Œé€šè¿‡å¯„å­˜å™¨æ§åˆ¶ï¼‰\n\né‚£æ¨¡å¼é€‰æ‹©åï¼Œå¦‚ä½•æŸ¥çœ‹æ˜¯å¦æœ‰æ•ˆå‘¢ï¼Ÿæœ€ç®€å•ç›´æ¥çš„å°±æ˜¯é€šè¿‡RJ45ç½‘å£çš„æŒ‡ç¤ºç¯æŸ¥çœ‹\n\n![img](../imgs/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_18,color_FFFFFF,t_70,g_se,x_16-17158590663256.png)\n\nRJ45 åº§å­ä¸Šä¸€èˆ¬æœ‰ä¸¤ä¸ªç¯ï¼Œä¸€ä¸ªé»„è‰²(æ©™è‰²)ï¼Œä¸€ä¸ªç»¿è‰²ï¼Œ**ç»¿è‰²äº®çš„è¯è¡¨ç¤ºç½‘ç»œè¿æ¥æ­£å¸¸ï¼Œé»„è‰²é—ªçƒçš„è¯è¯´æ˜å½“å‰æ­£åœ¨è¿›è¡Œç½‘ç»œé€šä¿¡**ï¼Œ**é»„ç¯é—ªåŠ¨é¢‘ç‡å¿«è¡¨ç¤ºç½‘é€Ÿ**å¥½ï¼Œè¿™ä¸¤ä¸ªç¯ç”± PHY èŠ¯ç‰‡æ§åˆ¶ã€‚\n\n## ç½‘ç»œä¸ƒå±‚åè®®\n\n![img](../img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_16,color_FFFFFF,t_70,g_se,x_16.png)\n\n## ä¸¤ä¸ªæ¨¡å—è¿›è¡Œé€šä¿¡\n\nä¸‹å›¾æ˜¯ä¸¤ä¸ªä¸»æ§ç›´æ¥çš„é€šä¿¡ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„ç”µè„‘ å’Œ è·¯ç”±å™¨ ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰ä¸­é—´çš„ä»‹è´¨è¿˜èƒ½è¿æ¥ç½‘ç»œå—ï¼Ÿç­”æ¡ˆæ˜¯å¯ä»¥çš„\n\nå¦‚æœphyèŠ¯ç‰‡æ²¡æœ‰ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥é€šè¿‡ä¸¤ä¸ªmacè¿æ¥è¿›è¡Œé€šä¿¡ï¼Œä¹‹æ‰€ä»¥éœ€è¦mac ã€phyã€å˜å‹å™¨çš„ç›®çš„æ˜¯ä¸ºäº†è½¬æ¢æ•°æ®ç±»å‹é€‚é…æ‰€ä»¥çš„ç½‘çº¿ï¼Œä½†æ˜¯åœ¨ä¸€äº›ç”µè·¯ä¸Šï¼Œæ²¡å¿…è¦åŠ è¿™ä¹ˆå¤šä¸œè¥¿\n\næ¯”å¦‚æ­è½½ Linuxç³»ç»Ÿçš„armèŠ¯ç‰‡æƒ³è¦ç½‘ç»œï¼Œå¯ä»¥ç›´æ¥é€šè¿‡macå’Œç½‘å¡èŠ¯ç‰‡è¿æ¥è·å–ï¼Œè¿™æ—¶å€™å°±éœ€è¦é€šè¿‡RGMIIæ¥å£æˆ–è€…MIIæ¥å£ å’Œ MDIO è¿æ¥ç½‘å¡èŠ¯ç‰‡ã€‚\n\nï¼ˆç½‘å¡èŠ¯ç‰‡å†…ç½®ä¹Ÿæ˜¯mac+phyï¼Œæœ‰çš„åªæœ‰mac å±‚è¿™ä¸ªè¦çœ‹å…·ä½“çš„æ‰‹å†Œï¼‰\n\n![img](../img/84b0b5e31bb246c0a970ace7c71a3f82.png)\n\n## ä»€ä¹ˆæ˜¯MDIOåè®®\n\nmidoåè®®å³SMIåè®®\n\nSMIåè®®ä¹Ÿæ˜¯ä¸€ç§é€šä¿¡åè®®ç±»ä¼¼ä¸I2Cåè®®ä½†æ˜¯é€šä¿¡æ–¹å¼ä¸ä¸€æ ·\n\nSMIåŒ…å«ä¸¤æ ¹ä¿¡å·çº¿ï¼Œä¸€ä¸ªMDCæ—¶é’Ÿçº¿ï¼Œä¸€ä¸ªMDIOåŒå‘ä¼ è¾“çš„æ•°æ®çº¿ï¼Œ\n\nå¦‚å›¾ä¸ºSMIåº”ç”¨æ¡†å›¾ã€‚STAè®¾å¤‡é€šè¿‡MDIOæ¥å£ä¸PHYé€šä¿¡ã€‚STAï¼ˆStaTIon Managementï¼‰ä¸ºä¸»æ§è®¾å¤‡ï¼Œæ¯”å¦‚MCUã€MACã€ONUç­‰ã€‚PHYä¸ºä»è®¾å¤‡ã€‚ä¸€ä¸ªSTAæœ€å¤šç®¡ç†32ä¸ªPHYã€‚MDCä¿¡å·ç”±STAæ§åˆ¶ï¼ŒMDIOä¿¡å·æ ¹æ®é€šä¿¡æ–¹å¼çš„ä¸åŒå¯ä»¥ç”±STAæˆ–è€…PHYæ¥ç®¡æ§åˆ¶ã€‚å¦‚å›¾é€šå¸¸MDIOä¼šæ¥ä¸€ä¸ªç”µé˜»ä¸Šæ‹‰è‡³æ¥å£ç”µæºã€‚\n\n![img](../img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_16,color_FFFFFF,t_70,g_se,x_16.png)\n\n\n\n## MDIOçš„ä½œç”¨ \n\nä»ä¸Šé¢çš„è¿æ¥å›¾å¯ä»¥çœ‹åˆ°MDIOæ˜¯ç”¨æ¥è¿æ¥ä¸»è®¾å¤‡å’Œå¤šä¸ªPHYè®¾å¤‡ï¼Œå¹¶ä¸”é€šè¿‡MDIOæ¥ä¼ è¾“æ•°æ®\n\né‚£ä¹ˆä¼ è¾“çš„æ˜¯æ•°æ®æ˜¯å“ªäº›å‘¢ï¼Ÿä¸»è¦æ˜¯ä¼ è¾“é“¾æ¥çŠ¶æ€ã€ä¼ è¾“é€Ÿåº¦ä¸é€‰æ‹©ã€æ–­ç”µã€ä½åŠŸç‡[ä¼‘çœ çŠ¶æ€](https://baike.baidu.com/item/ä¼‘çœ çŠ¶æ€?fromModule=lemma_inlink)ã€TX/RXæ¨¡å¼é€‰æ‹©ã€[è‡ªåŠ¨åå•†](https://baike.baidu.com/item/è‡ªåŠ¨åå•†/7765053?fromModule=lemma_inlink)æ§åˆ¶ã€ç¯å›æ¨¡å¼æ§åˆ¶ç­‰ã€‚\n\n\n\n### MDIOæ²¡é‚£ä¹ˆé‡è¦\n\nMDIOåœ¨ä¸Šé¢è¯´åˆ°çš„ä¸¤ä¸ªæ¨¡å—é€šä¿¡ï¼Œæˆ‘æåˆ°äº† armèŠ¯ç‰‡å’Œç½‘å¡èŠ¯ç‰‡ç›´æ¥éœ€è¦ï¼Œé‚£ä¹ˆè¿™ä¸ªçœŸçš„æœ‰å¿…è¦å—ï¼Ÿå…¶å®æ²¡å¿…è¦è¿æ¥ï¼ï¼ï¼\n\næ¢ä¸ªè¯è¯´ ä¸è¿æ¥ä¹Ÿå¯ä»¥ä½¿å¾—ç½‘ç»œç•…é€šï¼Œå› ä¸ºç½‘ç»œçš„æ•°æ®ä¼ è¾“æ—¶é RGMIIä¸æ˜¯é MDIOï¼ŒMDIOçš„ä½œç”¨ä»…ä»…åªæ˜¯ç”¨æ¥æŸ¥çœ‹ä¸€äº›çŠ¶æ€å’ŒåŠŸèƒ½ï¼Œè¿˜æœ‰ç®€å•çš„æ§åˆ¶ï¼Œè€Œè¿™äº›ç®€å•çš„æ§åˆ¶æ˜¯å®Œå…¨å¯ä»¥æœ‰ç½‘å¡èŠ¯ç‰‡å†…ç½®å»å†™æ­»ï¼Œarmå±‚åªè¦å’Œç½‘å¡çš„å†™çš„ä¸€ç›´å°±å¯ä»¥é€šè®¯ã€‚\n\nä½†æ˜¯ä¸ºä»€ä¹ˆå¾ˆå¤šæ—¶å€™éœ€è¦é€šè¿‡mdioæ¥è¿›è¡Œè¯»å†™æ§åˆ¶ï¼Œè¿™ä¸ªåªæ˜¯åœ¨ç½‘ç»œé€šè®¯æ­£å¸¸åçš„å‡çº§ä¼˜åŒ–ï¼Œç”¨æ¥æ–¹ä¾¿æŸ¥çœ‹çŠ¶æ€ï¼Œå°±åƒå†™äº†ä¸ªå‰ç«¯ç½‘é¡µæ¥çœ‹åå°æ•°æ®ã€‚\n\nå¦‚æœmidoæ²¡æœ‰è¯»é€šï¼Œæˆ–è€…è¯»å–çš„æ•°æ®æ˜¯0xfffffï¼Œé‚£ä¹ˆä¸ä¸€å®šæ˜¯mdioçš„é—®é¢˜ï¼Œå¾ˆå¤šæ—¶å€™æ˜¯ç½‘å¡æœ¬èº«æ²¡æœ‰å¯åŠ¨ï¼\n\n\n## MDIOè¯»å†™æ—¶åº\n\n![img](../img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_18,color_FFFFFF,t_70,g_se,x_16.png)\n\nPreambleï¼š32bitsçš„å‰å¯¼ç \n\nStartï¼š2bitçš„å¼€å§‹ä½ã€‚\n\nOP Codeï¼š2bitsçš„æ“ä½œç ï¼Œ10è¡¨ç¤ºè¯»ï¼Œ01è¡¨ç¤ºå†™ã€‚\n\nPHYADï¼š5bitsçš„PHYåœ°å€ã€‚\n\nREGADï¼š5bitsçš„å¯„å­˜å™¨åœ°å€ï¼Œå³è¦è¯»æˆ–å†™çš„å¯„å­˜å™¨ã€‚\n\nTurn Aroundï¼š2bitsçš„TAï¼Œåœ¨è¯»å‘½ä»¤ä¸­ï¼ŒMDIOåœ¨æ­¤æ—¶ç”±MACé©±åŠ¨æ”¹ä¸ºPHYé©±åŠ¨ï¼Œå¹¶ç­‰å¾…ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸå‡†å¤‡å‘é€æ•°æ®ã€‚åœ¨å†™å‘½ä»¤ä¸­ï¼Œä¸éœ€è¦MDIOæ–¹å‘å‘ç”Ÿå˜åŒ–ï¼Œåˆ™åªæ˜¯ç­‰å¾…ä¸¤ä¸ªæ—¶é’Ÿå‘¨æœŸå‡†å¤‡å†™å…¥æ•°æ®ã€‚\n\nDataï¼š16bitsæ•°æ®ï¼Œåœ¨è¯»å‘½ä»¤ä¸­ï¼ŒPHYèŠ¯ç‰‡å°†è¯»åˆ°çš„å¯¹åº”PHYADçš„REGADå¯„å­˜å™¨çš„æ•°æ®å†™åˆ°Dataä¸­ï¼Œåœ¨å†™å‘½ä»¤ä¸­ï¼ŒMACå°†è¦å†™å…¥å¯¹åº”PHYADçš„REGADå¯„å­˜å™¨çš„å€¼å†™å…¥Dataä¸­ã€‚\n\nIdleï¼šç©ºé—²çŠ¶æ€ï¼Œæ­¤æ—¶MDIOæ— æºé©±åŠ¨ï¼Œå¤„é«˜é˜»çŠ¶æ€ï¼Œä½†ä¸€èˆ¬ç”¨ä¸Šæ‹‰ç”µé˜»ä½¿å…¶å¤„åœ¨é«˜ç”µå¹³ï¼Œä¸Šæ‹‰ç”µé˜»ä¸€èˆ¬ä¸º1.5Kã€‚\nä¸ºä»€ä¹ˆè¯´è¯»å–çš„phyæœ€å¤š32ä¸ª\nå› ä¸ºmdioä¸­è¯»å–çš„phyåªæä¾›5bitçš„å­—èŠ‚å³æœ€é«˜11111 è½¬æˆåè¿›åˆ¶å°±æ˜¯31å³0-31å°±æ˜¯32ä¸ªï¼Œä½†è¿™æ˜¯ä»è¯»å–çš„æ–¹å¼åˆ¤æ–­çš„ï¼Œè€Œmdioè¯»å–æ˜¯ä¾ç…§phyèŠ¯ç‰‡æœ¬èº«åœ°å€ç©ºé—´å°±5ä¸º\n\n## ä¸ºä»€ä¹ˆè¯´regåœ°å€æœ€å¤š32ä¸ª\n\nåŒæ ·mdioä¸­è¯»å–çš„regåªæä¾›5bitçš„å­—èŠ‚å³æœ€é«˜11111 è½¬æˆåè¿›åˆ¶å°±æ˜¯31å³0-31å°±æ˜¯32ä¸ª\n\n PHY èŠ¯ç‰‡å¯„å­˜å™¨åœ°å€ç©ºé—´ä¸º 5 ä½ï¼Œåœ°å€ 0-31 å…± 32 ä¸ªå¯„å­˜å™¨ï¼Œ IEEE å®šä¹‰äº† 0-15 è¿™ 16 ä¸ªå¯„å­˜å™¨çš„åŠŸèƒ½ï¼Œ 16~31 è¿™ 16 ä¸ªå¯„å­˜å™¨ç”±å‚å•†è‡ªè¡Œå®ç°ã€‚ ä¹Ÿå°±æ˜¯è¯´ä¸ç®¡ä½ ç”¨çš„å“ªä¸ªå‚å®¶çš„ PHY èŠ¯ç‰‡ï¼Œå…¶ä¸­ 0~15 è¿™ 16 ä¸ªå¯„å­˜å™¨æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚ ä»…é è¿™ 16 ä¸ªå¯„å­˜å™¨æ˜¯å®Œå…¨å¯ä»¥é©±åŠ¨èµ· PHY èŠ¯ç‰‡çš„ï¼Œè‡³å°‘èƒ½ä¿è¯åŸºæœ¬çš„ç½‘ç»œæ•°æ®é€šä¿¡ã€‚\n\n \n\n\n\n[PHYèŠ¯ç‰‡å¿«é€Ÿæ·±åº¦ç†è§£ï¼ˆæŒç»­æ›´æ–°ä¸­â€¦â€¦ï¼‰-CSDNåšå®¢](https://blog.csdn.net/qq_40715266/article/details/124095801)\n\n\n\n[PHYï¼ˆPhysical Layerï¼ŒPHYï¼‰ - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/148538791)\n","source":"back_posts/PHYèŠ¯ç‰‡.md","raw":"---\ntitle: PHYèŠ¯ç‰‡\ncategories:\n  - test\ntags:\n  - PHYèŠ¯ç‰‡\ndate: 2024-05-16 18:58:06\n---\n\n\n\n# PHYï¼ˆphysical Layerï¼ŒPHYï¼‰\n\n## ä»€ä¹ˆæ˜¯PHYï¼Ÿ\n\nç‰©ç†å±‚èŠ¯ç‰‡ç§°ä¸ºPHYã€æ•°æ®é“¾è·¯å±‚èŠ¯ç‰‡ç§°ä¸ºMAC\n\nå¯ä»¥çœ‹åˆ°PHYçš„æ•°æ®æ˜¯[RJ45](https://so.csdn.net/so/search?q=RJ45&spm=1001.2101.3001.7020)ç½‘ç»œæ¥å£ï¼ˆç½‘çº¿å£ï¼‰ç©¿è¿‡äº†çš„å·®åˆ†ä¿¡å·ï¼Œè€ŒPHYä½œç”¨å°±æ˜¯å°†å·®åˆ†ä¿¡å·è½¬ä¸ºæ•°å­—ä¿¡å·ï¼Œè¿™å—å†…å®¹ä¸ç”¨æ·±ç©¶ï¼Œåˆ¶é€ å•†éƒ½è®¾è®¡å¥½äº†ã€‚\n\né‚£æˆ‘ä»¬å¹²ä»€ä¹ˆå‘¢ï¼Ÿï¼ˆä¸»è¦æ˜¯å¯¹phyèŠ¯ç‰‡è¿›è¡Œæ¨¡å¼é€‰æ‹©ï¼Œæ¯”å¦‚å·¥ä½œé€Ÿç‡ï¼Œå·¥ä½œæ¨¡å¼ï¼‰\n\n## ä»€ä¹ˆæ˜¯RJ45æ¥å£ï¼Ÿ\n\nRJ45æ¥å£é€šå¸¸ç”¨äºæ•°æ®ä¼ è¾“ï¼Œæœ€å¸¸è§çš„åº”ç”¨ä¸ºç½‘å¡æ¥å£ã€‚RJ-45ç«¯å£æ˜¯æˆ‘ä»¬æœ€å¸¸è§çš„ç«¯å£ä¹‹ä¸€ï¼Œæ˜¯æ¯”è¾ƒå¸¸è§çš„[åŒç»çº¿](https://www.zhihu.com/search?q=åŒç»çº¿&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra={\"sourceType\"%3A\"answer\"%2C\"sourceId\"%3A3477234795})ä»¥å¤ªç½‘ç«¯å£ï¼Œå› ä¸ºåœ¨å¿«é€Ÿä»¥å¤ªç½‘ä¸­ä¹Ÿä¸»è¦é‡‡ç”¨åŒç»çº¿ä½œä¸ºä¼ è¾“ä»‹è´¨ã€‚\n\nRJ45å‹ç½‘çº¿æ’å¤´åˆç§°æ°´æ™¶å¤´ï¼Œå…±ç”±å…«èŠ¯åšæˆï¼Œå¹¿æ³›åº”ç”¨äºå±€åŸŸç½‘å’ŒADSLå®½å¸¦ä¸Šç½‘ç”¨æˆ·çš„ç½‘ç»œè®¾å¤‡é—´ç½‘çº¿ï¼ˆç§°ä½œäº”ç±»çº¿æˆ–åŒç»çº¿ï¼‰çš„è¿æ¥ã€‚\n\nRJ45æ¥å¤´æ ¹æ®çº¿çš„æ’åºä¸åŒä¸»è¦åˆ†ä¸¤ç§ï¼Œä¸€ç§æ˜¯æ©™ç™½ã€æ©™ã€ç»¿ç™½ã€è“ã€è“ç™½ã€ç»¿ã€æ£•ç™½ã€æ£•ï¼›å¦ä¸€ç§æ˜¯ç»¿ç™½ã€ç»¿ã€æ©™ç™½ã€è“ã€è“ç™½ã€æ©™ã€æ£•ç™½ã€æ£•ï¼›å› æ­¤ä½¿ç”¨RJ45æ¥å¤´çš„çº¿ä¹Ÿæœ‰ä¸¤ç§å³ï¼šç›´é€šçº¿ã€äº¤å‰çº¿ã€‚åˆ†åˆ«ç§°ä½œ[T568Açº¿åº](https://www.zhihu.com/search?q=T568Açº¿åº&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra={\"sourceType\"%3A\"answer\"%2C\"sourceId\"%3A3477234795})å’ŒT568Bçº¿åºã€‚\n\nRJ45æ’åº§è¿æ¥å™¨æ¥å£å†…éƒ¨æ˜¯é‡‘å±ï¼Œæ³¨æ„ä¸èƒ½å—æ½®æˆ–è€…æ¥è§¦åˆ°æ°´ï¼Œå¦åˆ™ä¼šé€ æˆçŸ­è·¯ç°è±¡ã€‚\n\n## ä¸ºä»€ä¹ˆè¦ç†Ÿæ‚‰RJ45ç½‘å£\n\nä¸Šé¢è¯´åˆ°é’ˆå¯¹phyèŠ¯ç‰‡æˆ‘ä»¬åªè¦è¿›è¡Œæ¨¡å¼é€‰æ‹©ï¼ˆä¸‹æ–‡ä¼šä»‹ç»ä½¿ç”¨[mdio](https://so.csdn.net/so/search?q=mdio&spm=1001.2101.3001.7020)æ¥å£ï¼Œé€šè¿‡å¯„å­˜å™¨æ§åˆ¶ï¼‰\n\né‚£æ¨¡å¼é€‰æ‹©åï¼Œå¦‚ä½•æŸ¥çœ‹æ˜¯å¦æœ‰æ•ˆå‘¢ï¼Ÿæœ€ç®€å•ç›´æ¥çš„å°±æ˜¯é€šè¿‡RJ45ç½‘å£çš„æŒ‡ç¤ºç¯æŸ¥çœ‹\n\n![img](../imgs/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_18,color_FFFFFF,t_70,g_se,x_16-17158590663256.png)\n\nRJ45 åº§å­ä¸Šä¸€èˆ¬æœ‰ä¸¤ä¸ªç¯ï¼Œä¸€ä¸ªé»„è‰²(æ©™è‰²)ï¼Œä¸€ä¸ªç»¿è‰²ï¼Œ**ç»¿è‰²äº®çš„è¯è¡¨ç¤ºç½‘ç»œè¿æ¥æ­£å¸¸ï¼Œé»„è‰²é—ªçƒçš„è¯è¯´æ˜å½“å‰æ­£åœ¨è¿›è¡Œç½‘ç»œé€šä¿¡**ï¼Œ**é»„ç¯é—ªåŠ¨é¢‘ç‡å¿«è¡¨ç¤ºç½‘é€Ÿ**å¥½ï¼Œè¿™ä¸¤ä¸ªç¯ç”± PHY èŠ¯ç‰‡æ§åˆ¶ã€‚\n\n## ç½‘ç»œä¸ƒå±‚åè®®\n\n![img](../img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_16,color_FFFFFF,t_70,g_se,x_16.png)\n\n## ä¸¤ä¸ªæ¨¡å—è¿›è¡Œé€šä¿¡\n\nä¸‹å›¾æ˜¯ä¸¤ä¸ªä¸»æ§ç›´æ¥çš„é€šä¿¡ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„ç”µè„‘ å’Œ è·¯ç”±å™¨ ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰ä¸­é—´çš„ä»‹è´¨è¿˜èƒ½è¿æ¥ç½‘ç»œå—ï¼Ÿç­”æ¡ˆæ˜¯å¯ä»¥çš„\n\nå¦‚æœphyèŠ¯ç‰‡æ²¡æœ‰ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥é€šè¿‡ä¸¤ä¸ªmacè¿æ¥è¿›è¡Œé€šä¿¡ï¼Œä¹‹æ‰€ä»¥éœ€è¦mac ã€phyã€å˜å‹å™¨çš„ç›®çš„æ˜¯ä¸ºäº†è½¬æ¢æ•°æ®ç±»å‹é€‚é…æ‰€ä»¥çš„ç½‘çº¿ï¼Œä½†æ˜¯åœ¨ä¸€äº›ç”µè·¯ä¸Šï¼Œæ²¡å¿…è¦åŠ è¿™ä¹ˆå¤šä¸œè¥¿\n\næ¯”å¦‚æ­è½½ Linuxç³»ç»Ÿçš„armèŠ¯ç‰‡æƒ³è¦ç½‘ç»œï¼Œå¯ä»¥ç›´æ¥é€šè¿‡macå’Œç½‘å¡èŠ¯ç‰‡è¿æ¥è·å–ï¼Œè¿™æ—¶å€™å°±éœ€è¦é€šè¿‡RGMIIæ¥å£æˆ–è€…MIIæ¥å£ å’Œ MDIO è¿æ¥ç½‘å¡èŠ¯ç‰‡ã€‚\n\nï¼ˆç½‘å¡èŠ¯ç‰‡å†…ç½®ä¹Ÿæ˜¯mac+phyï¼Œæœ‰çš„åªæœ‰mac å±‚è¿™ä¸ªè¦çœ‹å…·ä½“çš„æ‰‹å†Œï¼‰\n\n![img](../img/84b0b5e31bb246c0a970ace7c71a3f82.png)\n\n## ä»€ä¹ˆæ˜¯MDIOåè®®\n\nmidoåè®®å³SMIåè®®\n\nSMIåè®®ä¹Ÿæ˜¯ä¸€ç§é€šä¿¡åè®®ç±»ä¼¼ä¸I2Cåè®®ä½†æ˜¯é€šä¿¡æ–¹å¼ä¸ä¸€æ ·\n\nSMIåŒ…å«ä¸¤æ ¹ä¿¡å·çº¿ï¼Œä¸€ä¸ªMDCæ—¶é’Ÿçº¿ï¼Œä¸€ä¸ªMDIOåŒå‘ä¼ è¾“çš„æ•°æ®çº¿ï¼Œ\n\nå¦‚å›¾ä¸ºSMIåº”ç”¨æ¡†å›¾ã€‚STAè®¾å¤‡é€šè¿‡MDIOæ¥å£ä¸PHYé€šä¿¡ã€‚STAï¼ˆStaTIon Managementï¼‰ä¸ºä¸»æ§è®¾å¤‡ï¼Œæ¯”å¦‚MCUã€MACã€ONUç­‰ã€‚PHYä¸ºä»è®¾å¤‡ã€‚ä¸€ä¸ªSTAæœ€å¤šç®¡ç†32ä¸ªPHYã€‚MDCä¿¡å·ç”±STAæ§åˆ¶ï¼ŒMDIOä¿¡å·æ ¹æ®é€šä¿¡æ–¹å¼çš„ä¸åŒå¯ä»¥ç”±STAæˆ–è€…PHYæ¥ç®¡æ§åˆ¶ã€‚å¦‚å›¾é€šå¸¸MDIOä¼šæ¥ä¸€ä¸ªç”µé˜»ä¸Šæ‹‰è‡³æ¥å£ç”µæºã€‚\n\n![img](../img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_16,color_FFFFFF,t_70,g_se,x_16.png)\n\n\n\n## MDIOçš„ä½œç”¨ \n\nä»ä¸Šé¢çš„è¿æ¥å›¾å¯ä»¥çœ‹åˆ°MDIOæ˜¯ç”¨æ¥è¿æ¥ä¸»è®¾å¤‡å’Œå¤šä¸ªPHYè®¾å¤‡ï¼Œå¹¶ä¸”é€šè¿‡MDIOæ¥ä¼ è¾“æ•°æ®\n\né‚£ä¹ˆä¼ è¾“çš„æ˜¯æ•°æ®æ˜¯å“ªäº›å‘¢ï¼Ÿä¸»è¦æ˜¯ä¼ è¾“é“¾æ¥çŠ¶æ€ã€ä¼ è¾“é€Ÿåº¦ä¸é€‰æ‹©ã€æ–­ç”µã€ä½åŠŸç‡[ä¼‘çœ çŠ¶æ€](https://baike.baidu.com/item/ä¼‘çœ çŠ¶æ€?fromModule=lemma_inlink)ã€TX/RXæ¨¡å¼é€‰æ‹©ã€[è‡ªåŠ¨åå•†](https://baike.baidu.com/item/è‡ªåŠ¨åå•†/7765053?fromModule=lemma_inlink)æ§åˆ¶ã€ç¯å›æ¨¡å¼æ§åˆ¶ç­‰ã€‚\n\n\n\n### MDIOæ²¡é‚£ä¹ˆé‡è¦\n\nMDIOåœ¨ä¸Šé¢è¯´åˆ°çš„ä¸¤ä¸ªæ¨¡å—é€šä¿¡ï¼Œæˆ‘æåˆ°äº† armèŠ¯ç‰‡å’Œç½‘å¡èŠ¯ç‰‡ç›´æ¥éœ€è¦ï¼Œé‚£ä¹ˆè¿™ä¸ªçœŸçš„æœ‰å¿…è¦å—ï¼Ÿå…¶å®æ²¡å¿…è¦è¿æ¥ï¼ï¼ï¼\n\næ¢ä¸ªè¯è¯´ ä¸è¿æ¥ä¹Ÿå¯ä»¥ä½¿å¾—ç½‘ç»œç•…é€šï¼Œå› ä¸ºç½‘ç»œçš„æ•°æ®ä¼ è¾“æ—¶é RGMIIä¸æ˜¯é MDIOï¼ŒMDIOçš„ä½œç”¨ä»…ä»…åªæ˜¯ç”¨æ¥æŸ¥çœ‹ä¸€äº›çŠ¶æ€å’ŒåŠŸèƒ½ï¼Œè¿˜æœ‰ç®€å•çš„æ§åˆ¶ï¼Œè€Œè¿™äº›ç®€å•çš„æ§åˆ¶æ˜¯å®Œå…¨å¯ä»¥æœ‰ç½‘å¡èŠ¯ç‰‡å†…ç½®å»å†™æ­»ï¼Œarmå±‚åªè¦å’Œç½‘å¡çš„å†™çš„ä¸€ç›´å°±å¯ä»¥é€šè®¯ã€‚\n\nä½†æ˜¯ä¸ºä»€ä¹ˆå¾ˆå¤šæ—¶å€™éœ€è¦é€šè¿‡mdioæ¥è¿›è¡Œè¯»å†™æ§åˆ¶ï¼Œè¿™ä¸ªåªæ˜¯åœ¨ç½‘ç»œé€šè®¯æ­£å¸¸åçš„å‡çº§ä¼˜åŒ–ï¼Œç”¨æ¥æ–¹ä¾¿æŸ¥çœ‹çŠ¶æ€ï¼Œå°±åƒå†™äº†ä¸ªå‰ç«¯ç½‘é¡µæ¥çœ‹åå°æ•°æ®ã€‚\n\nå¦‚æœmidoæ²¡æœ‰è¯»é€šï¼Œæˆ–è€…è¯»å–çš„æ•°æ®æ˜¯0xfffffï¼Œé‚£ä¹ˆä¸ä¸€å®šæ˜¯mdioçš„é—®é¢˜ï¼Œå¾ˆå¤šæ—¶å€™æ˜¯ç½‘å¡æœ¬èº«æ²¡æœ‰å¯åŠ¨ï¼\n\n\n## MDIOè¯»å†™æ—¶åº\n\n![img](../img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_18,color_FFFFFF,t_70,g_se,x_16.png)\n\nPreambleï¼š32bitsçš„å‰å¯¼ç \n\nStartï¼š2bitçš„å¼€å§‹ä½ã€‚\n\nOP Codeï¼š2bitsçš„æ“ä½œç ï¼Œ10è¡¨ç¤ºè¯»ï¼Œ01è¡¨ç¤ºå†™ã€‚\n\nPHYADï¼š5bitsçš„PHYåœ°å€ã€‚\n\nREGADï¼š5bitsçš„å¯„å­˜å™¨åœ°å€ï¼Œå³è¦è¯»æˆ–å†™çš„å¯„å­˜å™¨ã€‚\n\nTurn Aroundï¼š2bitsçš„TAï¼Œåœ¨è¯»å‘½ä»¤ä¸­ï¼ŒMDIOåœ¨æ­¤æ—¶ç”±MACé©±åŠ¨æ”¹ä¸ºPHYé©±åŠ¨ï¼Œå¹¶ç­‰å¾…ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸå‡†å¤‡å‘é€æ•°æ®ã€‚åœ¨å†™å‘½ä»¤ä¸­ï¼Œä¸éœ€è¦MDIOæ–¹å‘å‘ç”Ÿå˜åŒ–ï¼Œåˆ™åªæ˜¯ç­‰å¾…ä¸¤ä¸ªæ—¶é’Ÿå‘¨æœŸå‡†å¤‡å†™å…¥æ•°æ®ã€‚\n\nDataï¼š16bitsæ•°æ®ï¼Œåœ¨è¯»å‘½ä»¤ä¸­ï¼ŒPHYèŠ¯ç‰‡å°†è¯»åˆ°çš„å¯¹åº”PHYADçš„REGADå¯„å­˜å™¨çš„æ•°æ®å†™åˆ°Dataä¸­ï¼Œåœ¨å†™å‘½ä»¤ä¸­ï¼ŒMACå°†è¦å†™å…¥å¯¹åº”PHYADçš„REGADå¯„å­˜å™¨çš„å€¼å†™å…¥Dataä¸­ã€‚\n\nIdleï¼šç©ºé—²çŠ¶æ€ï¼Œæ­¤æ—¶MDIOæ— æºé©±åŠ¨ï¼Œå¤„é«˜é˜»çŠ¶æ€ï¼Œä½†ä¸€èˆ¬ç”¨ä¸Šæ‹‰ç”µé˜»ä½¿å…¶å¤„åœ¨é«˜ç”µå¹³ï¼Œä¸Šæ‹‰ç”µé˜»ä¸€èˆ¬ä¸º1.5Kã€‚\nä¸ºä»€ä¹ˆè¯´è¯»å–çš„phyæœ€å¤š32ä¸ª\nå› ä¸ºmdioä¸­è¯»å–çš„phyåªæä¾›5bitçš„å­—èŠ‚å³æœ€é«˜11111 è½¬æˆåè¿›åˆ¶å°±æ˜¯31å³0-31å°±æ˜¯32ä¸ªï¼Œä½†è¿™æ˜¯ä»è¯»å–çš„æ–¹å¼åˆ¤æ–­çš„ï¼Œè€Œmdioè¯»å–æ˜¯ä¾ç…§phyèŠ¯ç‰‡æœ¬èº«åœ°å€ç©ºé—´å°±5ä¸º\n\n## ä¸ºä»€ä¹ˆè¯´regåœ°å€æœ€å¤š32ä¸ª\n\nåŒæ ·mdioä¸­è¯»å–çš„regåªæä¾›5bitçš„å­—èŠ‚å³æœ€é«˜11111 è½¬æˆåè¿›åˆ¶å°±æ˜¯31å³0-31å°±æ˜¯32ä¸ª\n\n PHY èŠ¯ç‰‡å¯„å­˜å™¨åœ°å€ç©ºé—´ä¸º 5 ä½ï¼Œåœ°å€ 0-31 å…± 32 ä¸ªå¯„å­˜å™¨ï¼Œ IEEE å®šä¹‰äº† 0-15 è¿™ 16 ä¸ªå¯„å­˜å™¨çš„åŠŸèƒ½ï¼Œ 16~31 è¿™ 16 ä¸ªå¯„å­˜å™¨ç”±å‚å•†è‡ªè¡Œå®ç°ã€‚ ä¹Ÿå°±æ˜¯è¯´ä¸ç®¡ä½ ç”¨çš„å“ªä¸ªå‚å®¶çš„ PHY èŠ¯ç‰‡ï¼Œå…¶ä¸­ 0~15 è¿™ 16 ä¸ªå¯„å­˜å™¨æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚ ä»…é è¿™ 16 ä¸ªå¯„å­˜å™¨æ˜¯å®Œå…¨å¯ä»¥é©±åŠ¨èµ· PHY èŠ¯ç‰‡çš„ï¼Œè‡³å°‘èƒ½ä¿è¯åŸºæœ¬çš„ç½‘ç»œæ•°æ®é€šä¿¡ã€‚\n\n \n\n\n\n[PHYèŠ¯ç‰‡å¿«é€Ÿæ·±åº¦ç†è§£ï¼ˆæŒç»­æ›´æ–°ä¸­â€¦â€¦ï¼‰-CSDNåšå®¢](https://blog.csdn.net/qq_40715266/article/details/124095801)\n\n\n\n[PHYï¼ˆPhysical Layerï¼ŒPHYï¼‰ - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/148538791)\n","updated":"2024-05-16T11:43:17.805Z","path":"back_posts/PHYèŠ¯ç‰‡.html","_id":"clw96lvxr0000bpw0g20t03s2","comments":1,"layout":"page","content":"<h1 id=\"PHYï¼ˆphysical-Layerï¼ŒPHYï¼‰\"><a href=\"#PHYï¼ˆphysical-Layerï¼ŒPHYï¼‰\" class=\"headerlink\" title=\"PHYï¼ˆphysical Layerï¼ŒPHYï¼‰\"></a>PHYï¼ˆphysical Layerï¼ŒPHYï¼‰</h1><h2 id=\"ä»€ä¹ˆæ˜¯PHYï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯PHYï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯PHYï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯PHYï¼Ÿ</h2><p>ç‰©ç†å±‚èŠ¯ç‰‡ç§°ä¸ºPHYã€æ•°æ®é“¾è·¯å±‚èŠ¯ç‰‡ç§°ä¸ºMAC</p>\n<p>å¯ä»¥çœ‹åˆ°PHYçš„æ•°æ®æ˜¯<a href=\"https://so.csdn.net/so/search?q=RJ45&spm=1001.2101.3001.7020\">RJ45</a>ç½‘ç»œæ¥å£ï¼ˆç½‘çº¿å£ï¼‰ç©¿è¿‡äº†çš„å·®åˆ†ä¿¡å·ï¼Œè€ŒPHYä½œç”¨å°±æ˜¯å°†å·®åˆ†ä¿¡å·è½¬ä¸ºæ•°å­—ä¿¡å·ï¼Œè¿™å—å†…å®¹ä¸ç”¨æ·±ç©¶ï¼Œåˆ¶é€ å•†éƒ½è®¾è®¡å¥½äº†ã€‚</p>\n<p>é‚£æˆ‘ä»¬å¹²ä»€ä¹ˆå‘¢ï¼Ÿï¼ˆä¸»è¦æ˜¯å¯¹phyèŠ¯ç‰‡è¿›è¡Œæ¨¡å¼é€‰æ‹©ï¼Œæ¯”å¦‚å·¥ä½œé€Ÿç‡ï¼Œå·¥ä½œæ¨¡å¼ï¼‰</p>\n<h2 id=\"ä»€ä¹ˆæ˜¯RJ45æ¥å£ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯RJ45æ¥å£ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯RJ45æ¥å£ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯RJ45æ¥å£ï¼Ÿ</h2><p>RJ45æ¥å£é€šå¸¸ç”¨äºæ•°æ®ä¼ è¾“ï¼Œæœ€å¸¸è§çš„åº”ç”¨ä¸ºç½‘å¡æ¥å£ã€‚RJ-45ç«¯å£æ˜¯æˆ‘ä»¬æœ€å¸¸è§çš„ç«¯å£ä¹‹ä¸€ï¼Œæ˜¯æ¯”è¾ƒå¸¸è§çš„<a href=\"https://www.zhihu.com/search?q=%E5%8F%8C%E7%BB%9E%E7%BA%BF&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22answer%22,%22sourceId%22:3477234795%7D\">åŒç»çº¿</a>ä»¥å¤ªç½‘ç«¯å£ï¼Œå› ä¸ºåœ¨å¿«é€Ÿä»¥å¤ªç½‘ä¸­ä¹Ÿä¸»è¦é‡‡ç”¨åŒç»çº¿ä½œä¸ºä¼ è¾“ä»‹è´¨ã€‚</p>\n<p>RJ45å‹ç½‘çº¿æ’å¤´åˆç§°æ°´æ™¶å¤´ï¼Œå…±ç”±å…«èŠ¯åšæˆï¼Œå¹¿æ³›åº”ç”¨äºå±€åŸŸç½‘å’ŒADSLå®½å¸¦ä¸Šç½‘ç”¨æˆ·çš„ç½‘ç»œè®¾å¤‡é—´ç½‘çº¿ï¼ˆç§°ä½œäº”ç±»çº¿æˆ–åŒç»çº¿ï¼‰çš„è¿æ¥ã€‚</p>\n<p>RJ45æ¥å¤´æ ¹æ®çº¿çš„æ’åºä¸åŒä¸»è¦åˆ†ä¸¤ç§ï¼Œä¸€ç§æ˜¯æ©™ç™½ã€æ©™ã€ç»¿ç™½ã€è“ã€è“ç™½ã€ç»¿ã€æ£•ç™½ã€æ£•ï¼›å¦ä¸€ç§æ˜¯ç»¿ç™½ã€ç»¿ã€æ©™ç™½ã€è“ã€è“ç™½ã€æ©™ã€æ£•ç™½ã€æ£•ï¼›å› æ­¤ä½¿ç”¨RJ45æ¥å¤´çš„çº¿ä¹Ÿæœ‰ä¸¤ç§å³ï¼šç›´é€šçº¿ã€äº¤å‰çº¿ã€‚åˆ†åˆ«ç§°ä½œ<a href=\"https://www.zhihu.com/search?q=T568A%E7%BA%BF%E5%BA%8F&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22answer%22,%22sourceId%22:3477234795%7D\">T568Açº¿åº</a>å’ŒT568Bçº¿åºã€‚</p>\n<p>RJ45æ’åº§è¿æ¥å™¨æ¥å£å†…éƒ¨æ˜¯é‡‘å±ï¼Œæ³¨æ„ä¸èƒ½å—æ½®æˆ–è€…æ¥è§¦åˆ°æ°´ï¼Œå¦åˆ™ä¼šé€ æˆçŸ­è·¯ç°è±¡ã€‚</p>\n<h2 id=\"ä¸ºä»€ä¹ˆè¦ç†Ÿæ‚‰RJ45ç½‘å£\"><a href=\"#ä¸ºä»€ä¹ˆè¦ç†Ÿæ‚‰RJ45ç½‘å£\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆè¦ç†Ÿæ‚‰RJ45ç½‘å£\"></a>ä¸ºä»€ä¹ˆè¦ç†Ÿæ‚‰RJ45ç½‘å£</h2><p>ä¸Šé¢è¯´åˆ°é’ˆå¯¹phyèŠ¯ç‰‡æˆ‘ä»¬åªè¦è¿›è¡Œæ¨¡å¼é€‰æ‹©ï¼ˆä¸‹æ–‡ä¼šä»‹ç»ä½¿ç”¨<a href=\"https://so.csdn.net/so/search?q=mdio&spm=1001.2101.3001.7020\">mdio</a>æ¥å£ï¼Œé€šè¿‡å¯„å­˜å™¨æ§åˆ¶ï¼‰</p>\n<p>é‚£æ¨¡å¼é€‰æ‹©åï¼Œå¦‚ä½•æŸ¥çœ‹æ˜¯å¦æœ‰æ•ˆå‘¢ï¼Ÿæœ€ç®€å•ç›´æ¥çš„å°±æ˜¯é€šè¿‡RJ45ç½‘å£çš„æŒ‡ç¤ºç¯æŸ¥çœ‹</p>\n<p><img src=\"/../imgs/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_18,color_FFFFFF,t_70,g_se,x_16-17158590663256.png\" alt=\"img\"></p>\n<p>RJ45 åº§å­ä¸Šä¸€èˆ¬æœ‰ä¸¤ä¸ªç¯ï¼Œä¸€ä¸ªé»„è‰²(æ©™è‰²)ï¼Œä¸€ä¸ªç»¿è‰²ï¼Œ<strong>ç»¿è‰²äº®çš„è¯è¡¨ç¤ºç½‘ç»œè¿æ¥æ­£å¸¸ï¼Œé»„è‰²é—ªçƒçš„è¯è¯´æ˜å½“å‰æ­£åœ¨è¿›è¡Œç½‘ç»œé€šä¿¡</strong>ï¼Œ<strong>é»„ç¯é—ªåŠ¨é¢‘ç‡å¿«è¡¨ç¤ºç½‘é€Ÿ</strong>å¥½ï¼Œè¿™ä¸¤ä¸ªç¯ç”± PHY èŠ¯ç‰‡æ§åˆ¶ã€‚</p>\n<h2 id=\"ç½‘ç»œä¸ƒå±‚åè®®\"><a href=\"#ç½‘ç»œä¸ƒå±‚åè®®\" class=\"headerlink\" title=\"ç½‘ç»œä¸ƒå±‚åè®®\"></a>ç½‘ç»œä¸ƒå±‚åè®®</h2><p><img src=\"/../img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_16,color_FFFFFF,t_70,g_se,x_16.png\" alt=\"img\"></p>\n<h2 id=\"ä¸¤ä¸ªæ¨¡å—è¿›è¡Œé€šä¿¡\"><a href=\"#ä¸¤ä¸ªæ¨¡å—è¿›è¡Œé€šä¿¡\" class=\"headerlink\" title=\"ä¸¤ä¸ªæ¨¡å—è¿›è¡Œé€šä¿¡\"></a>ä¸¤ä¸ªæ¨¡å—è¿›è¡Œé€šä¿¡</h2><p>ä¸‹å›¾æ˜¯ä¸¤ä¸ªä¸»æ§ç›´æ¥çš„é€šä¿¡ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„ç”µè„‘ å’Œ è·¯ç”±å™¨ ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰ä¸­é—´çš„ä»‹è´¨è¿˜èƒ½è¿æ¥ç½‘ç»œå—ï¼Ÿç­”æ¡ˆæ˜¯å¯ä»¥çš„</p>\n<p>å¦‚æœphyèŠ¯ç‰‡æ²¡æœ‰ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥é€šè¿‡ä¸¤ä¸ªmacè¿æ¥è¿›è¡Œé€šä¿¡ï¼Œä¹‹æ‰€ä»¥éœ€è¦mac ã€phyã€å˜å‹å™¨çš„ç›®çš„æ˜¯ä¸ºäº†è½¬æ¢æ•°æ®ç±»å‹é€‚é…æ‰€ä»¥çš„ç½‘çº¿ï¼Œä½†æ˜¯åœ¨ä¸€äº›ç”µè·¯ä¸Šï¼Œæ²¡å¿…è¦åŠ è¿™ä¹ˆå¤šä¸œè¥¿</p>\n<p>æ¯”å¦‚æ­è½½ Linuxç³»ç»Ÿçš„armèŠ¯ç‰‡æƒ³è¦ç½‘ç»œï¼Œå¯ä»¥ç›´æ¥é€šè¿‡macå’Œç½‘å¡èŠ¯ç‰‡è¿æ¥è·å–ï¼Œè¿™æ—¶å€™å°±éœ€è¦é€šè¿‡RGMIIæ¥å£æˆ–è€…MIIæ¥å£ å’Œ MDIO è¿æ¥ç½‘å¡èŠ¯ç‰‡ã€‚</p>\n<p>ï¼ˆç½‘å¡èŠ¯ç‰‡å†…ç½®ä¹Ÿæ˜¯mac+phyï¼Œæœ‰çš„åªæœ‰mac å±‚è¿™ä¸ªè¦çœ‹å…·ä½“çš„æ‰‹å†Œï¼‰</p>\n<p><img src=\"/../img/84b0b5e31bb246c0a970ace7c71a3f82.png\" alt=\"img\"></p>\n<h2 id=\"ä»€ä¹ˆæ˜¯MDIOåè®®\"><a href=\"#ä»€ä¹ˆæ˜¯MDIOåè®®\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯MDIOåè®®\"></a>ä»€ä¹ˆæ˜¯MDIOåè®®</h2><p>midoåè®®å³SMIåè®®</p>\n<p>SMIåè®®ä¹Ÿæ˜¯ä¸€ç§é€šä¿¡åè®®ç±»ä¼¼ä¸I2Cåè®®ä½†æ˜¯é€šä¿¡æ–¹å¼ä¸ä¸€æ ·</p>\n<p>SMIåŒ…å«ä¸¤æ ¹ä¿¡å·çº¿ï¼Œä¸€ä¸ªMDCæ—¶é’Ÿçº¿ï¼Œä¸€ä¸ªMDIOåŒå‘ä¼ è¾“çš„æ•°æ®çº¿ï¼Œ</p>\n<p>å¦‚å›¾ä¸ºSMIåº”ç”¨æ¡†å›¾ã€‚STAè®¾å¤‡é€šè¿‡MDIOæ¥å£ä¸PHYé€šä¿¡ã€‚STAï¼ˆStaTIon Managementï¼‰ä¸ºä¸»æ§è®¾å¤‡ï¼Œæ¯”å¦‚MCUã€MACã€ONUç­‰ã€‚PHYä¸ºä»è®¾å¤‡ã€‚ä¸€ä¸ªSTAæœ€å¤šç®¡ç†32ä¸ªPHYã€‚MDCä¿¡å·ç”±STAæ§åˆ¶ï¼ŒMDIOä¿¡å·æ ¹æ®é€šä¿¡æ–¹å¼çš„ä¸åŒå¯ä»¥ç”±STAæˆ–è€…PHYæ¥ç®¡æ§åˆ¶ã€‚å¦‚å›¾é€šå¸¸MDIOä¼šæ¥ä¸€ä¸ªç”µé˜»ä¸Šæ‹‰è‡³æ¥å£ç”µæºã€‚</p>\n<p><img src=\"/../img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_16,color_FFFFFF,t_70,g_se,x_16.png\" alt=\"img\"></p>\n<h2 id=\"MDIOçš„ä½œç”¨\"><a href=\"#MDIOçš„ä½œç”¨\" class=\"headerlink\" title=\"MDIOçš„ä½œç”¨\"></a>MDIOçš„ä½œç”¨</h2><p>ä»ä¸Šé¢çš„è¿æ¥å›¾å¯ä»¥çœ‹åˆ°MDIOæ˜¯ç”¨æ¥è¿æ¥ä¸»è®¾å¤‡å’Œå¤šä¸ªPHYè®¾å¤‡ï¼Œå¹¶ä¸”é€šè¿‡MDIOæ¥ä¼ è¾“æ•°æ®</p>\n<p>é‚£ä¹ˆä¼ è¾“çš„æ˜¯æ•°æ®æ˜¯å“ªäº›å‘¢ï¼Ÿä¸»è¦æ˜¯ä¼ è¾“é“¾æ¥çŠ¶æ€ã€ä¼ è¾“é€Ÿåº¦ä¸é€‰æ‹©ã€æ–­ç”µã€ä½åŠŸç‡<a href=\"https://baike.baidu.com/item/%E4%BC%91%E7%9C%A0%E7%8A%B6%E6%80%81?fromModule=lemma_inlink\">ä¼‘çœ çŠ¶æ€</a>ã€TX&#x2F;RXæ¨¡å¼é€‰æ‹©ã€<a href=\"https://baike.baidu.com/item/%E8%87%AA%E5%8A%A8%E5%8D%8F%E5%95%86/7765053?fromModule=lemma_inlink\">è‡ªåŠ¨åå•†</a>æ§åˆ¶ã€ç¯å›æ¨¡å¼æ§åˆ¶ç­‰ã€‚</p>\n<h3 id=\"MDIOæ²¡é‚£ä¹ˆé‡è¦\"><a href=\"#MDIOæ²¡é‚£ä¹ˆé‡è¦\" class=\"headerlink\" title=\"MDIOæ²¡é‚£ä¹ˆé‡è¦\"></a>MDIOæ²¡é‚£ä¹ˆé‡è¦</h3><p>MDIOåœ¨ä¸Šé¢è¯´åˆ°çš„ä¸¤ä¸ªæ¨¡å—é€šä¿¡ï¼Œæˆ‘æåˆ°äº† armèŠ¯ç‰‡å’Œç½‘å¡èŠ¯ç‰‡ç›´æ¥éœ€è¦ï¼Œé‚£ä¹ˆè¿™ä¸ªçœŸçš„æœ‰å¿…è¦å—ï¼Ÿå…¶å®æ²¡å¿…è¦è¿æ¥ï¼ï¼ï¼</p>\n<p>æ¢ä¸ªè¯è¯´ ä¸è¿æ¥ä¹Ÿå¯ä»¥ä½¿å¾—ç½‘ç»œç•…é€šï¼Œå› ä¸ºç½‘ç»œçš„æ•°æ®ä¼ è¾“æ—¶é RGMIIä¸æ˜¯é MDIOï¼ŒMDIOçš„ä½œç”¨ä»…ä»…åªæ˜¯ç”¨æ¥æŸ¥çœ‹ä¸€äº›çŠ¶æ€å’ŒåŠŸèƒ½ï¼Œè¿˜æœ‰ç®€å•çš„æ§åˆ¶ï¼Œè€Œè¿™äº›ç®€å•çš„æ§åˆ¶æ˜¯å®Œå…¨å¯ä»¥æœ‰ç½‘å¡èŠ¯ç‰‡å†…ç½®å»å†™æ­»ï¼Œarmå±‚åªè¦å’Œç½‘å¡çš„å†™çš„ä¸€ç›´å°±å¯ä»¥é€šè®¯ã€‚</p>\n<p>ä½†æ˜¯ä¸ºä»€ä¹ˆå¾ˆå¤šæ—¶å€™éœ€è¦é€šè¿‡mdioæ¥è¿›è¡Œè¯»å†™æ§åˆ¶ï¼Œè¿™ä¸ªåªæ˜¯åœ¨ç½‘ç»œé€šè®¯æ­£å¸¸åçš„å‡çº§ä¼˜åŒ–ï¼Œç”¨æ¥æ–¹ä¾¿æŸ¥çœ‹çŠ¶æ€ï¼Œå°±åƒå†™äº†ä¸ªå‰ç«¯ç½‘é¡µæ¥çœ‹åå°æ•°æ®ã€‚</p>\n<p>å¦‚æœmidoæ²¡æœ‰è¯»é€šï¼Œæˆ–è€…è¯»å–çš„æ•°æ®æ˜¯0xfffffï¼Œé‚£ä¹ˆä¸ä¸€å®šæ˜¯mdioçš„é—®é¢˜ï¼Œå¾ˆå¤šæ—¶å€™æ˜¯ç½‘å¡æœ¬èº«æ²¡æœ‰å¯åŠ¨ï¼</p>\n<h2 id=\"MDIOè¯»å†™æ—¶åº\"><a href=\"#MDIOè¯»å†™æ—¶åº\" class=\"headerlink\" title=\"MDIOè¯»å†™æ—¶åº\"></a>MDIOè¯»å†™æ—¶åº</h2><p><img src=\"/../img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_18,color_FFFFFF,t_70,g_se,x_16.png\" alt=\"img\"></p>\n<p>Preambleï¼š32bitsçš„å‰å¯¼ç </p>\n<p>Startï¼š2bitçš„å¼€å§‹ä½ã€‚</p>\n<p>OP Codeï¼š2bitsçš„æ“ä½œç ï¼Œ10è¡¨ç¤ºè¯»ï¼Œ01è¡¨ç¤ºå†™ã€‚</p>\n<p>PHYADï¼š5bitsçš„PHYåœ°å€ã€‚</p>\n<p>REGADï¼š5bitsçš„å¯„å­˜å™¨åœ°å€ï¼Œå³è¦è¯»æˆ–å†™çš„å¯„å­˜å™¨ã€‚</p>\n<p>Turn Aroundï¼š2bitsçš„TAï¼Œåœ¨è¯»å‘½ä»¤ä¸­ï¼ŒMDIOåœ¨æ­¤æ—¶ç”±MACé©±åŠ¨æ”¹ä¸ºPHYé©±åŠ¨ï¼Œå¹¶ç­‰å¾…ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸå‡†å¤‡å‘é€æ•°æ®ã€‚åœ¨å†™å‘½ä»¤ä¸­ï¼Œä¸éœ€è¦MDIOæ–¹å‘å‘ç”Ÿå˜åŒ–ï¼Œåˆ™åªæ˜¯ç­‰å¾…ä¸¤ä¸ªæ—¶é’Ÿå‘¨æœŸå‡†å¤‡å†™å…¥æ•°æ®ã€‚</p>\n<p>Dataï¼š16bitsæ•°æ®ï¼Œåœ¨è¯»å‘½ä»¤ä¸­ï¼ŒPHYèŠ¯ç‰‡å°†è¯»åˆ°çš„å¯¹åº”PHYADçš„REGADå¯„å­˜å™¨çš„æ•°æ®å†™åˆ°Dataä¸­ï¼Œåœ¨å†™å‘½ä»¤ä¸­ï¼ŒMACå°†è¦å†™å…¥å¯¹åº”PHYADçš„REGADå¯„å­˜å™¨çš„å€¼å†™å…¥Dataä¸­ã€‚</p>\n<p>Idleï¼šç©ºé—²çŠ¶æ€ï¼Œæ­¤æ—¶MDIOæ— æºé©±åŠ¨ï¼Œå¤„é«˜é˜»çŠ¶æ€ï¼Œä½†ä¸€èˆ¬ç”¨ä¸Šæ‹‰ç”µé˜»ä½¿å…¶å¤„åœ¨é«˜ç”µå¹³ï¼Œä¸Šæ‹‰ç”µé˜»ä¸€èˆ¬ä¸º1.5Kã€‚<br>ä¸ºä»€ä¹ˆè¯´è¯»å–çš„phyæœ€å¤š32ä¸ª<br>å› ä¸ºmdioä¸­è¯»å–çš„phyåªæä¾›5bitçš„å­—èŠ‚å³æœ€é«˜11111 è½¬æˆåè¿›åˆ¶å°±æ˜¯31å³0-31å°±æ˜¯32ä¸ªï¼Œä½†è¿™æ˜¯ä»è¯»å–çš„æ–¹å¼åˆ¤æ–­çš„ï¼Œè€Œmdioè¯»å–æ˜¯ä¾ç…§phyèŠ¯ç‰‡æœ¬èº«åœ°å€ç©ºé—´å°±5ä¸º</p>\n<h2 id=\"ä¸ºä»€ä¹ˆè¯´regåœ°å€æœ€å¤š32ä¸ª\"><a href=\"#ä¸ºä»€ä¹ˆè¯´regåœ°å€æœ€å¤š32ä¸ª\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆè¯´regåœ°å€æœ€å¤š32ä¸ª\"></a>ä¸ºä»€ä¹ˆè¯´regåœ°å€æœ€å¤š32ä¸ª</h2><p>åŒæ ·mdioä¸­è¯»å–çš„regåªæä¾›5bitçš„å­—èŠ‚å³æœ€é«˜11111 è½¬æˆåè¿›åˆ¶å°±æ˜¯31å³0-31å°±æ˜¯32ä¸ª</p>\n<p> PHY èŠ¯ç‰‡å¯„å­˜å™¨åœ°å€ç©ºé—´ä¸º 5 ä½ï¼Œåœ°å€ 0-31 å…± 32 ä¸ªå¯„å­˜å™¨ï¼Œ IEEE å®šä¹‰äº† 0-15 è¿™ 16 ä¸ªå¯„å­˜å™¨çš„åŠŸèƒ½ï¼Œ 16<del>31 è¿™ 16 ä¸ªå¯„å­˜å™¨ç”±å‚å•†è‡ªè¡Œå®ç°ã€‚ ä¹Ÿå°±æ˜¯è¯´ä¸ç®¡ä½ ç”¨çš„å“ªä¸ªå‚å®¶çš„ PHY èŠ¯ç‰‡ï¼Œå…¶ä¸­ 0</del>15 è¿™ 16 ä¸ªå¯„å­˜å™¨æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚ ä»…é è¿™ 16 ä¸ªå¯„å­˜å™¨æ˜¯å®Œå…¨å¯ä»¥é©±åŠ¨èµ· PHY èŠ¯ç‰‡çš„ï¼Œè‡³å°‘èƒ½ä¿è¯åŸºæœ¬çš„ç½‘ç»œæ•°æ®é€šä¿¡ã€‚</p>\n<p><a href=\"https://blog.csdn.net/qq_40715266/article/details/124095801\">PHYèŠ¯ç‰‡å¿«é€Ÿæ·±åº¦ç†è§£ï¼ˆæŒç»­æ›´æ–°ä¸­â€¦â€¦ï¼‰-CSDNåšå®¢</a></p>\n<p><a href=\"https://zhuanlan.zhihu.com/p/148538791\">PHYï¼ˆPhysical Layerï¼ŒPHYï¼‰ - çŸ¥ä¹ (zhihu.com)</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"PHYï¼ˆphysical-Layerï¼ŒPHYï¼‰\"><a href=\"#PHYï¼ˆphysical-Layerï¼ŒPHYï¼‰\" class=\"headerlink\" title=\"PHYï¼ˆphysical Layerï¼ŒPHYï¼‰\"></a>PHYï¼ˆphysical Layerï¼ŒPHYï¼‰</h1><h2 id=\"ä»€ä¹ˆæ˜¯PHYï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯PHYï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯PHYï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯PHYï¼Ÿ</h2><p>ç‰©ç†å±‚èŠ¯ç‰‡ç§°ä¸ºPHYã€æ•°æ®é“¾è·¯å±‚èŠ¯ç‰‡ç§°ä¸ºMAC</p>\n<p>å¯ä»¥çœ‹åˆ°PHYçš„æ•°æ®æ˜¯<a href=\"https://so.csdn.net/so/search?q=RJ45&spm=1001.2101.3001.7020\">RJ45</a>ç½‘ç»œæ¥å£ï¼ˆç½‘çº¿å£ï¼‰ç©¿è¿‡äº†çš„å·®åˆ†ä¿¡å·ï¼Œè€ŒPHYä½œç”¨å°±æ˜¯å°†å·®åˆ†ä¿¡å·è½¬ä¸ºæ•°å­—ä¿¡å·ï¼Œè¿™å—å†…å®¹ä¸ç”¨æ·±ç©¶ï¼Œåˆ¶é€ å•†éƒ½è®¾è®¡å¥½äº†ã€‚</p>\n<p>é‚£æˆ‘ä»¬å¹²ä»€ä¹ˆå‘¢ï¼Ÿï¼ˆä¸»è¦æ˜¯å¯¹phyèŠ¯ç‰‡è¿›è¡Œæ¨¡å¼é€‰æ‹©ï¼Œæ¯”å¦‚å·¥ä½œé€Ÿç‡ï¼Œå·¥ä½œæ¨¡å¼ï¼‰</p>\n<h2 id=\"ä»€ä¹ˆæ˜¯RJ45æ¥å£ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯RJ45æ¥å£ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯RJ45æ¥å£ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯RJ45æ¥å£ï¼Ÿ</h2><p>RJ45æ¥å£é€šå¸¸ç”¨äºæ•°æ®ä¼ è¾“ï¼Œæœ€å¸¸è§çš„åº”ç”¨ä¸ºç½‘å¡æ¥å£ã€‚RJ-45ç«¯å£æ˜¯æˆ‘ä»¬æœ€å¸¸è§çš„ç«¯å£ä¹‹ä¸€ï¼Œæ˜¯æ¯”è¾ƒå¸¸è§çš„<a href=\"https://www.zhihu.com/search?q=%E5%8F%8C%E7%BB%9E%E7%BA%BF&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22answer%22,%22sourceId%22:3477234795%7D\">åŒç»çº¿</a>ä»¥å¤ªç½‘ç«¯å£ï¼Œå› ä¸ºåœ¨å¿«é€Ÿä»¥å¤ªç½‘ä¸­ä¹Ÿä¸»è¦é‡‡ç”¨åŒç»çº¿ä½œä¸ºä¼ è¾“ä»‹è´¨ã€‚</p>\n<p>RJ45å‹ç½‘çº¿æ’å¤´åˆç§°æ°´æ™¶å¤´ï¼Œå…±ç”±å…«èŠ¯åšæˆï¼Œå¹¿æ³›åº”ç”¨äºå±€åŸŸç½‘å’ŒADSLå®½å¸¦ä¸Šç½‘ç”¨æˆ·çš„ç½‘ç»œè®¾å¤‡é—´ç½‘çº¿ï¼ˆç§°ä½œäº”ç±»çº¿æˆ–åŒç»çº¿ï¼‰çš„è¿æ¥ã€‚</p>\n<p>RJ45æ¥å¤´æ ¹æ®çº¿çš„æ’åºä¸åŒä¸»è¦åˆ†ä¸¤ç§ï¼Œä¸€ç§æ˜¯æ©™ç™½ã€æ©™ã€ç»¿ç™½ã€è“ã€è“ç™½ã€ç»¿ã€æ£•ç™½ã€æ£•ï¼›å¦ä¸€ç§æ˜¯ç»¿ç™½ã€ç»¿ã€æ©™ç™½ã€è“ã€è“ç™½ã€æ©™ã€æ£•ç™½ã€æ£•ï¼›å› æ­¤ä½¿ç”¨RJ45æ¥å¤´çš„çº¿ä¹Ÿæœ‰ä¸¤ç§å³ï¼šç›´é€šçº¿ã€äº¤å‰çº¿ã€‚åˆ†åˆ«ç§°ä½œ<a href=\"https://www.zhihu.com/search?q=T568A%E7%BA%BF%E5%BA%8F&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22answer%22,%22sourceId%22:3477234795%7D\">T568Açº¿åº</a>å’ŒT568Bçº¿åºã€‚</p>\n<p>RJ45æ’åº§è¿æ¥å™¨æ¥å£å†…éƒ¨æ˜¯é‡‘å±ï¼Œæ³¨æ„ä¸èƒ½å—æ½®æˆ–è€…æ¥è§¦åˆ°æ°´ï¼Œå¦åˆ™ä¼šé€ æˆçŸ­è·¯ç°è±¡ã€‚</p>\n<h2 id=\"ä¸ºä»€ä¹ˆè¦ç†Ÿæ‚‰RJ45ç½‘å£\"><a href=\"#ä¸ºä»€ä¹ˆè¦ç†Ÿæ‚‰RJ45ç½‘å£\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆè¦ç†Ÿæ‚‰RJ45ç½‘å£\"></a>ä¸ºä»€ä¹ˆè¦ç†Ÿæ‚‰RJ45ç½‘å£</h2><p>ä¸Šé¢è¯´åˆ°é’ˆå¯¹phyèŠ¯ç‰‡æˆ‘ä»¬åªè¦è¿›è¡Œæ¨¡å¼é€‰æ‹©ï¼ˆä¸‹æ–‡ä¼šä»‹ç»ä½¿ç”¨<a href=\"https://so.csdn.net/so/search?q=mdio&spm=1001.2101.3001.7020\">mdio</a>æ¥å£ï¼Œé€šè¿‡å¯„å­˜å™¨æ§åˆ¶ï¼‰</p>\n<p>é‚£æ¨¡å¼é€‰æ‹©åï¼Œå¦‚ä½•æŸ¥çœ‹æ˜¯å¦æœ‰æ•ˆå‘¢ï¼Ÿæœ€ç®€å•ç›´æ¥çš„å°±æ˜¯é€šè¿‡RJ45ç½‘å£çš„æŒ‡ç¤ºç¯æŸ¥çœ‹</p>\n<p><img src=\"/../imgs/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_18,color_FFFFFF,t_70,g_se,x_16-17158590663256.png\" alt=\"img\"></p>\n<p>RJ45 åº§å­ä¸Šä¸€èˆ¬æœ‰ä¸¤ä¸ªç¯ï¼Œä¸€ä¸ªé»„è‰²(æ©™è‰²)ï¼Œä¸€ä¸ªç»¿è‰²ï¼Œ<strong>ç»¿è‰²äº®çš„è¯è¡¨ç¤ºç½‘ç»œè¿æ¥æ­£å¸¸ï¼Œé»„è‰²é—ªçƒçš„è¯è¯´æ˜å½“å‰æ­£åœ¨è¿›è¡Œç½‘ç»œé€šä¿¡</strong>ï¼Œ<strong>é»„ç¯é—ªåŠ¨é¢‘ç‡å¿«è¡¨ç¤ºç½‘é€Ÿ</strong>å¥½ï¼Œè¿™ä¸¤ä¸ªç¯ç”± PHY èŠ¯ç‰‡æ§åˆ¶ã€‚</p>\n<h2 id=\"ç½‘ç»œä¸ƒå±‚åè®®\"><a href=\"#ç½‘ç»œä¸ƒå±‚åè®®\" class=\"headerlink\" title=\"ç½‘ç»œä¸ƒå±‚åè®®\"></a>ç½‘ç»œä¸ƒå±‚åè®®</h2><p><img src=\"/../img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_16,color_FFFFFF,t_70,g_se,x_16.png\" alt=\"img\"></p>\n<h2 id=\"ä¸¤ä¸ªæ¨¡å—è¿›è¡Œé€šä¿¡\"><a href=\"#ä¸¤ä¸ªæ¨¡å—è¿›è¡Œé€šä¿¡\" class=\"headerlink\" title=\"ä¸¤ä¸ªæ¨¡å—è¿›è¡Œé€šä¿¡\"></a>ä¸¤ä¸ªæ¨¡å—è¿›è¡Œé€šä¿¡</h2><p>ä¸‹å›¾æ˜¯ä¸¤ä¸ªä¸»æ§ç›´æ¥çš„é€šä¿¡ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„ç”µè„‘ å’Œ è·¯ç”±å™¨ ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰ä¸­é—´çš„ä»‹è´¨è¿˜èƒ½è¿æ¥ç½‘ç»œå—ï¼Ÿç­”æ¡ˆæ˜¯å¯ä»¥çš„</p>\n<p>å¦‚æœphyèŠ¯ç‰‡æ²¡æœ‰ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥é€šè¿‡ä¸¤ä¸ªmacè¿æ¥è¿›è¡Œé€šä¿¡ï¼Œä¹‹æ‰€ä»¥éœ€è¦mac ã€phyã€å˜å‹å™¨çš„ç›®çš„æ˜¯ä¸ºäº†è½¬æ¢æ•°æ®ç±»å‹é€‚é…æ‰€ä»¥çš„ç½‘çº¿ï¼Œä½†æ˜¯åœ¨ä¸€äº›ç”µè·¯ä¸Šï¼Œæ²¡å¿…è¦åŠ è¿™ä¹ˆå¤šä¸œè¥¿</p>\n<p>æ¯”å¦‚æ­è½½ Linuxç³»ç»Ÿçš„armèŠ¯ç‰‡æƒ³è¦ç½‘ç»œï¼Œå¯ä»¥ç›´æ¥é€šè¿‡macå’Œç½‘å¡èŠ¯ç‰‡è¿æ¥è·å–ï¼Œè¿™æ—¶å€™å°±éœ€è¦é€šè¿‡RGMIIæ¥å£æˆ–è€…MIIæ¥å£ å’Œ MDIO è¿æ¥ç½‘å¡èŠ¯ç‰‡ã€‚</p>\n<p>ï¼ˆç½‘å¡èŠ¯ç‰‡å†…ç½®ä¹Ÿæ˜¯mac+phyï¼Œæœ‰çš„åªæœ‰mac å±‚è¿™ä¸ªè¦çœ‹å…·ä½“çš„æ‰‹å†Œï¼‰</p>\n<p><img src=\"/../img/84b0b5e31bb246c0a970ace7c71a3f82.png\" alt=\"img\"></p>\n<h2 id=\"ä»€ä¹ˆæ˜¯MDIOåè®®\"><a href=\"#ä»€ä¹ˆæ˜¯MDIOåè®®\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯MDIOåè®®\"></a>ä»€ä¹ˆæ˜¯MDIOåè®®</h2><p>midoåè®®å³SMIåè®®</p>\n<p>SMIåè®®ä¹Ÿæ˜¯ä¸€ç§é€šä¿¡åè®®ç±»ä¼¼ä¸I2Cåè®®ä½†æ˜¯é€šä¿¡æ–¹å¼ä¸ä¸€æ ·</p>\n<p>SMIåŒ…å«ä¸¤æ ¹ä¿¡å·çº¿ï¼Œä¸€ä¸ªMDCæ—¶é’Ÿçº¿ï¼Œä¸€ä¸ªMDIOåŒå‘ä¼ è¾“çš„æ•°æ®çº¿ï¼Œ</p>\n<p>å¦‚å›¾ä¸ºSMIåº”ç”¨æ¡†å›¾ã€‚STAè®¾å¤‡é€šè¿‡MDIOæ¥å£ä¸PHYé€šä¿¡ã€‚STAï¼ˆStaTIon Managementï¼‰ä¸ºä¸»æ§è®¾å¤‡ï¼Œæ¯”å¦‚MCUã€MACã€ONUç­‰ã€‚PHYä¸ºä»è®¾å¤‡ã€‚ä¸€ä¸ªSTAæœ€å¤šç®¡ç†32ä¸ªPHYã€‚MDCä¿¡å·ç”±STAæ§åˆ¶ï¼ŒMDIOä¿¡å·æ ¹æ®é€šä¿¡æ–¹å¼çš„ä¸åŒå¯ä»¥ç”±STAæˆ–è€…PHYæ¥ç®¡æ§åˆ¶ã€‚å¦‚å›¾é€šå¸¸MDIOä¼šæ¥ä¸€ä¸ªç”µé˜»ä¸Šæ‹‰è‡³æ¥å£ç”µæºã€‚</p>\n<p><img src=\"/../img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_16,color_FFFFFF,t_70,g_se,x_16.png\" alt=\"img\"></p>\n<h2 id=\"MDIOçš„ä½œç”¨\"><a href=\"#MDIOçš„ä½œç”¨\" class=\"headerlink\" title=\"MDIOçš„ä½œç”¨\"></a>MDIOçš„ä½œç”¨</h2><p>ä»ä¸Šé¢çš„è¿æ¥å›¾å¯ä»¥çœ‹åˆ°MDIOæ˜¯ç”¨æ¥è¿æ¥ä¸»è®¾å¤‡å’Œå¤šä¸ªPHYè®¾å¤‡ï¼Œå¹¶ä¸”é€šè¿‡MDIOæ¥ä¼ è¾“æ•°æ®</p>\n<p>é‚£ä¹ˆä¼ è¾“çš„æ˜¯æ•°æ®æ˜¯å“ªäº›å‘¢ï¼Ÿä¸»è¦æ˜¯ä¼ è¾“é“¾æ¥çŠ¶æ€ã€ä¼ è¾“é€Ÿåº¦ä¸é€‰æ‹©ã€æ–­ç”µã€ä½åŠŸç‡<a href=\"https://baike.baidu.com/item/%E4%BC%91%E7%9C%A0%E7%8A%B6%E6%80%81?fromModule=lemma_inlink\">ä¼‘çœ çŠ¶æ€</a>ã€TX&#x2F;RXæ¨¡å¼é€‰æ‹©ã€<a href=\"https://baike.baidu.com/item/%E8%87%AA%E5%8A%A8%E5%8D%8F%E5%95%86/7765053?fromModule=lemma_inlink\">è‡ªåŠ¨åå•†</a>æ§åˆ¶ã€ç¯å›æ¨¡å¼æ§åˆ¶ç­‰ã€‚</p>\n<h3 id=\"MDIOæ²¡é‚£ä¹ˆé‡è¦\"><a href=\"#MDIOæ²¡é‚£ä¹ˆé‡è¦\" class=\"headerlink\" title=\"MDIOæ²¡é‚£ä¹ˆé‡è¦\"></a>MDIOæ²¡é‚£ä¹ˆé‡è¦</h3><p>MDIOåœ¨ä¸Šé¢è¯´åˆ°çš„ä¸¤ä¸ªæ¨¡å—é€šä¿¡ï¼Œæˆ‘æåˆ°äº† armèŠ¯ç‰‡å’Œç½‘å¡èŠ¯ç‰‡ç›´æ¥éœ€è¦ï¼Œé‚£ä¹ˆè¿™ä¸ªçœŸçš„æœ‰å¿…è¦å—ï¼Ÿå…¶å®æ²¡å¿…è¦è¿æ¥ï¼ï¼ï¼</p>\n<p>æ¢ä¸ªè¯è¯´ ä¸è¿æ¥ä¹Ÿå¯ä»¥ä½¿å¾—ç½‘ç»œç•…é€šï¼Œå› ä¸ºç½‘ç»œçš„æ•°æ®ä¼ è¾“æ—¶é RGMIIä¸æ˜¯é MDIOï¼ŒMDIOçš„ä½œç”¨ä»…ä»…åªæ˜¯ç”¨æ¥æŸ¥çœ‹ä¸€äº›çŠ¶æ€å’ŒåŠŸèƒ½ï¼Œè¿˜æœ‰ç®€å•çš„æ§åˆ¶ï¼Œè€Œè¿™äº›ç®€å•çš„æ§åˆ¶æ˜¯å®Œå…¨å¯ä»¥æœ‰ç½‘å¡èŠ¯ç‰‡å†…ç½®å»å†™æ­»ï¼Œarmå±‚åªè¦å’Œç½‘å¡çš„å†™çš„ä¸€ç›´å°±å¯ä»¥é€šè®¯ã€‚</p>\n<p>ä½†æ˜¯ä¸ºä»€ä¹ˆå¾ˆå¤šæ—¶å€™éœ€è¦é€šè¿‡mdioæ¥è¿›è¡Œè¯»å†™æ§åˆ¶ï¼Œè¿™ä¸ªåªæ˜¯åœ¨ç½‘ç»œé€šè®¯æ­£å¸¸åçš„å‡çº§ä¼˜åŒ–ï¼Œç”¨æ¥æ–¹ä¾¿æŸ¥çœ‹çŠ¶æ€ï¼Œå°±åƒå†™äº†ä¸ªå‰ç«¯ç½‘é¡µæ¥çœ‹åå°æ•°æ®ã€‚</p>\n<p>å¦‚æœmidoæ²¡æœ‰è¯»é€šï¼Œæˆ–è€…è¯»å–çš„æ•°æ®æ˜¯0xfffffï¼Œé‚£ä¹ˆä¸ä¸€å®šæ˜¯mdioçš„é—®é¢˜ï¼Œå¾ˆå¤šæ—¶å€™æ˜¯ç½‘å¡æœ¬èº«æ²¡æœ‰å¯åŠ¨ï¼</p>\n<h2 id=\"MDIOè¯»å†™æ—¶åº\"><a href=\"#MDIOè¯»å†™æ—¶åº\" class=\"headerlink\" title=\"MDIOè¯»å†™æ—¶åº\"></a>MDIOè¯»å†™æ—¶åº</h2><p><img src=\"/../img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_18,color_FFFFFF,t_70,g_se,x_16.png\" alt=\"img\"></p>\n<p>Preambleï¼š32bitsçš„å‰å¯¼ç </p>\n<p>Startï¼š2bitçš„å¼€å§‹ä½ã€‚</p>\n<p>OP Codeï¼š2bitsçš„æ“ä½œç ï¼Œ10è¡¨ç¤ºè¯»ï¼Œ01è¡¨ç¤ºå†™ã€‚</p>\n<p>PHYADï¼š5bitsçš„PHYåœ°å€ã€‚</p>\n<p>REGADï¼š5bitsçš„å¯„å­˜å™¨åœ°å€ï¼Œå³è¦è¯»æˆ–å†™çš„å¯„å­˜å™¨ã€‚</p>\n<p>Turn Aroundï¼š2bitsçš„TAï¼Œåœ¨è¯»å‘½ä»¤ä¸­ï¼ŒMDIOåœ¨æ­¤æ—¶ç”±MACé©±åŠ¨æ”¹ä¸ºPHYé©±åŠ¨ï¼Œå¹¶ç­‰å¾…ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸå‡†å¤‡å‘é€æ•°æ®ã€‚åœ¨å†™å‘½ä»¤ä¸­ï¼Œä¸éœ€è¦MDIOæ–¹å‘å‘ç”Ÿå˜åŒ–ï¼Œåˆ™åªæ˜¯ç­‰å¾…ä¸¤ä¸ªæ—¶é’Ÿå‘¨æœŸå‡†å¤‡å†™å…¥æ•°æ®ã€‚</p>\n<p>Dataï¼š16bitsæ•°æ®ï¼Œåœ¨è¯»å‘½ä»¤ä¸­ï¼ŒPHYèŠ¯ç‰‡å°†è¯»åˆ°çš„å¯¹åº”PHYADçš„REGADå¯„å­˜å™¨çš„æ•°æ®å†™åˆ°Dataä¸­ï¼Œåœ¨å†™å‘½ä»¤ä¸­ï¼ŒMACå°†è¦å†™å…¥å¯¹åº”PHYADçš„REGADå¯„å­˜å™¨çš„å€¼å†™å…¥Dataä¸­ã€‚</p>\n<p>Idleï¼šç©ºé—²çŠ¶æ€ï¼Œæ­¤æ—¶MDIOæ— æºé©±åŠ¨ï¼Œå¤„é«˜é˜»çŠ¶æ€ï¼Œä½†ä¸€èˆ¬ç”¨ä¸Šæ‹‰ç”µé˜»ä½¿å…¶å¤„åœ¨é«˜ç”µå¹³ï¼Œä¸Šæ‹‰ç”µé˜»ä¸€èˆ¬ä¸º1.5Kã€‚<br>ä¸ºä»€ä¹ˆè¯´è¯»å–çš„phyæœ€å¤š32ä¸ª<br>å› ä¸ºmdioä¸­è¯»å–çš„phyåªæä¾›5bitçš„å­—èŠ‚å³æœ€é«˜11111 è½¬æˆåè¿›åˆ¶å°±æ˜¯31å³0-31å°±æ˜¯32ä¸ªï¼Œä½†è¿™æ˜¯ä»è¯»å–çš„æ–¹å¼åˆ¤æ–­çš„ï¼Œè€Œmdioè¯»å–æ˜¯ä¾ç…§phyèŠ¯ç‰‡æœ¬èº«åœ°å€ç©ºé—´å°±5ä¸º</p>\n<h2 id=\"ä¸ºä»€ä¹ˆè¯´regåœ°å€æœ€å¤š32ä¸ª\"><a href=\"#ä¸ºä»€ä¹ˆè¯´regåœ°å€æœ€å¤š32ä¸ª\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆè¯´regåœ°å€æœ€å¤š32ä¸ª\"></a>ä¸ºä»€ä¹ˆè¯´regåœ°å€æœ€å¤š32ä¸ª</h2><p>åŒæ ·mdioä¸­è¯»å–çš„regåªæä¾›5bitçš„å­—èŠ‚å³æœ€é«˜11111 è½¬æˆåè¿›åˆ¶å°±æ˜¯31å³0-31å°±æ˜¯32ä¸ª</p>\n<p> PHY èŠ¯ç‰‡å¯„å­˜å™¨åœ°å€ç©ºé—´ä¸º 5 ä½ï¼Œåœ°å€ 0-31 å…± 32 ä¸ªå¯„å­˜å™¨ï¼Œ IEEE å®šä¹‰äº† 0-15 è¿™ 16 ä¸ªå¯„å­˜å™¨çš„åŠŸèƒ½ï¼Œ 16<del>31 è¿™ 16 ä¸ªå¯„å­˜å™¨ç”±å‚å•†è‡ªè¡Œå®ç°ã€‚ ä¹Ÿå°±æ˜¯è¯´ä¸ç®¡ä½ ç”¨çš„å“ªä¸ªå‚å®¶çš„ PHY èŠ¯ç‰‡ï¼Œå…¶ä¸­ 0</del>15 è¿™ 16 ä¸ªå¯„å­˜å™¨æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚ ä»…é è¿™ 16 ä¸ªå¯„å­˜å™¨æ˜¯å®Œå…¨å¯ä»¥é©±åŠ¨èµ· PHY èŠ¯ç‰‡çš„ï¼Œè‡³å°‘èƒ½ä¿è¯åŸºæœ¬çš„ç½‘ç»œæ•°æ®é€šä¿¡ã€‚</p>\n<p><a href=\"https://blog.csdn.net/qq_40715266/article/details/124095801\">PHYèŠ¯ç‰‡å¿«é€Ÿæ·±åº¦ç†è§£ï¼ˆæŒç»­æ›´æ–°ä¸­â€¦â€¦ï¼‰-CSDNåšå®¢</a></p>\n<p><a href=\"https://zhuanlan.zhihu.com/p/148538791\">PHYï¼ˆPhysical Layerï¼ŒPHYï¼‰ - çŸ¥ä¹ (zhihu.com)</a></p>\n"}],"Post":[{"title":"00-rustå­¦ä¹ ç½‘ç«™","date":"2023-08-26T08:08:57.000Z","_content":"\n\n\n# ç›¸å…³ç½‘ç«™\n\n[GitHub-rust](https://github.com/sunface/rust-course)\n\n[å…³äºæœ¬ä¹¦ - Rustè¯­è¨€åœ£ç»(Rust Course)](https://course.rs/about-book.html)\n","source":"_posts/00-rustå­¦ä¹ ç½‘ç«™.md","raw":"---\ntitle: 00-rustå­¦ä¹ ç½‘ç«™\ndate: 2023-08-26 16:08:57\ncategories:\n- rust\ntags:\n- å­¦ä¹ ç½‘ç«™\n- rust\n---\n\n\n\n# ç›¸å…³ç½‘ç«™\n\n[GitHub-rust](https://github.com/sunface/rust-course)\n\n[å…³äºæœ¬ä¹¦ - Rustè¯­è¨€åœ£ç»(Rust Course)](https://course.rs/about-book.html)\n","slug":"00-rustå­¦ä¹ ç½‘ç«™","published":1,"updated":"2024-05-15T06:26:36.420Z","_id":"clvjcoaak0000r9w096yq3vus","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"ç›¸å…³ç½‘ç«™\"><a href=\"#ç›¸å…³ç½‘ç«™\" class=\"headerlink\" title=\"ç›¸å…³ç½‘ç«™\"></a>ç›¸å…³ç½‘ç«™</h1><p><a href=\"https://github.com/sunface/rust-course\">GitHub-rust</a></p>\n<p><a href=\"https://course.rs/about-book.html\">å…³äºæœ¬ä¹¦ - Rustè¯­è¨€åœ£ç»(Rust Course)</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"ç›¸å…³ç½‘ç«™\"><a href=\"#ç›¸å…³ç½‘ç«™\" class=\"headerlink\" title=\"ç›¸å…³ç½‘ç«™\"></a>ç›¸å…³ç½‘ç«™</h1><p><a href=\"https://github.com/sunface/rust-course\">GitHub-rust</a></p>\n<p><a href=\"https://course.rs/about-book.html\">å…³äºæœ¬ä¹¦ - Rustè¯­è¨€åœ£ç»(Rust Course)</a></p>\n"},{"title":"01-rustç¯å¢ƒæ­å»º","date":"2023-08-26T09:03:59.000Z","_content":"\n\n\n\n\n\n\n\n\n\n\nå½“å‰ç¯å¢ƒï¼šwin11+wsl+vscode\n\n## 1.å®‰è£…rustup\n\n```\ncurl --proto '=https' --tlsv1.2 https://sh.rustup.rs -sSf | sh\nsudo apt install build-essential\nrustc -V \ncargo -V\n```\n\n## 2.å®‰è£…vsocodeæ’ä»¶\n\n```\nrust-analyzer ï¼ŒRust è¯­è¨€æ’ä»¶\nEven Better TOMLï¼Œæ”¯æŒ .toml æ–‡ä»¶å®Œæ•´ç‰¹æ€§\nError Lens, æ›´å¥½çš„è·å¾—é”™è¯¯å±•ç¤º\nOne Dark Pro, éå¸¸å¥½çœ‹çš„ VSCode ä¸»é¢˜\nCodeLLDB, Debugger ç¨‹åº\n```\n\n## 3.è¿è¡Œhello world!\n\n```\ncargo new world_hello\ncd world_hello\ncargo run\n#ç¼–è¯‘\ncargo build\n#è¿è¡Œ\n./target/debug/world_hello\nHello, world!\n#å¿«é€Ÿçš„æ£€æŸ¥ä¸€ä¸‹ä»£ç èƒ½å¦ç¼–è¯‘é€šè¿‡\ncargo check\n```\n\n## 4.ä¿®æ”¹ Rust çš„ä¸‹è½½é•œåƒä¸ºå›½å†…çš„é•œåƒåœ°å€\n\n```\n#åœ¨ $HOME/.cargo/config.toml æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š\n\n[source.crates-io]\nreplace-with = 'ustc'\n\n[source.ustc]\nregistry = \"git://mirrors.ustc.edu.cn/crates.io-index\"\n```\n\n","source":"_posts/01-rustç¯å¢ƒæ­å»º.md","raw":"---\ntitle: 01-rustç¯å¢ƒæ­å»º\ndate: 2023-08-26 17:03:59\ncategories:\n- rust\ntags:\n- rustç¯å¢ƒæ­å»º\n- rust\n---\n\n\n\n\n\n\n\n\n\n\n\nå½“å‰ç¯å¢ƒï¼šwin11+wsl+vscode\n\n## 1.å®‰è£…rustup\n\n```\ncurl --proto '=https' --tlsv1.2 https://sh.rustup.rs -sSf | sh\nsudo apt install build-essential\nrustc -V \ncargo -V\n```\n\n## 2.å®‰è£…vsocodeæ’ä»¶\n\n```\nrust-analyzer ï¼ŒRust è¯­è¨€æ’ä»¶\nEven Better TOMLï¼Œæ”¯æŒ .toml æ–‡ä»¶å®Œæ•´ç‰¹æ€§\nError Lens, æ›´å¥½çš„è·å¾—é”™è¯¯å±•ç¤º\nOne Dark Pro, éå¸¸å¥½çœ‹çš„ VSCode ä¸»é¢˜\nCodeLLDB, Debugger ç¨‹åº\n```\n\n## 3.è¿è¡Œhello world!\n\n```\ncargo new world_hello\ncd world_hello\ncargo run\n#ç¼–è¯‘\ncargo build\n#è¿è¡Œ\n./target/debug/world_hello\nHello, world!\n#å¿«é€Ÿçš„æ£€æŸ¥ä¸€ä¸‹ä»£ç èƒ½å¦ç¼–è¯‘é€šè¿‡\ncargo check\n```\n\n## 4.ä¿®æ”¹ Rust çš„ä¸‹è½½é•œåƒä¸ºå›½å†…çš„é•œåƒåœ°å€\n\n```\n#åœ¨ $HOME/.cargo/config.toml æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š\n\n[source.crates-io]\nreplace-with = 'ustc'\n\n[source.ustc]\nregistry = \"git://mirrors.ustc.edu.cn/crates.io-index\"\n```\n\n","slug":"01-rustç¯å¢ƒæ­å»º","published":1,"updated":"2024-04-28T07:13:38.745Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clvjcoaao0001r9w0de539y4w","content":"<p>å½“å‰ç¯å¢ƒï¼šwin11+wsl+vscode</p>\n<h2 id=\"1-å®‰è£…rustup\"><a href=\"#1-å®‰è£…rustup\" class=\"headerlink\" title=\"1.å®‰è£…rustup\"></a>1.å®‰è£…rustup</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl --proto &#x27;=https&#x27; --tlsv1.2 https://sh.rustup.rs -sSf | sh</span><br><span class=\"line\">sudo apt install build-essential</span><br><span class=\"line\">rustc -V </span><br><span class=\"line\">cargo -V</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2-å®‰è£…vsocodeæ’ä»¶\"><a href=\"#2-å®‰è£…vsocodeæ’ä»¶\" class=\"headerlink\" title=\"2.å®‰è£…vsocodeæ’ä»¶\"></a>2.å®‰è£…vsocodeæ’ä»¶</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rust-analyzer ï¼ŒRust è¯­è¨€æ’ä»¶</span><br><span class=\"line\">Even Better TOMLï¼Œæ”¯æŒ .toml æ–‡ä»¶å®Œæ•´ç‰¹æ€§</span><br><span class=\"line\">Error Lens, æ›´å¥½çš„è·å¾—é”™è¯¯å±•ç¤º</span><br><span class=\"line\">One Dark Pro, éå¸¸å¥½çœ‹çš„ VSCode ä¸»é¢˜</span><br><span class=\"line\">CodeLLDB, Debugger ç¨‹åº</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3-è¿è¡Œhello-world\"><a href=\"#3-è¿è¡Œhello-world\" class=\"headerlink\" title=\"3.è¿è¡Œhello world!\"></a>3.è¿è¡Œhello world!</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cargo new world_hello</span><br><span class=\"line\">cd world_hello</span><br><span class=\"line\">cargo run</span><br><span class=\"line\">#ç¼–è¯‘</span><br><span class=\"line\">cargo build</span><br><span class=\"line\">#è¿è¡Œ</span><br><span class=\"line\">./target/debug/world_hello</span><br><span class=\"line\">Hello, world!</span><br><span class=\"line\">#å¿«é€Ÿçš„æ£€æŸ¥ä¸€ä¸‹ä»£ç èƒ½å¦ç¼–è¯‘é€šè¿‡</span><br><span class=\"line\">cargo check</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"4-ä¿®æ”¹-Rust-çš„ä¸‹è½½é•œåƒä¸ºå›½å†…çš„é•œåƒåœ°å€\"><a href=\"#4-ä¿®æ”¹-Rust-çš„ä¸‹è½½é•œåƒä¸ºå›½å†…çš„é•œåƒåœ°å€\" class=\"headerlink\" title=\"4.ä¿®æ”¹ Rust çš„ä¸‹è½½é•œåƒä¸ºå›½å†…çš„é•œåƒåœ°å€\"></a>4.ä¿®æ”¹ Rust çš„ä¸‹è½½é•œåƒä¸ºå›½å†…çš„é•œåƒåœ°å€</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#åœ¨ $HOME/.cargo/config.toml æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</span><br><span class=\"line\"></span><br><span class=\"line\">[source.crates-io]</span><br><span class=\"line\">replace-with = &#x27;ustc&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">[source.ustc]</span><br><span class=\"line\">registry = &quot;git://mirrors.ustc.edu.cn/crates.io-index&quot;</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<p>å½“å‰ç¯å¢ƒï¼šwin11+wsl+vscode</p>\n<h2 id=\"1-å®‰è£…rustup\"><a href=\"#1-å®‰è£…rustup\" class=\"headerlink\" title=\"1.å®‰è£…rustup\"></a>1.å®‰è£…rustup</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl --proto &#x27;=https&#x27; --tlsv1.2 https://sh.rustup.rs -sSf | sh</span><br><span class=\"line\">sudo apt install build-essential</span><br><span class=\"line\">rustc -V </span><br><span class=\"line\">cargo -V</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2-å®‰è£…vsocodeæ’ä»¶\"><a href=\"#2-å®‰è£…vsocodeæ’ä»¶\" class=\"headerlink\" title=\"2.å®‰è£…vsocodeæ’ä»¶\"></a>2.å®‰è£…vsocodeæ’ä»¶</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rust-analyzer ï¼ŒRust è¯­è¨€æ’ä»¶</span><br><span class=\"line\">Even Better TOMLï¼Œæ”¯æŒ .toml æ–‡ä»¶å®Œæ•´ç‰¹æ€§</span><br><span class=\"line\">Error Lens, æ›´å¥½çš„è·å¾—é”™è¯¯å±•ç¤º</span><br><span class=\"line\">One Dark Pro, éå¸¸å¥½çœ‹çš„ VSCode ä¸»é¢˜</span><br><span class=\"line\">CodeLLDB, Debugger ç¨‹åº</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3-è¿è¡Œhello-world\"><a href=\"#3-è¿è¡Œhello-world\" class=\"headerlink\" title=\"3.è¿è¡Œhello world!\"></a>3.è¿è¡Œhello world!</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cargo new world_hello</span><br><span class=\"line\">cd world_hello</span><br><span class=\"line\">cargo run</span><br><span class=\"line\">#ç¼–è¯‘</span><br><span class=\"line\">cargo build</span><br><span class=\"line\">#è¿è¡Œ</span><br><span class=\"line\">./target/debug/world_hello</span><br><span class=\"line\">Hello, world!</span><br><span class=\"line\">#å¿«é€Ÿçš„æ£€æŸ¥ä¸€ä¸‹ä»£ç èƒ½å¦ç¼–è¯‘é€šè¿‡</span><br><span class=\"line\">cargo check</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"4-ä¿®æ”¹-Rust-çš„ä¸‹è½½é•œåƒä¸ºå›½å†…çš„é•œåƒåœ°å€\"><a href=\"#4-ä¿®æ”¹-Rust-çš„ä¸‹è½½é•œåƒä¸ºå›½å†…çš„é•œåƒåœ°å€\" class=\"headerlink\" title=\"4.ä¿®æ”¹ Rust çš„ä¸‹è½½é•œåƒä¸ºå›½å†…çš„é•œåƒåœ°å€\"></a>4.ä¿®æ”¹ Rust çš„ä¸‹è½½é•œåƒä¸ºå›½å†…çš„é•œåƒåœ°å€</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#åœ¨ $HOME/.cargo/config.toml æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</span><br><span class=\"line\"></span><br><span class=\"line\">[source.crates-io]</span><br><span class=\"line\">replace-with = &#x27;ustc&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">[source.ustc]</span><br><span class=\"line\">registry = &quot;git://mirrors.ustc.edu.cn/crates.io-index&quot;</span><br></pre></td></tr></table></figure>\n\n"},{"title":"github+hexo åšå®¢æ­å»º","date":"2023-08-25T11:32:35.000Z","_content":"\n\n@[toc]\nç¯å¢ƒï¼šwin11+wsl\n## 1.å®‰è£…Node.jsã€Gitå’ŒHexo\næ‰“å¼€ç»ˆç«¯å®‰è£…ä»¥ä¸‹è½¯ä»¶\n```\nsudo apt update\nsudo apt-get install git\n\nsudo apt install nodejs\nsudo apt install npm        #Node.js çš„åŒ…ç®¡ç†å™¨\nsudo npm install -g hexo-cli        #å®‰è£…hexo\n```\n## 2.åˆ›å»º GitHub ä»“åº“å¹¶é…ç½®ssh\nç™»å½•ä½ çš„ GitHub å¸å·ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„ä»“åº“ï¼Œä»“åº“åæ˜¯ `<username>.github.io`ï¼Œå…¶ä¸­ `<username>` æ˜¯ä½ çš„ GitHub ç”¨æˆ·åã€‚å°†è¯¥ä»“åº“è®¾ç½®ä¸ºå…¬å¼€ä»“åº“ã€‚\nè®¾ç½®ssh\n```\nssh-keygen -t rsa -C 'xxx@xxx.com'  #è‡ªå·±çš„é‚®ç®±\ncat ~/.ssh/id_rsa.pub  #å°†é‡Œé¢çš„å†…å®¹å¤åˆ¶åˆ° github ->settings ->SSH and GPC keys ->SSH keys ->New SSH keyä¸­\nssh -T git@github.com  #è¾“å…¥yesä¹‹åï¼Œè¡Œæœ«å°¾ä¼šæ˜¾ç¤ºä½ çš„ç”¨æˆ·åï¼ˆç»‘å®šæˆåŠŸé‚®ç®±ä¼šæ”¶åˆ°é‚®ä»¶æé†’ï¼‰\n#æ¥ç€åœ¨æœ¬åœ°ç»‘å®šä¸Githubçš„ç”¨æˆ·åå’Œé‚®ç®±ï¼ˆgitï¼‰\ngit config --global user.name \"<username>\"    #è‡ªå·±çš„ç”¨æˆ·å\ngit config --global user.email 'xxx@xxx.com'  #è‡ªå·±çš„é‚®ç®±\n```\n## 3.åˆå§‹åŒ–Hexo\nåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹ï¼Œç”¨äºå­˜å‚¨ä½ çš„åšå®¢é¡¹ç›®ã€‚\nåœ¨ç»ˆç«¯ä¸­ï¼Œè¿›å…¥è¯¥æ–‡ä»¶å¤¹ï¼Œå¹¶è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥åˆå§‹åŒ– Hexo\n```\nmkdir myblog\nhexo init    \n#æˆ–è€…ç›´æ¥ä¸€æ­¥åˆ°ä½ \nhexo init myblog\n```\n## 4.é…ç½®Hexo\n- è¿›å…¥ä½ çš„ Hexo é¡¹ç›®æ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ° _config.yml æ–‡ä»¶ï¼Œä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€å®ƒã€‚\n- åœ¨ _config.yml æ–‡ä»¶ä¸­ï¼Œé…ç½®ä½ çš„åšå®¢è®¾ç½®ï¼Œä¾‹å¦‚æ ‡é¢˜ã€æè¿°ã€ä½œè€…ç­‰ã€‚\n- æ ¹æ®éœ€è¦ï¼Œä½ è¿˜å¯ä»¥é…ç½®ä¸»é¢˜ã€æ’ä»¶å’Œå…¶ä»– Hexo é€‰é¡¹ã€‚\nç¼–è¾‘_config.ymlæ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ \n```\ndeploy:\n        type: git\n        repo: git@github.com: <username>/ <username>.github.io.git  #<username>ä¸ºè‡ªå·±çš„ç”¨æˆ·å\n        branch: main\n```\n```\nnpm install hexo-deployer-git    #å®‰è£… hexo-deployer-git æ’ä»¶ å°†éƒ¨ç½²è¿‡ç¨‹è‡ªåŠ¨åŒ–\n```\n## 5.åˆ›å»ºåšå®¢å†…å®¹\nåœ¨ç»ˆç«¯ä¸­ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥åˆ›å»ºæ–°çš„åšå®¢æ–‡ç« ï¼š\n```\nhexo new \"My First Post\"\n```\nè¿™å°†åœ¨ Hexo é¡¹ç›®çš„ source/_posts ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–°çš„ Markdown æ–‡ä»¶ï¼Œç”¨äºç¼–å†™ä½ çš„ç¬¬ä¸€ç¯‡åšå®¢æ–‡ç« ã€‚\n## 6.éƒ¨ç½²\n```\nhexo s    # é¢„è§ˆ\n#Hexo is running at http://localhost:4000/ . Press Ctrl+C to stop.\n#ç”¨æµè§ˆå™¨æ‰“å¼€ http://localhost:4000/\nhexo g #ç”Ÿæˆé™æ€ç½‘ç«™æ–‡ä»¶\nhexo d #å°†ç”Ÿæˆçš„é™æ€ç½‘ç«™æ–‡ä»¶éƒ¨ç½²åˆ°github\n```\n## 7.æŸ¥çœ‹\næµè§ˆå™¨æ‰“å¼€`<username>.github.io`å³å¯æŸ¥çœ‹\n\n\n## 8.å‚è€ƒï¼š\nhttps://blog.csdn.net/qq_62928039/article/details/130248518\n\n## 9.é€‰æ‹©ä¸»é¢˜ï¼š\nhttps://hexo.io/themes/\nhttps://github.com/yelog/hexo-theme-3-hexo\n```\n#åœ¨hexoæ ¹ç›®å½•ä¸‹\ngit clone https://github.com/yelog/hexo-theme-3-hexo.git themes/3-hexo\n#ä¿®æ”¹hexoæ ¹ç›®å½•çš„_config.ymlï¼Œå¦‚ä¸‹\ntheme: 3-hexo\n#åšå®¢é…ç½®\nhttp://yelog.org/2017/03/23/3-hexo-instruction/\n```\næœ€ç»ˆæ•ˆæœï¼š\nhttps://yyheroi.github.io\n","source":"_posts/github+hexoåšå®¢æ­å»º.md","raw":"---\ntitle: github+hexo åšå®¢æ­å»º\ndate: 2023-08-25 19:32:35\ncategories:\n- test\ntags:\n- test\n---\n\n\n@[toc]\nç¯å¢ƒï¼šwin11+wsl\n## 1.å®‰è£…Node.jsã€Gitå’ŒHexo\næ‰“å¼€ç»ˆç«¯å®‰è£…ä»¥ä¸‹è½¯ä»¶\n```\nsudo apt update\nsudo apt-get install git\n\nsudo apt install nodejs\nsudo apt install npm        #Node.js çš„åŒ…ç®¡ç†å™¨\nsudo npm install -g hexo-cli        #å®‰è£…hexo\n```\n## 2.åˆ›å»º GitHub ä»“åº“å¹¶é…ç½®ssh\nç™»å½•ä½ çš„ GitHub å¸å·ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„ä»“åº“ï¼Œä»“åº“åæ˜¯ `<username>.github.io`ï¼Œå…¶ä¸­ `<username>` æ˜¯ä½ çš„ GitHub ç”¨æˆ·åã€‚å°†è¯¥ä»“åº“è®¾ç½®ä¸ºå…¬å¼€ä»“åº“ã€‚\nè®¾ç½®ssh\n```\nssh-keygen -t rsa -C 'xxx@xxx.com'  #è‡ªå·±çš„é‚®ç®±\ncat ~/.ssh/id_rsa.pub  #å°†é‡Œé¢çš„å†…å®¹å¤åˆ¶åˆ° github ->settings ->SSH and GPC keys ->SSH keys ->New SSH keyä¸­\nssh -T git@github.com  #è¾“å…¥yesä¹‹åï¼Œè¡Œæœ«å°¾ä¼šæ˜¾ç¤ºä½ çš„ç”¨æˆ·åï¼ˆç»‘å®šæˆåŠŸé‚®ç®±ä¼šæ”¶åˆ°é‚®ä»¶æé†’ï¼‰\n#æ¥ç€åœ¨æœ¬åœ°ç»‘å®šä¸Githubçš„ç”¨æˆ·åå’Œé‚®ç®±ï¼ˆgitï¼‰\ngit config --global user.name \"<username>\"    #è‡ªå·±çš„ç”¨æˆ·å\ngit config --global user.email 'xxx@xxx.com'  #è‡ªå·±çš„é‚®ç®±\n```\n## 3.åˆå§‹åŒ–Hexo\nåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹ï¼Œç”¨äºå­˜å‚¨ä½ çš„åšå®¢é¡¹ç›®ã€‚\nåœ¨ç»ˆç«¯ä¸­ï¼Œè¿›å…¥è¯¥æ–‡ä»¶å¤¹ï¼Œå¹¶è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥åˆå§‹åŒ– Hexo\n```\nmkdir myblog\nhexo init    \n#æˆ–è€…ç›´æ¥ä¸€æ­¥åˆ°ä½ \nhexo init myblog\n```\n## 4.é…ç½®Hexo\n- è¿›å…¥ä½ çš„ Hexo é¡¹ç›®æ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ° _config.yml æ–‡ä»¶ï¼Œä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€å®ƒã€‚\n- åœ¨ _config.yml æ–‡ä»¶ä¸­ï¼Œé…ç½®ä½ çš„åšå®¢è®¾ç½®ï¼Œä¾‹å¦‚æ ‡é¢˜ã€æè¿°ã€ä½œè€…ç­‰ã€‚\n- æ ¹æ®éœ€è¦ï¼Œä½ è¿˜å¯ä»¥é…ç½®ä¸»é¢˜ã€æ’ä»¶å’Œå…¶ä»– Hexo é€‰é¡¹ã€‚\nç¼–è¾‘_config.ymlæ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ \n```\ndeploy:\n        type: git\n        repo: git@github.com: <username>/ <username>.github.io.git  #<username>ä¸ºè‡ªå·±çš„ç”¨æˆ·å\n        branch: main\n```\n```\nnpm install hexo-deployer-git    #å®‰è£… hexo-deployer-git æ’ä»¶ å°†éƒ¨ç½²è¿‡ç¨‹è‡ªåŠ¨åŒ–\n```\n## 5.åˆ›å»ºåšå®¢å†…å®¹\nåœ¨ç»ˆç«¯ä¸­ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥åˆ›å»ºæ–°çš„åšå®¢æ–‡ç« ï¼š\n```\nhexo new \"My First Post\"\n```\nè¿™å°†åœ¨ Hexo é¡¹ç›®çš„ source/_posts ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–°çš„ Markdown æ–‡ä»¶ï¼Œç”¨äºç¼–å†™ä½ çš„ç¬¬ä¸€ç¯‡åšå®¢æ–‡ç« ã€‚\n## 6.éƒ¨ç½²\n```\nhexo s    # é¢„è§ˆ\n#Hexo is running at http://localhost:4000/ . Press Ctrl+C to stop.\n#ç”¨æµè§ˆå™¨æ‰“å¼€ http://localhost:4000/\nhexo g #ç”Ÿæˆé™æ€ç½‘ç«™æ–‡ä»¶\nhexo d #å°†ç”Ÿæˆçš„é™æ€ç½‘ç«™æ–‡ä»¶éƒ¨ç½²åˆ°github\n```\n## 7.æŸ¥çœ‹\næµè§ˆå™¨æ‰“å¼€`<username>.github.io`å³å¯æŸ¥çœ‹\n\n\n## 8.å‚è€ƒï¼š\nhttps://blog.csdn.net/qq_62928039/article/details/130248518\n\n## 9.é€‰æ‹©ä¸»é¢˜ï¼š\nhttps://hexo.io/themes/\nhttps://github.com/yelog/hexo-theme-3-hexo\n```\n#åœ¨hexoæ ¹ç›®å½•ä¸‹\ngit clone https://github.com/yelog/hexo-theme-3-hexo.git themes/3-hexo\n#ä¿®æ”¹hexoæ ¹ç›®å½•çš„_config.ymlï¼Œå¦‚ä¸‹\ntheme: 3-hexo\n#åšå®¢é…ç½®\nhttp://yelog.org/2017/03/23/3-hexo-instruction/\n```\næœ€ç»ˆæ•ˆæœï¼š\nhttps://yyheroi.github.io\n","slug":"github+hexoåšå®¢æ­å»º","published":1,"updated":"2024-04-28T07:13:38.769Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clvjcoaar0004r9w0en6ne5w9","content":"<p>@[toc]<br>ç¯å¢ƒï¼šwin11+wsl</p>\n<h2 id=\"1-å®‰è£…Node-jsã€Gitå’ŒHexo\"><a href=\"#1-å®‰è£…Node-jsã€Gitå’ŒHexo\" class=\"headerlink\" title=\"1.å®‰è£…Node.jsã€Gitå’ŒHexo\"></a>1.å®‰è£…Node.jsã€Gitå’ŒHexo</h2><p>æ‰“å¼€ç»ˆç«¯å®‰è£…ä»¥ä¸‹è½¯ä»¶</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt update</span><br><span class=\"line\">sudo apt-get install git</span><br><span class=\"line\"></span><br><span class=\"line\">sudo apt install nodejs</span><br><span class=\"line\">sudo apt install npm        #Node.js çš„åŒ…ç®¡ç†å™¨</span><br><span class=\"line\">sudo npm install -g hexo-cli        #å®‰è£…hexo</span><br></pre></td></tr></table></figure>\n<h2 id=\"2-åˆ›å»º-GitHub-ä»“åº“å¹¶é…ç½®ssh\"><a href=\"#2-åˆ›å»º-GitHub-ä»“åº“å¹¶é…ç½®ssh\" class=\"headerlink\" title=\"2.åˆ›å»º GitHub ä»“åº“å¹¶é…ç½®ssh\"></a>2.åˆ›å»º GitHub ä»“åº“å¹¶é…ç½®ssh</h2><p>ç™»å½•ä½ çš„ GitHub å¸å·ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„ä»“åº“ï¼Œä»“åº“åæ˜¯ <code>&lt;username&gt;.github.io</code>ï¼Œå…¶ä¸­ <code>&lt;username&gt;</code> æ˜¯ä½ çš„ GitHub ç”¨æˆ·åã€‚å°†è¯¥ä»“åº“è®¾ç½®ä¸ºå…¬å¼€ä»“åº“ã€‚<br>è®¾ç½®ssh</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa -C &#x27;xxx@xxx.com&#x27;  #è‡ªå·±çš„é‚®ç®±</span><br><span class=\"line\">cat ~/.ssh/id_rsa.pub  #å°†é‡Œé¢çš„å†…å®¹å¤åˆ¶åˆ° github -&gt;settings -&gt;SSH and GPC keys -&gt;SSH keys -&gt;New SSH keyä¸­</span><br><span class=\"line\">ssh -T git@github.com  #è¾“å…¥yesä¹‹åï¼Œè¡Œæœ«å°¾ä¼šæ˜¾ç¤ºä½ çš„ç”¨æˆ·åï¼ˆç»‘å®šæˆåŠŸé‚®ç®±ä¼šæ”¶åˆ°é‚®ä»¶æé†’ï¼‰</span><br><span class=\"line\">#æ¥ç€åœ¨æœ¬åœ°ç»‘å®šä¸Githubçš„ç”¨æˆ·åå’Œé‚®ç®±ï¼ˆgitï¼‰</span><br><span class=\"line\">git config --global user.name &quot;&lt;username&gt;&quot;    #è‡ªå·±çš„ç”¨æˆ·å</span><br><span class=\"line\">git config --global user.email &#x27;xxx@xxx.com&#x27;  #è‡ªå·±çš„é‚®ç®±</span><br></pre></td></tr></table></figure>\n<h2 id=\"3-åˆå§‹åŒ–Hexo\"><a href=\"#3-åˆå§‹åŒ–Hexo\" class=\"headerlink\" title=\"3.åˆå§‹åŒ–Hexo\"></a>3.åˆå§‹åŒ–Hexo</h2><p>åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹ï¼Œç”¨äºå­˜å‚¨ä½ çš„åšå®¢é¡¹ç›®ã€‚<br>åœ¨ç»ˆç«¯ä¸­ï¼Œè¿›å…¥è¯¥æ–‡ä»¶å¤¹ï¼Œå¹¶è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥åˆå§‹åŒ– Hexo</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir myblog</span><br><span class=\"line\">hexo init    </span><br><span class=\"line\">#æˆ–è€…ç›´æ¥ä¸€æ­¥åˆ°ä½ </span><br><span class=\"line\">hexo init myblog</span><br></pre></td></tr></table></figure>\n<h2 id=\"4-é…ç½®Hexo\"><a href=\"#4-é…ç½®Hexo\" class=\"headerlink\" title=\"4.é…ç½®Hexo\"></a>4.é…ç½®Hexo</h2><ul>\n<li>è¿›å…¥ä½ çš„ Hexo é¡¹ç›®æ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ° _config.yml æ–‡ä»¶ï¼Œä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€å®ƒã€‚</li>\n<li>åœ¨ _config.yml æ–‡ä»¶ä¸­ï¼Œé…ç½®ä½ çš„åšå®¢è®¾ç½®ï¼Œä¾‹å¦‚æ ‡é¢˜ã€æè¿°ã€ä½œè€…ç­‰ã€‚</li>\n<li>æ ¹æ®éœ€è¦ï¼Œä½ è¿˜å¯ä»¥é…ç½®ä¸»é¢˜ã€æ’ä»¶å’Œå…¶ä»– Hexo é€‰é¡¹ã€‚<br>ç¼–è¾‘_config.ymlæ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">deploy:</span><br><span class=\"line\">        type: git</span><br><span class=\"line\">        repo: git@github.com: &lt;username&gt;/ &lt;username&gt;.github.io.git  #&lt;username&gt;ä¸ºè‡ªå·±çš„ç”¨æˆ·å</span><br><span class=\"line\">        branch: main</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install hexo-deployer-git    #å®‰è£… hexo-deployer-git æ’ä»¶ å°†éƒ¨ç½²è¿‡ç¨‹è‡ªåŠ¨åŒ–</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h2 id=\"5-åˆ›å»ºåšå®¢å†…å®¹\"><a href=\"#5-åˆ›å»ºåšå®¢å†…å®¹\" class=\"headerlink\" title=\"5.åˆ›å»ºåšå®¢å†…å®¹\"></a>5.åˆ›å»ºåšå®¢å†…å®¹</h2><p>åœ¨ç»ˆç«¯ä¸­ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥åˆ›å»ºæ–°çš„åšå®¢æ–‡ç« ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo new &quot;My First Post&quot;</span><br></pre></td></tr></table></figure>\n<p>è¿™å°†åœ¨ Hexo é¡¹ç›®çš„ source&#x2F;_posts ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–°çš„ Markdown æ–‡ä»¶ï¼Œç”¨äºç¼–å†™ä½ çš„ç¬¬ä¸€ç¯‡åšå®¢æ–‡ç« ã€‚</p>\n<h2 id=\"6-éƒ¨ç½²\"><a href=\"#6-éƒ¨ç½²\" class=\"headerlink\" title=\"6.éƒ¨ç½²\"></a>6.éƒ¨ç½²</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo s    # é¢„è§ˆ</span><br><span class=\"line\">#Hexo is running at http://localhost:4000/ . Press Ctrl+C to stop.</span><br><span class=\"line\">#ç”¨æµè§ˆå™¨æ‰“å¼€ http://localhost:4000/</span><br><span class=\"line\">hexo g #ç”Ÿæˆé™æ€ç½‘ç«™æ–‡ä»¶</span><br><span class=\"line\">hexo d #å°†ç”Ÿæˆçš„é™æ€ç½‘ç«™æ–‡ä»¶éƒ¨ç½²åˆ°github</span><br></pre></td></tr></table></figure>\n<h2 id=\"7-æŸ¥çœ‹\"><a href=\"#7-æŸ¥çœ‹\" class=\"headerlink\" title=\"7.æŸ¥çœ‹\"></a>7.æŸ¥çœ‹</h2><p>æµè§ˆå™¨æ‰“å¼€<code>&lt;username&gt;.github.io</code>å³å¯æŸ¥çœ‹</p>\n<h2 id=\"8-å‚è€ƒï¼š\"><a href=\"#8-å‚è€ƒï¼š\" class=\"headerlink\" title=\"8.å‚è€ƒï¼š\"></a>8.å‚è€ƒï¼š</h2><p><a href=\"https://blog.csdn.net/qq_62928039/article/details/130248518\">https://blog.csdn.net/qq_62928039/article/details/130248518</a></p>\n<h2 id=\"9-é€‰æ‹©ä¸»é¢˜ï¼š\"><a href=\"#9-é€‰æ‹©ä¸»é¢˜ï¼š\" class=\"headerlink\" title=\"9.é€‰æ‹©ä¸»é¢˜ï¼š\"></a>9.é€‰æ‹©ä¸»é¢˜ï¼š</h2><p><a href=\"https://hexo.io/themes/\">https://hexo.io/themes/</a><br><a href=\"https://github.com/yelog/hexo-theme-3-hexo\">https://github.com/yelog/hexo-theme-3-hexo</a></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#åœ¨hexoæ ¹ç›®å½•ä¸‹</span><br><span class=\"line\">git clone https://github.com/yelog/hexo-theme-3-hexo.git themes/3-hexo</span><br><span class=\"line\">#ä¿®æ”¹hexoæ ¹ç›®å½•çš„_config.ymlï¼Œå¦‚ä¸‹</span><br><span class=\"line\">theme: 3-hexo</span><br><span class=\"line\">#åšå®¢é…ç½®</span><br><span class=\"line\">http://yelog.org/2017/03/23/3-hexo-instruction/</span><br></pre></td></tr></table></figure>\n<p>æœ€ç»ˆæ•ˆæœï¼š<br><a href=\"https://yyheroi.github.io/\">https://yyheroi.github.io</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p>@[toc]<br>ç¯å¢ƒï¼šwin11+wsl</p>\n<h2 id=\"1-å®‰è£…Node-jsã€Gitå’ŒHexo\"><a href=\"#1-å®‰è£…Node-jsã€Gitå’ŒHexo\" class=\"headerlink\" title=\"1.å®‰è£…Node.jsã€Gitå’ŒHexo\"></a>1.å®‰è£…Node.jsã€Gitå’ŒHexo</h2><p>æ‰“å¼€ç»ˆç«¯å®‰è£…ä»¥ä¸‹è½¯ä»¶</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt update</span><br><span class=\"line\">sudo apt-get install git</span><br><span class=\"line\"></span><br><span class=\"line\">sudo apt install nodejs</span><br><span class=\"line\">sudo apt install npm        #Node.js çš„åŒ…ç®¡ç†å™¨</span><br><span class=\"line\">sudo npm install -g hexo-cli        #å®‰è£…hexo</span><br></pre></td></tr></table></figure>\n<h2 id=\"2-åˆ›å»º-GitHub-ä»“åº“å¹¶é…ç½®ssh\"><a href=\"#2-åˆ›å»º-GitHub-ä»“åº“å¹¶é…ç½®ssh\" class=\"headerlink\" title=\"2.åˆ›å»º GitHub ä»“åº“å¹¶é…ç½®ssh\"></a>2.åˆ›å»º GitHub ä»“åº“å¹¶é…ç½®ssh</h2><p>ç™»å½•ä½ çš„ GitHub å¸å·ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„ä»“åº“ï¼Œä»“åº“åæ˜¯ <code>&lt;username&gt;.github.io</code>ï¼Œå…¶ä¸­ <code>&lt;username&gt;</code> æ˜¯ä½ çš„ GitHub ç”¨æˆ·åã€‚å°†è¯¥ä»“åº“è®¾ç½®ä¸ºå…¬å¼€ä»“åº“ã€‚<br>è®¾ç½®ssh</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa -C &#x27;xxx@xxx.com&#x27;  #è‡ªå·±çš„é‚®ç®±</span><br><span class=\"line\">cat ~/.ssh/id_rsa.pub  #å°†é‡Œé¢çš„å†…å®¹å¤åˆ¶åˆ° github -&gt;settings -&gt;SSH and GPC keys -&gt;SSH keys -&gt;New SSH keyä¸­</span><br><span class=\"line\">ssh -T git@github.com  #è¾“å…¥yesä¹‹åï¼Œè¡Œæœ«å°¾ä¼šæ˜¾ç¤ºä½ çš„ç”¨æˆ·åï¼ˆç»‘å®šæˆåŠŸé‚®ç®±ä¼šæ”¶åˆ°é‚®ä»¶æé†’ï¼‰</span><br><span class=\"line\">#æ¥ç€åœ¨æœ¬åœ°ç»‘å®šä¸Githubçš„ç”¨æˆ·åå’Œé‚®ç®±ï¼ˆgitï¼‰</span><br><span class=\"line\">git config --global user.name &quot;&lt;username&gt;&quot;    #è‡ªå·±çš„ç”¨æˆ·å</span><br><span class=\"line\">git config --global user.email &#x27;xxx@xxx.com&#x27;  #è‡ªå·±çš„é‚®ç®±</span><br></pre></td></tr></table></figure>\n<h2 id=\"3-åˆå§‹åŒ–Hexo\"><a href=\"#3-åˆå§‹åŒ–Hexo\" class=\"headerlink\" title=\"3.åˆå§‹åŒ–Hexo\"></a>3.åˆå§‹åŒ–Hexo</h2><p>åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹ï¼Œç”¨äºå­˜å‚¨ä½ çš„åšå®¢é¡¹ç›®ã€‚<br>åœ¨ç»ˆç«¯ä¸­ï¼Œè¿›å…¥è¯¥æ–‡ä»¶å¤¹ï¼Œå¹¶è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥åˆå§‹åŒ– Hexo</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir myblog</span><br><span class=\"line\">hexo init    </span><br><span class=\"line\">#æˆ–è€…ç›´æ¥ä¸€æ­¥åˆ°ä½ </span><br><span class=\"line\">hexo init myblog</span><br></pre></td></tr></table></figure>\n<h2 id=\"4-é…ç½®Hexo\"><a href=\"#4-é…ç½®Hexo\" class=\"headerlink\" title=\"4.é…ç½®Hexo\"></a>4.é…ç½®Hexo</h2><ul>\n<li>è¿›å…¥ä½ çš„ Hexo é¡¹ç›®æ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ° _config.yml æ–‡ä»¶ï¼Œä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€å®ƒã€‚</li>\n<li>åœ¨ _config.yml æ–‡ä»¶ä¸­ï¼Œé…ç½®ä½ çš„åšå®¢è®¾ç½®ï¼Œä¾‹å¦‚æ ‡é¢˜ã€æè¿°ã€ä½œè€…ç­‰ã€‚</li>\n<li>æ ¹æ®éœ€è¦ï¼Œä½ è¿˜å¯ä»¥é…ç½®ä¸»é¢˜ã€æ’ä»¶å’Œå…¶ä»– Hexo é€‰é¡¹ã€‚<br>ç¼–è¾‘_config.ymlæ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">deploy:</span><br><span class=\"line\">        type: git</span><br><span class=\"line\">        repo: git@github.com: &lt;username&gt;/ &lt;username&gt;.github.io.git  #&lt;username&gt;ä¸ºè‡ªå·±çš„ç”¨æˆ·å</span><br><span class=\"line\">        branch: main</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install hexo-deployer-git    #å®‰è£… hexo-deployer-git æ’ä»¶ å°†éƒ¨ç½²è¿‡ç¨‹è‡ªåŠ¨åŒ–</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h2 id=\"5-åˆ›å»ºåšå®¢å†…å®¹\"><a href=\"#5-åˆ›å»ºåšå®¢å†…å®¹\" class=\"headerlink\" title=\"5.åˆ›å»ºåšå®¢å†…å®¹\"></a>5.åˆ›å»ºåšå®¢å†…å®¹</h2><p>åœ¨ç»ˆç«¯ä¸­ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥åˆ›å»ºæ–°çš„åšå®¢æ–‡ç« ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo new &quot;My First Post&quot;</span><br></pre></td></tr></table></figure>\n<p>è¿™å°†åœ¨ Hexo é¡¹ç›®çš„ source&#x2F;_posts ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–°çš„ Markdown æ–‡ä»¶ï¼Œç”¨äºç¼–å†™ä½ çš„ç¬¬ä¸€ç¯‡åšå®¢æ–‡ç« ã€‚</p>\n<h2 id=\"6-éƒ¨ç½²\"><a href=\"#6-éƒ¨ç½²\" class=\"headerlink\" title=\"6.éƒ¨ç½²\"></a>6.éƒ¨ç½²</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo s    # é¢„è§ˆ</span><br><span class=\"line\">#Hexo is running at http://localhost:4000/ . Press Ctrl+C to stop.</span><br><span class=\"line\">#ç”¨æµè§ˆå™¨æ‰“å¼€ http://localhost:4000/</span><br><span class=\"line\">hexo g #ç”Ÿæˆé™æ€ç½‘ç«™æ–‡ä»¶</span><br><span class=\"line\">hexo d #å°†ç”Ÿæˆçš„é™æ€ç½‘ç«™æ–‡ä»¶éƒ¨ç½²åˆ°github</span><br></pre></td></tr></table></figure>\n<h2 id=\"7-æŸ¥çœ‹\"><a href=\"#7-æŸ¥çœ‹\" class=\"headerlink\" title=\"7.æŸ¥çœ‹\"></a>7.æŸ¥çœ‹</h2><p>æµè§ˆå™¨æ‰“å¼€<code>&lt;username&gt;.github.io</code>å³å¯æŸ¥çœ‹</p>\n<h2 id=\"8-å‚è€ƒï¼š\"><a href=\"#8-å‚è€ƒï¼š\" class=\"headerlink\" title=\"8.å‚è€ƒï¼š\"></a>8.å‚è€ƒï¼š</h2><p><a href=\"https://blog.csdn.net/qq_62928039/article/details/130248518\">https://blog.csdn.net/qq_62928039/article/details/130248518</a></p>\n<h2 id=\"9-é€‰æ‹©ä¸»é¢˜ï¼š\"><a href=\"#9-é€‰æ‹©ä¸»é¢˜ï¼š\" class=\"headerlink\" title=\"9.é€‰æ‹©ä¸»é¢˜ï¼š\"></a>9.é€‰æ‹©ä¸»é¢˜ï¼š</h2><p><a href=\"https://hexo.io/themes/\">https://hexo.io/themes/</a><br><a href=\"https://github.com/yelog/hexo-theme-3-hexo\">https://github.com/yelog/hexo-theme-3-hexo</a></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#åœ¨hexoæ ¹ç›®å½•ä¸‹</span><br><span class=\"line\">git clone https://github.com/yelog/hexo-theme-3-hexo.git themes/3-hexo</span><br><span class=\"line\">#ä¿®æ”¹hexoæ ¹ç›®å½•çš„_config.ymlï¼Œå¦‚ä¸‹</span><br><span class=\"line\">theme: 3-hexo</span><br><span class=\"line\">#åšå®¢é…ç½®</span><br><span class=\"line\">http://yelog.org/2017/03/23/3-hexo-instruction/</span><br></pre></td></tr></table></figure>\n<p>æœ€ç»ˆæ•ˆæœï¼š<br><a href=\"https://yyheroi.github.io/\">https://yyheroi.github.io</a></p>\n"},{"title":"cpufreq","date":"2024-04-28T09:04:13.000Z","_content":"\n[toc]\n\n# cpufreq\n\n\n\nCPUFreqæ¡†æ¶æ˜¯å†…æ ¸çš„CPUè°ƒé¢‘æ¡†æ¶ï¼Œæ•´ä¸ªè°ƒé¢‘æ¡†æ¶ç”±ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ç»„æˆï¼š\n\n- cpufreq driver\n- cpufreq framework (core)\n- cpufreq governor\n\nä¸€äº›åŸºæœ¬æ¦‚å¿µï¼š\n\nP-state: voltage and frequency point\n\næ€»ä½“ä¸Šï¼ŒCPU Freqä¸»è¦åœ¨sysfså‘userspaceæä¾›äº†è°ƒé¢‘æ“ä½œå’Œç­–ç•¥è®¾ç½®èŠ‚ç‚¹ã€‚å½“ä½¿ç”¨ä¸€äº›è‡ªåŠ¨è°ƒé¢‘çš„governoræ—¶ï¼Œå…è®¸governorä»ç³»ç»Ÿè·å–ä¿¡æ¯ï¼Œè‡ªåŠ¨è§¦å‘è°ƒé¢‘åŠ¨ä½œã€‚\n\nå¦å¤–ï¼Œè¿˜å‘å…¶ä»–æ¨¡å—æä¾›äº†qosé¢‘ç‡æŠ•ç¥¨ï¼Œä»¥åŠè°ƒé¢‘äº‹ä»¶çš„notifieræœºåˆ¶ã€‚\n\nä¸‹é¢åˆ†å¼€æ¥çœ‹æ¯ä¸ªéƒ¨åˆ†ã€‚\n\n## Driver\n\n\n\nCpufreq Driverä¸»è¦è´Ÿè´£åº•å±‚è°ƒé¢‘çš„æ“ä½œï¼Œæ ¸å¿ƒæ˜¯å®ç° `cpufreq_dirver` å¯¹è±¡ï¼Œå¹¶é€šè¿‡ `cpufreq_register_driver` å°†é©±åŠ¨æ³¨å†Œåˆ°ç³»ç»Ÿï¼Œä¾›coreéƒ¨åˆ†ä½¿ç”¨ã€‚\n\nå…¶ä¸­ï¼Œæœ€æ ¸å¿ƒçš„å‡ ä¸ªå›è°ƒåŒ…æ‹¬ï¼š\n\n- online: hotplug callback\n- offline: hotplug callback\n- target_index: set freq\n- set_boost: enter into boost mode\n\nä»¥ `mediatek-cpufreq-hw.c` ä¸ºä¾‹ï¼Œå…¶freq tableä¿å­˜åœ¨ç¡¬ä»¶å¯„å­˜å™¨ä¸­ï¼Œdriveråˆå§‹åŒ–æ—¶ï¼Œä»ç¡¬ä»¶ä¸­è¯»å‡ºfreq tableï¼Œå¹¶å®ç°ç›¸å…³è°ƒé¢‘å›è°ƒï¼Œæœ€ç»ˆæ³¨å†Œåˆ°coreã€‚\n\ndb845cä½¿ç”¨çš„ `qcom-cpufreq-hw.c` ä¸ºä¾‹ï¼Œå…¶freq tableä¿å­˜åœ¨dtsä¸­ï¼Œdriverä½¿ç”¨OPPæ¡†æ¶æ¥è¯»å–è¿™äº›é…ç½®ï¼Œå¹¶å®ç°cpufreqå›è°ƒã€‚\n\n\\* OPPï¼ˆOperating Performance Pointï¼Œæä¾›dtsçš„freq-valt-tableé…ç½®ï¼ŒåŠè·å–æ¥å£ã€‚\n\n## Core\n\n\n\nCoreéƒ¨åˆ†æ ¸å¿ƒæ–‡ä»¶æ˜¯ `/drivers/cpufreq/cpufreq.c`\n\nè¿™ä¸ªæ–‡ä»¶ä¸»è¦å®ç°äº†BOOSTï¼ŒDRIVERï¼ŒSYSFSï¼ŒFREQï¼ŒNOTIFIERï¼ŒGOVERNORï¼ŒPOLICYç›¸å…³åŠŸèƒ½çš„æ“ä½œæ¥å£ã€‚\n\n`cpufreq_register_driver` (cpufreq_driver* cpufreq_driver)\n\n`cpufreq_register_governor` (cpufreq_governor_list)\n\n`cpufreq_register_notifier` (cpufreq_transition_notifier_list)\n\n`cpufreq_policy_alloc` (cpufreq_policy* PERCPU:cpufreq_cpu_data)\n\n`cpufreq_policy` æ˜¯ä¸€ä¸ªè°ƒé¢‘å®ä½“ï¼Œå¯¹åº”ä¸€ä¸ªè°ƒé¢‘åŸŸï¼ˆfreq domainï¼‰ï¼Œä¸€èˆ¬ä¸ºä¸€ä¸ªclusterï¼Œè¿™ä¸ªç»“æ„ä¿å­˜äº†æ¯ä¸ªè°ƒé¢‘å®ä½“ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªclusterï¼‰è°ƒé¢‘ç›¸å…³çš„æ‰€æœ‰ç§æœ‰ä¿¡æ¯ã€‚åŒæ—¶ï¼Œä»–ä½œä¸ºè°ƒé¢‘æ“ä½œçš„å¥æŸ„ï¼Œcpufreqé¡¶å±‚æ“ä½œæ¥å£ä½¿ç”¨policyæ¥å¯¹ä¸€ä¸ªè°ƒé¢‘å®ä½“è¿›è¡Œæ“ä½œã€‚\n\næ¯ä¸ªCPUæœ‰ä¸€ä¸ªpercpuçš„æŒ‡é’ˆæŒ‡å‘å…¶æ‰€å±çš„policyï¼Œclusterä¸­çš„å¤šä¸ªCPUå…±äº«ä¸€ä¸ªpolicyã€‚ï¼ˆ`cpufreq_cpu_data`ï¼‰\n\nMainflowï¼š\n\n1ã€cpufreq driveræ³¨å†Œ\n\n2ã€governoræ³¨å†Œï¼ˆæ¯ä¸ªpolicyåˆå§‹åŒ–è‡ªå·±çš„governorï¼‰\n\n3ã€cpu hotplug state: \"cpufreq:online\"ï¼Œ`cpuhp_cpufreq_online`ã€`cpuhp_cpufreq_offline`ï¼Œåˆ›å»ºå‡ºpercpu policyï¼Œç»‘å®šdriverã€governor\n\n4ã€å‘sysfsåˆ›å»ºèŠ‚ç‚¹ï¼Œæä¾›åŠŸèƒ½\n\n5ã€governorå¼€å§‹å·¥ä½œï¼Œé€šè¿‡ `__cpufreq_driver_target` è¿›è¡Œè°ƒé¢‘ã€‚\n\n- Qosæ˜¯è°ƒé¢‘æŠ•ç¥¨æœºåˆ¶ï¼Œç”¨æ¥å®ç°max_freqã€min_freq limitationã€‚(`cpufreq_notifier_min` `cpufreq_notifier_max`)ï¼Œåœ¨å…¶ä»–moduleæœ‰éœ€æ±‚æŠ•ç¥¨åï¼Œfreq constrantsä¼šè¢«æ›´æ–°ã€‚\n\n## Sysfs\n\n\n\n```\n/sys/devices/system/cpu/cpu0/cpufreq/policyX\nscaling_driver\t\t\tr\t# cpufreq driver name\naffected_cpus\t\t\tr\t# cpu\nrelated_cpus\t\t\tr\t# <?>\nscaling_cur_freq\t\trw\t# cur freq\nscaling_min_freq\t\trw\t# min freq limit\nscaling_max_freq\t\trw\t# max freq limit\nscaling_governor\t\trw\t# selected governor\nscaling_available_governors\tr\t# available governors\nscaling_setspeed\t\tr\t# <not supported>\ncpuinfo_min_freq\t\tr\t# hardware min freq\ncpuinfo_max_freq\t\tr\t# hardware max freq\ncpuinfo_transition_latency\tr\t# hardware latency\n```\n\n\n\n## Governors\n\n\n\nGovernorè´Ÿè´£ä»ç³»ç»Ÿæ”¶é›†ä¿¡æ¯ï¼Œå¹¶è§¦å‘è°ƒé¢‘åŠ¨ä½œã€‚\n\n**powersave**\n\nalways lowest frequency\n\n**performance**\n\nalways highest frequency\n\n**schedutil**\n\nuses CPU utilization data from scheduler to determine target frequence\n\nå¾…å®Œæˆ\n\n**userspace**\n\nallow user space set the frequency\n\n**ondemand**\n\nuses CPU load as a CPU frequency selection metric\n\nit reaches the target by CPU load, 0->min, 100->max\n\n**conservative**\n\nuses CPU load as a CPU frequency selection metric\n\nit reaches the target step by step, up_threshold->up, down_threshold->down\n\n## Files\n\n\n\n```\n- /drivers/cpufreq/cpufreq.c\n- /drivers/cpufreq/cpufreq-dt.c\n- /drivers/cpufreq/cpufreq_stats.c\n- /drivers/cpufreq/cpufreq_conservative.c\n- /drivers/cpufreq/cpufreq_governor.c\n- /drivers/cpufreq/cpufreq_ondemand.c\n- /drivers/cpufreq/cpufreq_powersave.c\n- /drivers/cpufreq/cpufreq_performance.c\n- /drivers/cpufreq/cpufreq_userspace.c\n- /kernel/sched/cpufreq_schedutil.c\n- /kernel/power/qos.c\n```\n\n\n\n## Reference\n\n\n\nhttps://www.kernel.org/doc/html/latest/admin-guide/pm/cpufreq.html\n\nhttps://docs.kernel.org/scheduler/schedutil.html\n\nhttp://www.wowotech.net/pm_subsystem/cpufreq_overview.html\n\nhttp://www.wowotech.net/pm_subsystem/cpufreq_driver.html\n\nhttp://www.wowotech.net/pm_subsystem/cpufreq_core.html\n\nhttp://www.wowotech.net/pm_subsystem/cpufreq_governor.html","source":"_posts/cpufreq.md","raw":"---\ntitle: cpufreq\ndate: 2024-04-28 17:04:13\ncategories:\n- kernel\ntags:\n- power\n- cpufreq\n---\n\n[toc]\n\n# cpufreq\n\n\n\nCPUFreqæ¡†æ¶æ˜¯å†…æ ¸çš„CPUè°ƒé¢‘æ¡†æ¶ï¼Œæ•´ä¸ªè°ƒé¢‘æ¡†æ¶ç”±ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ç»„æˆï¼š\n\n- cpufreq driver\n- cpufreq framework (core)\n- cpufreq governor\n\nä¸€äº›åŸºæœ¬æ¦‚å¿µï¼š\n\nP-state: voltage and frequency point\n\næ€»ä½“ä¸Šï¼ŒCPU Freqä¸»è¦åœ¨sysfså‘userspaceæä¾›äº†è°ƒé¢‘æ“ä½œå’Œç­–ç•¥è®¾ç½®èŠ‚ç‚¹ã€‚å½“ä½¿ç”¨ä¸€äº›è‡ªåŠ¨è°ƒé¢‘çš„governoræ—¶ï¼Œå…è®¸governorä»ç³»ç»Ÿè·å–ä¿¡æ¯ï¼Œè‡ªåŠ¨è§¦å‘è°ƒé¢‘åŠ¨ä½œã€‚\n\nå¦å¤–ï¼Œè¿˜å‘å…¶ä»–æ¨¡å—æä¾›äº†qosé¢‘ç‡æŠ•ç¥¨ï¼Œä»¥åŠè°ƒé¢‘äº‹ä»¶çš„notifieræœºåˆ¶ã€‚\n\nä¸‹é¢åˆ†å¼€æ¥çœ‹æ¯ä¸ªéƒ¨åˆ†ã€‚\n\n## Driver\n\n\n\nCpufreq Driverä¸»è¦è´Ÿè´£åº•å±‚è°ƒé¢‘çš„æ“ä½œï¼Œæ ¸å¿ƒæ˜¯å®ç° `cpufreq_dirver` å¯¹è±¡ï¼Œå¹¶é€šè¿‡ `cpufreq_register_driver` å°†é©±åŠ¨æ³¨å†Œåˆ°ç³»ç»Ÿï¼Œä¾›coreéƒ¨åˆ†ä½¿ç”¨ã€‚\n\nå…¶ä¸­ï¼Œæœ€æ ¸å¿ƒçš„å‡ ä¸ªå›è°ƒåŒ…æ‹¬ï¼š\n\n- online: hotplug callback\n- offline: hotplug callback\n- target_index: set freq\n- set_boost: enter into boost mode\n\nä»¥ `mediatek-cpufreq-hw.c` ä¸ºä¾‹ï¼Œå…¶freq tableä¿å­˜åœ¨ç¡¬ä»¶å¯„å­˜å™¨ä¸­ï¼Œdriveråˆå§‹åŒ–æ—¶ï¼Œä»ç¡¬ä»¶ä¸­è¯»å‡ºfreq tableï¼Œå¹¶å®ç°ç›¸å…³è°ƒé¢‘å›è°ƒï¼Œæœ€ç»ˆæ³¨å†Œåˆ°coreã€‚\n\ndb845cä½¿ç”¨çš„ `qcom-cpufreq-hw.c` ä¸ºä¾‹ï¼Œå…¶freq tableä¿å­˜åœ¨dtsä¸­ï¼Œdriverä½¿ç”¨OPPæ¡†æ¶æ¥è¯»å–è¿™äº›é…ç½®ï¼Œå¹¶å®ç°cpufreqå›è°ƒã€‚\n\n\\* OPPï¼ˆOperating Performance Pointï¼Œæä¾›dtsçš„freq-valt-tableé…ç½®ï¼ŒåŠè·å–æ¥å£ã€‚\n\n## Core\n\n\n\nCoreéƒ¨åˆ†æ ¸å¿ƒæ–‡ä»¶æ˜¯ `/drivers/cpufreq/cpufreq.c`\n\nè¿™ä¸ªæ–‡ä»¶ä¸»è¦å®ç°äº†BOOSTï¼ŒDRIVERï¼ŒSYSFSï¼ŒFREQï¼ŒNOTIFIERï¼ŒGOVERNORï¼ŒPOLICYç›¸å…³åŠŸèƒ½çš„æ“ä½œæ¥å£ã€‚\n\n`cpufreq_register_driver` (cpufreq_driver* cpufreq_driver)\n\n`cpufreq_register_governor` (cpufreq_governor_list)\n\n`cpufreq_register_notifier` (cpufreq_transition_notifier_list)\n\n`cpufreq_policy_alloc` (cpufreq_policy* PERCPU:cpufreq_cpu_data)\n\n`cpufreq_policy` æ˜¯ä¸€ä¸ªè°ƒé¢‘å®ä½“ï¼Œå¯¹åº”ä¸€ä¸ªè°ƒé¢‘åŸŸï¼ˆfreq domainï¼‰ï¼Œä¸€èˆ¬ä¸ºä¸€ä¸ªclusterï¼Œè¿™ä¸ªç»“æ„ä¿å­˜äº†æ¯ä¸ªè°ƒé¢‘å®ä½“ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªclusterï¼‰è°ƒé¢‘ç›¸å…³çš„æ‰€æœ‰ç§æœ‰ä¿¡æ¯ã€‚åŒæ—¶ï¼Œä»–ä½œä¸ºè°ƒé¢‘æ“ä½œçš„å¥æŸ„ï¼Œcpufreqé¡¶å±‚æ“ä½œæ¥å£ä½¿ç”¨policyæ¥å¯¹ä¸€ä¸ªè°ƒé¢‘å®ä½“è¿›è¡Œæ“ä½œã€‚\n\næ¯ä¸ªCPUæœ‰ä¸€ä¸ªpercpuçš„æŒ‡é’ˆæŒ‡å‘å…¶æ‰€å±çš„policyï¼Œclusterä¸­çš„å¤šä¸ªCPUå…±äº«ä¸€ä¸ªpolicyã€‚ï¼ˆ`cpufreq_cpu_data`ï¼‰\n\nMainflowï¼š\n\n1ã€cpufreq driveræ³¨å†Œ\n\n2ã€governoræ³¨å†Œï¼ˆæ¯ä¸ªpolicyåˆå§‹åŒ–è‡ªå·±çš„governorï¼‰\n\n3ã€cpu hotplug state: \"cpufreq:online\"ï¼Œ`cpuhp_cpufreq_online`ã€`cpuhp_cpufreq_offline`ï¼Œåˆ›å»ºå‡ºpercpu policyï¼Œç»‘å®šdriverã€governor\n\n4ã€å‘sysfsåˆ›å»ºèŠ‚ç‚¹ï¼Œæä¾›åŠŸèƒ½\n\n5ã€governorå¼€å§‹å·¥ä½œï¼Œé€šè¿‡ `__cpufreq_driver_target` è¿›è¡Œè°ƒé¢‘ã€‚\n\n- Qosæ˜¯è°ƒé¢‘æŠ•ç¥¨æœºåˆ¶ï¼Œç”¨æ¥å®ç°max_freqã€min_freq limitationã€‚(`cpufreq_notifier_min` `cpufreq_notifier_max`)ï¼Œåœ¨å…¶ä»–moduleæœ‰éœ€æ±‚æŠ•ç¥¨åï¼Œfreq constrantsä¼šè¢«æ›´æ–°ã€‚\n\n## Sysfs\n\n\n\n```\n/sys/devices/system/cpu/cpu0/cpufreq/policyX\nscaling_driver\t\t\tr\t# cpufreq driver name\naffected_cpus\t\t\tr\t# cpu\nrelated_cpus\t\t\tr\t# <?>\nscaling_cur_freq\t\trw\t# cur freq\nscaling_min_freq\t\trw\t# min freq limit\nscaling_max_freq\t\trw\t# max freq limit\nscaling_governor\t\trw\t# selected governor\nscaling_available_governors\tr\t# available governors\nscaling_setspeed\t\tr\t# <not supported>\ncpuinfo_min_freq\t\tr\t# hardware min freq\ncpuinfo_max_freq\t\tr\t# hardware max freq\ncpuinfo_transition_latency\tr\t# hardware latency\n```\n\n\n\n## Governors\n\n\n\nGovernorè´Ÿè´£ä»ç³»ç»Ÿæ”¶é›†ä¿¡æ¯ï¼Œå¹¶è§¦å‘è°ƒé¢‘åŠ¨ä½œã€‚\n\n**powersave**\n\nalways lowest frequency\n\n**performance**\n\nalways highest frequency\n\n**schedutil**\n\nuses CPU utilization data from scheduler to determine target frequence\n\nå¾…å®Œæˆ\n\n**userspace**\n\nallow user space set the frequency\n\n**ondemand**\n\nuses CPU load as a CPU frequency selection metric\n\nit reaches the target by CPU load, 0->min, 100->max\n\n**conservative**\n\nuses CPU load as a CPU frequency selection metric\n\nit reaches the target step by step, up_threshold->up, down_threshold->down\n\n## Files\n\n\n\n```\n- /drivers/cpufreq/cpufreq.c\n- /drivers/cpufreq/cpufreq-dt.c\n- /drivers/cpufreq/cpufreq_stats.c\n- /drivers/cpufreq/cpufreq_conservative.c\n- /drivers/cpufreq/cpufreq_governor.c\n- /drivers/cpufreq/cpufreq_ondemand.c\n- /drivers/cpufreq/cpufreq_powersave.c\n- /drivers/cpufreq/cpufreq_performance.c\n- /drivers/cpufreq/cpufreq_userspace.c\n- /kernel/sched/cpufreq_schedutil.c\n- /kernel/power/qos.c\n```\n\n\n\n## Reference\n\n\n\nhttps://www.kernel.org/doc/html/latest/admin-guide/pm/cpufreq.html\n\nhttps://docs.kernel.org/scheduler/schedutil.html\n\nhttp://www.wowotech.net/pm_subsystem/cpufreq_overview.html\n\nhttp://www.wowotech.net/pm_subsystem/cpufreq_driver.html\n\nhttp://www.wowotech.net/pm_subsystem/cpufreq_core.html\n\nhttp://www.wowotech.net/pm_subsystem/cpufreq_governor.html","slug":"cpufreq","published":1,"updated":"2024-04-28T09:07:20.119Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clvjcoaas0005r9w0fujveufw","content":"<p>[toc]</p>\n<h1 id=\"cpufreq\"><a href=\"#cpufreq\" class=\"headerlink\" title=\"cpufreq\"></a>cpufreq</h1><p>CPUFreqæ¡†æ¶æ˜¯å†…æ ¸çš„CPUè°ƒé¢‘æ¡†æ¶ï¼Œæ•´ä¸ªè°ƒé¢‘æ¡†æ¶ç”±ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ç»„æˆï¼š</p>\n<ul>\n<li>cpufreq driver</li>\n<li>cpufreq framework (core)</li>\n<li>cpufreq governor</li>\n</ul>\n<p>ä¸€äº›åŸºæœ¬æ¦‚å¿µï¼š</p>\n<p>P-state: voltage and frequency point</p>\n<p>æ€»ä½“ä¸Šï¼ŒCPU Freqä¸»è¦åœ¨sysfså‘userspaceæä¾›äº†è°ƒé¢‘æ“ä½œå’Œç­–ç•¥è®¾ç½®èŠ‚ç‚¹ã€‚å½“ä½¿ç”¨ä¸€äº›è‡ªåŠ¨è°ƒé¢‘çš„governoræ—¶ï¼Œå…è®¸governorä»ç³»ç»Ÿè·å–ä¿¡æ¯ï¼Œè‡ªåŠ¨è§¦å‘è°ƒé¢‘åŠ¨ä½œã€‚</p>\n<p>å¦å¤–ï¼Œè¿˜å‘å…¶ä»–æ¨¡å—æä¾›äº†qosé¢‘ç‡æŠ•ç¥¨ï¼Œä»¥åŠè°ƒé¢‘äº‹ä»¶çš„notifieræœºåˆ¶ã€‚</p>\n<p>ä¸‹é¢åˆ†å¼€æ¥çœ‹æ¯ä¸ªéƒ¨åˆ†ã€‚</p>\n<h2 id=\"Driver\"><a href=\"#Driver\" class=\"headerlink\" title=\"Driver\"></a>Driver</h2><p>Cpufreq Driverä¸»è¦è´Ÿè´£åº•å±‚è°ƒé¢‘çš„æ“ä½œï¼Œæ ¸å¿ƒæ˜¯å®ç° <code>cpufreq_dirver</code> å¯¹è±¡ï¼Œå¹¶é€šè¿‡ <code>cpufreq_register_driver</code> å°†é©±åŠ¨æ³¨å†Œåˆ°ç³»ç»Ÿï¼Œä¾›coreéƒ¨åˆ†ä½¿ç”¨ã€‚</p>\n<p>å…¶ä¸­ï¼Œæœ€æ ¸å¿ƒçš„å‡ ä¸ªå›è°ƒåŒ…æ‹¬ï¼š</p>\n<ul>\n<li>online: hotplug callback</li>\n<li>offline: hotplug callback</li>\n<li>target_index: set freq</li>\n<li>set_boost: enter into boost mode</li>\n</ul>\n<p>ä»¥ <code>mediatek-cpufreq-hw.c</code> ä¸ºä¾‹ï¼Œå…¶freq tableä¿å­˜åœ¨ç¡¬ä»¶å¯„å­˜å™¨ä¸­ï¼Œdriveråˆå§‹åŒ–æ—¶ï¼Œä»ç¡¬ä»¶ä¸­è¯»å‡ºfreq tableï¼Œå¹¶å®ç°ç›¸å…³è°ƒé¢‘å›è°ƒï¼Œæœ€ç»ˆæ³¨å†Œåˆ°coreã€‚</p>\n<p>db845cä½¿ç”¨çš„ <code>qcom-cpufreq-hw.c</code> ä¸ºä¾‹ï¼Œå…¶freq tableä¿å­˜åœ¨dtsä¸­ï¼Œdriverä½¿ç”¨OPPæ¡†æ¶æ¥è¯»å–è¿™äº›é…ç½®ï¼Œå¹¶å®ç°cpufreqå›è°ƒã€‚</p>\n<p>* OPPï¼ˆOperating Performance Pointï¼Œæä¾›dtsçš„freq-valt-tableé…ç½®ï¼ŒåŠè·å–æ¥å£ã€‚</p>\n<h2 id=\"Core\"><a href=\"#Core\" class=\"headerlink\" title=\"Core\"></a>Core</h2><p>Coreéƒ¨åˆ†æ ¸å¿ƒæ–‡ä»¶æ˜¯ <code>/drivers/cpufreq/cpufreq.c</code></p>\n<p>è¿™ä¸ªæ–‡ä»¶ä¸»è¦å®ç°äº†BOOSTï¼ŒDRIVERï¼ŒSYSFSï¼ŒFREQï¼ŒNOTIFIERï¼ŒGOVERNORï¼ŒPOLICYç›¸å…³åŠŸèƒ½çš„æ“ä½œæ¥å£ã€‚</p>\n<p><code>cpufreq_register_driver</code> (cpufreq_driver* cpufreq_driver)</p>\n<p><code>cpufreq_register_governor</code> (cpufreq_governor_list)</p>\n<p><code>cpufreq_register_notifier</code> (cpufreq_transition_notifier_list)</p>\n<p><code>cpufreq_policy_alloc</code> (cpufreq_policy* PERCPU:cpufreq_cpu_data)</p>\n<p><code>cpufreq_policy</code> æ˜¯ä¸€ä¸ªè°ƒé¢‘å®ä½“ï¼Œå¯¹åº”ä¸€ä¸ªè°ƒé¢‘åŸŸï¼ˆfreq domainï¼‰ï¼Œä¸€èˆ¬ä¸ºä¸€ä¸ªclusterï¼Œè¿™ä¸ªç»“æ„ä¿å­˜äº†æ¯ä¸ªè°ƒé¢‘å®ä½“ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªclusterï¼‰è°ƒé¢‘ç›¸å…³çš„æ‰€æœ‰ç§æœ‰ä¿¡æ¯ã€‚åŒæ—¶ï¼Œä»–ä½œä¸ºè°ƒé¢‘æ“ä½œçš„å¥æŸ„ï¼Œcpufreqé¡¶å±‚æ“ä½œæ¥å£ä½¿ç”¨policyæ¥å¯¹ä¸€ä¸ªè°ƒé¢‘å®ä½“è¿›è¡Œæ“ä½œã€‚</p>\n<p>æ¯ä¸ªCPUæœ‰ä¸€ä¸ªpercpuçš„æŒ‡é’ˆæŒ‡å‘å…¶æ‰€å±çš„policyï¼Œclusterä¸­çš„å¤šä¸ªCPUå…±äº«ä¸€ä¸ªpolicyã€‚ï¼ˆ<code>cpufreq_cpu_data</code>ï¼‰</p>\n<p>Mainflowï¼š</p>\n<p>1ã€cpufreq driveræ³¨å†Œ</p>\n<p>2ã€governoræ³¨å†Œï¼ˆæ¯ä¸ªpolicyåˆå§‹åŒ–è‡ªå·±çš„governorï¼‰</p>\n<p>3ã€cpu hotplug state: â€œcpufreq:onlineâ€ï¼Œ<code>cpuhp_cpufreq_online</code>ã€<code>cpuhp_cpufreq_offline</code>ï¼Œåˆ›å»ºå‡ºpercpu policyï¼Œç»‘å®šdriverã€governor</p>\n<p>4ã€å‘sysfsåˆ›å»ºèŠ‚ç‚¹ï¼Œæä¾›åŠŸèƒ½</p>\n<p>5ã€governorå¼€å§‹å·¥ä½œï¼Œé€šè¿‡ <code>__cpufreq_driver_target</code> è¿›è¡Œè°ƒé¢‘ã€‚</p>\n<ul>\n<li>Qosæ˜¯è°ƒé¢‘æŠ•ç¥¨æœºåˆ¶ï¼Œç”¨æ¥å®ç°max_freqã€min_freq limitationã€‚(<code>cpufreq_notifier_min</code> <code>cpufreq_notifier_max</code>)ï¼Œåœ¨å…¶ä»–moduleæœ‰éœ€æ±‚æŠ•ç¥¨åï¼Œfreq constrantsä¼šè¢«æ›´æ–°ã€‚</li>\n</ul>\n<h2 id=\"Sysfs\"><a href=\"#Sysfs\" class=\"headerlink\" title=\"Sysfs\"></a>Sysfs</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/sys/devices/system/cpu/cpu0/cpufreq/policyX</span><br><span class=\"line\">scaling_driver\t\t\tr\t# cpufreq driver name</span><br><span class=\"line\">affected_cpus\t\t\tr\t# cpu</span><br><span class=\"line\">related_cpus\t\t\tr\t# &lt;?&gt;</span><br><span class=\"line\">scaling_cur_freq\t\trw\t# cur freq</span><br><span class=\"line\">scaling_min_freq\t\trw\t# min freq limit</span><br><span class=\"line\">scaling_max_freq\t\trw\t# max freq limit</span><br><span class=\"line\">scaling_governor\t\trw\t# selected governor</span><br><span class=\"line\">scaling_available_governors\tr\t# available governors</span><br><span class=\"line\">scaling_setspeed\t\tr\t# &lt;not supported&gt;</span><br><span class=\"line\">cpuinfo_min_freq\t\tr\t# hardware min freq</span><br><span class=\"line\">cpuinfo_max_freq\t\tr\t# hardware max freq</span><br><span class=\"line\">cpuinfo_transition_latency\tr\t# hardware latency</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"Governors\"><a href=\"#Governors\" class=\"headerlink\" title=\"Governors\"></a>Governors</h2><p>Governorè´Ÿè´£ä»ç³»ç»Ÿæ”¶é›†ä¿¡æ¯ï¼Œå¹¶è§¦å‘è°ƒé¢‘åŠ¨ä½œã€‚</p>\n<p><strong>powersave</strong></p>\n<p>always lowest frequency</p>\n<p><strong>performance</strong></p>\n<p>always highest frequency</p>\n<p><strong>schedutil</strong></p>\n<p>uses CPU utilization data from scheduler to determine target frequence</p>\n<p>å¾…å®Œæˆ</p>\n<p><strong>userspace</strong></p>\n<p>allow user space set the frequency</p>\n<p><strong>ondemand</strong></p>\n<p>uses CPU load as a CPU frequency selection metric</p>\n<p>it reaches the target by CPU load, 0-&gt;min, 100-&gt;max</p>\n<p><strong>conservative</strong></p>\n<p>uses CPU load as a CPU frequency selection metric</p>\n<p>it reaches the target step by step, up_threshold-&gt;up, down_threshold-&gt;down</p>\n<h2 id=\"Files\"><a href=\"#Files\" class=\"headerlink\" title=\"Files\"></a>Files</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- /drivers/cpufreq/cpufreq.c</span><br><span class=\"line\">- /drivers/cpufreq/cpufreq-dt.c</span><br><span class=\"line\">- /drivers/cpufreq/cpufreq_stats.c</span><br><span class=\"line\">- /drivers/cpufreq/cpufreq_conservative.c</span><br><span class=\"line\">- /drivers/cpufreq/cpufreq_governor.c</span><br><span class=\"line\">- /drivers/cpufreq/cpufreq_ondemand.c</span><br><span class=\"line\">- /drivers/cpufreq/cpufreq_powersave.c</span><br><span class=\"line\">- /drivers/cpufreq/cpufreq_performance.c</span><br><span class=\"line\">- /drivers/cpufreq/cpufreq_userspace.c</span><br><span class=\"line\">- /kernel/sched/cpufreq_schedutil.c</span><br><span class=\"line\">- /kernel/power/qos.c</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"Reference\"><a href=\"#Reference\" class=\"headerlink\" title=\"Reference\"></a>Reference</h2><p><a href=\"https://www.kernel.org/doc/html/latest/admin-guide/pm/cpufreq.html\">https://www.kernel.org/doc/html/latest/admin-guide/pm/cpufreq.html</a></p>\n<p><a href=\"https://docs.kernel.org/scheduler/schedutil.html\">https://docs.kernel.org/scheduler/schedutil.html</a></p>\n<p><a href=\"http://www.wowotech.net/pm_subsystem/cpufreq_overview.html\">http://www.wowotech.net/pm_subsystem/cpufreq_overview.html</a></p>\n<p><a href=\"http://www.wowotech.net/pm_subsystem/cpufreq_driver.html\">http://www.wowotech.net/pm_subsystem/cpufreq_driver.html</a></p>\n<p><a href=\"http://www.wowotech.net/pm_subsystem/cpufreq_core.html\">http://www.wowotech.net/pm_subsystem/cpufreq_core.html</a></p>\n<p><a href=\"http://www.wowotech.net/pm_subsystem/cpufreq_governor.html\">http://www.wowotech.net/pm_subsystem/cpufreq_governor.html</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p>[toc]</p>\n<h1 id=\"cpufreq\"><a href=\"#cpufreq\" class=\"headerlink\" title=\"cpufreq\"></a>cpufreq</h1><p>CPUFreqæ¡†æ¶æ˜¯å†…æ ¸çš„CPUè°ƒé¢‘æ¡†æ¶ï¼Œæ•´ä¸ªè°ƒé¢‘æ¡†æ¶ç”±ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ç»„æˆï¼š</p>\n<ul>\n<li>cpufreq driver</li>\n<li>cpufreq framework (core)</li>\n<li>cpufreq governor</li>\n</ul>\n<p>ä¸€äº›åŸºæœ¬æ¦‚å¿µï¼š</p>\n<p>P-state: voltage and frequency point</p>\n<p>æ€»ä½“ä¸Šï¼ŒCPU Freqä¸»è¦åœ¨sysfså‘userspaceæä¾›äº†è°ƒé¢‘æ“ä½œå’Œç­–ç•¥è®¾ç½®èŠ‚ç‚¹ã€‚å½“ä½¿ç”¨ä¸€äº›è‡ªåŠ¨è°ƒé¢‘çš„governoræ—¶ï¼Œå…è®¸governorä»ç³»ç»Ÿè·å–ä¿¡æ¯ï¼Œè‡ªåŠ¨è§¦å‘è°ƒé¢‘åŠ¨ä½œã€‚</p>\n<p>å¦å¤–ï¼Œè¿˜å‘å…¶ä»–æ¨¡å—æä¾›äº†qosé¢‘ç‡æŠ•ç¥¨ï¼Œä»¥åŠè°ƒé¢‘äº‹ä»¶çš„notifieræœºåˆ¶ã€‚</p>\n<p>ä¸‹é¢åˆ†å¼€æ¥çœ‹æ¯ä¸ªéƒ¨åˆ†ã€‚</p>\n<h2 id=\"Driver\"><a href=\"#Driver\" class=\"headerlink\" title=\"Driver\"></a>Driver</h2><p>Cpufreq Driverä¸»è¦è´Ÿè´£åº•å±‚è°ƒé¢‘çš„æ“ä½œï¼Œæ ¸å¿ƒæ˜¯å®ç° <code>cpufreq_dirver</code> å¯¹è±¡ï¼Œå¹¶é€šè¿‡ <code>cpufreq_register_driver</code> å°†é©±åŠ¨æ³¨å†Œåˆ°ç³»ç»Ÿï¼Œä¾›coreéƒ¨åˆ†ä½¿ç”¨ã€‚</p>\n<p>å…¶ä¸­ï¼Œæœ€æ ¸å¿ƒçš„å‡ ä¸ªå›è°ƒåŒ…æ‹¬ï¼š</p>\n<ul>\n<li>online: hotplug callback</li>\n<li>offline: hotplug callback</li>\n<li>target_index: set freq</li>\n<li>set_boost: enter into boost mode</li>\n</ul>\n<p>ä»¥ <code>mediatek-cpufreq-hw.c</code> ä¸ºä¾‹ï¼Œå…¶freq tableä¿å­˜åœ¨ç¡¬ä»¶å¯„å­˜å™¨ä¸­ï¼Œdriveråˆå§‹åŒ–æ—¶ï¼Œä»ç¡¬ä»¶ä¸­è¯»å‡ºfreq tableï¼Œå¹¶å®ç°ç›¸å…³è°ƒé¢‘å›è°ƒï¼Œæœ€ç»ˆæ³¨å†Œåˆ°coreã€‚</p>\n<p>db845cä½¿ç”¨çš„ <code>qcom-cpufreq-hw.c</code> ä¸ºä¾‹ï¼Œå…¶freq tableä¿å­˜åœ¨dtsä¸­ï¼Œdriverä½¿ç”¨OPPæ¡†æ¶æ¥è¯»å–è¿™äº›é…ç½®ï¼Œå¹¶å®ç°cpufreqå›è°ƒã€‚</p>\n<p>* OPPï¼ˆOperating Performance Pointï¼Œæä¾›dtsçš„freq-valt-tableé…ç½®ï¼ŒåŠè·å–æ¥å£ã€‚</p>\n<h2 id=\"Core\"><a href=\"#Core\" class=\"headerlink\" title=\"Core\"></a>Core</h2><p>Coreéƒ¨åˆ†æ ¸å¿ƒæ–‡ä»¶æ˜¯ <code>/drivers/cpufreq/cpufreq.c</code></p>\n<p>è¿™ä¸ªæ–‡ä»¶ä¸»è¦å®ç°äº†BOOSTï¼ŒDRIVERï¼ŒSYSFSï¼ŒFREQï¼ŒNOTIFIERï¼ŒGOVERNORï¼ŒPOLICYç›¸å…³åŠŸèƒ½çš„æ“ä½œæ¥å£ã€‚</p>\n<p><code>cpufreq_register_driver</code> (cpufreq_driver* cpufreq_driver)</p>\n<p><code>cpufreq_register_governor</code> (cpufreq_governor_list)</p>\n<p><code>cpufreq_register_notifier</code> (cpufreq_transition_notifier_list)</p>\n<p><code>cpufreq_policy_alloc</code> (cpufreq_policy* PERCPU:cpufreq_cpu_data)</p>\n<p><code>cpufreq_policy</code> æ˜¯ä¸€ä¸ªè°ƒé¢‘å®ä½“ï¼Œå¯¹åº”ä¸€ä¸ªè°ƒé¢‘åŸŸï¼ˆfreq domainï¼‰ï¼Œä¸€èˆ¬ä¸ºä¸€ä¸ªclusterï¼Œè¿™ä¸ªç»“æ„ä¿å­˜äº†æ¯ä¸ªè°ƒé¢‘å®ä½“ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªclusterï¼‰è°ƒé¢‘ç›¸å…³çš„æ‰€æœ‰ç§æœ‰ä¿¡æ¯ã€‚åŒæ—¶ï¼Œä»–ä½œä¸ºè°ƒé¢‘æ“ä½œçš„å¥æŸ„ï¼Œcpufreqé¡¶å±‚æ“ä½œæ¥å£ä½¿ç”¨policyæ¥å¯¹ä¸€ä¸ªè°ƒé¢‘å®ä½“è¿›è¡Œæ“ä½œã€‚</p>\n<p>æ¯ä¸ªCPUæœ‰ä¸€ä¸ªpercpuçš„æŒ‡é’ˆæŒ‡å‘å…¶æ‰€å±çš„policyï¼Œclusterä¸­çš„å¤šä¸ªCPUå…±äº«ä¸€ä¸ªpolicyã€‚ï¼ˆ<code>cpufreq_cpu_data</code>ï¼‰</p>\n<p>Mainflowï¼š</p>\n<p>1ã€cpufreq driveræ³¨å†Œ</p>\n<p>2ã€governoræ³¨å†Œï¼ˆæ¯ä¸ªpolicyåˆå§‹åŒ–è‡ªå·±çš„governorï¼‰</p>\n<p>3ã€cpu hotplug state: â€œcpufreq:onlineâ€ï¼Œ<code>cpuhp_cpufreq_online</code>ã€<code>cpuhp_cpufreq_offline</code>ï¼Œåˆ›å»ºå‡ºpercpu policyï¼Œç»‘å®šdriverã€governor</p>\n<p>4ã€å‘sysfsåˆ›å»ºèŠ‚ç‚¹ï¼Œæä¾›åŠŸèƒ½</p>\n<p>5ã€governorå¼€å§‹å·¥ä½œï¼Œé€šè¿‡ <code>__cpufreq_driver_target</code> è¿›è¡Œè°ƒé¢‘ã€‚</p>\n<ul>\n<li>Qosæ˜¯è°ƒé¢‘æŠ•ç¥¨æœºåˆ¶ï¼Œç”¨æ¥å®ç°max_freqã€min_freq limitationã€‚(<code>cpufreq_notifier_min</code> <code>cpufreq_notifier_max</code>)ï¼Œåœ¨å…¶ä»–moduleæœ‰éœ€æ±‚æŠ•ç¥¨åï¼Œfreq constrantsä¼šè¢«æ›´æ–°ã€‚</li>\n</ul>\n<h2 id=\"Sysfs\"><a href=\"#Sysfs\" class=\"headerlink\" title=\"Sysfs\"></a>Sysfs</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/sys/devices/system/cpu/cpu0/cpufreq/policyX</span><br><span class=\"line\">scaling_driver\t\t\tr\t# cpufreq driver name</span><br><span class=\"line\">affected_cpus\t\t\tr\t# cpu</span><br><span class=\"line\">related_cpus\t\t\tr\t# &lt;?&gt;</span><br><span class=\"line\">scaling_cur_freq\t\trw\t# cur freq</span><br><span class=\"line\">scaling_min_freq\t\trw\t# min freq limit</span><br><span class=\"line\">scaling_max_freq\t\trw\t# max freq limit</span><br><span class=\"line\">scaling_governor\t\trw\t# selected governor</span><br><span class=\"line\">scaling_available_governors\tr\t# available governors</span><br><span class=\"line\">scaling_setspeed\t\tr\t# &lt;not supported&gt;</span><br><span class=\"line\">cpuinfo_min_freq\t\tr\t# hardware min freq</span><br><span class=\"line\">cpuinfo_max_freq\t\tr\t# hardware max freq</span><br><span class=\"line\">cpuinfo_transition_latency\tr\t# hardware latency</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"Governors\"><a href=\"#Governors\" class=\"headerlink\" title=\"Governors\"></a>Governors</h2><p>Governorè´Ÿè´£ä»ç³»ç»Ÿæ”¶é›†ä¿¡æ¯ï¼Œå¹¶è§¦å‘è°ƒé¢‘åŠ¨ä½œã€‚</p>\n<p><strong>powersave</strong></p>\n<p>always lowest frequency</p>\n<p><strong>performance</strong></p>\n<p>always highest frequency</p>\n<p><strong>schedutil</strong></p>\n<p>uses CPU utilization data from scheduler to determine target frequence</p>\n<p>å¾…å®Œæˆ</p>\n<p><strong>userspace</strong></p>\n<p>allow user space set the frequency</p>\n<p><strong>ondemand</strong></p>\n<p>uses CPU load as a CPU frequency selection metric</p>\n<p>it reaches the target by CPU load, 0-&gt;min, 100-&gt;max</p>\n<p><strong>conservative</strong></p>\n<p>uses CPU load as a CPU frequency selection metric</p>\n<p>it reaches the target step by step, up_threshold-&gt;up, down_threshold-&gt;down</p>\n<h2 id=\"Files\"><a href=\"#Files\" class=\"headerlink\" title=\"Files\"></a>Files</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- /drivers/cpufreq/cpufreq.c</span><br><span class=\"line\">- /drivers/cpufreq/cpufreq-dt.c</span><br><span class=\"line\">- /drivers/cpufreq/cpufreq_stats.c</span><br><span class=\"line\">- /drivers/cpufreq/cpufreq_conservative.c</span><br><span class=\"line\">- /drivers/cpufreq/cpufreq_governor.c</span><br><span class=\"line\">- /drivers/cpufreq/cpufreq_ondemand.c</span><br><span class=\"line\">- /drivers/cpufreq/cpufreq_powersave.c</span><br><span class=\"line\">- /drivers/cpufreq/cpufreq_performance.c</span><br><span class=\"line\">- /drivers/cpufreq/cpufreq_userspace.c</span><br><span class=\"line\">- /kernel/sched/cpufreq_schedutil.c</span><br><span class=\"line\">- /kernel/power/qos.c</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"Reference\"><a href=\"#Reference\" class=\"headerlink\" title=\"Reference\"></a>Reference</h2><p><a href=\"https://www.kernel.org/doc/html/latest/admin-guide/pm/cpufreq.html\">https://www.kernel.org/doc/html/latest/admin-guide/pm/cpufreq.html</a></p>\n<p><a href=\"https://docs.kernel.org/scheduler/schedutil.html\">https://docs.kernel.org/scheduler/schedutil.html</a></p>\n<p><a href=\"http://www.wowotech.net/pm_subsystem/cpufreq_overview.html\">http://www.wowotech.net/pm_subsystem/cpufreq_overview.html</a></p>\n<p><a href=\"http://www.wowotech.net/pm_subsystem/cpufreq_driver.html\">http://www.wowotech.net/pm_subsystem/cpufreq_driver.html</a></p>\n<p><a href=\"http://www.wowotech.net/pm_subsystem/cpufreq_core.html\">http://www.wowotech.net/pm_subsystem/cpufreq_core.html</a></p>\n<p><a href=\"http://www.wowotech.net/pm_subsystem/cpufreq_governor.html\">http://www.wowotech.net/pm_subsystem/cpufreq_governor.html</a></p>\n"},{"title":"Hello World","date":"2023-08-24T16:00:00.000Z","_content":"Welcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/one-command-deployment.html)\n","source":"_posts/hello-world.md","raw":"---\ntitle: Hello World\ndate: 2023-08-25 00:00:00\ncategories:\n- test\ntags:\n- test\n---\nWelcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/one-command-deployment.html)\n","slug":"hello-world","published":1,"updated":"2024-04-28T07:13:38.770Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clvjcoaas0006r9w0ciswdc7c","content":"<p>Welcome to <a href=\"https://hexo.io/\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/server.html\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo generate</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo deploy</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/one-command-deployment.html\">Deployment</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p>Welcome to <a href=\"https://hexo.io/\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/server.html\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo generate</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo deploy</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/one-command-deployment.html\">Deployment</a></p>\n"},{"title":"Hexoåœ¨å¤šå°ç”µè„‘ä¸Šæäº¤å’Œæ›´æ–°","date":"2023-09-13T07:35:30.000Z","_content":"\n[toc]\n\n\n\n# 1.åšå®¢æ­å»º\n\nhttps://yyheroi.github.io/2023/08/25/github+hexo%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/\n\n# 2.åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¤¹newï¼Œç”¨äºä¸Šä¼ hexoåšå®¢ç›®å½•\n\nå°†ä»¥ä¸‹ç›®å½•ï¼ˆé™¤äº†çº¢è‰²æ–¹æ¡†çš„ç›®å½•ï¼‰æ‹·è´åˆ°æ–°ç›®å½•ä¸­\n\n![image-20230913154437526](../imgs/image-20230913154437526.png)\n\nå‚è€ƒï¼šhttps://blog.csdn.net/K1052176873/article/details/122879462 \n\n# 3.githubä¸Šåˆ›å»ºhexoåˆ†æ”¯å¹¶è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯\n\n## åˆ›å»ºhexoåˆ†æ”¯\n\n![image-20230913154510439](../imgs/image-20230913154510439.png)\n\n## å°†hexoåˆ†æ”¯è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯\n\n![image-20230913154524492](../imgs/image-20230913154524492.png)\n\n# 4.è¿›å…¥æ–°å»ºçš„æ–‡ä»¶å¤¹ä¸­git cloneï¼Œå†ä¸Šä¼ ç›¸å…³æ–‡ä»¶è‡³hexoåˆ†æ”¯\n\nåŸºæœ¬åŸç†ï¼šgithubä»“åº“å¼€ä¸¤ä¸ªåˆ†æ”¯ï¼Œmainåˆ†æ”¯å­˜æ”¾çš„æ˜¯hexoç”Ÿæˆçš„é™æ€é¡µé¢ï¼Œhexoåˆ†æ”¯å­˜æ”¾åŸºæœ¬çš„ Hexo åšå®¢é¡¹ç›®çš„ç»“æ„å’Œé»˜è®¤é…ç½®æ–‡ä»¶ï¼Œå¦‚æ–‡ç« ï¼Œä¸»é¢˜\nå½“éœ€è¦é‡æ–°æ­å»ºç¯å¢ƒæ—¶ï¼Œç›´æ¥æ‹‰å–hexoåˆ†æ”¯ä¸­Hexoåšå®¢ç›®å½•ä»¥åŠç›¸å…³é…ç½®æ–‡ä»¶ï¼Œå½“éœ€è¦æ›´æ–°åšå®¢æ—¶ç›´æ¥\n\n```\ncd new\ngit clone git@github.com:<username>/<username>.github.io.git #<username> ç”¨æˆ·å\ngit branch    #æŸ¥çœ‹åˆ†æ”¯ï¼Œæ˜¾ç¤º * hexo\n```\n\n\n\n## 1.cloneä¸‹æ¥çš„æ–‡ä»¶å¤¹å†…åº”è¯¥æœ‰ä¸ª.gitignoreæ–‡ä»¶ï¼Œç”¨æ¥å¿½ç•¥ä¸€äº›ä¸éœ€è¦çš„æ–‡ä»¶ï¼Œè¡¨ç¤ºè¿™äº›ç±»å‹æ–‡ä»¶ä¸éœ€è¦gitã€‚å¦‚æœæ²¡æœ‰ï¼Œå³é”®æ–°å»ºï¼Œå†…å®¹å¦‚ä¸‹ï¼š\n\n```\n.DS_Store\nThumbs.db\ndb.json\n*.log\nnode_modules/\npublic/\n.deploy*/\n```\n\n## 2.å¦‚æœå·²ç»cloneè¿‡ä¸»é¢˜æ–‡ä»¶ï¼Œé‚£ä¹ˆéœ€è¦æŠŠthemeä¸»é¢˜æ–‡ä»¶å¤¹é‡Œçš„ .git ä¹Ÿåˆ é™¤ï¼Œæˆ‘è¿™é‡Œå·²ç»åˆ é™¤äº†themeä¸»é¢˜çš„.gitç›®å½•\n\n![image-20230913154559571](../imgs/image-20230913154559571.png)\n\n## 3.é€newç›®å½•ä¸­çš„ç›¸å…³æ–‡ä»¶åˆ°è¿œç¨‹ä»“åº“ hexoåˆ†æ”¯\n\n```\ngit add .\ngit commit â€“m add_branch\ngit push        \n\n```\n\n\n\n# 5.ï¼æ–°ç¯å¢ƒä¸­å¿«é€Ÿæ­å»ºåšå®¢ç¯å¢ƒï¼\n\n## 1.è®¾ç½®ssh\n\nå‚è€ƒï¼šhttps://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent\n\n```\nssh-keygen -t ed25519 -C \"your_email@gmail.com\"\ncat ~/.ssh/id_ed25519.pub  #å°†é‡Œé¢çš„å†…å®¹å¤åˆ¶åˆ° github ->settings ->SSH and GPC keys ->SSH keys ->New SSH keyä¸­\nssh -T git@github.com  #è¾“å…¥yesä¹‹åï¼Œè¡Œæœ«å°¾ä¼šæ˜¾ç¤ºä½ çš„ç”¨æˆ·åï¼ˆç»‘å®šæˆåŠŸé‚®ç®±ä¼šæ”¶åˆ°é‚®ä»¶æé†’ï¼‰\n#æ¥ç€åœ¨æœ¬åœ°ç»‘å®šä¸Githubçš„ç”¨æˆ·åå’Œé‚®ç®±ï¼ˆgitï¼‰\ngit config --global user.name \"<username>\"    #è‡ªå·±çš„ç”¨æˆ·å\ngit config --global user.email 'xxx@xxx.com'  #è‡ªå·±çš„é‚®ç®±\n```\n\n## 2.å®‰è£…nodejså’Œhexo\n\n```\nsudo apt update\nsudo apt-get install git\n\nsudo apt install nodejs\nsudo apt install npm  \n```\n\n## 3.æ‹‰å–hexoåšå®¢ç›®å½•\n\n```\ngit clone git@github.com:<username>/<username>.github.io.git #<username> ç”¨æˆ·å\ngit branch    #æŸ¥çœ‹åˆ†æ”¯ï¼Œæ˜¾ç¤º * hexo\nnpm install hexo\nnpm install\nnpm install hexo-deployer-git        #ä¸éœ€è¦hexo initè¿™æ¡æŒ‡ä»¤\nnpm i hexo-renderer-marked\n\n\n#æ›´æ–°åšå®¢ æ·»åŠ æ–°æ–‡ç«  hello-world\nhexo new \"hello-world\"\ngit add .        #å°†æ–‡ç« å¤‡ä»½è‡³ hexoåˆ†æ”¯  æˆ–è€…git add source/_posts/hello-world \ngit commit â€“m \"hello-world\"\ngit push         #æˆ–è€…git push origin hexo\n\nhexo g        #ç”Ÿæˆé™æ€é¡µé¢\nhexo s        #å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨ é¢„è§ˆ\nhexo d        #å°†ç”Ÿæˆçš„åšå®¢æ–‡ä»¶éƒ¨ç½²åˆ° github mainåˆ†æ”¯ï¼ŒHexoåšå®¢é¡¹ç›®é…ç½®æ–‡ä»¶ä¸­_config.ymlå·²è®¾ç½®å¥½\n```\n\n# 6.é‡åˆ°çš„é—®é¢˜\n\n## é—®é¢˜1.nodejsç‰ˆæœ¬è¿‡ä½\n\nnpm WARN notsup Unsupported engine for hexo@6.3.0: wanted: {\"node\":\">=12.13.0\"} (current: {\"node\":\"10.19.0\",\"npm\":\"6.14.4\"})\nnpm WARN notsup Not compatible with your version of node/npm: hexo@6.3.0\nnpm WARN notsup Unsupported engine for hexo-front-matter@3.0.0: wanted: {\"node\":\">=12.13.0\"} (current: {\"node\":\"10.19.0\",\"npm\":\"6.14.4\"})\nnpm WARN notsup Not compatible with your version of node/npm: hexo-front-matter@3.0.0\nnpm WARN notsup Unsupported engine for hexo-cli@4.3.1: wanted: {\"node\":\">=14\"} (current: {\"node\":\"10.19.0\",\"npm\":\"6.14.4\"})\nnpm WARN notsup Not compatible with your version of node/npm: hexo-cli@4.3.1\nnpm WARN notsup Unsupported engine for hexo-log@3.2.0: wanted: {\"node\":\">=12.4.0\"} (current: {\"node\":\"10.19.0\",\"npm\":\"6.14.4\"})\nnpm WARN notsup Not compatible with your version of node/npm: hexo-log@3.2.0\nnpm WARN notsup Unsupported engine for abbrev@2.0.0: wanted: {\"node\":\"^14.17.0 || ^16.13.0 || >=18.0.0\"} (current: {\"node\":\"10.19.0\",\"npm\":\"6.14.4\"})\nnpm WARN notsup Not compatible with your version of node/npm: abbrev@2.0.0\nnpm WARN notsup Unsupported engine for hexo-fs@4.1.1: wanted: {\"node\":\">=14\"} (current: {\"node\":\"10.19.0\",\"npm\":\"6.14.4\"})\nnpm WARN notsup Not compatible with your version of node/npm: hexo-fs@4.1.1\nnpm WARN notsup Unsupported engine for hexo-log@4.1.0: wanted: {\"node\":\">=14\"} (current: {\"node\":\"10.19.0\",\"npm\":\"6.14.4\"})\nnpm WARN notsup Not compatible with your version of node/npm: hexo-log@4.1.0\nnpm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@2.3.3 (node_modules/fsevents):\nnpm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for fsevents@2.3.3: wanted {\"os\":\"darwin\",\"arch\":\"any\"} (current: {\"os\":\"linux\",\"arch\":\"x64\"})\n\n## å‡çº§nodejs\n\n```\nwget -qO- https://raw.githubusercontent.com/nvm-sh/nvm/v0.38.0/install.sh | bash         #å®‰è£… nvm\nsource ~/.bashrc            #åŠ è½½ nvm\nnvm install node            #ä½¿ç”¨ nvm å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ Node.js\nnode -v                     #éªŒè¯ Node.js ç‰ˆæœ¬\n```\n\n\n\n\n\n## é—®é¢˜2.hexoåšå®¢å›¾ç‰‡ä¸æ˜¾ç¤º\n\nhttps://blog.csdn.net/QRLYLETITBE/article/details/127737904 \n\n```\nnpm i hexo-renderer-marked\n\n```\n\n## æ–°å»ºimgsæ–‡ä»¶å¤¹\n\n![image-20230913161638961](../imgs/image-20230913161638961.png)\n\n```\nmarked:\n  prependRoot: true\n  postAsset: true\n\n```\n## ä¿®æ”¹å›¾ç‰‡è·¯å¾„\n\n![image-20230913161842174](../imgs/image-20230913161842174.png)\n","source":"_posts/Hexoåœ¨å¤šå°ç”µè„‘ä¸Šæäº¤å’Œæ›´æ–°.md","raw":"---\ntitle: Hexoåœ¨å¤šå°ç”µè„‘ä¸Šæäº¤å’Œæ›´æ–°\ndate: 2023-09-13 15:35:30\ncategories:\n- test\ntags:\n- test\n---\n\n[toc]\n\n\n\n# 1.åšå®¢æ­å»º\n\nhttps://yyheroi.github.io/2023/08/25/github+hexo%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/\n\n# 2.åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¤¹newï¼Œç”¨äºä¸Šä¼ hexoåšå®¢ç›®å½•\n\nå°†ä»¥ä¸‹ç›®å½•ï¼ˆé™¤äº†çº¢è‰²æ–¹æ¡†çš„ç›®å½•ï¼‰æ‹·è´åˆ°æ–°ç›®å½•ä¸­\n\n![image-20230913154437526](../imgs/image-20230913154437526.png)\n\nå‚è€ƒï¼šhttps://blog.csdn.net/K1052176873/article/details/122879462 \n\n# 3.githubä¸Šåˆ›å»ºhexoåˆ†æ”¯å¹¶è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯\n\n## åˆ›å»ºhexoåˆ†æ”¯\n\n![image-20230913154510439](../imgs/image-20230913154510439.png)\n\n## å°†hexoåˆ†æ”¯è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯\n\n![image-20230913154524492](../imgs/image-20230913154524492.png)\n\n# 4.è¿›å…¥æ–°å»ºçš„æ–‡ä»¶å¤¹ä¸­git cloneï¼Œå†ä¸Šä¼ ç›¸å…³æ–‡ä»¶è‡³hexoåˆ†æ”¯\n\nåŸºæœ¬åŸç†ï¼šgithubä»“åº“å¼€ä¸¤ä¸ªåˆ†æ”¯ï¼Œmainåˆ†æ”¯å­˜æ”¾çš„æ˜¯hexoç”Ÿæˆçš„é™æ€é¡µé¢ï¼Œhexoåˆ†æ”¯å­˜æ”¾åŸºæœ¬çš„ Hexo åšå®¢é¡¹ç›®çš„ç»“æ„å’Œé»˜è®¤é…ç½®æ–‡ä»¶ï¼Œå¦‚æ–‡ç« ï¼Œä¸»é¢˜\nå½“éœ€è¦é‡æ–°æ­å»ºç¯å¢ƒæ—¶ï¼Œç›´æ¥æ‹‰å–hexoåˆ†æ”¯ä¸­Hexoåšå®¢ç›®å½•ä»¥åŠç›¸å…³é…ç½®æ–‡ä»¶ï¼Œå½“éœ€è¦æ›´æ–°åšå®¢æ—¶ç›´æ¥\n\n```\ncd new\ngit clone git@github.com:<username>/<username>.github.io.git #<username> ç”¨æˆ·å\ngit branch    #æŸ¥çœ‹åˆ†æ”¯ï¼Œæ˜¾ç¤º * hexo\n```\n\n\n\n## 1.cloneä¸‹æ¥çš„æ–‡ä»¶å¤¹å†…åº”è¯¥æœ‰ä¸ª.gitignoreæ–‡ä»¶ï¼Œç”¨æ¥å¿½ç•¥ä¸€äº›ä¸éœ€è¦çš„æ–‡ä»¶ï¼Œè¡¨ç¤ºè¿™äº›ç±»å‹æ–‡ä»¶ä¸éœ€è¦gitã€‚å¦‚æœæ²¡æœ‰ï¼Œå³é”®æ–°å»ºï¼Œå†…å®¹å¦‚ä¸‹ï¼š\n\n```\n.DS_Store\nThumbs.db\ndb.json\n*.log\nnode_modules/\npublic/\n.deploy*/\n```\n\n## 2.å¦‚æœå·²ç»cloneè¿‡ä¸»é¢˜æ–‡ä»¶ï¼Œé‚£ä¹ˆéœ€è¦æŠŠthemeä¸»é¢˜æ–‡ä»¶å¤¹é‡Œçš„ .git ä¹Ÿåˆ é™¤ï¼Œæˆ‘è¿™é‡Œå·²ç»åˆ é™¤äº†themeä¸»é¢˜çš„.gitç›®å½•\n\n![image-20230913154559571](../imgs/image-20230913154559571.png)\n\n## 3.é€newç›®å½•ä¸­çš„ç›¸å…³æ–‡ä»¶åˆ°è¿œç¨‹ä»“åº“ hexoåˆ†æ”¯\n\n```\ngit add .\ngit commit â€“m add_branch\ngit push        \n\n```\n\n\n\n# 5.ï¼æ–°ç¯å¢ƒä¸­å¿«é€Ÿæ­å»ºåšå®¢ç¯å¢ƒï¼\n\n## 1.è®¾ç½®ssh\n\nå‚è€ƒï¼šhttps://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent\n\n```\nssh-keygen -t ed25519 -C \"your_email@gmail.com\"\ncat ~/.ssh/id_ed25519.pub  #å°†é‡Œé¢çš„å†…å®¹å¤åˆ¶åˆ° github ->settings ->SSH and GPC keys ->SSH keys ->New SSH keyä¸­\nssh -T git@github.com  #è¾“å…¥yesä¹‹åï¼Œè¡Œæœ«å°¾ä¼šæ˜¾ç¤ºä½ çš„ç”¨æˆ·åï¼ˆç»‘å®šæˆåŠŸé‚®ç®±ä¼šæ”¶åˆ°é‚®ä»¶æé†’ï¼‰\n#æ¥ç€åœ¨æœ¬åœ°ç»‘å®šä¸Githubçš„ç”¨æˆ·åå’Œé‚®ç®±ï¼ˆgitï¼‰\ngit config --global user.name \"<username>\"    #è‡ªå·±çš„ç”¨æˆ·å\ngit config --global user.email 'xxx@xxx.com'  #è‡ªå·±çš„é‚®ç®±\n```\n\n## 2.å®‰è£…nodejså’Œhexo\n\n```\nsudo apt update\nsudo apt-get install git\n\nsudo apt install nodejs\nsudo apt install npm  \n```\n\n## 3.æ‹‰å–hexoåšå®¢ç›®å½•\n\n```\ngit clone git@github.com:<username>/<username>.github.io.git #<username> ç”¨æˆ·å\ngit branch    #æŸ¥çœ‹åˆ†æ”¯ï¼Œæ˜¾ç¤º * hexo\nnpm install hexo\nnpm install\nnpm install hexo-deployer-git        #ä¸éœ€è¦hexo initè¿™æ¡æŒ‡ä»¤\nnpm i hexo-renderer-marked\n\n\n#æ›´æ–°åšå®¢ æ·»åŠ æ–°æ–‡ç«  hello-world\nhexo new \"hello-world\"\ngit add .        #å°†æ–‡ç« å¤‡ä»½è‡³ hexoåˆ†æ”¯  æˆ–è€…git add source/_posts/hello-world \ngit commit â€“m \"hello-world\"\ngit push         #æˆ–è€…git push origin hexo\n\nhexo g        #ç”Ÿæˆé™æ€é¡µé¢\nhexo s        #å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨ é¢„è§ˆ\nhexo d        #å°†ç”Ÿæˆçš„åšå®¢æ–‡ä»¶éƒ¨ç½²åˆ° github mainåˆ†æ”¯ï¼ŒHexoåšå®¢é¡¹ç›®é…ç½®æ–‡ä»¶ä¸­_config.ymlå·²è®¾ç½®å¥½\n```\n\n# 6.é‡åˆ°çš„é—®é¢˜\n\n## é—®é¢˜1.nodejsç‰ˆæœ¬è¿‡ä½\n\nnpm WARN notsup Unsupported engine for hexo@6.3.0: wanted: {\"node\":\">=12.13.0\"} (current: {\"node\":\"10.19.0\",\"npm\":\"6.14.4\"})\nnpm WARN notsup Not compatible with your version of node/npm: hexo@6.3.0\nnpm WARN notsup Unsupported engine for hexo-front-matter@3.0.0: wanted: {\"node\":\">=12.13.0\"} (current: {\"node\":\"10.19.0\",\"npm\":\"6.14.4\"})\nnpm WARN notsup Not compatible with your version of node/npm: hexo-front-matter@3.0.0\nnpm WARN notsup Unsupported engine for hexo-cli@4.3.1: wanted: {\"node\":\">=14\"} (current: {\"node\":\"10.19.0\",\"npm\":\"6.14.4\"})\nnpm WARN notsup Not compatible with your version of node/npm: hexo-cli@4.3.1\nnpm WARN notsup Unsupported engine for hexo-log@3.2.0: wanted: {\"node\":\">=12.4.0\"} (current: {\"node\":\"10.19.0\",\"npm\":\"6.14.4\"})\nnpm WARN notsup Not compatible with your version of node/npm: hexo-log@3.2.0\nnpm WARN notsup Unsupported engine for abbrev@2.0.0: wanted: {\"node\":\"^14.17.0 || ^16.13.0 || >=18.0.0\"} (current: {\"node\":\"10.19.0\",\"npm\":\"6.14.4\"})\nnpm WARN notsup Not compatible with your version of node/npm: abbrev@2.0.0\nnpm WARN notsup Unsupported engine for hexo-fs@4.1.1: wanted: {\"node\":\">=14\"} (current: {\"node\":\"10.19.0\",\"npm\":\"6.14.4\"})\nnpm WARN notsup Not compatible with your version of node/npm: hexo-fs@4.1.1\nnpm WARN notsup Unsupported engine for hexo-log@4.1.0: wanted: {\"node\":\">=14\"} (current: {\"node\":\"10.19.0\",\"npm\":\"6.14.4\"})\nnpm WARN notsup Not compatible with your version of node/npm: hexo-log@4.1.0\nnpm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@2.3.3 (node_modules/fsevents):\nnpm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for fsevents@2.3.3: wanted {\"os\":\"darwin\",\"arch\":\"any\"} (current: {\"os\":\"linux\",\"arch\":\"x64\"})\n\n## å‡çº§nodejs\n\n```\nwget -qO- https://raw.githubusercontent.com/nvm-sh/nvm/v0.38.0/install.sh | bash         #å®‰è£… nvm\nsource ~/.bashrc            #åŠ è½½ nvm\nnvm install node            #ä½¿ç”¨ nvm å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ Node.js\nnode -v                     #éªŒè¯ Node.js ç‰ˆæœ¬\n```\n\n\n\n\n\n## é—®é¢˜2.hexoåšå®¢å›¾ç‰‡ä¸æ˜¾ç¤º\n\nhttps://blog.csdn.net/QRLYLETITBE/article/details/127737904 \n\n```\nnpm i hexo-renderer-marked\n\n```\n\n## æ–°å»ºimgsæ–‡ä»¶å¤¹\n\n![image-20230913161638961](../imgs/image-20230913161638961.png)\n\n```\nmarked:\n  prependRoot: true\n  postAsset: true\n\n```\n## ä¿®æ”¹å›¾ç‰‡è·¯å¾„\n\n![image-20230913161842174](../imgs/image-20230913161842174.png)\n","slug":"Hexoåœ¨å¤šå°ç”µè„‘ä¸Šæäº¤å’Œæ›´æ–°","published":1,"updated":"2024-04-28T07:17:56.763Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clvjcoaau0009r9w09xzi7r99","content":"<p>[toc]</p>\n<h1 id=\"1-åšå®¢æ­å»º\"><a href=\"#1-åšå®¢æ­å»º\" class=\"headerlink\" title=\"1.åšå®¢æ­å»º\"></a>1.åšå®¢æ­å»º</h1><p><a href=\"https://yyheroi.github.io/2023/08/25/github+hexo%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/\">https://yyheroi.github.io/2023/08/25/github+hexo%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/</a></p>\n<h1 id=\"2-åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¤¹newï¼Œç”¨äºä¸Šä¼ hexoåšå®¢ç›®å½•\"><a href=\"#2-åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¤¹newï¼Œç”¨äºä¸Šä¼ hexoåšå®¢ç›®å½•\" class=\"headerlink\" title=\"2.åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¤¹newï¼Œç”¨äºä¸Šä¼ hexoåšå®¢ç›®å½•\"></a>2.åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¤¹newï¼Œç”¨äºä¸Šä¼ hexoåšå®¢ç›®å½•</h1><p>å°†ä»¥ä¸‹ç›®å½•ï¼ˆé™¤äº†çº¢è‰²æ–¹æ¡†çš„ç›®å½•ï¼‰æ‹·è´åˆ°æ–°ç›®å½•ä¸­</p>\n<p><img src=\"/../imgs/image-20230913154437526.png\" alt=\"image-20230913154437526\"></p>\n<p>å‚è€ƒï¼š<a href=\"https://blog.csdn.net/K1052176873/article/details/122879462\">https://blog.csdn.net/K1052176873/article/details/122879462</a> </p>\n<h1 id=\"3-githubä¸Šåˆ›å»ºhexoåˆ†æ”¯å¹¶è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯\"><a href=\"#3-githubä¸Šåˆ›å»ºhexoåˆ†æ”¯å¹¶è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯\" class=\"headerlink\" title=\"3.githubä¸Šåˆ›å»ºhexoåˆ†æ”¯å¹¶è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯\"></a>3.githubä¸Šåˆ›å»ºhexoåˆ†æ”¯å¹¶è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯</h1><h2 id=\"åˆ›å»ºhexoåˆ†æ”¯\"><a href=\"#åˆ›å»ºhexoåˆ†æ”¯\" class=\"headerlink\" title=\"åˆ›å»ºhexoåˆ†æ”¯\"></a>åˆ›å»ºhexoåˆ†æ”¯</h2><p><img src=\"/../imgs/image-20230913154510439.png\" alt=\"image-20230913154510439\"></p>\n<h2 id=\"å°†hexoåˆ†æ”¯è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯\"><a href=\"#å°†hexoåˆ†æ”¯è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯\" class=\"headerlink\" title=\"å°†hexoåˆ†æ”¯è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯\"></a>å°†hexoåˆ†æ”¯è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯</h2><p><img src=\"/../imgs/image-20230913154524492.png\" alt=\"image-20230913154524492\"></p>\n<h1 id=\"4-è¿›å…¥æ–°å»ºçš„æ–‡ä»¶å¤¹ä¸­git-cloneï¼Œå†ä¸Šä¼ ç›¸å…³æ–‡ä»¶è‡³hexoåˆ†æ”¯\"><a href=\"#4-è¿›å…¥æ–°å»ºçš„æ–‡ä»¶å¤¹ä¸­git-cloneï¼Œå†ä¸Šä¼ ç›¸å…³æ–‡ä»¶è‡³hexoåˆ†æ”¯\" class=\"headerlink\" title=\"4.è¿›å…¥æ–°å»ºçš„æ–‡ä»¶å¤¹ä¸­git cloneï¼Œå†ä¸Šä¼ ç›¸å…³æ–‡ä»¶è‡³hexoåˆ†æ”¯\"></a>4.è¿›å…¥æ–°å»ºçš„æ–‡ä»¶å¤¹ä¸­git cloneï¼Œå†ä¸Šä¼ ç›¸å…³æ–‡ä»¶è‡³hexoåˆ†æ”¯</h1><p>åŸºæœ¬åŸç†ï¼šgithubä»“åº“å¼€ä¸¤ä¸ªåˆ†æ”¯ï¼Œmainåˆ†æ”¯å­˜æ”¾çš„æ˜¯hexoç”Ÿæˆçš„é™æ€é¡µé¢ï¼Œhexoåˆ†æ”¯å­˜æ”¾åŸºæœ¬çš„ Hexo åšå®¢é¡¹ç›®çš„ç»“æ„å’Œé»˜è®¤é…ç½®æ–‡ä»¶ï¼Œå¦‚æ–‡ç« ï¼Œä¸»é¢˜<br>å½“éœ€è¦é‡æ–°æ­å»ºç¯å¢ƒæ—¶ï¼Œç›´æ¥æ‹‰å–hexoåˆ†æ”¯ä¸­Hexoåšå®¢ç›®å½•ä»¥åŠç›¸å…³é…ç½®æ–‡ä»¶ï¼Œå½“éœ€è¦æ›´æ–°åšå®¢æ—¶ç›´æ¥</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd new</span><br><span class=\"line\">git clone git@github.com:&lt;username&gt;/&lt;username&gt;.github.io.git #&lt;username&gt; ç”¨æˆ·å</span><br><span class=\"line\">git branch    #æŸ¥çœ‹åˆ†æ”¯ï¼Œæ˜¾ç¤º * hexo</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"1-cloneä¸‹æ¥çš„æ–‡ä»¶å¤¹å†…åº”è¯¥æœ‰ä¸ª-gitignoreæ–‡ä»¶ï¼Œç”¨æ¥å¿½ç•¥ä¸€äº›ä¸éœ€è¦çš„æ–‡ä»¶ï¼Œè¡¨ç¤ºè¿™äº›ç±»å‹æ–‡ä»¶ä¸éœ€è¦gitã€‚å¦‚æœæ²¡æœ‰ï¼Œå³é”®æ–°å»ºï¼Œå†…å®¹å¦‚ä¸‹ï¼š\"><a href=\"#1-cloneä¸‹æ¥çš„æ–‡ä»¶å¤¹å†…åº”è¯¥æœ‰ä¸ª-gitignoreæ–‡ä»¶ï¼Œç”¨æ¥å¿½ç•¥ä¸€äº›ä¸éœ€è¦çš„æ–‡ä»¶ï¼Œè¡¨ç¤ºè¿™äº›ç±»å‹æ–‡ä»¶ä¸éœ€è¦gitã€‚å¦‚æœæ²¡æœ‰ï¼Œå³é”®æ–°å»ºï¼Œå†…å®¹å¦‚ä¸‹ï¼š\" class=\"headerlink\" title=\"1.cloneä¸‹æ¥çš„æ–‡ä»¶å¤¹å†…åº”è¯¥æœ‰ä¸ª.gitignoreæ–‡ä»¶ï¼Œç”¨æ¥å¿½ç•¥ä¸€äº›ä¸éœ€è¦çš„æ–‡ä»¶ï¼Œè¡¨ç¤ºè¿™äº›ç±»å‹æ–‡ä»¶ä¸éœ€è¦gitã€‚å¦‚æœæ²¡æœ‰ï¼Œå³é”®æ–°å»ºï¼Œå†…å®¹å¦‚ä¸‹ï¼š\"></a>1.cloneä¸‹æ¥çš„æ–‡ä»¶å¤¹å†…åº”è¯¥æœ‰ä¸ª.gitignoreæ–‡ä»¶ï¼Œç”¨æ¥å¿½ç•¥ä¸€äº›ä¸éœ€è¦çš„æ–‡ä»¶ï¼Œè¡¨ç¤ºè¿™äº›ç±»å‹æ–‡ä»¶ä¸éœ€è¦gitã€‚å¦‚æœæ²¡æœ‰ï¼Œå³é”®æ–°å»ºï¼Œå†…å®¹å¦‚ä¸‹ï¼š</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.DS_Store</span><br><span class=\"line\">Thumbs.db</span><br><span class=\"line\">db.json</span><br><span class=\"line\">*.log</span><br><span class=\"line\">node_modules/</span><br><span class=\"line\">public/</span><br><span class=\"line\">.deploy*/</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2-å¦‚æœå·²ç»cloneè¿‡ä¸»é¢˜æ–‡ä»¶ï¼Œé‚£ä¹ˆéœ€è¦æŠŠthemeä¸»é¢˜æ–‡ä»¶å¤¹é‡Œçš„-git-ä¹Ÿåˆ é™¤ï¼Œæˆ‘è¿™é‡Œå·²ç»åˆ é™¤äº†themeä¸»é¢˜çš„-gitç›®å½•\"><a href=\"#2-å¦‚æœå·²ç»cloneè¿‡ä¸»é¢˜æ–‡ä»¶ï¼Œé‚£ä¹ˆéœ€è¦æŠŠthemeä¸»é¢˜æ–‡ä»¶å¤¹é‡Œçš„-git-ä¹Ÿåˆ é™¤ï¼Œæˆ‘è¿™é‡Œå·²ç»åˆ é™¤äº†themeä¸»é¢˜çš„-gitç›®å½•\" class=\"headerlink\" title=\"2.å¦‚æœå·²ç»cloneè¿‡ä¸»é¢˜æ–‡ä»¶ï¼Œé‚£ä¹ˆéœ€è¦æŠŠthemeä¸»é¢˜æ–‡ä»¶å¤¹é‡Œçš„ .git ä¹Ÿåˆ é™¤ï¼Œæˆ‘è¿™é‡Œå·²ç»åˆ é™¤äº†themeä¸»é¢˜çš„.gitç›®å½•\"></a>2.å¦‚æœå·²ç»cloneè¿‡ä¸»é¢˜æ–‡ä»¶ï¼Œé‚£ä¹ˆéœ€è¦æŠŠthemeä¸»é¢˜æ–‡ä»¶å¤¹é‡Œçš„ .git ä¹Ÿåˆ é™¤ï¼Œæˆ‘è¿™é‡Œå·²ç»åˆ é™¤äº†themeä¸»é¢˜çš„.gitç›®å½•</h2><p><img src=\"/../imgs/image-20230913154559571.png\" alt=\"image-20230913154559571\"></p>\n<h2 id=\"3-é€newç›®å½•ä¸­çš„ç›¸å…³æ–‡ä»¶åˆ°è¿œç¨‹ä»“åº“-hexoåˆ†æ”¯\"><a href=\"#3-é€newç›®å½•ä¸­çš„ç›¸å…³æ–‡ä»¶åˆ°è¿œç¨‹ä»“åº“-hexoåˆ†æ”¯\" class=\"headerlink\" title=\"3.é€newç›®å½•ä¸­çš„ç›¸å…³æ–‡ä»¶åˆ°è¿œç¨‹ä»“åº“ hexoåˆ†æ”¯\"></a>3.é€newç›®å½•ä¸­çš„ç›¸å…³æ–‡ä»¶åˆ°è¿œç¨‹ä»“åº“ hexoåˆ†æ”¯</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git add .</span><br><span class=\"line\">git commit â€“m add_branch</span><br><span class=\"line\">git push        </span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"5-ï¼æ–°ç¯å¢ƒä¸­å¿«é€Ÿæ­å»ºåšå®¢ç¯å¢ƒï¼\"><a href=\"#5-ï¼æ–°ç¯å¢ƒä¸­å¿«é€Ÿæ­å»ºåšå®¢ç¯å¢ƒï¼\" class=\"headerlink\" title=\"5.ï¼æ–°ç¯å¢ƒä¸­å¿«é€Ÿæ­å»ºåšå®¢ç¯å¢ƒï¼\"></a>5.ï¼æ–°ç¯å¢ƒä¸­å¿«é€Ÿæ­å»ºåšå®¢ç¯å¢ƒï¼</h1><h2 id=\"1-è®¾ç½®ssh\"><a href=\"#1-è®¾ç½®ssh\" class=\"headerlink\" title=\"1.è®¾ç½®ssh\"></a>1.è®¾ç½®ssh</h2><p>å‚è€ƒï¼š<a href=\"https://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent\">https://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent</a></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t ed25519 -C &quot;your_email@gmail.com&quot;</span><br><span class=\"line\">cat ~/.ssh/id_ed25519.pub  #å°†é‡Œé¢çš„å†…å®¹å¤åˆ¶åˆ° github -&gt;settings -&gt;SSH and GPC keys -&gt;SSH keys -&gt;New SSH keyä¸­</span><br><span class=\"line\">ssh -T git@github.com  #è¾“å…¥yesä¹‹åï¼Œè¡Œæœ«å°¾ä¼šæ˜¾ç¤ºä½ çš„ç”¨æˆ·åï¼ˆç»‘å®šæˆåŠŸé‚®ç®±ä¼šæ”¶åˆ°é‚®ä»¶æé†’ï¼‰</span><br><span class=\"line\">#æ¥ç€åœ¨æœ¬åœ°ç»‘å®šä¸Githubçš„ç”¨æˆ·åå’Œé‚®ç®±ï¼ˆgitï¼‰</span><br><span class=\"line\">git config --global user.name &quot;&lt;username&gt;&quot;    #è‡ªå·±çš„ç”¨æˆ·å</span><br><span class=\"line\">git config --global user.email &#x27;xxx@xxx.com&#x27;  #è‡ªå·±çš„é‚®ç®±</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2-å®‰è£…nodejså’Œhexo\"><a href=\"#2-å®‰è£…nodejså’Œhexo\" class=\"headerlink\" title=\"2.å®‰è£…nodejså’Œhexo\"></a>2.å®‰è£…nodejså’Œhexo</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt update</span><br><span class=\"line\">sudo apt-get install git</span><br><span class=\"line\"></span><br><span class=\"line\">sudo apt install nodejs</span><br><span class=\"line\">sudo apt install npm  </span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3-æ‹‰å–hexoåšå®¢ç›®å½•\"><a href=\"#3-æ‹‰å–hexoåšå®¢ç›®å½•\" class=\"headerlink\" title=\"3.æ‹‰å–hexoåšå®¢ç›®å½•\"></a>3.æ‹‰å–hexoåšå®¢ç›®å½•</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git clone git@github.com:&lt;username&gt;/&lt;username&gt;.github.io.git #&lt;username&gt; ç”¨æˆ·å</span><br><span class=\"line\">git branch    #æŸ¥çœ‹åˆ†æ”¯ï¼Œæ˜¾ç¤º * hexo</span><br><span class=\"line\">npm install hexo</span><br><span class=\"line\">npm install</span><br><span class=\"line\">npm install hexo-deployer-git        #ä¸éœ€è¦hexo initè¿™æ¡æŒ‡ä»¤</span><br><span class=\"line\">npm i hexo-renderer-marked</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">#æ›´æ–°åšå®¢ æ·»åŠ æ–°æ–‡ç«  hello-world</span><br><span class=\"line\">hexo new &quot;hello-world&quot;</span><br><span class=\"line\">git add .        #å°†æ–‡ç« å¤‡ä»½è‡³ hexoåˆ†æ”¯  æˆ–è€…git add source/_posts/hello-world </span><br><span class=\"line\">git commit â€“m &quot;hello-world&quot;</span><br><span class=\"line\">git push         #æˆ–è€…git push origin hexo</span><br><span class=\"line\"></span><br><span class=\"line\">hexo g        #ç”Ÿæˆé™æ€é¡µé¢</span><br><span class=\"line\">hexo s        #å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨ é¢„è§ˆ</span><br><span class=\"line\">hexo d        #å°†ç”Ÿæˆçš„åšå®¢æ–‡ä»¶éƒ¨ç½²åˆ° github mainåˆ†æ”¯ï¼ŒHexoåšå®¢é¡¹ç›®é…ç½®æ–‡ä»¶ä¸­_config.ymlå·²è®¾ç½®å¥½</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"6-é‡åˆ°çš„é—®é¢˜\"><a href=\"#6-é‡åˆ°çš„é—®é¢˜\" class=\"headerlink\" title=\"6.é‡åˆ°çš„é—®é¢˜\"></a>6.é‡åˆ°çš„é—®é¢˜</h1><h2 id=\"é—®é¢˜1-nodejsç‰ˆæœ¬è¿‡ä½\"><a href=\"#é—®é¢˜1-nodejsç‰ˆæœ¬è¿‡ä½\" class=\"headerlink\" title=\"é—®é¢˜1.nodejsç‰ˆæœ¬è¿‡ä½\"></a>é—®é¢˜1.nodejsç‰ˆæœ¬è¿‡ä½</h2><p>npm WARN notsup Unsupported engine for <a href=\"mailto:&#104;&#101;&#120;&#x6f;&#x40;&#x36;&#x2e;&#51;&#x2e;&#48;\">&#104;&#101;&#120;&#x6f;&#x40;&#x36;&#x2e;&#51;&#x2e;&#48;</a>: wanted: {â€œnodeâ€:â€&gt;&#x3D;12.13.0â€} (current: {â€œnodeâ€:â€10.19.0â€,â€npmâ€:â€6.14.4â€})<br>npm WARN notsup Not compatible with your version of node&#x2F;npm: <a href=\"mailto:&#104;&#101;&#120;&#x6f;&#64;&#x36;&#46;&#x33;&#46;&#48;\">&#104;&#101;&#120;&#x6f;&#64;&#x36;&#46;&#x33;&#46;&#48;</a><br>npm WARN notsup Unsupported engine for <a href=\"mailto:&#104;&#101;&#120;&#111;&#45;&#102;&#x72;&#x6f;&#110;&#116;&#45;&#109;&#x61;&#x74;&#116;&#x65;&#114;&#x40;&#x33;&#46;&#48;&#x2e;&#x30;\">&#104;&#101;&#120;&#111;&#45;&#102;&#x72;&#x6f;&#110;&#116;&#45;&#109;&#x61;&#x74;&#116;&#x65;&#114;&#x40;&#x33;&#46;&#48;&#x2e;&#x30;</a>: wanted: {â€œnodeâ€:â€&gt;&#x3D;12.13.0â€} (current: {â€œnodeâ€:â€10.19.0â€,â€npmâ€:â€6.14.4â€})<br>npm WARN notsup Not compatible with your version of node&#x2F;npm: <a href=\"mailto:&#104;&#101;&#120;&#111;&#45;&#102;&#x72;&#111;&#x6e;&#x74;&#x2d;&#x6d;&#97;&#116;&#x74;&#x65;&#114;&#64;&#x33;&#x2e;&#48;&#46;&#48;\">&#104;&#101;&#120;&#111;&#45;&#102;&#x72;&#111;&#x6e;&#x74;&#x2d;&#x6d;&#97;&#116;&#x74;&#x65;&#114;&#64;&#x33;&#x2e;&#48;&#46;&#48;</a><br>npm WARN notsup Unsupported engine for <a href=\"mailto:&#x68;&#x65;&#120;&#111;&#x2d;&#x63;&#108;&#x69;&#64;&#52;&#x2e;&#51;&#x2e;&#x31;\">&#x68;&#x65;&#120;&#111;&#x2d;&#x63;&#108;&#x69;&#64;&#52;&#x2e;&#51;&#x2e;&#x31;</a>: wanted: {â€œnodeâ€:â€&gt;&#x3D;14â€} (current: {â€œnodeâ€:â€10.19.0â€,â€npmâ€:â€6.14.4â€})<br>npm WARN notsup Not compatible with your version of node&#x2F;npm: <a href=\"mailto:&#x68;&#x65;&#120;&#111;&#45;&#99;&#108;&#x69;&#64;&#52;&#x2e;&#51;&#46;&#49;\">&#x68;&#x65;&#120;&#111;&#45;&#99;&#108;&#x69;&#64;&#52;&#x2e;&#51;&#46;&#49;</a><br>npm WARN notsup Unsupported engine for <a href=\"mailto:&#x68;&#x65;&#x78;&#x6f;&#45;&#x6c;&#x6f;&#x67;&#64;&#x33;&#x2e;&#x32;&#x2e;&#x30;\">&#x68;&#x65;&#x78;&#x6f;&#45;&#x6c;&#x6f;&#x67;&#64;&#x33;&#x2e;&#x32;&#x2e;&#x30;</a>: wanted: {â€œnodeâ€:â€&gt;&#x3D;12.4.0â€} (current: {â€œnodeâ€:â€10.19.0â€,â€npmâ€:â€6.14.4â€})<br>npm WARN notsup Not compatible with your version of node&#x2F;npm: <a href=\"mailto:&#x68;&#101;&#x78;&#x6f;&#45;&#108;&#x6f;&#103;&#64;&#x33;&#x2e;&#50;&#x2e;&#48;\">&#x68;&#101;&#x78;&#x6f;&#45;&#108;&#x6f;&#103;&#64;&#x33;&#x2e;&#50;&#x2e;&#48;</a><br>npm WARN notsup Unsupported engine for <a href=\"mailto:&#97;&#x62;&#x62;&#114;&#101;&#118;&#64;&#x32;&#x2e;&#48;&#46;&#48;\">&#97;&#x62;&#x62;&#114;&#101;&#118;&#64;&#x32;&#x2e;&#48;&#46;&#48;</a>: wanted: {â€œnodeâ€:â€^14.17.0 || ^16.13.0 || &gt;&#x3D;18.0.0â€} (current: {â€œnodeâ€:â€10.19.0â€,â€npmâ€:â€6.14.4â€})<br>npm WARN notsup Not compatible with your version of node&#x2F;npm: <a href=\"mailto:&#x61;&#x62;&#98;&#114;&#101;&#118;&#x40;&#x32;&#x2e;&#x30;&#x2e;&#x30;\">&#x61;&#x62;&#98;&#114;&#101;&#118;&#x40;&#x32;&#x2e;&#x30;&#x2e;&#x30;</a><br>npm WARN notsup Unsupported engine for <a href=\"mailto:&#x68;&#101;&#120;&#x6f;&#45;&#102;&#x73;&#64;&#52;&#x2e;&#49;&#46;&#x31;\">&#x68;&#101;&#120;&#x6f;&#45;&#102;&#x73;&#64;&#52;&#x2e;&#49;&#46;&#x31;</a>: wanted: {â€œnodeâ€:â€&gt;&#x3D;14â€} (current: {â€œnodeâ€:â€10.19.0â€,â€npmâ€:â€6.14.4â€})<br>npm WARN notsup Not compatible with your version of node&#x2F;npm: <a href=\"mailto:&#x68;&#x65;&#120;&#111;&#45;&#102;&#x73;&#x40;&#x34;&#46;&#x31;&#x2e;&#x31;\">&#x68;&#x65;&#120;&#111;&#45;&#102;&#x73;&#x40;&#x34;&#46;&#x31;&#x2e;&#x31;</a><br>npm WARN notsup Unsupported engine for <a href=\"mailto:&#104;&#101;&#120;&#111;&#x2d;&#x6c;&#111;&#x67;&#x40;&#52;&#x2e;&#x31;&#x2e;&#48;\">&#104;&#101;&#120;&#111;&#x2d;&#x6c;&#111;&#x67;&#x40;&#52;&#x2e;&#x31;&#x2e;&#48;</a>: wanted: {â€œnodeâ€:â€&gt;&#x3D;14â€} (current: {â€œnodeâ€:â€10.19.0â€,â€npmâ€:â€6.14.4â€})<br>npm WARN notsup Not compatible with your version of node&#x2F;npm: <a href=\"mailto:&#104;&#x65;&#120;&#x6f;&#x2d;&#x6c;&#111;&#x67;&#64;&#52;&#46;&#49;&#46;&#48;\">&#104;&#x65;&#120;&#x6f;&#x2d;&#x6c;&#111;&#x67;&#64;&#52;&#46;&#49;&#46;&#48;</a><br>npm WARN optional SKIPPING OPTIONAL DEPENDENCY: <a href=\"mailto:&#x66;&#115;&#101;&#x76;&#101;&#110;&#116;&#115;&#64;&#50;&#x2e;&#51;&#x2e;&#x33;\">&#x66;&#115;&#101;&#x76;&#101;&#110;&#116;&#115;&#64;&#50;&#x2e;&#51;&#x2e;&#x33;</a> (node_modules&#x2F;fsevents):<br>npm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for <a href=\"mailto:&#102;&#x73;&#x65;&#118;&#101;&#110;&#116;&#115;&#x40;&#x32;&#x2e;&#51;&#x2e;&#x33;\">&#102;&#x73;&#x65;&#118;&#101;&#110;&#116;&#115;&#x40;&#x32;&#x2e;&#51;&#x2e;&#x33;</a>: wanted {â€œosâ€:â€darwinâ€,â€archâ€:â€anyâ€} (current: {â€œosâ€:â€linuxâ€,â€archâ€:â€x64â€})</p>\n<h2 id=\"å‡çº§nodejs\"><a href=\"#å‡çº§nodejs\" class=\"headerlink\" title=\"å‡çº§nodejs\"></a>å‡çº§nodejs</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget -qO- https://raw.githubusercontent.com/nvm-sh/nvm/v0.38.0/install.sh | bash         #å®‰è£… nvm</span><br><span class=\"line\">source ~/.bashrc            #åŠ è½½ nvm</span><br><span class=\"line\">nvm install node            #ä½¿ç”¨ nvm å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ Node.js</span><br><span class=\"line\">node -v                     #éªŒè¯ Node.js ç‰ˆæœ¬</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<h2 id=\"é—®é¢˜2-hexoåšå®¢å›¾ç‰‡ä¸æ˜¾ç¤º\"><a href=\"#é—®é¢˜2-hexoåšå®¢å›¾ç‰‡ä¸æ˜¾ç¤º\" class=\"headerlink\" title=\"é—®é¢˜2.hexoåšå®¢å›¾ç‰‡ä¸æ˜¾ç¤º\"></a>é—®é¢˜2.hexoåšå®¢å›¾ç‰‡ä¸æ˜¾ç¤º</h2><p><a href=\"https://blog.csdn.net/QRLYLETITBE/article/details/127737904\">https://blog.csdn.net/QRLYLETITBE/article/details/127737904</a> </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i hexo-renderer-marked</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"æ–°å»ºimgsæ–‡ä»¶å¤¹\"><a href=\"#æ–°å»ºimgsæ–‡ä»¶å¤¹\" class=\"headerlink\" title=\"æ–°å»ºimgsæ–‡ä»¶å¤¹\"></a>æ–°å»ºimgsæ–‡ä»¶å¤¹</h2><p><img src=\"/../imgs/image-20230913161638961.png\" alt=\"image-20230913161638961\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">marked:</span><br><span class=\"line\">  prependRoot: true</span><br><span class=\"line\">  postAsset: true</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h2 id=\"ä¿®æ”¹å›¾ç‰‡è·¯å¾„\"><a href=\"#ä¿®æ”¹å›¾ç‰‡è·¯å¾„\" class=\"headerlink\" title=\"ä¿®æ”¹å›¾ç‰‡è·¯å¾„\"></a>ä¿®æ”¹å›¾ç‰‡è·¯å¾„</h2><p><img src=\"/../imgs/image-20230913161842174.png\" alt=\"image-20230913161842174\"></p>\n","site":{"data":{}},"excerpt":"","more":"<p>[toc]</p>\n<h1 id=\"1-åšå®¢æ­å»º\"><a href=\"#1-åšå®¢æ­å»º\" class=\"headerlink\" title=\"1.åšå®¢æ­å»º\"></a>1.åšå®¢æ­å»º</h1><p><a href=\"https://yyheroi.github.io/2023/08/25/github+hexo%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/\">https://yyheroi.github.io/2023/08/25/github+hexo%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/</a></p>\n<h1 id=\"2-åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¤¹newï¼Œç”¨äºä¸Šä¼ hexoåšå®¢ç›®å½•\"><a href=\"#2-åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¤¹newï¼Œç”¨äºä¸Šä¼ hexoåšå®¢ç›®å½•\" class=\"headerlink\" title=\"2.åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¤¹newï¼Œç”¨äºä¸Šä¼ hexoåšå®¢ç›®å½•\"></a>2.åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¤¹newï¼Œç”¨äºä¸Šä¼ hexoåšå®¢ç›®å½•</h1><p>å°†ä»¥ä¸‹ç›®å½•ï¼ˆé™¤äº†çº¢è‰²æ–¹æ¡†çš„ç›®å½•ï¼‰æ‹·è´åˆ°æ–°ç›®å½•ä¸­</p>\n<p><img src=\"/../imgs/image-20230913154437526.png\" alt=\"image-20230913154437526\"></p>\n<p>å‚è€ƒï¼š<a href=\"https://blog.csdn.net/K1052176873/article/details/122879462\">https://blog.csdn.net/K1052176873/article/details/122879462</a> </p>\n<h1 id=\"3-githubä¸Šåˆ›å»ºhexoåˆ†æ”¯å¹¶è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯\"><a href=\"#3-githubä¸Šåˆ›å»ºhexoåˆ†æ”¯å¹¶è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯\" class=\"headerlink\" title=\"3.githubä¸Šåˆ›å»ºhexoåˆ†æ”¯å¹¶è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯\"></a>3.githubä¸Šåˆ›å»ºhexoåˆ†æ”¯å¹¶è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯</h1><h2 id=\"åˆ›å»ºhexoåˆ†æ”¯\"><a href=\"#åˆ›å»ºhexoåˆ†æ”¯\" class=\"headerlink\" title=\"åˆ›å»ºhexoåˆ†æ”¯\"></a>åˆ›å»ºhexoåˆ†æ”¯</h2><p><img src=\"/../imgs/image-20230913154510439.png\" alt=\"image-20230913154510439\"></p>\n<h2 id=\"å°†hexoåˆ†æ”¯è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯\"><a href=\"#å°†hexoåˆ†æ”¯è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯\" class=\"headerlink\" title=\"å°†hexoåˆ†æ”¯è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯\"></a>å°†hexoåˆ†æ”¯è®¾ç½®ä¸ºé»˜è®¤åˆ†æ”¯</h2><p><img src=\"/../imgs/image-20230913154524492.png\" alt=\"image-20230913154524492\"></p>\n<h1 id=\"4-è¿›å…¥æ–°å»ºçš„æ–‡ä»¶å¤¹ä¸­git-cloneï¼Œå†ä¸Šä¼ ç›¸å…³æ–‡ä»¶è‡³hexoåˆ†æ”¯\"><a href=\"#4-è¿›å…¥æ–°å»ºçš„æ–‡ä»¶å¤¹ä¸­git-cloneï¼Œå†ä¸Šä¼ ç›¸å…³æ–‡ä»¶è‡³hexoåˆ†æ”¯\" class=\"headerlink\" title=\"4.è¿›å…¥æ–°å»ºçš„æ–‡ä»¶å¤¹ä¸­git cloneï¼Œå†ä¸Šä¼ ç›¸å…³æ–‡ä»¶è‡³hexoåˆ†æ”¯\"></a>4.è¿›å…¥æ–°å»ºçš„æ–‡ä»¶å¤¹ä¸­git cloneï¼Œå†ä¸Šä¼ ç›¸å…³æ–‡ä»¶è‡³hexoåˆ†æ”¯</h1><p>åŸºæœ¬åŸç†ï¼šgithubä»“åº“å¼€ä¸¤ä¸ªåˆ†æ”¯ï¼Œmainåˆ†æ”¯å­˜æ”¾çš„æ˜¯hexoç”Ÿæˆçš„é™æ€é¡µé¢ï¼Œhexoåˆ†æ”¯å­˜æ”¾åŸºæœ¬çš„ Hexo åšå®¢é¡¹ç›®çš„ç»“æ„å’Œé»˜è®¤é…ç½®æ–‡ä»¶ï¼Œå¦‚æ–‡ç« ï¼Œä¸»é¢˜<br>å½“éœ€è¦é‡æ–°æ­å»ºç¯å¢ƒæ—¶ï¼Œç›´æ¥æ‹‰å–hexoåˆ†æ”¯ä¸­Hexoåšå®¢ç›®å½•ä»¥åŠç›¸å…³é…ç½®æ–‡ä»¶ï¼Œå½“éœ€è¦æ›´æ–°åšå®¢æ—¶ç›´æ¥</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd new</span><br><span class=\"line\">git clone git@github.com:&lt;username&gt;/&lt;username&gt;.github.io.git #&lt;username&gt; ç”¨æˆ·å</span><br><span class=\"line\">git branch    #æŸ¥çœ‹åˆ†æ”¯ï¼Œæ˜¾ç¤º * hexo</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"1-cloneä¸‹æ¥çš„æ–‡ä»¶å¤¹å†…åº”è¯¥æœ‰ä¸ª-gitignoreæ–‡ä»¶ï¼Œç”¨æ¥å¿½ç•¥ä¸€äº›ä¸éœ€è¦çš„æ–‡ä»¶ï¼Œè¡¨ç¤ºè¿™äº›ç±»å‹æ–‡ä»¶ä¸éœ€è¦gitã€‚å¦‚æœæ²¡æœ‰ï¼Œå³é”®æ–°å»ºï¼Œå†…å®¹å¦‚ä¸‹ï¼š\"><a href=\"#1-cloneä¸‹æ¥çš„æ–‡ä»¶å¤¹å†…åº”è¯¥æœ‰ä¸ª-gitignoreæ–‡ä»¶ï¼Œç”¨æ¥å¿½ç•¥ä¸€äº›ä¸éœ€è¦çš„æ–‡ä»¶ï¼Œè¡¨ç¤ºè¿™äº›ç±»å‹æ–‡ä»¶ä¸éœ€è¦gitã€‚å¦‚æœæ²¡æœ‰ï¼Œå³é”®æ–°å»ºï¼Œå†…å®¹å¦‚ä¸‹ï¼š\" class=\"headerlink\" title=\"1.cloneä¸‹æ¥çš„æ–‡ä»¶å¤¹å†…åº”è¯¥æœ‰ä¸ª.gitignoreæ–‡ä»¶ï¼Œç”¨æ¥å¿½ç•¥ä¸€äº›ä¸éœ€è¦çš„æ–‡ä»¶ï¼Œè¡¨ç¤ºè¿™äº›ç±»å‹æ–‡ä»¶ä¸éœ€è¦gitã€‚å¦‚æœæ²¡æœ‰ï¼Œå³é”®æ–°å»ºï¼Œå†…å®¹å¦‚ä¸‹ï¼š\"></a>1.cloneä¸‹æ¥çš„æ–‡ä»¶å¤¹å†…åº”è¯¥æœ‰ä¸ª.gitignoreæ–‡ä»¶ï¼Œç”¨æ¥å¿½ç•¥ä¸€äº›ä¸éœ€è¦çš„æ–‡ä»¶ï¼Œè¡¨ç¤ºè¿™äº›ç±»å‹æ–‡ä»¶ä¸éœ€è¦gitã€‚å¦‚æœæ²¡æœ‰ï¼Œå³é”®æ–°å»ºï¼Œå†…å®¹å¦‚ä¸‹ï¼š</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.DS_Store</span><br><span class=\"line\">Thumbs.db</span><br><span class=\"line\">db.json</span><br><span class=\"line\">*.log</span><br><span class=\"line\">node_modules/</span><br><span class=\"line\">public/</span><br><span class=\"line\">.deploy*/</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2-å¦‚æœå·²ç»cloneè¿‡ä¸»é¢˜æ–‡ä»¶ï¼Œé‚£ä¹ˆéœ€è¦æŠŠthemeä¸»é¢˜æ–‡ä»¶å¤¹é‡Œçš„-git-ä¹Ÿåˆ é™¤ï¼Œæˆ‘è¿™é‡Œå·²ç»åˆ é™¤äº†themeä¸»é¢˜çš„-gitç›®å½•\"><a href=\"#2-å¦‚æœå·²ç»cloneè¿‡ä¸»é¢˜æ–‡ä»¶ï¼Œé‚£ä¹ˆéœ€è¦æŠŠthemeä¸»é¢˜æ–‡ä»¶å¤¹é‡Œçš„-git-ä¹Ÿåˆ é™¤ï¼Œæˆ‘è¿™é‡Œå·²ç»åˆ é™¤äº†themeä¸»é¢˜çš„-gitç›®å½•\" class=\"headerlink\" title=\"2.å¦‚æœå·²ç»cloneè¿‡ä¸»é¢˜æ–‡ä»¶ï¼Œé‚£ä¹ˆéœ€è¦æŠŠthemeä¸»é¢˜æ–‡ä»¶å¤¹é‡Œçš„ .git ä¹Ÿåˆ é™¤ï¼Œæˆ‘è¿™é‡Œå·²ç»åˆ é™¤äº†themeä¸»é¢˜çš„.gitç›®å½•\"></a>2.å¦‚æœå·²ç»cloneè¿‡ä¸»é¢˜æ–‡ä»¶ï¼Œé‚£ä¹ˆéœ€è¦æŠŠthemeä¸»é¢˜æ–‡ä»¶å¤¹é‡Œçš„ .git ä¹Ÿåˆ é™¤ï¼Œæˆ‘è¿™é‡Œå·²ç»åˆ é™¤äº†themeä¸»é¢˜çš„.gitç›®å½•</h2><p><img src=\"/../imgs/image-20230913154559571.png\" alt=\"image-20230913154559571\"></p>\n<h2 id=\"3-é€newç›®å½•ä¸­çš„ç›¸å…³æ–‡ä»¶åˆ°è¿œç¨‹ä»“åº“-hexoåˆ†æ”¯\"><a href=\"#3-é€newç›®å½•ä¸­çš„ç›¸å…³æ–‡ä»¶åˆ°è¿œç¨‹ä»“åº“-hexoåˆ†æ”¯\" class=\"headerlink\" title=\"3.é€newç›®å½•ä¸­çš„ç›¸å…³æ–‡ä»¶åˆ°è¿œç¨‹ä»“åº“ hexoåˆ†æ”¯\"></a>3.é€newç›®å½•ä¸­çš„ç›¸å…³æ–‡ä»¶åˆ°è¿œç¨‹ä»“åº“ hexoåˆ†æ”¯</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git add .</span><br><span class=\"line\">git commit â€“m add_branch</span><br><span class=\"line\">git push        </span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"5-ï¼æ–°ç¯å¢ƒä¸­å¿«é€Ÿæ­å»ºåšå®¢ç¯å¢ƒï¼\"><a href=\"#5-ï¼æ–°ç¯å¢ƒä¸­å¿«é€Ÿæ­å»ºåšå®¢ç¯å¢ƒï¼\" class=\"headerlink\" title=\"5.ï¼æ–°ç¯å¢ƒä¸­å¿«é€Ÿæ­å»ºåšå®¢ç¯å¢ƒï¼\"></a>5.ï¼æ–°ç¯å¢ƒä¸­å¿«é€Ÿæ­å»ºåšå®¢ç¯å¢ƒï¼</h1><h2 id=\"1-è®¾ç½®ssh\"><a href=\"#1-è®¾ç½®ssh\" class=\"headerlink\" title=\"1.è®¾ç½®ssh\"></a>1.è®¾ç½®ssh</h2><p>å‚è€ƒï¼š<a href=\"https://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent\">https://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent</a></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t ed25519 -C &quot;your_email@gmail.com&quot;</span><br><span class=\"line\">cat ~/.ssh/id_ed25519.pub  #å°†é‡Œé¢çš„å†…å®¹å¤åˆ¶åˆ° github -&gt;settings -&gt;SSH and GPC keys -&gt;SSH keys -&gt;New SSH keyä¸­</span><br><span class=\"line\">ssh -T git@github.com  #è¾“å…¥yesä¹‹åï¼Œè¡Œæœ«å°¾ä¼šæ˜¾ç¤ºä½ çš„ç”¨æˆ·åï¼ˆç»‘å®šæˆåŠŸé‚®ç®±ä¼šæ”¶åˆ°é‚®ä»¶æé†’ï¼‰</span><br><span class=\"line\">#æ¥ç€åœ¨æœ¬åœ°ç»‘å®šä¸Githubçš„ç”¨æˆ·åå’Œé‚®ç®±ï¼ˆgitï¼‰</span><br><span class=\"line\">git config --global user.name &quot;&lt;username&gt;&quot;    #è‡ªå·±çš„ç”¨æˆ·å</span><br><span class=\"line\">git config --global user.email &#x27;xxx@xxx.com&#x27;  #è‡ªå·±çš„é‚®ç®±</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2-å®‰è£…nodejså’Œhexo\"><a href=\"#2-å®‰è£…nodejså’Œhexo\" class=\"headerlink\" title=\"2.å®‰è£…nodejså’Œhexo\"></a>2.å®‰è£…nodejså’Œhexo</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt update</span><br><span class=\"line\">sudo apt-get install git</span><br><span class=\"line\"></span><br><span class=\"line\">sudo apt install nodejs</span><br><span class=\"line\">sudo apt install npm  </span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3-æ‹‰å–hexoåšå®¢ç›®å½•\"><a href=\"#3-æ‹‰å–hexoåšå®¢ç›®å½•\" class=\"headerlink\" title=\"3.æ‹‰å–hexoåšå®¢ç›®å½•\"></a>3.æ‹‰å–hexoåšå®¢ç›®å½•</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git clone git@github.com:&lt;username&gt;/&lt;username&gt;.github.io.git #&lt;username&gt; ç”¨æˆ·å</span><br><span class=\"line\">git branch    #æŸ¥çœ‹åˆ†æ”¯ï¼Œæ˜¾ç¤º * hexo</span><br><span class=\"line\">npm install hexo</span><br><span class=\"line\">npm install</span><br><span class=\"line\">npm install hexo-deployer-git        #ä¸éœ€è¦hexo initè¿™æ¡æŒ‡ä»¤</span><br><span class=\"line\">npm i hexo-renderer-marked</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">#æ›´æ–°åšå®¢ æ·»åŠ æ–°æ–‡ç«  hello-world</span><br><span class=\"line\">hexo new &quot;hello-world&quot;</span><br><span class=\"line\">git add .        #å°†æ–‡ç« å¤‡ä»½è‡³ hexoåˆ†æ”¯  æˆ–è€…git add source/_posts/hello-world </span><br><span class=\"line\">git commit â€“m &quot;hello-world&quot;</span><br><span class=\"line\">git push         #æˆ–è€…git push origin hexo</span><br><span class=\"line\"></span><br><span class=\"line\">hexo g        #ç”Ÿæˆé™æ€é¡µé¢</span><br><span class=\"line\">hexo s        #å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨ é¢„è§ˆ</span><br><span class=\"line\">hexo d        #å°†ç”Ÿæˆçš„åšå®¢æ–‡ä»¶éƒ¨ç½²åˆ° github mainåˆ†æ”¯ï¼ŒHexoåšå®¢é¡¹ç›®é…ç½®æ–‡ä»¶ä¸­_config.ymlå·²è®¾ç½®å¥½</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"6-é‡åˆ°çš„é—®é¢˜\"><a href=\"#6-é‡åˆ°çš„é—®é¢˜\" class=\"headerlink\" title=\"6.é‡åˆ°çš„é—®é¢˜\"></a>6.é‡åˆ°çš„é—®é¢˜</h1><h2 id=\"é—®é¢˜1-nodejsç‰ˆæœ¬è¿‡ä½\"><a href=\"#é—®é¢˜1-nodejsç‰ˆæœ¬è¿‡ä½\" class=\"headerlink\" title=\"é—®é¢˜1.nodejsç‰ˆæœ¬è¿‡ä½\"></a>é—®é¢˜1.nodejsç‰ˆæœ¬è¿‡ä½</h2><p>npm WARN notsup Unsupported engine for <a href=\"mailto:&#104;&#101;&#120;&#x6f;&#x40;&#x36;&#x2e;&#51;&#x2e;&#48;\">&#104;&#101;&#120;&#x6f;&#x40;&#x36;&#x2e;&#51;&#x2e;&#48;</a>: wanted: {â€œnodeâ€:â€&gt;&#x3D;12.13.0â€} (current: {â€œnodeâ€:â€10.19.0â€,â€npmâ€:â€6.14.4â€})<br>npm WARN notsup Not compatible with your version of node&#x2F;npm: <a href=\"mailto:&#104;&#101;&#120;&#x6f;&#64;&#x36;&#46;&#x33;&#46;&#48;\">&#104;&#101;&#120;&#x6f;&#64;&#x36;&#46;&#x33;&#46;&#48;</a><br>npm WARN notsup Unsupported engine for <a href=\"mailto:&#104;&#101;&#120;&#111;&#45;&#102;&#x72;&#x6f;&#110;&#116;&#45;&#109;&#x61;&#x74;&#116;&#x65;&#114;&#x40;&#x33;&#46;&#48;&#x2e;&#x30;\">&#104;&#101;&#120;&#111;&#45;&#102;&#x72;&#x6f;&#110;&#116;&#45;&#109;&#x61;&#x74;&#116;&#x65;&#114;&#x40;&#x33;&#46;&#48;&#x2e;&#x30;</a>: wanted: {â€œnodeâ€:â€&gt;&#x3D;12.13.0â€} (current: {â€œnodeâ€:â€10.19.0â€,â€npmâ€:â€6.14.4â€})<br>npm WARN notsup Not compatible with your version of node&#x2F;npm: <a href=\"mailto:&#104;&#101;&#120;&#111;&#45;&#102;&#x72;&#111;&#x6e;&#x74;&#x2d;&#x6d;&#97;&#116;&#x74;&#x65;&#114;&#64;&#x33;&#x2e;&#48;&#46;&#48;\">&#104;&#101;&#120;&#111;&#45;&#102;&#x72;&#111;&#x6e;&#x74;&#x2d;&#x6d;&#97;&#116;&#x74;&#x65;&#114;&#64;&#x33;&#x2e;&#48;&#46;&#48;</a><br>npm WARN notsup Unsupported engine for <a href=\"mailto:&#x68;&#x65;&#120;&#111;&#x2d;&#x63;&#108;&#x69;&#64;&#52;&#x2e;&#51;&#x2e;&#x31;\">&#x68;&#x65;&#120;&#111;&#x2d;&#x63;&#108;&#x69;&#64;&#52;&#x2e;&#51;&#x2e;&#x31;</a>: wanted: {â€œnodeâ€:â€&gt;&#x3D;14â€} (current: {â€œnodeâ€:â€10.19.0â€,â€npmâ€:â€6.14.4â€})<br>npm WARN notsup Not compatible with your version of node&#x2F;npm: <a href=\"mailto:&#x68;&#x65;&#120;&#111;&#45;&#99;&#108;&#x69;&#64;&#52;&#x2e;&#51;&#46;&#49;\">&#x68;&#x65;&#120;&#111;&#45;&#99;&#108;&#x69;&#64;&#52;&#x2e;&#51;&#46;&#49;</a><br>npm WARN notsup Unsupported engine for <a href=\"mailto:&#x68;&#x65;&#x78;&#x6f;&#45;&#x6c;&#x6f;&#x67;&#64;&#x33;&#x2e;&#x32;&#x2e;&#x30;\">&#x68;&#x65;&#x78;&#x6f;&#45;&#x6c;&#x6f;&#x67;&#64;&#x33;&#x2e;&#x32;&#x2e;&#x30;</a>: wanted: {â€œnodeâ€:â€&gt;&#x3D;12.4.0â€} (current: {â€œnodeâ€:â€10.19.0â€,â€npmâ€:â€6.14.4â€})<br>npm WARN notsup Not compatible with your version of node&#x2F;npm: <a href=\"mailto:&#x68;&#101;&#x78;&#x6f;&#45;&#108;&#x6f;&#103;&#64;&#x33;&#x2e;&#50;&#x2e;&#48;\">&#x68;&#101;&#x78;&#x6f;&#45;&#108;&#x6f;&#103;&#64;&#x33;&#x2e;&#50;&#x2e;&#48;</a><br>npm WARN notsup Unsupported engine for <a href=\"mailto:&#97;&#x62;&#x62;&#114;&#101;&#118;&#64;&#x32;&#x2e;&#48;&#46;&#48;\">&#97;&#x62;&#x62;&#114;&#101;&#118;&#64;&#x32;&#x2e;&#48;&#46;&#48;</a>: wanted: {â€œnodeâ€:â€^14.17.0 || ^16.13.0 || &gt;&#x3D;18.0.0â€} (current: {â€œnodeâ€:â€10.19.0â€,â€npmâ€:â€6.14.4â€})<br>npm WARN notsup Not compatible with your version of node&#x2F;npm: <a href=\"mailto:&#x61;&#x62;&#98;&#114;&#101;&#118;&#x40;&#x32;&#x2e;&#x30;&#x2e;&#x30;\">&#x61;&#x62;&#98;&#114;&#101;&#118;&#x40;&#x32;&#x2e;&#x30;&#x2e;&#x30;</a><br>npm WARN notsup Unsupported engine for <a href=\"mailto:&#x68;&#101;&#120;&#x6f;&#45;&#102;&#x73;&#64;&#52;&#x2e;&#49;&#46;&#x31;\">&#x68;&#101;&#120;&#x6f;&#45;&#102;&#x73;&#64;&#52;&#x2e;&#49;&#46;&#x31;</a>: wanted: {â€œnodeâ€:â€&gt;&#x3D;14â€} (current: {â€œnodeâ€:â€10.19.0â€,â€npmâ€:â€6.14.4â€})<br>npm WARN notsup Not compatible with your version of node&#x2F;npm: <a href=\"mailto:&#x68;&#x65;&#120;&#111;&#45;&#102;&#x73;&#x40;&#x34;&#46;&#x31;&#x2e;&#x31;\">&#x68;&#x65;&#120;&#111;&#45;&#102;&#x73;&#x40;&#x34;&#46;&#x31;&#x2e;&#x31;</a><br>npm WARN notsup Unsupported engine for <a href=\"mailto:&#104;&#101;&#120;&#111;&#x2d;&#x6c;&#111;&#x67;&#x40;&#52;&#x2e;&#x31;&#x2e;&#48;\">&#104;&#101;&#120;&#111;&#x2d;&#x6c;&#111;&#x67;&#x40;&#52;&#x2e;&#x31;&#x2e;&#48;</a>: wanted: {â€œnodeâ€:â€&gt;&#x3D;14â€} (current: {â€œnodeâ€:â€10.19.0â€,â€npmâ€:â€6.14.4â€})<br>npm WARN notsup Not compatible with your version of node&#x2F;npm: <a href=\"mailto:&#104;&#x65;&#120;&#x6f;&#x2d;&#x6c;&#111;&#x67;&#64;&#52;&#46;&#49;&#46;&#48;\">&#104;&#x65;&#120;&#x6f;&#x2d;&#x6c;&#111;&#x67;&#64;&#52;&#46;&#49;&#46;&#48;</a><br>npm WARN optional SKIPPING OPTIONAL DEPENDENCY: <a href=\"mailto:&#x66;&#115;&#101;&#x76;&#101;&#110;&#116;&#115;&#64;&#50;&#x2e;&#51;&#x2e;&#x33;\">&#x66;&#115;&#101;&#x76;&#101;&#110;&#116;&#115;&#64;&#50;&#x2e;&#51;&#x2e;&#x33;</a> (node_modules&#x2F;fsevents):<br>npm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for <a href=\"mailto:&#102;&#x73;&#x65;&#118;&#101;&#110;&#116;&#115;&#x40;&#x32;&#x2e;&#51;&#x2e;&#x33;\">&#102;&#x73;&#x65;&#118;&#101;&#110;&#116;&#115;&#x40;&#x32;&#x2e;&#51;&#x2e;&#x33;</a>: wanted {â€œosâ€:â€darwinâ€,â€archâ€:â€anyâ€} (current: {â€œosâ€:â€linuxâ€,â€archâ€:â€x64â€})</p>\n<h2 id=\"å‡çº§nodejs\"><a href=\"#å‡çº§nodejs\" class=\"headerlink\" title=\"å‡çº§nodejs\"></a>å‡çº§nodejs</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget -qO- https://raw.githubusercontent.com/nvm-sh/nvm/v0.38.0/install.sh | bash         #å®‰è£… nvm</span><br><span class=\"line\">source ~/.bashrc            #åŠ è½½ nvm</span><br><span class=\"line\">nvm install node            #ä½¿ç”¨ nvm å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ Node.js</span><br><span class=\"line\">node -v                     #éªŒè¯ Node.js ç‰ˆæœ¬</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<h2 id=\"é—®é¢˜2-hexoåšå®¢å›¾ç‰‡ä¸æ˜¾ç¤º\"><a href=\"#é—®é¢˜2-hexoåšå®¢å›¾ç‰‡ä¸æ˜¾ç¤º\" class=\"headerlink\" title=\"é—®é¢˜2.hexoåšå®¢å›¾ç‰‡ä¸æ˜¾ç¤º\"></a>é—®é¢˜2.hexoåšå®¢å›¾ç‰‡ä¸æ˜¾ç¤º</h2><p><a href=\"https://blog.csdn.net/QRLYLETITBE/article/details/127737904\">https://blog.csdn.net/QRLYLETITBE/article/details/127737904</a> </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i hexo-renderer-marked</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"æ–°å»ºimgsæ–‡ä»¶å¤¹\"><a href=\"#æ–°å»ºimgsæ–‡ä»¶å¤¹\" class=\"headerlink\" title=\"æ–°å»ºimgsæ–‡ä»¶å¤¹\"></a>æ–°å»ºimgsæ–‡ä»¶å¤¹</h2><p><img src=\"/../imgs/image-20230913161638961.png\" alt=\"image-20230913161638961\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">marked:</span><br><span class=\"line\">  prependRoot: true</span><br><span class=\"line\">  postAsset: true</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h2 id=\"ä¿®æ”¹å›¾ç‰‡è·¯å¾„\"><a href=\"#ä¿®æ”¹å›¾ç‰‡è·¯å¾„\" class=\"headerlink\" title=\"ä¿®æ”¹å›¾ç‰‡è·¯å¾„\"></a>ä¿®æ”¹å›¾ç‰‡è·¯å¾„</h2><p><img src=\"/../imgs/image-20230913161842174.png\" alt=\"image-20230913161842174\"></p>\n"},{"title":"02-ruståŸºæœ¬ç±»å‹","date":"2023-08-26T13:17:00.000Z","_content":"\n\n\n\n\n\n\n\n\n[toc]\n\n# RuståŸºæœ¬æ•°æ®ç±»å‹\n\nRust æ¯ä¸ªå€¼éƒ½æœ‰å…¶ç¡®åˆ‡çš„æ•°æ®ç±»å‹ï¼Œæ€»çš„æ¥è¯´å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼šåŸºæœ¬ç±»å‹å’Œå¤åˆç±»å‹ã€‚ åŸºæœ¬ç±»å‹æ„å‘³ç€å®ƒä»¬å¾€å¾€æ˜¯ä¸€ä¸ªæœ€å°åŒ–åŸå­ç±»å‹ï¼Œæ— æ³•è§£æ„ä¸ºå…¶å®ƒç±»å‹(ä¸€èˆ¬æ„ä¹‰ä¸Šæ¥è¯´)ï¼Œç”±ä»¥ä¸‹ç»„æˆï¼š\n\n- æ•°å€¼ç±»å‹: æœ‰ç¬¦å·æ•´æ•° (`i8`, `i16`, `i32`, `i64`, `isize`)ã€ æ— ç¬¦å·æ•´æ•° (`u8`, `u16`, `u32`, `u64`, `usize`) ã€æµ®ç‚¹æ•° (`f32`, `f64`)ã€ä»¥åŠæœ‰ç†æ•°ã€å¤æ•°\n- å­—ç¬¦ä¸²ï¼šå­—ç¬¦ä¸²å­—é¢é‡å’Œå­—ç¬¦ä¸²åˆ‡ç‰‡ `&str`\n- å¸ƒå°”ç±»å‹ï¼š `true`å’Œ`false`\n- å­—ç¬¦ç±»å‹: è¡¨ç¤ºå•ä¸ª Unicode å­—ç¬¦ï¼Œå­˜å‚¨ä¸º 4 ä¸ªå­—èŠ‚\n- å•å…ƒç±»å‹: å³ `()` ï¼Œå…¶å”¯ä¸€çš„å€¼ä¹Ÿæ˜¯ `()`\n\n## 1.æ•°å€¼ç±»å‹\n\n| é•¿åº¦       | æœ‰ç¬¦å·ç±»å‹ | æ— ç¬¦å·ç±»å‹ |\n| ---------- | ---------- | ---------- |\n| 8 ä½       | `i8`       | `u8`       |\n| 16 ä½      | `i16`      | `u16`      |\n| 32 ä½      | `i32`      | `u32`      |\n| 64 ä½      | `i64`      | `u64`      |\n| 128 ä½     | `i128`     | `u128`     |\n| è§†æ¶æ„è€Œå®š | `isize`    | `usize`    |\n\næ•´å½¢å­—é¢é‡å¯ä»¥ç”¨ä¸‹è¡¨çš„å½¢å¼ä¹¦å†™ï¼š\n\n| æ•°å­—å­—é¢é‡         | ç¤ºä¾‹          |\n| ------------------ | ------------- |\n| åè¿›åˆ¶             | `98_222`      |\n| åå…­è¿›åˆ¶           | `0xff`        |\n| å…«è¿›åˆ¶             | `0o77`        |\n| äºŒè¿›åˆ¶             | `0b1111_0000` |\n| å­—èŠ‚ (ä»…é™äº `u8`) | `b'A'`        |\n\n## 2.[æµ®ç‚¹ç±»å‹](https://course.rs/basic/base-type/numbers.html#æµ®ç‚¹ç±»å‹)\n\n**æµ®ç‚¹ç±»å‹æ•°å­—** æ˜¯å¸¦æœ‰å°æ•°ç‚¹çš„æ•°å­—ï¼Œåœ¨ Rust ä¸­æµ®ç‚¹ç±»å‹æ•°å­—ä¹Ÿæœ‰ä¸¤ç§åŸºæœ¬ç±»å‹ï¼š `f32` å’Œ `f64`ï¼Œåˆ†åˆ«ä¸º 32 ä½å’Œ 64 ä½å¤§å°ã€‚é»˜è®¤æµ®ç‚¹ç±»å‹æ˜¯ `f64`ï¼Œåœ¨ç°ä»£çš„ CPU ä¸­å®ƒçš„é€Ÿåº¦ä¸ `f32` å‡ ä¹ç›¸åŒï¼Œä½†ç²¾åº¦æ›´é«˜ã€‚\n\nä¸‹é¢æ˜¯ä¸€ä¸ªæ¼”ç¤ºæµ®ç‚¹æ•°çš„ç¤ºä¾‹ï¼š\n\n```rust\nfn main() {\n    let x = 2.0; // f64\n\n    let y: f32 = 3.0; // f32\n}\n```\n\n## 3.[åºåˆ—(Range)](https://course.rs/basic/base-type/numbers.html#åºåˆ—range)\n\nRust æä¾›äº†ä¸€ä¸ªéå¸¸ç®€æ´çš„æ–¹å¼ï¼Œç”¨æ¥ç”Ÿæˆè¿ç»­çš„æ•°å€¼ï¼Œä¾‹å¦‚ **`1..5`ï¼Œç”Ÿæˆä» 1 åˆ° 4 çš„è¿ç»­æ•°å­—ï¼Œä¸åŒ…å« 5** ï¼›`1..=5`ï¼Œç”Ÿæˆä» 1 åˆ° 5 çš„è¿ç»­æ•°å­—ï¼ŒåŒ…å« 5ï¼Œå®ƒçš„ç”¨é€”å¾ˆç®€å•ï¼Œå¸¸å¸¸ç”¨äºå¾ªç¯ä¸­ï¼š\n\n```rust\nfor i in 1..=5 {\n    println!(\"{}\",i);\n}\n```\n\næœ€ç»ˆç¨‹åºè¾“å‡º:\n\n```console\n1\n2\n3\n4\n5\n```\n\n**åºåˆ—åªå…è®¸ç”¨äºæ•°å­—æˆ–å­—ç¬¦ç±»å‹**ï¼ŒåŸå› æ˜¯ï¼šå®ƒä»¬å¯ä»¥è¿ç»­ï¼ŒåŒæ—¶ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æœŸå¯ä»¥æ£€æŸ¥è¯¥åºåˆ—æ˜¯å¦ä¸ºç©ºï¼Œå­—ç¬¦å’Œæ•°å­—å€¼æ˜¯ Rust ä¸­ä»…æœ‰çš„å¯ä»¥ç”¨äºåˆ¤æ–­æ˜¯å¦ä¸ºç©ºçš„ç±»å‹ã€‚å¦‚ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨å­—ç¬¦ç±»å‹åºåˆ—çš„ä¾‹å­ï¼š\n\n```rust\nfor i in 'a'..='z' {\n    println!(\"{}\",i);\n}\n```\n\n## 4.[æœ‰ç†æ•°å’Œå¤æ•°](https://course.rs/basic/base-type/numbers.html#æœ‰ç†æ•°å’Œå¤æ•°)\n\nRust çš„æ ‡å‡†åº“ç›¸æ¯”å…¶å®ƒè¯­è¨€ï¼Œå‡†å…¥é—¨æ§›è¾ƒé«˜ï¼Œå› æ­¤æœ‰ç†æ•°å’Œå¤æ•°å¹¶æœªåŒ…å«åœ¨æ ‡å‡†åº“ä¸­ï¼š\n\n- æœ‰ç†æ•°å’Œå¤æ•°\n- ä»»æ„å¤§å°çš„æ•´æ•°å’Œä»»æ„ç²¾åº¦çš„æµ®ç‚¹æ•°\n- å›ºå®šç²¾åº¦çš„åè¿›åˆ¶å°æ•°ï¼Œå¸¸ç”¨äºè´§å¸ç›¸å…³çš„åœºæ™¯\n\nå¥½åœ¨ç¤¾åŒºå·²ç»å¼€å‘å‡ºé«˜è´¨é‡çš„ Rust æ•°å€¼åº“ï¼š[num](https://crates.io/crates/num)ã€‚\n\næŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ¥å¼•å…¥ `num` åº“ï¼š\n\n1. åˆ›å»ºæ–°å·¥ç¨‹ `cargo new complex-num && cd complex-num`\n2. åœ¨ `Cargo.toml` ä¸­çš„ `[dependencies]` ä¸‹æ·»åŠ ä¸€è¡Œ `num = \"0.4.0\"`\n3. å°† `src/main.rs` æ–‡ä»¶ä¸­çš„ `main` å‡½æ•°æ›¿æ¢ä¸ºä¸‹é¢çš„ä»£ç \n4. è¿è¡Œ `cargo run`\n\n```rust\nuse num::complex::Complex;\n\n fn main() {\n   let a = Complex { re: 2.1, im: -1.2 };\n   let b = Complex::new(11.1, 22.2);\n   let result = a + b;\n\n   println!(\"{} + {}i\", result.re, result.im)\n }\n```\n\n#### [æ€»ç»“](https://course.rs/basic/base-type/numbers.html#æ€»ç»“)\n\nä¹‹å‰æåˆ°äº†è¿‡ Rust çš„æ•°å€¼ç±»å‹å’Œè¿ç®—è·Ÿå…¶ä»–è¯­è¨€è¾ƒä¸ºç›¸ä¼¼ï¼Œä½†æ˜¯å®é™…ä¸Šï¼Œé™¤äº†è¯­æ³•ä¸Šçš„ä¸åŒä¹‹å¤–ï¼Œè¿˜æ˜¯å­˜åœ¨ä¸€äº›å·®å¼‚ç‚¹ï¼š\n\n- **Rust æ‹¥æœ‰ç›¸å½“å¤šçš„æ•°å€¼ç±»å‹**. å› æ­¤ä½ éœ€è¦ç†Ÿæ‚‰è¿™äº›ç±»å‹æ‰€å ç”¨çš„å­—èŠ‚æ•°ï¼Œè¿™æ ·å°±çŸ¥é“è¯¥ç±»å‹å…è®¸çš„å¤§å°èŒƒå›´ä»¥åŠä½ é€‰æ‹©çš„ç±»å‹æ˜¯å¦èƒ½è¡¨è¾¾è´Ÿæ•°\n- **ç±»å‹è½¬æ¢å¿…é¡»æ˜¯æ˜¾å¼çš„**. Rust æ°¸è¿œä¹Ÿä¸ä¼šå·å·æŠŠä½ çš„ 16bit æ•´æ•°è½¬æ¢æˆ 32bit æ•´æ•°\n- **Rust çš„æ•°å€¼ä¸Šå¯ä»¥ä½¿ç”¨æ–¹æ³•**. ä¾‹å¦‚ä½ å¯ä»¥ç”¨ä»¥ä¸‹æ–¹æ³•æ¥å°† `13.14` å–æ•´ï¼š`13.14_f32.round()`ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº†ç±»å‹åç¼€ï¼Œå› ä¸ºç¼–è¯‘å™¨éœ€è¦çŸ¥é“ `13.14` çš„å…·ä½“ç±»å‹\n\n## 5.[å‡½æ•°è¦ç‚¹](https://course.rs/basic/base-type/function.html#å‡½æ•°è¦ç‚¹)\n\n- å‡½æ•°åå’Œå˜é‡åä½¿ç”¨[è›‡å½¢å‘½åæ³•(snake case)](https://course.rs/practice/naming.html)ï¼Œä¾‹å¦‚ `fn add_two() -> {}`\n- å‡½æ•°çš„ä½ç½®å¯ä»¥éšä¾¿æ”¾ï¼ŒRust ä¸å…³å¿ƒæˆ‘ä»¬åœ¨å“ªé‡Œå®šä¹‰äº†å‡½æ•°ï¼Œåªè¦æœ‰å®šä¹‰å³å¯\n- æ¯ä¸ªå‡½æ•°å‚æ•°éƒ½éœ€è¦æ ‡æ³¨ç±»å‹\n\n```\nfn add(i: i32, j: i32) -> i32 {\n   i + j\n }\n\n```\n\n![img](https://pic2.zhimg.com/80/v2-54b3a6d435d2482243edc4be9ab98153_1440w.png)\n\n### è¿”å›å€¼ï¼š\n\nâ€‹\t[æ— è¿”å›å€¼`()`](https://course.rs/basic/base-type/function.html#æ— è¿”å›å€¼)\n\n- å‡½æ•°æ²¡æœ‰è¿”å›å€¼ï¼Œé‚£ä¹ˆè¿”å›ä¸€ä¸ª `()`\n- é€šè¿‡ `;` ç»“å°¾çš„è¡¨è¾¾å¼è¿”å›ä¸€ä¸ª `()`\n\nâ€‹    [æ°¸ä¸è¿”å›çš„å‘æ•£å‡½æ•° `!`](https://course.rs/basic/base-type/function.html#æ°¸ä¸è¿”å›çš„å‘æ•£å‡½æ•°-)\n\nâ€‹\t\tå½“ç”¨ `!` ä½œå‡½æ•°è¿”å›ç±»å‹çš„æ—¶å€™ï¼Œè¡¨ç¤ºè¯¥å‡½æ•°æ°¸ä¸è¿”å›( diverge function )ï¼Œç‰¹åˆ«çš„ï¼Œè¿™ç§è¯­æ³•å¾€å¾€ç”¨åšä¼šå¯¼è‡´ç¨‹åºå´©æºƒçš„å‡½æ•°ï¼š\n\n## 6.ç»ƒä¹ \n\n[æ•°å€¼ç±»å‹ - Rust By Practice( Rust ç»ƒä¹ å®è·µ )](https://zh.practice.rs/basic-types/numbers.html)\n\n```// å¡«ç©º\nfn main() {\n    let v: u16 = 38_u8 as u16; //ä»8ä½æ— ç¬¦å·æ•´æ•°ï¼ˆu8ï¼‰åˆ°16ä½æ— ç¬¦å·æ•´æ•°ï¼ˆu16ï¼‰çš„ç±»å‹è½¬æ¢\n}\n```\n\n```\n\n// ä¿®æ”¹ `assert_eq!` è®©ä»£ç å·¥ä½œ\nfn main() {\n    let x = 5;\t\t//i32\n    assert_eq!(\"i32\".to_string(), type_of(&x)); //\n}\n\n// ä»¥ä¸‹å‡½æ•°å¯ä»¥è·å–ä¼ å…¥å‚æ•°çš„ç±»å‹ï¼Œå¹¶è¿”å›ç±»å‹çš„å­—ç¬¦ä¸²å½¢å¼ï¼Œä¾‹å¦‚  \"i8\", \"u8\", \"i32\", \"u32\"\nfn type_of<T>(_: &T) -> String {\n    format!(\"{}\", std::any::type_name::<T>())\n}\n\n```\n\n```\nfn main() {\n    assert_eq!(i8::MAX, 127); \n    assert_eq!(u8::MAX, 255); \n}\n\n```\n\n```\n\n// è§£å†³ä»£ç ä¸­çš„é”™è¯¯å’Œ `panic`\nfn main() {\n   let v1 = 251_u8.wrapping_add(8);\n   let v2 = match u8::checked_add(251, 8) {\n        Some(value) => value,\n        None => {\n            println!(\"Overflow occurred.\");\n            0\n        }\n    };\n   println!(\"{},{}\",v1,v2);\n}\n\n```\n\n```\nfn main() {\n    let x = 1_000.000_1; // f64\n    let y: f32 = 0.12; // f32\n    let z = 0.01_f64; // f64\n}\n```\n\n```c\n#ä½¿ç”¨ä¸¤ç§æ–¹æ³•æ¥è®©ä¸‹é¢ä»£ç å·¥ä½œ\nfn main() {\n    assert!(0.1+0.2==0.3);\n}\n fn main() {\n     assert!(0.1_f32+0.2_f32==0.3_f32);\n }\n//é™ä½ç²¾åº¦\nfn main() {\n    let eps=0.001;\n    assert!((0.1_f64+ 0.2 - 0.3).abs() < eps);\n}\n//è®¾ç½®å…è®¸è¯¯å·®\n```\n\n### [åºåˆ—Range](https://zh.practice.rs/basic-types/numbers.html#åºåˆ—range)\n\n1. ğŸŒŸğŸŒŸ ä¸¤ä¸ªç›®æ ‡: 1. ä¿®æ”¹ `assert!` è®©å®ƒå·¥ä½œ 2. è®© `println!` è¾“å‡º: 97 - 122\n\n```\nfn main() {\n    let mut sum = 0;\n    for i in -3..2 {\n        sum += i\n    }\n\n    assert!(sum == -5);\n\n    for c in 'a'..='z' {\n        println!(\"{}\",c as u8);\n    }\n}\n\n```\n\n```\\// å¡«ç©º\nuse std::ops::{Range, RangeInclusive};\nfn main() {\n    assert_eq!((1..5), Range{ start: 1, end: 5 });\n    assert_eq!((1..=5), RangeInclusive::new(1, 5));\n}\n///RangeInclusive::new(1, 5) åˆ›å»ºçš„æ˜¯ä¸€ä¸ªé—­åŒºé—´ï¼Œè¡¨ç¤ºä» 1 åˆ° 5ï¼ˆåŒ…æ‹¬ 5ï¼‰çš„èŒƒå›´ã€‚è‹¥ (1..5) åˆ›å»ºçš„æ˜¯ä¸€ä¸ªåŠå¼€åŒºé—´ï¼Œè¡¨ç¤ºä» 1 åˆ° 5ï¼ˆä¸åŒ…æ‹¬ 5ï¼‰çš„èŒƒå›´ã€‚\n```\n\n```\nuse std::mem::size_of_val;\nfn main() {\n    let unit: () = ();\n    assert!(size_of_val(&unit) == 0);\t\t//å•å…ƒç±»å‹å ç”¨çš„å†…å­˜å¤§å° 0\n\n    println!(\"Success!\")\n}\n```\n\n### [è¯­å¥ä¸è¡¨è¾¾å¼](https://zh.practice.rs/basic-types/statements-expressions.html#è¯­å¥ä¸è¡¨è¾¾å¼)\n\n```\nfn main() {\n   let v = {\n       let mut x = 1;\n       x += 2\t\t// æ²¡æœ‰è¿”å›å€¼  \n   };\n\n   assert_eq!(v, 3);\n}\næ­£ç¡®çš„åšæ³•\nfn main() {\n   let v = {\n       let mut x = 1;\n       x += 2;\n       x\n   };\n\n   assert_eq!(v, 3);\n}\n\nlet z = {\n\t// åˆ†å·è®©è¡¨è¾¾å¼å˜æˆäº†è¯­å¥ï¼Œå› æ­¤è¿”å›çš„ä¸å†æ˜¯è¡¨è¾¾å¼ `2 * x` çš„å€¼ï¼Œè€Œæ˜¯è¯­å¥çš„å€¼ `()`\n\t2 * x;\n};\nfn main() {\n   let v = { let x = 3; x};\n\n   assert!(v == 3);\n}\n```\n\n### [å‡½æ•°](https://zh.practice.rs/basic-types/functions.html#å‡½æ•°)\n\n\n\n## 7.æ€»ç»“ï¼š\n\n1.`let x = 2.0; // f64`\n\n2.æ¯”è¾ƒæµ®ç‚¹æ•°`(0.1_f64 + 0.2 - 0.3).abs() < 0.00001`\n\n3.`ç¼–è¯‘å™¨ä¼šè¿›è¡Œè‡ªåŠ¨æ¨å¯¼ï¼Œç»™äºˆtwenty i32çš„ç±»å‹  let twenty = 20;`\n\n4.æŒ‰ç…§è¡¥ç å¾ªç¯æº¢å‡ºè§„åˆ™å¤„ç†`et b = 255_u8.wrapping_add(20);  // 19`  `åœ¨ u8 çš„æƒ…å†µä¸‹ï¼Œ256 å˜æˆ 0ï¼Œ257 å˜æˆ 1ï¼Œ`\n\n5.`(1..5)  è¡¨ç¤ºä» 1 åˆ° 5ï¼ˆä¸åŒ…æ‹¬ 5ï¼‰åŠå¼€åŒºé—´çš„èŒƒå›´`\n\n6.`(1..=5)  è¡¨ç¤ºä» 1 åˆ° 5ï¼ˆåŒ…æ‹¬ 5ï¼‰åŠé—­åŒºé—´çš„èŒƒå›´`\n\n6.**è¡¨è¾¾å¼ä¸èƒ½åŒ…å«åˆ†å·**ã€‚`è¡¨è¾¾å¼æ€»è¦è¿”å›å€¼`\n\n7.è¿”å›å€¼ä¸ºï¼çš„è¡¨è¾¾å¼\n\n```\nloop {}  \npanic!(\"Never return\");  \ntodo!();  \nunimplemented!();  //æœªå®ç°çš„å ä½ç¬¦å‡½æ•°\n \n```\n","source":"_posts/02-ruståŸºæœ¬ç±»å‹.md","raw":"---\ntitle: 02-ruståŸºæœ¬ç±»å‹\ndate: 2023-08-26 21:17:00\ncategories:\n- rust\ntags:\n- ruståŸºæœ¬ç±»å‹\n- rust\n\n---\n\n\n\n\n\n\n\n\n\n[toc]\n\n# RuståŸºæœ¬æ•°æ®ç±»å‹\n\nRust æ¯ä¸ªå€¼éƒ½æœ‰å…¶ç¡®åˆ‡çš„æ•°æ®ç±»å‹ï¼Œæ€»çš„æ¥è¯´å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼šåŸºæœ¬ç±»å‹å’Œå¤åˆç±»å‹ã€‚ åŸºæœ¬ç±»å‹æ„å‘³ç€å®ƒä»¬å¾€å¾€æ˜¯ä¸€ä¸ªæœ€å°åŒ–åŸå­ç±»å‹ï¼Œæ— æ³•è§£æ„ä¸ºå…¶å®ƒç±»å‹(ä¸€èˆ¬æ„ä¹‰ä¸Šæ¥è¯´)ï¼Œç”±ä»¥ä¸‹ç»„æˆï¼š\n\n- æ•°å€¼ç±»å‹: æœ‰ç¬¦å·æ•´æ•° (`i8`, `i16`, `i32`, `i64`, `isize`)ã€ æ— ç¬¦å·æ•´æ•° (`u8`, `u16`, `u32`, `u64`, `usize`) ã€æµ®ç‚¹æ•° (`f32`, `f64`)ã€ä»¥åŠæœ‰ç†æ•°ã€å¤æ•°\n- å­—ç¬¦ä¸²ï¼šå­—ç¬¦ä¸²å­—é¢é‡å’Œå­—ç¬¦ä¸²åˆ‡ç‰‡ `&str`\n- å¸ƒå°”ç±»å‹ï¼š `true`å’Œ`false`\n- å­—ç¬¦ç±»å‹: è¡¨ç¤ºå•ä¸ª Unicode å­—ç¬¦ï¼Œå­˜å‚¨ä¸º 4 ä¸ªå­—èŠ‚\n- å•å…ƒç±»å‹: å³ `()` ï¼Œå…¶å”¯ä¸€çš„å€¼ä¹Ÿæ˜¯ `()`\n\n## 1.æ•°å€¼ç±»å‹\n\n| é•¿åº¦       | æœ‰ç¬¦å·ç±»å‹ | æ— ç¬¦å·ç±»å‹ |\n| ---------- | ---------- | ---------- |\n| 8 ä½       | `i8`       | `u8`       |\n| 16 ä½      | `i16`      | `u16`      |\n| 32 ä½      | `i32`      | `u32`      |\n| 64 ä½      | `i64`      | `u64`      |\n| 128 ä½     | `i128`     | `u128`     |\n| è§†æ¶æ„è€Œå®š | `isize`    | `usize`    |\n\næ•´å½¢å­—é¢é‡å¯ä»¥ç”¨ä¸‹è¡¨çš„å½¢å¼ä¹¦å†™ï¼š\n\n| æ•°å­—å­—é¢é‡         | ç¤ºä¾‹          |\n| ------------------ | ------------- |\n| åè¿›åˆ¶             | `98_222`      |\n| åå…­è¿›åˆ¶           | `0xff`        |\n| å…«è¿›åˆ¶             | `0o77`        |\n| äºŒè¿›åˆ¶             | `0b1111_0000` |\n| å­—èŠ‚ (ä»…é™äº `u8`) | `b'A'`        |\n\n## 2.[æµ®ç‚¹ç±»å‹](https://course.rs/basic/base-type/numbers.html#æµ®ç‚¹ç±»å‹)\n\n**æµ®ç‚¹ç±»å‹æ•°å­—** æ˜¯å¸¦æœ‰å°æ•°ç‚¹çš„æ•°å­—ï¼Œåœ¨ Rust ä¸­æµ®ç‚¹ç±»å‹æ•°å­—ä¹Ÿæœ‰ä¸¤ç§åŸºæœ¬ç±»å‹ï¼š `f32` å’Œ `f64`ï¼Œåˆ†åˆ«ä¸º 32 ä½å’Œ 64 ä½å¤§å°ã€‚é»˜è®¤æµ®ç‚¹ç±»å‹æ˜¯ `f64`ï¼Œåœ¨ç°ä»£çš„ CPU ä¸­å®ƒçš„é€Ÿåº¦ä¸ `f32` å‡ ä¹ç›¸åŒï¼Œä½†ç²¾åº¦æ›´é«˜ã€‚\n\nä¸‹é¢æ˜¯ä¸€ä¸ªæ¼”ç¤ºæµ®ç‚¹æ•°çš„ç¤ºä¾‹ï¼š\n\n```rust\nfn main() {\n    let x = 2.0; // f64\n\n    let y: f32 = 3.0; // f32\n}\n```\n\n## 3.[åºåˆ—(Range)](https://course.rs/basic/base-type/numbers.html#åºåˆ—range)\n\nRust æä¾›äº†ä¸€ä¸ªéå¸¸ç®€æ´çš„æ–¹å¼ï¼Œç”¨æ¥ç”Ÿæˆè¿ç»­çš„æ•°å€¼ï¼Œä¾‹å¦‚ **`1..5`ï¼Œç”Ÿæˆä» 1 åˆ° 4 çš„è¿ç»­æ•°å­—ï¼Œä¸åŒ…å« 5** ï¼›`1..=5`ï¼Œç”Ÿæˆä» 1 åˆ° 5 çš„è¿ç»­æ•°å­—ï¼ŒåŒ…å« 5ï¼Œå®ƒçš„ç”¨é€”å¾ˆç®€å•ï¼Œå¸¸å¸¸ç”¨äºå¾ªç¯ä¸­ï¼š\n\n```rust\nfor i in 1..=5 {\n    println!(\"{}\",i);\n}\n```\n\næœ€ç»ˆç¨‹åºè¾“å‡º:\n\n```console\n1\n2\n3\n4\n5\n```\n\n**åºåˆ—åªå…è®¸ç”¨äºæ•°å­—æˆ–å­—ç¬¦ç±»å‹**ï¼ŒåŸå› æ˜¯ï¼šå®ƒä»¬å¯ä»¥è¿ç»­ï¼ŒåŒæ—¶ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æœŸå¯ä»¥æ£€æŸ¥è¯¥åºåˆ—æ˜¯å¦ä¸ºç©ºï¼Œå­—ç¬¦å’Œæ•°å­—å€¼æ˜¯ Rust ä¸­ä»…æœ‰çš„å¯ä»¥ç”¨äºåˆ¤æ–­æ˜¯å¦ä¸ºç©ºçš„ç±»å‹ã€‚å¦‚ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨å­—ç¬¦ç±»å‹åºåˆ—çš„ä¾‹å­ï¼š\n\n```rust\nfor i in 'a'..='z' {\n    println!(\"{}\",i);\n}\n```\n\n## 4.[æœ‰ç†æ•°å’Œå¤æ•°](https://course.rs/basic/base-type/numbers.html#æœ‰ç†æ•°å’Œå¤æ•°)\n\nRust çš„æ ‡å‡†åº“ç›¸æ¯”å…¶å®ƒè¯­è¨€ï¼Œå‡†å…¥é—¨æ§›è¾ƒé«˜ï¼Œå› æ­¤æœ‰ç†æ•°å’Œå¤æ•°å¹¶æœªåŒ…å«åœ¨æ ‡å‡†åº“ä¸­ï¼š\n\n- æœ‰ç†æ•°å’Œå¤æ•°\n- ä»»æ„å¤§å°çš„æ•´æ•°å’Œä»»æ„ç²¾åº¦çš„æµ®ç‚¹æ•°\n- å›ºå®šç²¾åº¦çš„åè¿›åˆ¶å°æ•°ï¼Œå¸¸ç”¨äºè´§å¸ç›¸å…³çš„åœºæ™¯\n\nå¥½åœ¨ç¤¾åŒºå·²ç»å¼€å‘å‡ºé«˜è´¨é‡çš„ Rust æ•°å€¼åº“ï¼š[num](https://crates.io/crates/num)ã€‚\n\næŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ¥å¼•å…¥ `num` åº“ï¼š\n\n1. åˆ›å»ºæ–°å·¥ç¨‹ `cargo new complex-num && cd complex-num`\n2. åœ¨ `Cargo.toml` ä¸­çš„ `[dependencies]` ä¸‹æ·»åŠ ä¸€è¡Œ `num = \"0.4.0\"`\n3. å°† `src/main.rs` æ–‡ä»¶ä¸­çš„ `main` å‡½æ•°æ›¿æ¢ä¸ºä¸‹é¢çš„ä»£ç \n4. è¿è¡Œ `cargo run`\n\n```rust\nuse num::complex::Complex;\n\n fn main() {\n   let a = Complex { re: 2.1, im: -1.2 };\n   let b = Complex::new(11.1, 22.2);\n   let result = a + b;\n\n   println!(\"{} + {}i\", result.re, result.im)\n }\n```\n\n#### [æ€»ç»“](https://course.rs/basic/base-type/numbers.html#æ€»ç»“)\n\nä¹‹å‰æåˆ°äº†è¿‡ Rust çš„æ•°å€¼ç±»å‹å’Œè¿ç®—è·Ÿå…¶ä»–è¯­è¨€è¾ƒä¸ºç›¸ä¼¼ï¼Œä½†æ˜¯å®é™…ä¸Šï¼Œé™¤äº†è¯­æ³•ä¸Šçš„ä¸åŒä¹‹å¤–ï¼Œè¿˜æ˜¯å­˜åœ¨ä¸€äº›å·®å¼‚ç‚¹ï¼š\n\n- **Rust æ‹¥æœ‰ç›¸å½“å¤šçš„æ•°å€¼ç±»å‹**. å› æ­¤ä½ éœ€è¦ç†Ÿæ‚‰è¿™äº›ç±»å‹æ‰€å ç”¨çš„å­—èŠ‚æ•°ï¼Œè¿™æ ·å°±çŸ¥é“è¯¥ç±»å‹å…è®¸çš„å¤§å°èŒƒå›´ä»¥åŠä½ é€‰æ‹©çš„ç±»å‹æ˜¯å¦èƒ½è¡¨è¾¾è´Ÿæ•°\n- **ç±»å‹è½¬æ¢å¿…é¡»æ˜¯æ˜¾å¼çš„**. Rust æ°¸è¿œä¹Ÿä¸ä¼šå·å·æŠŠä½ çš„ 16bit æ•´æ•°è½¬æ¢æˆ 32bit æ•´æ•°\n- **Rust çš„æ•°å€¼ä¸Šå¯ä»¥ä½¿ç”¨æ–¹æ³•**. ä¾‹å¦‚ä½ å¯ä»¥ç”¨ä»¥ä¸‹æ–¹æ³•æ¥å°† `13.14` å–æ•´ï¼š`13.14_f32.round()`ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº†ç±»å‹åç¼€ï¼Œå› ä¸ºç¼–è¯‘å™¨éœ€è¦çŸ¥é“ `13.14` çš„å…·ä½“ç±»å‹\n\n## 5.[å‡½æ•°è¦ç‚¹](https://course.rs/basic/base-type/function.html#å‡½æ•°è¦ç‚¹)\n\n- å‡½æ•°åå’Œå˜é‡åä½¿ç”¨[è›‡å½¢å‘½åæ³•(snake case)](https://course.rs/practice/naming.html)ï¼Œä¾‹å¦‚ `fn add_two() -> {}`\n- å‡½æ•°çš„ä½ç½®å¯ä»¥éšä¾¿æ”¾ï¼ŒRust ä¸å…³å¿ƒæˆ‘ä»¬åœ¨å“ªé‡Œå®šä¹‰äº†å‡½æ•°ï¼Œåªè¦æœ‰å®šä¹‰å³å¯\n- æ¯ä¸ªå‡½æ•°å‚æ•°éƒ½éœ€è¦æ ‡æ³¨ç±»å‹\n\n```\nfn add(i: i32, j: i32) -> i32 {\n   i + j\n }\n\n```\n\n![img](https://pic2.zhimg.com/80/v2-54b3a6d435d2482243edc4be9ab98153_1440w.png)\n\n### è¿”å›å€¼ï¼š\n\nâ€‹\t[æ— è¿”å›å€¼`()`](https://course.rs/basic/base-type/function.html#æ— è¿”å›å€¼)\n\n- å‡½æ•°æ²¡æœ‰è¿”å›å€¼ï¼Œé‚£ä¹ˆè¿”å›ä¸€ä¸ª `()`\n- é€šè¿‡ `;` ç»“å°¾çš„è¡¨è¾¾å¼è¿”å›ä¸€ä¸ª `()`\n\nâ€‹    [æ°¸ä¸è¿”å›çš„å‘æ•£å‡½æ•° `!`](https://course.rs/basic/base-type/function.html#æ°¸ä¸è¿”å›çš„å‘æ•£å‡½æ•°-)\n\nâ€‹\t\tå½“ç”¨ `!` ä½œå‡½æ•°è¿”å›ç±»å‹çš„æ—¶å€™ï¼Œè¡¨ç¤ºè¯¥å‡½æ•°æ°¸ä¸è¿”å›( diverge function )ï¼Œç‰¹åˆ«çš„ï¼Œè¿™ç§è¯­æ³•å¾€å¾€ç”¨åšä¼šå¯¼è‡´ç¨‹åºå´©æºƒçš„å‡½æ•°ï¼š\n\n## 6.ç»ƒä¹ \n\n[æ•°å€¼ç±»å‹ - Rust By Practice( Rust ç»ƒä¹ å®è·µ )](https://zh.practice.rs/basic-types/numbers.html)\n\n```// å¡«ç©º\nfn main() {\n    let v: u16 = 38_u8 as u16; //ä»8ä½æ— ç¬¦å·æ•´æ•°ï¼ˆu8ï¼‰åˆ°16ä½æ— ç¬¦å·æ•´æ•°ï¼ˆu16ï¼‰çš„ç±»å‹è½¬æ¢\n}\n```\n\n```\n\n// ä¿®æ”¹ `assert_eq!` è®©ä»£ç å·¥ä½œ\nfn main() {\n    let x = 5;\t\t//i32\n    assert_eq!(\"i32\".to_string(), type_of(&x)); //\n}\n\n// ä»¥ä¸‹å‡½æ•°å¯ä»¥è·å–ä¼ å…¥å‚æ•°çš„ç±»å‹ï¼Œå¹¶è¿”å›ç±»å‹çš„å­—ç¬¦ä¸²å½¢å¼ï¼Œä¾‹å¦‚  \"i8\", \"u8\", \"i32\", \"u32\"\nfn type_of<T>(_: &T) -> String {\n    format!(\"{}\", std::any::type_name::<T>())\n}\n\n```\n\n```\nfn main() {\n    assert_eq!(i8::MAX, 127); \n    assert_eq!(u8::MAX, 255); \n}\n\n```\n\n```\n\n// è§£å†³ä»£ç ä¸­çš„é”™è¯¯å’Œ `panic`\nfn main() {\n   let v1 = 251_u8.wrapping_add(8);\n   let v2 = match u8::checked_add(251, 8) {\n        Some(value) => value,\n        None => {\n            println!(\"Overflow occurred.\");\n            0\n        }\n    };\n   println!(\"{},{}\",v1,v2);\n}\n\n```\n\n```\nfn main() {\n    let x = 1_000.000_1; // f64\n    let y: f32 = 0.12; // f32\n    let z = 0.01_f64; // f64\n}\n```\n\n```c\n#ä½¿ç”¨ä¸¤ç§æ–¹æ³•æ¥è®©ä¸‹é¢ä»£ç å·¥ä½œ\nfn main() {\n    assert!(0.1+0.2==0.3);\n}\n fn main() {\n     assert!(0.1_f32+0.2_f32==0.3_f32);\n }\n//é™ä½ç²¾åº¦\nfn main() {\n    let eps=0.001;\n    assert!((0.1_f64+ 0.2 - 0.3).abs() < eps);\n}\n//è®¾ç½®å…è®¸è¯¯å·®\n```\n\n### [åºåˆ—Range](https://zh.practice.rs/basic-types/numbers.html#åºåˆ—range)\n\n1. ğŸŒŸğŸŒŸ ä¸¤ä¸ªç›®æ ‡: 1. ä¿®æ”¹ `assert!` è®©å®ƒå·¥ä½œ 2. è®© `println!` è¾“å‡º: 97 - 122\n\n```\nfn main() {\n    let mut sum = 0;\n    for i in -3..2 {\n        sum += i\n    }\n\n    assert!(sum == -5);\n\n    for c in 'a'..='z' {\n        println!(\"{}\",c as u8);\n    }\n}\n\n```\n\n```\\// å¡«ç©º\nuse std::ops::{Range, RangeInclusive};\nfn main() {\n    assert_eq!((1..5), Range{ start: 1, end: 5 });\n    assert_eq!((1..=5), RangeInclusive::new(1, 5));\n}\n///RangeInclusive::new(1, 5) åˆ›å»ºçš„æ˜¯ä¸€ä¸ªé—­åŒºé—´ï¼Œè¡¨ç¤ºä» 1 åˆ° 5ï¼ˆåŒ…æ‹¬ 5ï¼‰çš„èŒƒå›´ã€‚è‹¥ (1..5) åˆ›å»ºçš„æ˜¯ä¸€ä¸ªåŠå¼€åŒºé—´ï¼Œè¡¨ç¤ºä» 1 åˆ° 5ï¼ˆä¸åŒ…æ‹¬ 5ï¼‰çš„èŒƒå›´ã€‚\n```\n\n```\nuse std::mem::size_of_val;\nfn main() {\n    let unit: () = ();\n    assert!(size_of_val(&unit) == 0);\t\t//å•å…ƒç±»å‹å ç”¨çš„å†…å­˜å¤§å° 0\n\n    println!(\"Success!\")\n}\n```\n\n### [è¯­å¥ä¸è¡¨è¾¾å¼](https://zh.practice.rs/basic-types/statements-expressions.html#è¯­å¥ä¸è¡¨è¾¾å¼)\n\n```\nfn main() {\n   let v = {\n       let mut x = 1;\n       x += 2\t\t// æ²¡æœ‰è¿”å›å€¼  \n   };\n\n   assert_eq!(v, 3);\n}\næ­£ç¡®çš„åšæ³•\nfn main() {\n   let v = {\n       let mut x = 1;\n       x += 2;\n       x\n   };\n\n   assert_eq!(v, 3);\n}\n\nlet z = {\n\t// åˆ†å·è®©è¡¨è¾¾å¼å˜æˆäº†è¯­å¥ï¼Œå› æ­¤è¿”å›çš„ä¸å†æ˜¯è¡¨è¾¾å¼ `2 * x` çš„å€¼ï¼Œè€Œæ˜¯è¯­å¥çš„å€¼ `()`\n\t2 * x;\n};\nfn main() {\n   let v = { let x = 3; x};\n\n   assert!(v == 3);\n}\n```\n\n### [å‡½æ•°](https://zh.practice.rs/basic-types/functions.html#å‡½æ•°)\n\n\n\n## 7.æ€»ç»“ï¼š\n\n1.`let x = 2.0; // f64`\n\n2.æ¯”è¾ƒæµ®ç‚¹æ•°`(0.1_f64 + 0.2 - 0.3).abs() < 0.00001`\n\n3.`ç¼–è¯‘å™¨ä¼šè¿›è¡Œè‡ªåŠ¨æ¨å¯¼ï¼Œç»™äºˆtwenty i32çš„ç±»å‹  let twenty = 20;`\n\n4.æŒ‰ç…§è¡¥ç å¾ªç¯æº¢å‡ºè§„åˆ™å¤„ç†`et b = 255_u8.wrapping_add(20);  // 19`  `åœ¨ u8 çš„æƒ…å†µä¸‹ï¼Œ256 å˜æˆ 0ï¼Œ257 å˜æˆ 1ï¼Œ`\n\n5.`(1..5)  è¡¨ç¤ºä» 1 åˆ° 5ï¼ˆä¸åŒ…æ‹¬ 5ï¼‰åŠå¼€åŒºé—´çš„èŒƒå›´`\n\n6.`(1..=5)  è¡¨ç¤ºä» 1 åˆ° 5ï¼ˆåŒ…æ‹¬ 5ï¼‰åŠé—­åŒºé—´çš„èŒƒå›´`\n\n6.**è¡¨è¾¾å¼ä¸èƒ½åŒ…å«åˆ†å·**ã€‚`è¡¨è¾¾å¼æ€»è¦è¿”å›å€¼`\n\n7.è¿”å›å€¼ä¸ºï¼çš„è¡¨è¾¾å¼\n\n```\nloop {}  \npanic!(\"Never return\");  \ntodo!();  \nunimplemented!();  //æœªå®ç°çš„å ä½ç¬¦å‡½æ•°\n \n```\n","slug":"02-ruståŸºæœ¬ç±»å‹","published":1,"updated":"2024-04-28T07:13:38.746Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clvjcoaav000ar9w07gr4ho88","content":"<p>[toc]</p>\n<h1 id=\"RuståŸºæœ¬æ•°æ®ç±»å‹\"><a href=\"#RuståŸºæœ¬æ•°æ®ç±»å‹\" class=\"headerlink\" title=\"RuståŸºæœ¬æ•°æ®ç±»å‹\"></a>RuståŸºæœ¬æ•°æ®ç±»å‹</h1><p>Rust æ¯ä¸ªå€¼éƒ½æœ‰å…¶ç¡®åˆ‡çš„æ•°æ®ç±»å‹ï¼Œæ€»çš„æ¥è¯´å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼šåŸºæœ¬ç±»å‹å’Œå¤åˆç±»å‹ã€‚ åŸºæœ¬ç±»å‹æ„å‘³ç€å®ƒä»¬å¾€å¾€æ˜¯ä¸€ä¸ªæœ€å°åŒ–åŸå­ç±»å‹ï¼Œæ— æ³•è§£æ„ä¸ºå…¶å®ƒç±»å‹(ä¸€èˆ¬æ„ä¹‰ä¸Šæ¥è¯´)ï¼Œç”±ä»¥ä¸‹ç»„æˆï¼š</p>\n<ul>\n<li>æ•°å€¼ç±»å‹: æœ‰ç¬¦å·æ•´æ•° (<code>i8</code>, <code>i16</code>, <code>i32</code>, <code>i64</code>, <code>isize</code>)ã€ æ— ç¬¦å·æ•´æ•° (<code>u8</code>, <code>u16</code>, <code>u32</code>, <code>u64</code>, <code>usize</code>) ã€æµ®ç‚¹æ•° (<code>f32</code>, <code>f64</code>)ã€ä»¥åŠæœ‰ç†æ•°ã€å¤æ•°</li>\n<li>å­—ç¬¦ä¸²ï¼šå­—ç¬¦ä¸²å­—é¢é‡å’Œå­—ç¬¦ä¸²åˆ‡ç‰‡ <code>&amp;str</code></li>\n<li>å¸ƒå°”ç±»å‹ï¼š <code>true</code>å’Œ<code>false</code></li>\n<li>å­—ç¬¦ç±»å‹: è¡¨ç¤ºå•ä¸ª Unicode å­—ç¬¦ï¼Œå­˜å‚¨ä¸º 4 ä¸ªå­—èŠ‚</li>\n<li>å•å…ƒç±»å‹: å³ <code>()</code> ï¼Œå…¶å”¯ä¸€çš„å€¼ä¹Ÿæ˜¯ <code>()</code></li>\n</ul>\n<h2 id=\"1-æ•°å€¼ç±»å‹\"><a href=\"#1-æ•°å€¼ç±»å‹\" class=\"headerlink\" title=\"1.æ•°å€¼ç±»å‹\"></a>1.æ•°å€¼ç±»å‹</h2><table>\n<thead>\n<tr>\n<th>é•¿åº¦</th>\n<th>æœ‰ç¬¦å·ç±»å‹</th>\n<th>æ— ç¬¦å·ç±»å‹</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>8 ä½</td>\n<td><code>i8</code></td>\n<td><code>u8</code></td>\n</tr>\n<tr>\n<td>16 ä½</td>\n<td><code>i16</code></td>\n<td><code>u16</code></td>\n</tr>\n<tr>\n<td>32 ä½</td>\n<td><code>i32</code></td>\n<td><code>u32</code></td>\n</tr>\n<tr>\n<td>64 ä½</td>\n<td><code>i64</code></td>\n<td><code>u64</code></td>\n</tr>\n<tr>\n<td>128 ä½</td>\n<td><code>i128</code></td>\n<td><code>u128</code></td>\n</tr>\n<tr>\n<td>è§†æ¶æ„è€Œå®š</td>\n<td><code>isize</code></td>\n<td><code>usize</code></td>\n</tr>\n</tbody></table>\n<p>æ•´å½¢å­—é¢é‡å¯ä»¥ç”¨ä¸‹è¡¨çš„å½¢å¼ä¹¦å†™ï¼š</p>\n<table>\n<thead>\n<tr>\n<th>æ•°å­—å­—é¢é‡</th>\n<th>ç¤ºä¾‹</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>åè¿›åˆ¶</td>\n<td><code>98_222</code></td>\n</tr>\n<tr>\n<td>åå…­è¿›åˆ¶</td>\n<td><code>0xff</code></td>\n</tr>\n<tr>\n<td>å…«è¿›åˆ¶</td>\n<td><code>0o77</code></td>\n</tr>\n<tr>\n<td>äºŒè¿›åˆ¶</td>\n<td><code>0b1111_0000</code></td>\n</tr>\n<tr>\n<td>å­—èŠ‚ (ä»…é™äº <code>u8</code>)</td>\n<td><code>b&#39;A&#39;</code></td>\n</tr>\n</tbody></table>\n<h2 id=\"2-æµ®ç‚¹ç±»å‹\"><a href=\"#2-æµ®ç‚¹ç±»å‹\" class=\"headerlink\" title=\"2.æµ®ç‚¹ç±»å‹\"></a>2.<a href=\"https://course.rs/basic/base-type/numbers.html#%E6%B5%AE%E7%82%B9%E7%B1%BB%E5%9E%8B\">æµ®ç‚¹ç±»å‹</a></h2><p><strong>æµ®ç‚¹ç±»å‹æ•°å­—</strong> æ˜¯å¸¦æœ‰å°æ•°ç‚¹çš„æ•°å­—ï¼Œåœ¨ Rust ä¸­æµ®ç‚¹ç±»å‹æ•°å­—ä¹Ÿæœ‰ä¸¤ç§åŸºæœ¬ç±»å‹ï¼š <code>f32</code> å’Œ <code>f64</code>ï¼Œåˆ†åˆ«ä¸º 32 ä½å’Œ 64 ä½å¤§å°ã€‚é»˜è®¤æµ®ç‚¹ç±»å‹æ˜¯ <code>f64</code>ï¼Œåœ¨ç°ä»£çš„ CPU ä¸­å®ƒçš„é€Ÿåº¦ä¸ <code>f32</code> å‡ ä¹ç›¸åŒï¼Œä½†ç²¾åº¦æ›´é«˜ã€‚</p>\n<p>ä¸‹é¢æ˜¯ä¸€ä¸ªæ¼”ç¤ºæµ®ç‚¹æ•°çš„ç¤ºä¾‹ï¼š</p>\n<figure class=\"highlight rust\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">fn</span> <span class=\"title function_\">main</span>() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> <span class=\"variable\">x</span> = <span class=\"number\">2.0</span>; <span class=\"comment\">// f64</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">let</span> <span class=\"variable\">y</span>: <span class=\"type\">f32</span> = <span class=\"number\">3.0</span>; <span class=\"comment\">// f32</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3-åºåˆ—-Range\"><a href=\"#3-åºåˆ—-Range\" class=\"headerlink\" title=\"3.åºåˆ—(Range)\"></a>3.<a href=\"https://course.rs/basic/base-type/numbers.html#%E5%BA%8F%E5%88%97range\">åºåˆ—(Range)</a></h2><p>Rust æä¾›äº†ä¸€ä¸ªéå¸¸ç®€æ´çš„æ–¹å¼ï¼Œç”¨æ¥ç”Ÿæˆè¿ç»­çš„æ•°å€¼ï¼Œä¾‹å¦‚ <strong><code>1..5</code>ï¼Œç”Ÿæˆä» 1 åˆ° 4 çš„è¿ç»­æ•°å­—ï¼Œä¸åŒ…å« 5</strong> ï¼›<code>1..=5</code>ï¼Œç”Ÿæˆä» 1 åˆ° 5 çš„è¿ç»­æ•°å­—ï¼ŒåŒ…å« 5ï¼Œå®ƒçš„ç”¨é€”å¾ˆç®€å•ï¼Œå¸¸å¸¸ç”¨äºå¾ªç¯ä¸­ï¼š</p>\n<figure class=\"highlight rust\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"variable\">i</span> <span class=\"keyword\">in</span> <span class=\"number\">1</span>..=<span class=\"number\">5</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">println!</span>(<span class=\"string\">&quot;&#123;&#125;&quot;</span>,i);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>æœ€ç»ˆç¨‹åºè¾“å‡º:</p>\n<figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td></tr></table></figure>\n\n<p><strong>åºåˆ—åªå…è®¸ç”¨äºæ•°å­—æˆ–å­—ç¬¦ç±»å‹</strong>ï¼ŒåŸå› æ˜¯ï¼šå®ƒä»¬å¯ä»¥è¿ç»­ï¼ŒåŒæ—¶ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æœŸå¯ä»¥æ£€æŸ¥è¯¥åºåˆ—æ˜¯å¦ä¸ºç©ºï¼Œå­—ç¬¦å’Œæ•°å­—å€¼æ˜¯ Rust ä¸­ä»…æœ‰çš„å¯ä»¥ç”¨äºåˆ¤æ–­æ˜¯å¦ä¸ºç©ºçš„ç±»å‹ã€‚å¦‚ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨å­—ç¬¦ç±»å‹åºåˆ—çš„ä¾‹å­ï¼š</p>\n<figure class=\"highlight rust\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"variable\">i</span> <span class=\"keyword\">in</span> <span class=\"string\">&#x27;a&#x27;</span>..=<span class=\"string\">&#x27;z&#x27;</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">println!</span>(<span class=\"string\">&quot;&#123;&#125;&quot;</span>,i);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"4-æœ‰ç†æ•°å’Œå¤æ•°\"><a href=\"#4-æœ‰ç†æ•°å’Œå¤æ•°\" class=\"headerlink\" title=\"4.æœ‰ç†æ•°å’Œå¤æ•°\"></a>4.<a href=\"https://course.rs/basic/base-type/numbers.html#%E6%9C%89%E7%90%86%E6%95%B0%E5%92%8C%E5%A4%8D%E6%95%B0\">æœ‰ç†æ•°å’Œå¤æ•°</a></h2><p>Rust çš„æ ‡å‡†åº“ç›¸æ¯”å…¶å®ƒè¯­è¨€ï¼Œå‡†å…¥é—¨æ§›è¾ƒé«˜ï¼Œå› æ­¤æœ‰ç†æ•°å’Œå¤æ•°å¹¶æœªåŒ…å«åœ¨æ ‡å‡†åº“ä¸­ï¼š</p>\n<ul>\n<li>æœ‰ç†æ•°å’Œå¤æ•°</li>\n<li>ä»»æ„å¤§å°çš„æ•´æ•°å’Œä»»æ„ç²¾åº¦çš„æµ®ç‚¹æ•°</li>\n<li>å›ºå®šç²¾åº¦çš„åè¿›åˆ¶å°æ•°ï¼Œå¸¸ç”¨äºè´§å¸ç›¸å…³çš„åœºæ™¯</li>\n</ul>\n<p>å¥½åœ¨ç¤¾åŒºå·²ç»å¼€å‘å‡ºé«˜è´¨é‡çš„ Rust æ•°å€¼åº“ï¼š<a href=\"https://crates.io/crates/num\">num</a>ã€‚</p>\n<p>æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ¥å¼•å…¥ <code>num</code> åº“ï¼š</p>\n<ol>\n<li>åˆ›å»ºæ–°å·¥ç¨‹ <code>cargo new complex-num &amp;&amp; cd complex-num</code></li>\n<li>åœ¨ <code>Cargo.toml</code> ä¸­çš„ <code>[dependencies]</code> ä¸‹æ·»åŠ ä¸€è¡Œ <code>num = &quot;0.4.0&quot;</code></li>\n<li>å°† <code>src/main.rs</code> æ–‡ä»¶ä¸­çš„ <code>main</code> å‡½æ•°æ›¿æ¢ä¸ºä¸‹é¢çš„ä»£ç </li>\n<li>è¿è¡Œ <code>cargo run</code></li>\n</ol>\n<figure class=\"highlight rust\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">use</span> num::complex::Complex;</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"keyword\">fn</span> <span class=\"title function_\">main</span>() &#123;</span><br><span class=\"line\">   <span class=\"keyword\">let</span> <span class=\"variable\">a</span> = Complex &#123; re: <span class=\"number\">2.1</span>, im: -<span class=\"number\">1.2</span> &#125;;</span><br><span class=\"line\">   <span class=\"keyword\">let</span> <span class=\"variable\">b</span> = Complex::<span class=\"title function_ invoke__\">new</span>(<span class=\"number\">11.1</span>, <span class=\"number\">22.2</span>);</span><br><span class=\"line\">   <span class=\"keyword\">let</span> <span class=\"variable\">result</span> = a + b;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"built_in\">println!</span>(<span class=\"string\">&quot;&#123;&#125; + &#123;&#125;i&quot;</span>, result.re, result.im)</span><br><span class=\"line\"> &#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a><a href=\"https://course.rs/basic/base-type/numbers.html#%E6%80%BB%E7%BB%93\">æ€»ç»“</a></h4><p>ä¹‹å‰æåˆ°äº†è¿‡ Rust çš„æ•°å€¼ç±»å‹å’Œè¿ç®—è·Ÿå…¶ä»–è¯­è¨€è¾ƒä¸ºç›¸ä¼¼ï¼Œä½†æ˜¯å®é™…ä¸Šï¼Œé™¤äº†è¯­æ³•ä¸Šçš„ä¸åŒä¹‹å¤–ï¼Œè¿˜æ˜¯å­˜åœ¨ä¸€äº›å·®å¼‚ç‚¹ï¼š</p>\n<ul>\n<li><strong>Rust æ‹¥æœ‰ç›¸å½“å¤šçš„æ•°å€¼ç±»å‹</strong>. å› æ­¤ä½ éœ€è¦ç†Ÿæ‚‰è¿™äº›ç±»å‹æ‰€å ç”¨çš„å­—èŠ‚æ•°ï¼Œè¿™æ ·å°±çŸ¥é“è¯¥ç±»å‹å…è®¸çš„å¤§å°èŒƒå›´ä»¥åŠä½ é€‰æ‹©çš„ç±»å‹æ˜¯å¦èƒ½è¡¨è¾¾è´Ÿæ•°</li>\n<li><strong>ç±»å‹è½¬æ¢å¿…é¡»æ˜¯æ˜¾å¼çš„</strong>. Rust æ°¸è¿œä¹Ÿä¸ä¼šå·å·æŠŠä½ çš„ 16bit æ•´æ•°è½¬æ¢æˆ 32bit æ•´æ•°</li>\n<li><strong>Rust çš„æ•°å€¼ä¸Šå¯ä»¥ä½¿ç”¨æ–¹æ³•</strong>. ä¾‹å¦‚ä½ å¯ä»¥ç”¨ä»¥ä¸‹æ–¹æ³•æ¥å°† <code>13.14</code> å–æ•´ï¼š<code>13.14_f32.round()</code>ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº†ç±»å‹åç¼€ï¼Œå› ä¸ºç¼–è¯‘å™¨éœ€è¦çŸ¥é“ <code>13.14</code> çš„å…·ä½“ç±»å‹</li>\n</ul>\n<h2 id=\"5-å‡½æ•°è¦ç‚¹\"><a href=\"#5-å‡½æ•°è¦ç‚¹\" class=\"headerlink\" title=\"5.å‡½æ•°è¦ç‚¹\"></a>5.<a href=\"https://course.rs/basic/base-type/function.html#%E5%87%BD%E6%95%B0%E8%A6%81%E7%82%B9\">å‡½æ•°è¦ç‚¹</a></h2><ul>\n<li>å‡½æ•°åå’Œå˜é‡åä½¿ç”¨<a href=\"https://course.rs/practice/naming.html\">è›‡å½¢å‘½åæ³•(snake case)</a>ï¼Œä¾‹å¦‚ <code>fn add_two() -&gt; &#123;&#125;</code></li>\n<li>å‡½æ•°çš„ä½ç½®å¯ä»¥éšä¾¿æ”¾ï¼ŒRust ä¸å…³å¿ƒæˆ‘ä»¬åœ¨å“ªé‡Œå®šä¹‰äº†å‡½æ•°ï¼Œåªè¦æœ‰å®šä¹‰å³å¯</li>\n<li>æ¯ä¸ªå‡½æ•°å‚æ•°éƒ½éœ€è¦æ ‡æ³¨ç±»å‹</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fn add(i: i32, j: i32) -&gt; i32 &#123;</span><br><span class=\"line\">   i + j</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://pic2.zhimg.com/80/v2-54b3a6d435d2482243edc4be9ab98153_1440w.png\" alt=\"img\"></p>\n<h3 id=\"è¿”å›å€¼ï¼š\"><a href=\"#è¿”å›å€¼ï¼š\" class=\"headerlink\" title=\"è¿”å›å€¼ï¼š\"></a>è¿”å›å€¼ï¼š</h3><p>â€‹\t<a href=\"https://course.rs/basic/base-type/function.html#%E6%97%A0%E8%BF%94%E5%9B%9E%E5%80%BC\">æ— è¿”å›å€¼<code>()</code></a></p>\n<ul>\n<li>å‡½æ•°æ²¡æœ‰è¿”å›å€¼ï¼Œé‚£ä¹ˆè¿”å›ä¸€ä¸ª <code>()</code></li>\n<li>é€šè¿‡ <code>;</code> ç»“å°¾çš„è¡¨è¾¾å¼è¿”å›ä¸€ä¸ª <code>()</code></li>\n</ul>\n<p>â€‹    <a href=\"https://course.rs/basic/base-type/function.html#%E6%B0%B8%E4%B8%8D%E8%BF%94%E5%9B%9E%E7%9A%84%E5%8F%91%E6%95%A3%E5%87%BD%E6%95%B0-\">æ°¸ä¸è¿”å›çš„å‘æ•£å‡½æ•° <code>!</code></a></p>\n<p>â€‹\t\tå½“ç”¨ <code>!</code> ä½œå‡½æ•°è¿”å›ç±»å‹çš„æ—¶å€™ï¼Œè¡¨ç¤ºè¯¥å‡½æ•°æ°¸ä¸è¿”å›( diverge function )ï¼Œç‰¹åˆ«çš„ï¼Œè¿™ç§è¯­æ³•å¾€å¾€ç”¨åšä¼šå¯¼è‡´ç¨‹åºå´©æºƒçš„å‡½æ•°ï¼š</p>\n<h2 id=\"6-ç»ƒä¹ \"><a href=\"#6-ç»ƒä¹ \" class=\"headerlink\" title=\"6.ç»ƒä¹ \"></a>6.ç»ƒä¹ </h2><p><a href=\"https://zh.practice.rs/basic-types/numbers.html\">æ•°å€¼ç±»å‹ - Rust By Practice( Rust ç»ƒä¹ å®è·µ )</a></p>\n<figure class=\"highlight plaintext\"><figcaption><span>å¡«ç©º</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let v: u16 = 38_u8 as u16; //ä»8ä½æ— ç¬¦å·æ•´æ•°ï¼ˆu8ï¼‰åˆ°16ä½æ— ç¬¦å·æ•´æ•°ï¼ˆu16ï¼‰çš„ç±»å‹è½¬æ¢</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">// ä¿®æ”¹ `assert_eq!` è®©ä»£ç å·¥ä½œ</span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let x = 5;\t\t//i32</span><br><span class=\"line\">    assert_eq!(&quot;i32&quot;.to_string(), type_of(&amp;x)); //</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// ä»¥ä¸‹å‡½æ•°å¯ä»¥è·å–ä¼ å…¥å‚æ•°çš„ç±»å‹ï¼Œå¹¶è¿”å›ç±»å‹çš„å­—ç¬¦ä¸²å½¢å¼ï¼Œä¾‹å¦‚  &quot;i8&quot;, &quot;u8&quot;, &quot;i32&quot;, &quot;u32&quot;</span><br><span class=\"line\">fn type_of&lt;T&gt;(_: &amp;T) -&gt; String &#123;</span><br><span class=\"line\">    format!(&quot;&#123;&#125;&quot;, std::any::type_name::&lt;T&gt;())</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    assert_eq!(i8::MAX, 127); </span><br><span class=\"line\">    assert_eq!(u8::MAX, 255); </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">// è§£å†³ä»£ç ä¸­çš„é”™è¯¯å’Œ `panic`</span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">   let v1 = 251_u8.wrapping_add(8);</span><br><span class=\"line\">   let v2 = match u8::checked_add(251, 8) &#123;</span><br><span class=\"line\">        Some(value) =&gt; value,</span><br><span class=\"line\">        None =&gt; &#123;</span><br><span class=\"line\">            println!(&quot;Overflow occurred.&quot;);</span><br><span class=\"line\">            0</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">   println!(&quot;&#123;&#125;,&#123;&#125;&quot;,v1,v2);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let x = 1_000.000_1; // f64</span><br><span class=\"line\">    let y: f32 = 0.12; // f32</span><br><span class=\"line\">    let z = 0.01_f64; // f64</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#ä½¿ç”¨ä¸¤ç§æ–¹æ³•æ¥è®©ä¸‹é¢ä»£ç å·¥ä½œ</span><br><span class=\"line\">fn <span class=\"title function_\">main</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    assert!(<span class=\"number\">0.1</span>+<span class=\"number\">0.2</span>==<span class=\"number\">0.3</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> fn <span class=\"title function_\">main</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">     assert!(<span class=\"number\">0.1</span>_f32+<span class=\"number\">0.2</span>_f32==<span class=\"number\">0.3</span>_f32);</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"><span class=\"comment\">//é™ä½ç²¾åº¦</span></span><br><span class=\"line\">fn <span class=\"title function_\">main</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    let eps=<span class=\"number\">0.001</span>;</span><br><span class=\"line\">    assert!((<span class=\"number\">0.1</span>_f64+ <span class=\"number\">0.2</span> - <span class=\"number\">0.3</span>).<span class=\"built_in\">abs</span>() &lt; eps);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//è®¾ç½®å…è®¸è¯¯å·®</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"åºåˆ—Range\"><a href=\"#åºåˆ—Range\" class=\"headerlink\" title=\"åºåˆ—Range\"></a><a href=\"https://zh.practice.rs/basic-types/numbers.html#%E5%BA%8F%E5%88%97range\">åºåˆ—Range</a></h3><ol>\n<li>ğŸŒŸğŸŒŸ ä¸¤ä¸ªç›®æ ‡: 1. ä¿®æ”¹ <code>assert!</code> è®©å®ƒå·¥ä½œ 2. è®© <code>println!</code> è¾“å‡º: 97 - 122</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let mut sum = 0;</span><br><span class=\"line\">    for i in -3..2 &#123;</span><br><span class=\"line\">        sum += i</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    assert!(sum == -5);</span><br><span class=\"line\"></span><br><span class=\"line\">    for c in &#x27;a&#x27;..=&#x27;z&#x27; &#123;</span><br><span class=\"line\">        println!(&quot;&#123;&#125;&quot;,c as u8);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><figcaption><span>å¡«ç©º</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">use std::ops::&#123;Range, RangeInclusive&#125;;</span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    assert_eq!((1..5), Range&#123; start: 1, end: 5 &#125;);</span><br><span class=\"line\">    assert_eq!((1..=5), RangeInclusive::new(1, 5));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">///RangeInclusive::new(1, 5) åˆ›å»ºçš„æ˜¯ä¸€ä¸ªé—­åŒºé—´ï¼Œè¡¨ç¤ºä» 1 åˆ° 5ï¼ˆåŒ…æ‹¬ 5ï¼‰çš„èŒƒå›´ã€‚è‹¥ (1..5) åˆ›å»ºçš„æ˜¯ä¸€ä¸ªåŠå¼€åŒºé—´ï¼Œè¡¨ç¤ºä» 1 åˆ° 5ï¼ˆä¸åŒ…æ‹¬ 5ï¼‰çš„èŒƒå›´ã€‚</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">use std::mem::size_of_val;</span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let unit: () = ();</span><br><span class=\"line\">    assert!(size_of_val(&amp;unit) == 0);\t\t//å•å…ƒç±»å‹å ç”¨çš„å†…å­˜å¤§å° 0</span><br><span class=\"line\"></span><br><span class=\"line\">    println!(&quot;Success!&quot;)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"è¯­å¥ä¸è¡¨è¾¾å¼\"><a href=\"#è¯­å¥ä¸è¡¨è¾¾å¼\" class=\"headerlink\" title=\"è¯­å¥ä¸è¡¨è¾¾å¼\"></a><a href=\"https://zh.practice.rs/basic-types/statements-expressions.html#%E8%AF%AD%E5%8F%A5%E4%B8%8E%E8%A1%A8%E8%BE%BE%E5%BC%8F\">è¯­å¥ä¸è¡¨è¾¾å¼</a></h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">   let v = &#123;</span><br><span class=\"line\">       let mut x = 1;</span><br><span class=\"line\">       x += 2\t\t// æ²¡æœ‰è¿”å›å€¼  </span><br><span class=\"line\">   &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">   assert_eq!(v, 3);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">æ­£ç¡®çš„åšæ³•</span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">   let v = &#123;</span><br><span class=\"line\">       let mut x = 1;</span><br><span class=\"line\">       x += 2;</span><br><span class=\"line\">       x</span><br><span class=\"line\">   &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">   assert_eq!(v, 3);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">let z = &#123;</span><br><span class=\"line\">\t// åˆ†å·è®©è¡¨è¾¾å¼å˜æˆäº†è¯­å¥ï¼Œå› æ­¤è¿”å›çš„ä¸å†æ˜¯è¡¨è¾¾å¼ `2 * x` çš„å€¼ï¼Œè€Œæ˜¯è¯­å¥çš„å€¼ `()`</span><br><span class=\"line\">\t2 * x;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">   let v = &#123; let x = 3; x&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">   assert!(v == 3);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"å‡½æ•°\"><a href=\"#å‡½æ•°\" class=\"headerlink\" title=\"å‡½æ•°\"></a><a href=\"https://zh.practice.rs/basic-types/functions.html#%E5%87%BD%E6%95%B0\">å‡½æ•°</a></h3><h2 id=\"7-æ€»ç»“ï¼š\"><a href=\"#7-æ€»ç»“ï¼š\" class=\"headerlink\" title=\"7.æ€»ç»“ï¼š\"></a>7.æ€»ç»“ï¼š</h2><p>1.<code>let x = 2.0; // f64</code></p>\n<p>2.æ¯”è¾ƒæµ®ç‚¹æ•°<code>(0.1_f64 + 0.2 - 0.3).abs() &lt; 0.00001</code></p>\n<p>3.<code>ç¼–è¯‘å™¨ä¼šè¿›è¡Œè‡ªåŠ¨æ¨å¯¼ï¼Œç»™äºˆtwenty i32çš„ç±»å‹  let twenty = 20;</code></p>\n<p>4.æŒ‰ç…§è¡¥ç å¾ªç¯æº¢å‡ºè§„åˆ™å¤„ç†<code>et b = 255_u8.wrapping_add(20);  // 19</code>  <code>åœ¨ u8 çš„æƒ…å†µä¸‹ï¼Œ256 å˜æˆ 0ï¼Œ257 å˜æˆ 1ï¼Œ</code></p>\n<p>5.<code>(1..5)  è¡¨ç¤ºä» 1 åˆ° 5ï¼ˆä¸åŒ…æ‹¬ 5ï¼‰åŠå¼€åŒºé—´çš„èŒƒå›´</code></p>\n<p>6.<code>(1..=5)  è¡¨ç¤ºä» 1 åˆ° 5ï¼ˆåŒ…æ‹¬ 5ï¼‰åŠé—­åŒºé—´çš„èŒƒå›´</code></p>\n<p>6.<strong>è¡¨è¾¾å¼ä¸èƒ½åŒ…å«åˆ†å·</strong>ã€‚<code>è¡¨è¾¾å¼æ€»è¦è¿”å›å€¼</code></p>\n<p>7.è¿”å›å€¼ä¸ºï¼çš„è¡¨è¾¾å¼</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">loop &#123;&#125;  </span><br><span class=\"line\">panic!(&quot;Never return&quot;);  </span><br><span class=\"line\">todo!();  </span><br><span class=\"line\">unimplemented!();  //æœªå®ç°çš„å ä½ç¬¦å‡½æ•°</span><br><span class=\"line\"> </span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<p>[toc]</p>\n<h1 id=\"RuståŸºæœ¬æ•°æ®ç±»å‹\"><a href=\"#RuståŸºæœ¬æ•°æ®ç±»å‹\" class=\"headerlink\" title=\"RuståŸºæœ¬æ•°æ®ç±»å‹\"></a>RuståŸºæœ¬æ•°æ®ç±»å‹</h1><p>Rust æ¯ä¸ªå€¼éƒ½æœ‰å…¶ç¡®åˆ‡çš„æ•°æ®ç±»å‹ï¼Œæ€»çš„æ¥è¯´å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼šåŸºæœ¬ç±»å‹å’Œå¤åˆç±»å‹ã€‚ åŸºæœ¬ç±»å‹æ„å‘³ç€å®ƒä»¬å¾€å¾€æ˜¯ä¸€ä¸ªæœ€å°åŒ–åŸå­ç±»å‹ï¼Œæ— æ³•è§£æ„ä¸ºå…¶å®ƒç±»å‹(ä¸€èˆ¬æ„ä¹‰ä¸Šæ¥è¯´)ï¼Œç”±ä»¥ä¸‹ç»„æˆï¼š</p>\n<ul>\n<li>æ•°å€¼ç±»å‹: æœ‰ç¬¦å·æ•´æ•° (<code>i8</code>, <code>i16</code>, <code>i32</code>, <code>i64</code>, <code>isize</code>)ã€ æ— ç¬¦å·æ•´æ•° (<code>u8</code>, <code>u16</code>, <code>u32</code>, <code>u64</code>, <code>usize</code>) ã€æµ®ç‚¹æ•° (<code>f32</code>, <code>f64</code>)ã€ä»¥åŠæœ‰ç†æ•°ã€å¤æ•°</li>\n<li>å­—ç¬¦ä¸²ï¼šå­—ç¬¦ä¸²å­—é¢é‡å’Œå­—ç¬¦ä¸²åˆ‡ç‰‡ <code>&amp;str</code></li>\n<li>å¸ƒå°”ç±»å‹ï¼š <code>true</code>å’Œ<code>false</code></li>\n<li>å­—ç¬¦ç±»å‹: è¡¨ç¤ºå•ä¸ª Unicode å­—ç¬¦ï¼Œå­˜å‚¨ä¸º 4 ä¸ªå­—èŠ‚</li>\n<li>å•å…ƒç±»å‹: å³ <code>()</code> ï¼Œå…¶å”¯ä¸€çš„å€¼ä¹Ÿæ˜¯ <code>()</code></li>\n</ul>\n<h2 id=\"1-æ•°å€¼ç±»å‹\"><a href=\"#1-æ•°å€¼ç±»å‹\" class=\"headerlink\" title=\"1.æ•°å€¼ç±»å‹\"></a>1.æ•°å€¼ç±»å‹</h2><table>\n<thead>\n<tr>\n<th>é•¿åº¦</th>\n<th>æœ‰ç¬¦å·ç±»å‹</th>\n<th>æ— ç¬¦å·ç±»å‹</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>8 ä½</td>\n<td><code>i8</code></td>\n<td><code>u8</code></td>\n</tr>\n<tr>\n<td>16 ä½</td>\n<td><code>i16</code></td>\n<td><code>u16</code></td>\n</tr>\n<tr>\n<td>32 ä½</td>\n<td><code>i32</code></td>\n<td><code>u32</code></td>\n</tr>\n<tr>\n<td>64 ä½</td>\n<td><code>i64</code></td>\n<td><code>u64</code></td>\n</tr>\n<tr>\n<td>128 ä½</td>\n<td><code>i128</code></td>\n<td><code>u128</code></td>\n</tr>\n<tr>\n<td>è§†æ¶æ„è€Œå®š</td>\n<td><code>isize</code></td>\n<td><code>usize</code></td>\n</tr>\n</tbody></table>\n<p>æ•´å½¢å­—é¢é‡å¯ä»¥ç”¨ä¸‹è¡¨çš„å½¢å¼ä¹¦å†™ï¼š</p>\n<table>\n<thead>\n<tr>\n<th>æ•°å­—å­—é¢é‡</th>\n<th>ç¤ºä¾‹</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>åè¿›åˆ¶</td>\n<td><code>98_222</code></td>\n</tr>\n<tr>\n<td>åå…­è¿›åˆ¶</td>\n<td><code>0xff</code></td>\n</tr>\n<tr>\n<td>å…«è¿›åˆ¶</td>\n<td><code>0o77</code></td>\n</tr>\n<tr>\n<td>äºŒè¿›åˆ¶</td>\n<td><code>0b1111_0000</code></td>\n</tr>\n<tr>\n<td>å­—èŠ‚ (ä»…é™äº <code>u8</code>)</td>\n<td><code>b&#39;A&#39;</code></td>\n</tr>\n</tbody></table>\n<h2 id=\"2-æµ®ç‚¹ç±»å‹\"><a href=\"#2-æµ®ç‚¹ç±»å‹\" class=\"headerlink\" title=\"2.æµ®ç‚¹ç±»å‹\"></a>2.<a href=\"https://course.rs/basic/base-type/numbers.html#%E6%B5%AE%E7%82%B9%E7%B1%BB%E5%9E%8B\">æµ®ç‚¹ç±»å‹</a></h2><p><strong>æµ®ç‚¹ç±»å‹æ•°å­—</strong> æ˜¯å¸¦æœ‰å°æ•°ç‚¹çš„æ•°å­—ï¼Œåœ¨ Rust ä¸­æµ®ç‚¹ç±»å‹æ•°å­—ä¹Ÿæœ‰ä¸¤ç§åŸºæœ¬ç±»å‹ï¼š <code>f32</code> å’Œ <code>f64</code>ï¼Œåˆ†åˆ«ä¸º 32 ä½å’Œ 64 ä½å¤§å°ã€‚é»˜è®¤æµ®ç‚¹ç±»å‹æ˜¯ <code>f64</code>ï¼Œåœ¨ç°ä»£çš„ CPU ä¸­å®ƒçš„é€Ÿåº¦ä¸ <code>f32</code> å‡ ä¹ç›¸åŒï¼Œä½†ç²¾åº¦æ›´é«˜ã€‚</p>\n<p>ä¸‹é¢æ˜¯ä¸€ä¸ªæ¼”ç¤ºæµ®ç‚¹æ•°çš„ç¤ºä¾‹ï¼š</p>\n<figure class=\"highlight rust\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">fn</span> <span class=\"title function_\">main</span>() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> <span class=\"variable\">x</span> = <span class=\"number\">2.0</span>; <span class=\"comment\">// f64</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">let</span> <span class=\"variable\">y</span>: <span class=\"type\">f32</span> = <span class=\"number\">3.0</span>; <span class=\"comment\">// f32</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3-åºåˆ—-Range\"><a href=\"#3-åºåˆ—-Range\" class=\"headerlink\" title=\"3.åºåˆ—(Range)\"></a>3.<a href=\"https://course.rs/basic/base-type/numbers.html#%E5%BA%8F%E5%88%97range\">åºåˆ—(Range)</a></h2><p>Rust æä¾›äº†ä¸€ä¸ªéå¸¸ç®€æ´çš„æ–¹å¼ï¼Œç”¨æ¥ç”Ÿæˆè¿ç»­çš„æ•°å€¼ï¼Œä¾‹å¦‚ <strong><code>1..5</code>ï¼Œç”Ÿæˆä» 1 åˆ° 4 çš„è¿ç»­æ•°å­—ï¼Œä¸åŒ…å« 5</strong> ï¼›<code>1..=5</code>ï¼Œç”Ÿæˆä» 1 åˆ° 5 çš„è¿ç»­æ•°å­—ï¼ŒåŒ…å« 5ï¼Œå®ƒçš„ç”¨é€”å¾ˆç®€å•ï¼Œå¸¸å¸¸ç”¨äºå¾ªç¯ä¸­ï¼š</p>\n<figure class=\"highlight rust\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"variable\">i</span> <span class=\"keyword\">in</span> <span class=\"number\">1</span>..=<span class=\"number\">5</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">println!</span>(<span class=\"string\">&quot;&#123;&#125;&quot;</span>,i);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>æœ€ç»ˆç¨‹åºè¾“å‡º:</p>\n<figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td></tr></table></figure>\n\n<p><strong>åºåˆ—åªå…è®¸ç”¨äºæ•°å­—æˆ–å­—ç¬¦ç±»å‹</strong>ï¼ŒåŸå› æ˜¯ï¼šå®ƒä»¬å¯ä»¥è¿ç»­ï¼ŒåŒæ—¶ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æœŸå¯ä»¥æ£€æŸ¥è¯¥åºåˆ—æ˜¯å¦ä¸ºç©ºï¼Œå­—ç¬¦å’Œæ•°å­—å€¼æ˜¯ Rust ä¸­ä»…æœ‰çš„å¯ä»¥ç”¨äºåˆ¤æ–­æ˜¯å¦ä¸ºç©ºçš„ç±»å‹ã€‚å¦‚ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨å­—ç¬¦ç±»å‹åºåˆ—çš„ä¾‹å­ï¼š</p>\n<figure class=\"highlight rust\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"variable\">i</span> <span class=\"keyword\">in</span> <span class=\"string\">&#x27;a&#x27;</span>..=<span class=\"string\">&#x27;z&#x27;</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">println!</span>(<span class=\"string\">&quot;&#123;&#125;&quot;</span>,i);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"4-æœ‰ç†æ•°å’Œå¤æ•°\"><a href=\"#4-æœ‰ç†æ•°å’Œå¤æ•°\" class=\"headerlink\" title=\"4.æœ‰ç†æ•°å’Œå¤æ•°\"></a>4.<a href=\"https://course.rs/basic/base-type/numbers.html#%E6%9C%89%E7%90%86%E6%95%B0%E5%92%8C%E5%A4%8D%E6%95%B0\">æœ‰ç†æ•°å’Œå¤æ•°</a></h2><p>Rust çš„æ ‡å‡†åº“ç›¸æ¯”å…¶å®ƒè¯­è¨€ï¼Œå‡†å…¥é—¨æ§›è¾ƒé«˜ï¼Œå› æ­¤æœ‰ç†æ•°å’Œå¤æ•°å¹¶æœªåŒ…å«åœ¨æ ‡å‡†åº“ä¸­ï¼š</p>\n<ul>\n<li>æœ‰ç†æ•°å’Œå¤æ•°</li>\n<li>ä»»æ„å¤§å°çš„æ•´æ•°å’Œä»»æ„ç²¾åº¦çš„æµ®ç‚¹æ•°</li>\n<li>å›ºå®šç²¾åº¦çš„åè¿›åˆ¶å°æ•°ï¼Œå¸¸ç”¨äºè´§å¸ç›¸å…³çš„åœºæ™¯</li>\n</ul>\n<p>å¥½åœ¨ç¤¾åŒºå·²ç»å¼€å‘å‡ºé«˜è´¨é‡çš„ Rust æ•°å€¼åº“ï¼š<a href=\"https://crates.io/crates/num\">num</a>ã€‚</p>\n<p>æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ¥å¼•å…¥ <code>num</code> åº“ï¼š</p>\n<ol>\n<li>åˆ›å»ºæ–°å·¥ç¨‹ <code>cargo new complex-num &amp;&amp; cd complex-num</code></li>\n<li>åœ¨ <code>Cargo.toml</code> ä¸­çš„ <code>[dependencies]</code> ä¸‹æ·»åŠ ä¸€è¡Œ <code>num = &quot;0.4.0&quot;</code></li>\n<li>å°† <code>src/main.rs</code> æ–‡ä»¶ä¸­çš„ <code>main</code> å‡½æ•°æ›¿æ¢ä¸ºä¸‹é¢çš„ä»£ç </li>\n<li>è¿è¡Œ <code>cargo run</code></li>\n</ol>\n<figure class=\"highlight rust\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">use</span> num::complex::Complex;</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"keyword\">fn</span> <span class=\"title function_\">main</span>() &#123;</span><br><span class=\"line\">   <span class=\"keyword\">let</span> <span class=\"variable\">a</span> = Complex &#123; re: <span class=\"number\">2.1</span>, im: -<span class=\"number\">1.2</span> &#125;;</span><br><span class=\"line\">   <span class=\"keyword\">let</span> <span class=\"variable\">b</span> = Complex::<span class=\"title function_ invoke__\">new</span>(<span class=\"number\">11.1</span>, <span class=\"number\">22.2</span>);</span><br><span class=\"line\">   <span class=\"keyword\">let</span> <span class=\"variable\">result</span> = a + b;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"built_in\">println!</span>(<span class=\"string\">&quot;&#123;&#125; + &#123;&#125;i&quot;</span>, result.re, result.im)</span><br><span class=\"line\"> &#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a><a href=\"https://course.rs/basic/base-type/numbers.html#%E6%80%BB%E7%BB%93\">æ€»ç»“</a></h4><p>ä¹‹å‰æåˆ°äº†è¿‡ Rust çš„æ•°å€¼ç±»å‹å’Œè¿ç®—è·Ÿå…¶ä»–è¯­è¨€è¾ƒä¸ºç›¸ä¼¼ï¼Œä½†æ˜¯å®é™…ä¸Šï¼Œé™¤äº†è¯­æ³•ä¸Šçš„ä¸åŒä¹‹å¤–ï¼Œè¿˜æ˜¯å­˜åœ¨ä¸€äº›å·®å¼‚ç‚¹ï¼š</p>\n<ul>\n<li><strong>Rust æ‹¥æœ‰ç›¸å½“å¤šçš„æ•°å€¼ç±»å‹</strong>. å› æ­¤ä½ éœ€è¦ç†Ÿæ‚‰è¿™äº›ç±»å‹æ‰€å ç”¨çš„å­—èŠ‚æ•°ï¼Œè¿™æ ·å°±çŸ¥é“è¯¥ç±»å‹å…è®¸çš„å¤§å°èŒƒå›´ä»¥åŠä½ é€‰æ‹©çš„ç±»å‹æ˜¯å¦èƒ½è¡¨è¾¾è´Ÿæ•°</li>\n<li><strong>ç±»å‹è½¬æ¢å¿…é¡»æ˜¯æ˜¾å¼çš„</strong>. Rust æ°¸è¿œä¹Ÿä¸ä¼šå·å·æŠŠä½ çš„ 16bit æ•´æ•°è½¬æ¢æˆ 32bit æ•´æ•°</li>\n<li><strong>Rust çš„æ•°å€¼ä¸Šå¯ä»¥ä½¿ç”¨æ–¹æ³•</strong>. ä¾‹å¦‚ä½ å¯ä»¥ç”¨ä»¥ä¸‹æ–¹æ³•æ¥å°† <code>13.14</code> å–æ•´ï¼š<code>13.14_f32.round()</code>ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº†ç±»å‹åç¼€ï¼Œå› ä¸ºç¼–è¯‘å™¨éœ€è¦çŸ¥é“ <code>13.14</code> çš„å…·ä½“ç±»å‹</li>\n</ul>\n<h2 id=\"5-å‡½æ•°è¦ç‚¹\"><a href=\"#5-å‡½æ•°è¦ç‚¹\" class=\"headerlink\" title=\"5.å‡½æ•°è¦ç‚¹\"></a>5.<a href=\"https://course.rs/basic/base-type/function.html#%E5%87%BD%E6%95%B0%E8%A6%81%E7%82%B9\">å‡½æ•°è¦ç‚¹</a></h2><ul>\n<li>å‡½æ•°åå’Œå˜é‡åä½¿ç”¨<a href=\"https://course.rs/practice/naming.html\">è›‡å½¢å‘½åæ³•(snake case)</a>ï¼Œä¾‹å¦‚ <code>fn add_two() -&gt; &#123;&#125;</code></li>\n<li>å‡½æ•°çš„ä½ç½®å¯ä»¥éšä¾¿æ”¾ï¼ŒRust ä¸å…³å¿ƒæˆ‘ä»¬åœ¨å“ªé‡Œå®šä¹‰äº†å‡½æ•°ï¼Œåªè¦æœ‰å®šä¹‰å³å¯</li>\n<li>æ¯ä¸ªå‡½æ•°å‚æ•°éƒ½éœ€è¦æ ‡æ³¨ç±»å‹</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fn add(i: i32, j: i32) -&gt; i32 &#123;</span><br><span class=\"line\">   i + j</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://pic2.zhimg.com/80/v2-54b3a6d435d2482243edc4be9ab98153_1440w.png\" alt=\"img\"></p>\n<h3 id=\"è¿”å›å€¼ï¼š\"><a href=\"#è¿”å›å€¼ï¼š\" class=\"headerlink\" title=\"è¿”å›å€¼ï¼š\"></a>è¿”å›å€¼ï¼š</h3><p>â€‹\t<a href=\"https://course.rs/basic/base-type/function.html#%E6%97%A0%E8%BF%94%E5%9B%9E%E5%80%BC\">æ— è¿”å›å€¼<code>()</code></a></p>\n<ul>\n<li>å‡½æ•°æ²¡æœ‰è¿”å›å€¼ï¼Œé‚£ä¹ˆè¿”å›ä¸€ä¸ª <code>()</code></li>\n<li>é€šè¿‡ <code>;</code> ç»“å°¾çš„è¡¨è¾¾å¼è¿”å›ä¸€ä¸ª <code>()</code></li>\n</ul>\n<p>â€‹    <a href=\"https://course.rs/basic/base-type/function.html#%E6%B0%B8%E4%B8%8D%E8%BF%94%E5%9B%9E%E7%9A%84%E5%8F%91%E6%95%A3%E5%87%BD%E6%95%B0-\">æ°¸ä¸è¿”å›çš„å‘æ•£å‡½æ•° <code>!</code></a></p>\n<p>â€‹\t\tå½“ç”¨ <code>!</code> ä½œå‡½æ•°è¿”å›ç±»å‹çš„æ—¶å€™ï¼Œè¡¨ç¤ºè¯¥å‡½æ•°æ°¸ä¸è¿”å›( diverge function )ï¼Œç‰¹åˆ«çš„ï¼Œè¿™ç§è¯­æ³•å¾€å¾€ç”¨åšä¼šå¯¼è‡´ç¨‹åºå´©æºƒçš„å‡½æ•°ï¼š</p>\n<h2 id=\"6-ç»ƒä¹ \"><a href=\"#6-ç»ƒä¹ \" class=\"headerlink\" title=\"6.ç»ƒä¹ \"></a>6.ç»ƒä¹ </h2><p><a href=\"https://zh.practice.rs/basic-types/numbers.html\">æ•°å€¼ç±»å‹ - Rust By Practice( Rust ç»ƒä¹ å®è·µ )</a></p>\n<figure class=\"highlight plaintext\"><figcaption><span>å¡«ç©º</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let v: u16 = 38_u8 as u16; //ä»8ä½æ— ç¬¦å·æ•´æ•°ï¼ˆu8ï¼‰åˆ°16ä½æ— ç¬¦å·æ•´æ•°ï¼ˆu16ï¼‰çš„ç±»å‹è½¬æ¢</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">// ä¿®æ”¹ `assert_eq!` è®©ä»£ç å·¥ä½œ</span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let x = 5;\t\t//i32</span><br><span class=\"line\">    assert_eq!(&quot;i32&quot;.to_string(), type_of(&amp;x)); //</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// ä»¥ä¸‹å‡½æ•°å¯ä»¥è·å–ä¼ å…¥å‚æ•°çš„ç±»å‹ï¼Œå¹¶è¿”å›ç±»å‹çš„å­—ç¬¦ä¸²å½¢å¼ï¼Œä¾‹å¦‚  &quot;i8&quot;, &quot;u8&quot;, &quot;i32&quot;, &quot;u32&quot;</span><br><span class=\"line\">fn type_of&lt;T&gt;(_: &amp;T) -&gt; String &#123;</span><br><span class=\"line\">    format!(&quot;&#123;&#125;&quot;, std::any::type_name::&lt;T&gt;())</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    assert_eq!(i8::MAX, 127); </span><br><span class=\"line\">    assert_eq!(u8::MAX, 255); </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">// è§£å†³ä»£ç ä¸­çš„é”™è¯¯å’Œ `panic`</span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">   let v1 = 251_u8.wrapping_add(8);</span><br><span class=\"line\">   let v2 = match u8::checked_add(251, 8) &#123;</span><br><span class=\"line\">        Some(value) =&gt; value,</span><br><span class=\"line\">        None =&gt; &#123;</span><br><span class=\"line\">            println!(&quot;Overflow occurred.&quot;);</span><br><span class=\"line\">            0</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">   println!(&quot;&#123;&#125;,&#123;&#125;&quot;,v1,v2);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let x = 1_000.000_1; // f64</span><br><span class=\"line\">    let y: f32 = 0.12; // f32</span><br><span class=\"line\">    let z = 0.01_f64; // f64</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#ä½¿ç”¨ä¸¤ç§æ–¹æ³•æ¥è®©ä¸‹é¢ä»£ç å·¥ä½œ</span><br><span class=\"line\">fn <span class=\"title function_\">main</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    assert!(<span class=\"number\">0.1</span>+<span class=\"number\">0.2</span>==<span class=\"number\">0.3</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> fn <span class=\"title function_\">main</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">     assert!(<span class=\"number\">0.1</span>_f32+<span class=\"number\">0.2</span>_f32==<span class=\"number\">0.3</span>_f32);</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"><span class=\"comment\">//é™ä½ç²¾åº¦</span></span><br><span class=\"line\">fn <span class=\"title function_\">main</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    let eps=<span class=\"number\">0.001</span>;</span><br><span class=\"line\">    assert!((<span class=\"number\">0.1</span>_f64+ <span class=\"number\">0.2</span> - <span class=\"number\">0.3</span>).<span class=\"built_in\">abs</span>() &lt; eps);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//è®¾ç½®å…è®¸è¯¯å·®</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"åºåˆ—Range\"><a href=\"#åºåˆ—Range\" class=\"headerlink\" title=\"åºåˆ—Range\"></a><a href=\"https://zh.practice.rs/basic-types/numbers.html#%E5%BA%8F%E5%88%97range\">åºåˆ—Range</a></h3><ol>\n<li>ğŸŒŸğŸŒŸ ä¸¤ä¸ªç›®æ ‡: 1. ä¿®æ”¹ <code>assert!</code> è®©å®ƒå·¥ä½œ 2. è®© <code>println!</code> è¾“å‡º: 97 - 122</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let mut sum = 0;</span><br><span class=\"line\">    for i in -3..2 &#123;</span><br><span class=\"line\">        sum += i</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    assert!(sum == -5);</span><br><span class=\"line\"></span><br><span class=\"line\">    for c in &#x27;a&#x27;..=&#x27;z&#x27; &#123;</span><br><span class=\"line\">        println!(&quot;&#123;&#125;&quot;,c as u8);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><figcaption><span>å¡«ç©º</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">use std::ops::&#123;Range, RangeInclusive&#125;;</span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    assert_eq!((1..5), Range&#123; start: 1, end: 5 &#125;);</span><br><span class=\"line\">    assert_eq!((1..=5), RangeInclusive::new(1, 5));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">///RangeInclusive::new(1, 5) åˆ›å»ºçš„æ˜¯ä¸€ä¸ªé—­åŒºé—´ï¼Œè¡¨ç¤ºä» 1 åˆ° 5ï¼ˆåŒ…æ‹¬ 5ï¼‰çš„èŒƒå›´ã€‚è‹¥ (1..5) åˆ›å»ºçš„æ˜¯ä¸€ä¸ªåŠå¼€åŒºé—´ï¼Œè¡¨ç¤ºä» 1 åˆ° 5ï¼ˆä¸åŒ…æ‹¬ 5ï¼‰çš„èŒƒå›´ã€‚</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">use std::mem::size_of_val;</span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let unit: () = ();</span><br><span class=\"line\">    assert!(size_of_val(&amp;unit) == 0);\t\t//å•å…ƒç±»å‹å ç”¨çš„å†…å­˜å¤§å° 0</span><br><span class=\"line\"></span><br><span class=\"line\">    println!(&quot;Success!&quot;)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"è¯­å¥ä¸è¡¨è¾¾å¼\"><a href=\"#è¯­å¥ä¸è¡¨è¾¾å¼\" class=\"headerlink\" title=\"è¯­å¥ä¸è¡¨è¾¾å¼\"></a><a href=\"https://zh.practice.rs/basic-types/statements-expressions.html#%E8%AF%AD%E5%8F%A5%E4%B8%8E%E8%A1%A8%E8%BE%BE%E5%BC%8F\">è¯­å¥ä¸è¡¨è¾¾å¼</a></h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">   let v = &#123;</span><br><span class=\"line\">       let mut x = 1;</span><br><span class=\"line\">       x += 2\t\t// æ²¡æœ‰è¿”å›å€¼  </span><br><span class=\"line\">   &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">   assert_eq!(v, 3);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">æ­£ç¡®çš„åšæ³•</span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">   let v = &#123;</span><br><span class=\"line\">       let mut x = 1;</span><br><span class=\"line\">       x += 2;</span><br><span class=\"line\">       x</span><br><span class=\"line\">   &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">   assert_eq!(v, 3);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">let z = &#123;</span><br><span class=\"line\">\t// åˆ†å·è®©è¡¨è¾¾å¼å˜æˆäº†è¯­å¥ï¼Œå› æ­¤è¿”å›çš„ä¸å†æ˜¯è¡¨è¾¾å¼ `2 * x` çš„å€¼ï¼Œè€Œæ˜¯è¯­å¥çš„å€¼ `()`</span><br><span class=\"line\">\t2 * x;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">   let v = &#123; let x = 3; x&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">   assert!(v == 3);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"å‡½æ•°\"><a href=\"#å‡½æ•°\" class=\"headerlink\" title=\"å‡½æ•°\"></a><a href=\"https://zh.practice.rs/basic-types/functions.html#%E5%87%BD%E6%95%B0\">å‡½æ•°</a></h3><h2 id=\"7-æ€»ç»“ï¼š\"><a href=\"#7-æ€»ç»“ï¼š\" class=\"headerlink\" title=\"7.æ€»ç»“ï¼š\"></a>7.æ€»ç»“ï¼š</h2><p>1.<code>let x = 2.0; // f64</code></p>\n<p>2.æ¯”è¾ƒæµ®ç‚¹æ•°<code>(0.1_f64 + 0.2 - 0.3).abs() &lt; 0.00001</code></p>\n<p>3.<code>ç¼–è¯‘å™¨ä¼šè¿›è¡Œè‡ªåŠ¨æ¨å¯¼ï¼Œç»™äºˆtwenty i32çš„ç±»å‹  let twenty = 20;</code></p>\n<p>4.æŒ‰ç…§è¡¥ç å¾ªç¯æº¢å‡ºè§„åˆ™å¤„ç†<code>et b = 255_u8.wrapping_add(20);  // 19</code>  <code>åœ¨ u8 çš„æƒ…å†µä¸‹ï¼Œ256 å˜æˆ 0ï¼Œ257 å˜æˆ 1ï¼Œ</code></p>\n<p>5.<code>(1..5)  è¡¨ç¤ºä» 1 åˆ° 5ï¼ˆä¸åŒ…æ‹¬ 5ï¼‰åŠå¼€åŒºé—´çš„èŒƒå›´</code></p>\n<p>6.<code>(1..=5)  è¡¨ç¤ºä» 1 åˆ° 5ï¼ˆåŒ…æ‹¬ 5ï¼‰åŠé—­åŒºé—´çš„èŒƒå›´</code></p>\n<p>6.<strong>è¡¨è¾¾å¼ä¸èƒ½åŒ…å«åˆ†å·</strong>ã€‚<code>è¡¨è¾¾å¼æ€»è¦è¿”å›å€¼</code></p>\n<p>7.è¿”å›å€¼ä¸ºï¼çš„è¡¨è¾¾å¼</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">loop &#123;&#125;  </span><br><span class=\"line\">panic!(&quot;Never return&quot;);  </span><br><span class=\"line\">todo!();  </span><br><span class=\"line\">unimplemented!();  //æœªå®ç°çš„å ä½ç¬¦å‡½æ•°</span><br><span class=\"line\"> </span><br></pre></td></tr></table></figure>\n"},{"title":"03-rustå¤åˆç±»å‹","date":"2023-08-28T13:58:27.000Z","_content":"\n\n\n\n\n# 1.å­—ç¬¦ä¸²å’Œåˆ‡ç‰‡\n\n## [ä»€ä¹ˆæ˜¯å­—ç¬¦ä¸²?](https://course.rs/basic/compound-type/string-slice.html#ä»€ä¹ˆæ˜¯å­—ç¬¦ä¸²)\n\n**Rust ä¸­çš„å­—ç¬¦æ˜¯ Unicode ç±»å‹ï¼Œå› æ­¤æ¯ä¸ªå­—ç¬¦å æ® 4 ä¸ªå­—èŠ‚å†…å­˜ç©ºé—´ï¼Œä½†æ˜¯åœ¨å­—ç¬¦ä¸²ä¸­ä¸ä¸€æ ·ï¼Œå­—ç¬¦ä¸²æ˜¯ UTF-8 ç¼–ç ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦æ‰€å çš„å­—èŠ‚æ•°æ˜¯å˜åŒ–çš„(1 - 4)**\n\n`str` ç±»å‹æ˜¯ç¡¬ç¼–ç è¿›å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¹Ÿæ— æ³•è¢«ä¿®æ”¹ï¼Œä½†æ˜¯ `String` åˆ™æ˜¯ä¸€ä¸ªå¯å¢é•¿ã€å¯æ”¹å˜ä¸”å…·æœ‰æ‰€æœ‰æƒçš„ UTF-8 ç¼–ç å­—ç¬¦ä¸²ï¼Œ**å½“ Rust ç”¨æˆ·æåˆ°å­—ç¬¦ä¸²æ—¶ï¼Œå¾€å¾€æŒ‡çš„å°±æ˜¯ `String` ç±»å‹å’Œ `&str` å­—ç¬¦ä¸²åˆ‡ç‰‡ç±»å‹ï¼Œè¿™ä¸¤ä¸ªç±»å‹éƒ½æ˜¯ UTF-8 ç¼–ç **ã€‚\n\n```\nlet a = [1, 2, 3, 4, 5];\n\nlet slice = &a[1..3];\n\nassert_eq!(slice, &[2, 3]);\n\n```\n\n\n\n## [String ä¸ &str çš„è½¬æ¢](https://course.rs/basic/compound-type/string-slice.html#string-ä¸-str-çš„è½¬æ¢)\n\n```\nfn main() {\n    let s = String::from(\"hello,world!\");\n    say_hello(&s);\n    say_hello(&s[..]);\n    say_hello(s.as_str());\n}\n\nfn say_hello(s: &str) {\n    println!(\"{}\",s);\n}\n```\n\n## [å­—ç¬¦ä¸²ç´¢å¼•](https://course.rs/basic/compound-type/string-slice.html#å­—ç¬¦ä¸²ç´¢å¼•)\n\n## [å­—ç¬¦ä¸²åˆ‡ç‰‡](https://course.rs/basic/compound-type/string-slice.html#å­—ç¬¦ä¸²åˆ‡ç‰‡)\n\né€šè¿‡ç´¢å¼•åŒºé—´æ¥è®¿é—®å­—ç¬¦ä¸²æ—¶ï¼Œ**éœ€è¦æ ¼å¤–çš„å°å¿ƒ**ï¼Œä¸€ä¸æ³¨æ„ï¼Œå°±ä¼šå¯¼è‡´ä½ ç¨‹åºçš„å´©æºƒï¼\n\n## [æ“ä½œå­—ç¬¦ä¸²](https://course.rs/basic/compound-type/string-slice.html#æ“ä½œå­—ç¬¦ä¸²)\n\n#### [è¿½åŠ  (Push)](https://course.rs/basic/compound-type/string-slice.html#è¿½åŠ -push)\n\n\n\n#### [æ’å…¥ (Insert)](https://course.rs/basic/compound-type/string-slice.html#æ’å…¥-insert)\n\n#### [æ›¿æ¢ (Replace)](https://course.rs/basic/compound-type/string-slice.html#æ›¿æ¢-replace)\n\n#### [åˆ é™¤ (Delete)](https://course.rs/basic/compound-type/string-slice.html#åˆ é™¤-delete)\n\n#### [è¿æ¥ (Concatenate)](https://course.rs/basic/compound-type/string-slice.html#è¿æ¥-concatenate)\n\n## [å­—ç¬¦ä¸²è½¬ä¹‰](https://course.rs/basic/compound-type/string-slice.html#å­—ç¬¦ä¸²è½¬ä¹‰)\n\n```\nfn main() {\n    println!(\"{}\", \"hello \\\\x52\\\\x75\\\\x73\\\\x74\");\n    let raw_str = r\"Escapes don't work here: \\x3F \\u{211D}\";\n    println!(\"{}\", raw_str);\n\n    // å¦‚æœå­—ç¬¦ä¸²åŒ…å«åŒå¼•å·ï¼Œå¯ä»¥åœ¨å¼€å¤´å’Œç»“å°¾åŠ  #\n    let quotes = r#\"And then I said: \"There is no escape!\"\"#;\n    println!(\"{}\", quotes);\n\n    // å¦‚æœè¿˜æ˜¯æœ‰æ­§ä¹‰ï¼Œå¯ä»¥ç»§ç»­å¢åŠ ï¼Œæ²¡æœ‰é™åˆ¶\n    let longer_delimiter = r###\"A string with \"# in it. And even \"##!\"###;\n    println!(\"{}\", longer_delimiter);\n}\n```\n\n## [æ“ä½œ UTF-8 å­—ç¬¦ä¸²](https://course.rs/basic/compound-type/string-slice.html#æ“ä½œ-utf-8-å­—ç¬¦ä¸²)\n\n[å­—ç¬¦ä¸²ä¸åˆ‡ç‰‡ - Rustè¯­è¨€åœ£ç»(Rust Course)](https://course.rs/basic/compound-type/string-slice.html#è¯¾åç»ƒä¹ )\n\n```\nfor c in \"ä¸­å›½äºº\".chars() {\n    println!(\"{}\", c);\n}\n```\n\n## [è¯¾åç»ƒä¹ ](https://course.rs/basic/compound-type/string-slice.html#è¯¾åç»ƒä¹ )\n\n> Rust By Practiceï¼Œæ”¯æŒä»£ç åœ¨çº¿ç¼–è¾‘å’Œè¿è¡Œï¼Œå¹¶æä¾›è¯¦ç»†çš„ä¹ é¢˜è§£ç­”ã€‚\n>\n> - [å­—ç¬¦ä¸²](https://zh.practice.rs/compound-types/string.html)\n>   - [ä¹ é¢˜è§£ç­”](https://github.com/sunface/rust-by-practice/blob/master/solutions/compound-types/string.md)\n> - [åˆ‡ç‰‡](https://zh.practice.rs/compound-types/slice.html)\n>   - [ä¹ é¢˜è§£ç­”](https://github.com/sunface/rust-by-practice/blob/master/solutions/compound-types/slice.md)\n> - [String](https://zh.practice.rs/collections/String.html)\n>   - [ä¹ é¢˜è§£ç­”](https://github.com/sunface/rust-by-practice/blob/master/solutions/collections/String.md)\n\n```\n\n// å¡«ç©ºå¹¶ä¿®å¤é”™è¯¯\nfn main() {\n    let s = String::from(\"hello, ä¸–ç•Œ\");\n    let slice1 = &s[0..1]; //æç¤º: `h` åœ¨ UTF-8 ç¼–ç ä¸­åªå ç”¨ 1 ä¸ªå­—èŠ‚\n    assert_eq!(slice1, \"h\");\n\n    let slice2 = &s[7..10];// æç¤º: `ä¸–` åœ¨ UTF-8 ç¼–ç ä¸­å ç”¨ 3 ä¸ªå­—èŠ‚\n    assert_eq!(slice2, \"ä¸–\");\n    \n    // è¿­ä»£ s ä¸­çš„æ‰€æœ‰å­—ç¬¦\n    for (i, c) in s.chars().enumerate() {\n        if i == 7 {\n            assert_eq!(c, 'ä¸–')\n        }\n    }\n\n    println!(\"Success!\")\n}\n\n\n\n// å¡«ç©º\nfn main() {\n    let mut s = String::new();\n     s.push_str(\"hello\");\n\n    let v = vec![104, 101, 108, 108, 111];\n\n    // å°†å­—èŠ‚æ•°ç»„è½¬æ¢æˆ String\n    let s1 = String::from_utf8(v).unwrap();\n    \n    \n    assert_eq!(s, s1);\n\n    println!(\"Success!\")\n}\n\n\n\n// å¡«ç©º\nuse std::mem;\n\nfn main() {\n    let story = String::from(\"Rust By Practice\");\n\n    // é˜»æ­¢ String çš„æ•°æ®è¢«è‡ªåŠ¨ drop\n    let mut story = mem::ManuallyDrop::new(story);\n\n    let ptr = story.as_mut_ptr();\n    let len = story.len();\n    let capacity = story.capacity();\n\n    assert_eq!(16, len);\n\n    // æˆ‘ä»¬å¯ä»¥åŸºäº ptr æŒ‡é’ˆã€é•¿åº¦å’Œå®¹é‡æ¥é‡æ–°æ„å»º String. \n    // è¿™ç§æ“ä½œå¿…é¡»æ ‡è®°ä¸º unsafeï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦è‡ªå·±æ¥ç¡®ä¿è¿™é‡Œçš„æ“ä½œæ˜¯å®‰å…¨çš„\n    let s = unsafe { String::from_raw_parts(ptr, len, capacity) };\n\n    assert_eq!(*story, s);\n\n    println!(\"Success!\")\n}\n\n```\n\n\n\n# 2.[å…ƒç»„](https://course.rs/basic/compound-type/tuple.html#å…ƒç»„)\n\n# 3. å…ƒç»„\n# 4. test\n\nå¾…ç»­ã€‚ã€‚ã€‚\n","source":"_posts/03-rustå¤åˆç±»å‹.md","raw":"---\ntitle: 03-rustå¤åˆç±»å‹\ndate: 2023-08-28 21:58:27\ncategories:\n- rust\ntags:\n- rustå¤åˆç±»å‹\n- rust\n---\n\n\n\n\n\n# 1.å­—ç¬¦ä¸²å’Œåˆ‡ç‰‡\n\n## [ä»€ä¹ˆæ˜¯å­—ç¬¦ä¸²?](https://course.rs/basic/compound-type/string-slice.html#ä»€ä¹ˆæ˜¯å­—ç¬¦ä¸²)\n\n**Rust ä¸­çš„å­—ç¬¦æ˜¯ Unicode ç±»å‹ï¼Œå› æ­¤æ¯ä¸ªå­—ç¬¦å æ® 4 ä¸ªå­—èŠ‚å†…å­˜ç©ºé—´ï¼Œä½†æ˜¯åœ¨å­—ç¬¦ä¸²ä¸­ä¸ä¸€æ ·ï¼Œå­—ç¬¦ä¸²æ˜¯ UTF-8 ç¼–ç ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦æ‰€å çš„å­—èŠ‚æ•°æ˜¯å˜åŒ–çš„(1 - 4)**\n\n`str` ç±»å‹æ˜¯ç¡¬ç¼–ç è¿›å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¹Ÿæ— æ³•è¢«ä¿®æ”¹ï¼Œä½†æ˜¯ `String` åˆ™æ˜¯ä¸€ä¸ªå¯å¢é•¿ã€å¯æ”¹å˜ä¸”å…·æœ‰æ‰€æœ‰æƒçš„ UTF-8 ç¼–ç å­—ç¬¦ä¸²ï¼Œ**å½“ Rust ç”¨æˆ·æåˆ°å­—ç¬¦ä¸²æ—¶ï¼Œå¾€å¾€æŒ‡çš„å°±æ˜¯ `String` ç±»å‹å’Œ `&str` å­—ç¬¦ä¸²åˆ‡ç‰‡ç±»å‹ï¼Œè¿™ä¸¤ä¸ªç±»å‹éƒ½æ˜¯ UTF-8 ç¼–ç **ã€‚\n\n```\nlet a = [1, 2, 3, 4, 5];\n\nlet slice = &a[1..3];\n\nassert_eq!(slice, &[2, 3]);\n\n```\n\n\n\n## [String ä¸ &str çš„è½¬æ¢](https://course.rs/basic/compound-type/string-slice.html#string-ä¸-str-çš„è½¬æ¢)\n\n```\nfn main() {\n    let s = String::from(\"hello,world!\");\n    say_hello(&s);\n    say_hello(&s[..]);\n    say_hello(s.as_str());\n}\n\nfn say_hello(s: &str) {\n    println!(\"{}\",s);\n}\n```\n\n## [å­—ç¬¦ä¸²ç´¢å¼•](https://course.rs/basic/compound-type/string-slice.html#å­—ç¬¦ä¸²ç´¢å¼•)\n\n## [å­—ç¬¦ä¸²åˆ‡ç‰‡](https://course.rs/basic/compound-type/string-slice.html#å­—ç¬¦ä¸²åˆ‡ç‰‡)\n\né€šè¿‡ç´¢å¼•åŒºé—´æ¥è®¿é—®å­—ç¬¦ä¸²æ—¶ï¼Œ**éœ€è¦æ ¼å¤–çš„å°å¿ƒ**ï¼Œä¸€ä¸æ³¨æ„ï¼Œå°±ä¼šå¯¼è‡´ä½ ç¨‹åºçš„å´©æºƒï¼\n\n## [æ“ä½œå­—ç¬¦ä¸²](https://course.rs/basic/compound-type/string-slice.html#æ“ä½œå­—ç¬¦ä¸²)\n\n#### [è¿½åŠ  (Push)](https://course.rs/basic/compound-type/string-slice.html#è¿½åŠ -push)\n\n\n\n#### [æ’å…¥ (Insert)](https://course.rs/basic/compound-type/string-slice.html#æ’å…¥-insert)\n\n#### [æ›¿æ¢ (Replace)](https://course.rs/basic/compound-type/string-slice.html#æ›¿æ¢-replace)\n\n#### [åˆ é™¤ (Delete)](https://course.rs/basic/compound-type/string-slice.html#åˆ é™¤-delete)\n\n#### [è¿æ¥ (Concatenate)](https://course.rs/basic/compound-type/string-slice.html#è¿æ¥-concatenate)\n\n## [å­—ç¬¦ä¸²è½¬ä¹‰](https://course.rs/basic/compound-type/string-slice.html#å­—ç¬¦ä¸²è½¬ä¹‰)\n\n```\nfn main() {\n    println!(\"{}\", \"hello \\\\x52\\\\x75\\\\x73\\\\x74\");\n    let raw_str = r\"Escapes don't work here: \\x3F \\u{211D}\";\n    println!(\"{}\", raw_str);\n\n    // å¦‚æœå­—ç¬¦ä¸²åŒ…å«åŒå¼•å·ï¼Œå¯ä»¥åœ¨å¼€å¤´å’Œç»“å°¾åŠ  #\n    let quotes = r#\"And then I said: \"There is no escape!\"\"#;\n    println!(\"{}\", quotes);\n\n    // å¦‚æœè¿˜æ˜¯æœ‰æ­§ä¹‰ï¼Œå¯ä»¥ç»§ç»­å¢åŠ ï¼Œæ²¡æœ‰é™åˆ¶\n    let longer_delimiter = r###\"A string with \"# in it. And even \"##!\"###;\n    println!(\"{}\", longer_delimiter);\n}\n```\n\n## [æ“ä½œ UTF-8 å­—ç¬¦ä¸²](https://course.rs/basic/compound-type/string-slice.html#æ“ä½œ-utf-8-å­—ç¬¦ä¸²)\n\n[å­—ç¬¦ä¸²ä¸åˆ‡ç‰‡ - Rustè¯­è¨€åœ£ç»(Rust Course)](https://course.rs/basic/compound-type/string-slice.html#è¯¾åç»ƒä¹ )\n\n```\nfor c in \"ä¸­å›½äºº\".chars() {\n    println!(\"{}\", c);\n}\n```\n\n## [è¯¾åç»ƒä¹ ](https://course.rs/basic/compound-type/string-slice.html#è¯¾åç»ƒä¹ )\n\n> Rust By Practiceï¼Œæ”¯æŒä»£ç åœ¨çº¿ç¼–è¾‘å’Œè¿è¡Œï¼Œå¹¶æä¾›è¯¦ç»†çš„ä¹ é¢˜è§£ç­”ã€‚\n>\n> - [å­—ç¬¦ä¸²](https://zh.practice.rs/compound-types/string.html)\n>   - [ä¹ é¢˜è§£ç­”](https://github.com/sunface/rust-by-practice/blob/master/solutions/compound-types/string.md)\n> - [åˆ‡ç‰‡](https://zh.practice.rs/compound-types/slice.html)\n>   - [ä¹ é¢˜è§£ç­”](https://github.com/sunface/rust-by-practice/blob/master/solutions/compound-types/slice.md)\n> - [String](https://zh.practice.rs/collections/String.html)\n>   - [ä¹ é¢˜è§£ç­”](https://github.com/sunface/rust-by-practice/blob/master/solutions/collections/String.md)\n\n```\n\n// å¡«ç©ºå¹¶ä¿®å¤é”™è¯¯\nfn main() {\n    let s = String::from(\"hello, ä¸–ç•Œ\");\n    let slice1 = &s[0..1]; //æç¤º: `h` åœ¨ UTF-8 ç¼–ç ä¸­åªå ç”¨ 1 ä¸ªå­—èŠ‚\n    assert_eq!(slice1, \"h\");\n\n    let slice2 = &s[7..10];// æç¤º: `ä¸–` åœ¨ UTF-8 ç¼–ç ä¸­å ç”¨ 3 ä¸ªå­—èŠ‚\n    assert_eq!(slice2, \"ä¸–\");\n    \n    // è¿­ä»£ s ä¸­çš„æ‰€æœ‰å­—ç¬¦\n    for (i, c) in s.chars().enumerate() {\n        if i == 7 {\n            assert_eq!(c, 'ä¸–')\n        }\n    }\n\n    println!(\"Success!\")\n}\n\n\n\n// å¡«ç©º\nfn main() {\n    let mut s = String::new();\n     s.push_str(\"hello\");\n\n    let v = vec![104, 101, 108, 108, 111];\n\n    // å°†å­—èŠ‚æ•°ç»„è½¬æ¢æˆ String\n    let s1 = String::from_utf8(v).unwrap();\n    \n    \n    assert_eq!(s, s1);\n\n    println!(\"Success!\")\n}\n\n\n\n// å¡«ç©º\nuse std::mem;\n\nfn main() {\n    let story = String::from(\"Rust By Practice\");\n\n    // é˜»æ­¢ String çš„æ•°æ®è¢«è‡ªåŠ¨ drop\n    let mut story = mem::ManuallyDrop::new(story);\n\n    let ptr = story.as_mut_ptr();\n    let len = story.len();\n    let capacity = story.capacity();\n\n    assert_eq!(16, len);\n\n    // æˆ‘ä»¬å¯ä»¥åŸºäº ptr æŒ‡é’ˆã€é•¿åº¦å’Œå®¹é‡æ¥é‡æ–°æ„å»º String. \n    // è¿™ç§æ“ä½œå¿…é¡»æ ‡è®°ä¸º unsafeï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦è‡ªå·±æ¥ç¡®ä¿è¿™é‡Œçš„æ“ä½œæ˜¯å®‰å…¨çš„\n    let s = unsafe { String::from_raw_parts(ptr, len, capacity) };\n\n    assert_eq!(*story, s);\n\n    println!(\"Success!\")\n}\n\n```\n\n\n\n# 2.[å…ƒç»„](https://course.rs/basic/compound-type/tuple.html#å…ƒç»„)\n\n# 3. å…ƒç»„\n# 4. test\n\nå¾…ç»­ã€‚ã€‚ã€‚\n","slug":"03-rustå¤åˆç±»å‹","published":1,"updated":"2024-04-28T07:13:38.746Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clvjcoaaw000er9w08cjhb54a","content":"<h1 id=\"1-å­—ç¬¦ä¸²å’Œåˆ‡ç‰‡\"><a href=\"#1-å­—ç¬¦ä¸²å’Œåˆ‡ç‰‡\" class=\"headerlink\" title=\"1.å­—ç¬¦ä¸²å’Œåˆ‡ç‰‡\"></a>1.å­—ç¬¦ä¸²å’Œåˆ‡ç‰‡</h1><h2 id=\"ä»€ä¹ˆæ˜¯å­—ç¬¦ä¸²\"><a href=\"#ä»€ä¹ˆæ˜¯å­—ç¬¦ä¸²\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯å­—ç¬¦ä¸²?\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E4%BB%80%E4%B9%88%E6%98%AF%E5%AD%97%E7%AC%A6%E4%B8%B2\">ä»€ä¹ˆæ˜¯å­—ç¬¦ä¸²?</a></h2><p><strong>Rust ä¸­çš„å­—ç¬¦æ˜¯ Unicode ç±»å‹ï¼Œå› æ­¤æ¯ä¸ªå­—ç¬¦å æ® 4 ä¸ªå­—èŠ‚å†…å­˜ç©ºé—´ï¼Œä½†æ˜¯åœ¨å­—ç¬¦ä¸²ä¸­ä¸ä¸€æ ·ï¼Œå­—ç¬¦ä¸²æ˜¯ UTF-8 ç¼–ç ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦æ‰€å çš„å­—èŠ‚æ•°æ˜¯å˜åŒ–çš„(1 - 4)</strong></p>\n<p><code>str</code> ç±»å‹æ˜¯ç¡¬ç¼–ç è¿›å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¹Ÿæ— æ³•è¢«ä¿®æ”¹ï¼Œä½†æ˜¯ <code>String</code> åˆ™æ˜¯ä¸€ä¸ªå¯å¢é•¿ã€å¯æ”¹å˜ä¸”å…·æœ‰æ‰€æœ‰æƒçš„ UTF-8 ç¼–ç å­—ç¬¦ä¸²ï¼Œ<strong>å½“ Rust ç”¨æˆ·æåˆ°å­—ç¬¦ä¸²æ—¶ï¼Œå¾€å¾€æŒ‡çš„å°±æ˜¯ <code>String</code> ç±»å‹å’Œ <code>&amp;str</code> å­—ç¬¦ä¸²åˆ‡ç‰‡ç±»å‹ï¼Œè¿™ä¸¤ä¸ªç±»å‹éƒ½æ˜¯ UTF-8 ç¼–ç </strong>ã€‚</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">let a = [1, 2, 3, 4, 5];</span><br><span class=\"line\"></span><br><span class=\"line\">let slice = &amp;a[1..3];</span><br><span class=\"line\"></span><br><span class=\"line\">assert_eq!(slice, &amp;[2, 3]);</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"String-ä¸-str-çš„è½¬æ¢\"><a href=\"#String-ä¸-str-çš„è½¬æ¢\" class=\"headerlink\" title=\"String ä¸ &amp;str çš„è½¬æ¢\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#string-%E4%B8%8E-str-%E7%9A%84%E8%BD%AC%E6%8D%A2\">String ä¸ &amp;str çš„è½¬æ¢</a></h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let s = String::from(&quot;hello,world!&quot;);</span><br><span class=\"line\">    say_hello(&amp;s);</span><br><span class=\"line\">    say_hello(&amp;s[..]);</span><br><span class=\"line\">    say_hello(s.as_str());</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">fn say_hello(s: &amp;str) &#123;</span><br><span class=\"line\">    println!(&quot;&#123;&#125;&quot;,s);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"å­—ç¬¦ä¸²ç´¢å¼•\"><a href=\"#å­—ç¬¦ä¸²ç´¢å¼•\" class=\"headerlink\" title=\"å­—ç¬¦ä¸²ç´¢å¼•\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B4%A2%E5%BC%95\">å­—ç¬¦ä¸²ç´¢å¼•</a></h2><h2 id=\"å­—ç¬¦ä¸²åˆ‡ç‰‡\"><a href=\"#å­—ç¬¦ä¸²åˆ‡ç‰‡\" class=\"headerlink\" title=\"å­—ç¬¦ä¸²åˆ‡ç‰‡\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%88%87%E7%89%87\">å­—ç¬¦ä¸²åˆ‡ç‰‡</a></h2><p>é€šè¿‡ç´¢å¼•åŒºé—´æ¥è®¿é—®å­—ç¬¦ä¸²æ—¶ï¼Œ<strong>éœ€è¦æ ¼å¤–çš„å°å¿ƒ</strong>ï¼Œä¸€ä¸æ³¨æ„ï¼Œå°±ä¼šå¯¼è‡´ä½ ç¨‹åºçš„å´©æºƒï¼</p>\n<h2 id=\"æ“ä½œå­—ç¬¦ä¸²\"><a href=\"#æ“ä½œå­—ç¬¦ä¸²\" class=\"headerlink\" title=\"æ“ä½œå­—ç¬¦ä¸²\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E6%93%8D%E4%BD%9C%E5%AD%97%E7%AC%A6%E4%B8%B2\">æ“ä½œå­—ç¬¦ä¸²</a></h2><h4 id=\"è¿½åŠ -Push\"><a href=\"#è¿½åŠ -Push\" class=\"headerlink\" title=\"è¿½åŠ  (Push)\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E8%BF%BD%E5%8A%A0-push\">è¿½åŠ  (Push)</a></h4><h4 id=\"æ’å…¥-Insert\"><a href=\"#æ’å…¥-Insert\" class=\"headerlink\" title=\"æ’å…¥ (Insert)\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E6%8F%92%E5%85%A5-insert\">æ’å…¥ (Insert)</a></h4><h4 id=\"æ›¿æ¢-Replace\"><a href=\"#æ›¿æ¢-Replace\" class=\"headerlink\" title=\"æ›¿æ¢ (Replace)\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E6%9B%BF%E6%8D%A2-replace\">æ›¿æ¢ (Replace)</a></h4><h4 id=\"åˆ é™¤-Delete\"><a href=\"#åˆ é™¤-Delete\" class=\"headerlink\" title=\"åˆ é™¤ (Delete)\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E5%88%A0%E9%99%A4-delete\">åˆ é™¤ (Delete)</a></h4><h4 id=\"è¿æ¥-Concatenate\"><a href=\"#è¿æ¥-Concatenate\" class=\"headerlink\" title=\"è¿æ¥ (Concatenate)\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E8%BF%9E%E6%8E%A5-concatenate\">è¿æ¥ (Concatenate)</a></h4><h2 id=\"å­—ç¬¦ä¸²è½¬ä¹‰\"><a href=\"#å­—ç¬¦ä¸²è½¬ä¹‰\" class=\"headerlink\" title=\"å­—ç¬¦ä¸²è½¬ä¹‰\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BD%AC%E4%B9%89\">å­—ç¬¦ä¸²è½¬ä¹‰</a></h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    println!(&quot;&#123;&#125;&quot;, &quot;hello \\\\x52\\\\x75\\\\x73\\\\x74&quot;);</span><br><span class=\"line\">    let raw_str = r&quot;Escapes don&#x27;t work here: \\x3F \\u&#123;211D&#125;&quot;;</span><br><span class=\"line\">    println!(&quot;&#123;&#125;&quot;, raw_str);</span><br><span class=\"line\"></span><br><span class=\"line\">    // å¦‚æœå­—ç¬¦ä¸²åŒ…å«åŒå¼•å·ï¼Œå¯ä»¥åœ¨å¼€å¤´å’Œç»“å°¾åŠ  #</span><br><span class=\"line\">    let quotes = r#&quot;And then I said: &quot;There is no escape!&quot;&quot;#;</span><br><span class=\"line\">    println!(&quot;&#123;&#125;&quot;, quotes);</span><br><span class=\"line\"></span><br><span class=\"line\">    // å¦‚æœè¿˜æ˜¯æœ‰æ­§ä¹‰ï¼Œå¯ä»¥ç»§ç»­å¢åŠ ï¼Œæ²¡æœ‰é™åˆ¶</span><br><span class=\"line\">    let longer_delimiter = r###&quot;A string with &quot;# in it. And even &quot;##!&quot;###;</span><br><span class=\"line\">    println!(&quot;&#123;&#125;&quot;, longer_delimiter);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"æ“ä½œ-UTF-8-å­—ç¬¦ä¸²\"><a href=\"#æ“ä½œ-UTF-8-å­—ç¬¦ä¸²\" class=\"headerlink\" title=\"æ“ä½œ UTF-8 å­—ç¬¦ä¸²\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E6%93%8D%E4%BD%9C-utf-8-%E5%AD%97%E7%AC%A6%E4%B8%B2\">æ“ä½œ UTF-8 å­—ç¬¦ä¸²</a></h2><p><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E8%AF%BE%E5%90%8E%E7%BB%83%E4%B9%A0\">å­—ç¬¦ä¸²ä¸åˆ‡ç‰‡ - Rustè¯­è¨€åœ£ç»(Rust Course)</a></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">for c in &quot;ä¸­å›½äºº&quot;.chars() &#123;</span><br><span class=\"line\">    println!(&quot;&#123;&#125;&quot;, c);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"è¯¾åç»ƒä¹ \"><a href=\"#è¯¾åç»ƒä¹ \" class=\"headerlink\" title=\"è¯¾åç»ƒä¹ \"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E8%AF%BE%E5%90%8E%E7%BB%83%E4%B9%A0\">è¯¾åç»ƒä¹ </a></h2><blockquote>\n<p>Rust By Practiceï¼Œæ”¯æŒä»£ç åœ¨çº¿ç¼–è¾‘å’Œè¿è¡Œï¼Œå¹¶æä¾›è¯¦ç»†çš„ä¹ é¢˜è§£ç­”ã€‚</p>\n<ul>\n<li><a href=\"https://zh.practice.rs/compound-types/string.html\">å­—ç¬¦ä¸²</a><ul>\n<li><a href=\"https://github.com/sunface/rust-by-practice/blob/master/solutions/compound-types/string.md\">ä¹ é¢˜è§£ç­”</a></li>\n</ul>\n</li>\n<li><a href=\"https://zh.practice.rs/compound-types/slice.html\">åˆ‡ç‰‡</a><ul>\n<li><a href=\"https://github.com/sunface/rust-by-practice/blob/master/solutions/compound-types/slice.md\">ä¹ é¢˜è§£ç­”</a></li>\n</ul>\n</li>\n<li><a href=\"https://zh.practice.rs/collections/String.html\">String</a><ul>\n<li><a href=\"https://github.com/sunface/rust-by-practice/blob/master/solutions/collections/String.md\">ä¹ é¢˜è§£ç­”</a></li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">// å¡«ç©ºå¹¶ä¿®å¤é”™è¯¯</span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let s = String::from(&quot;hello, ä¸–ç•Œ&quot;);</span><br><span class=\"line\">    let slice1 = &amp;s[0..1]; //æç¤º: `h` åœ¨ UTF-8 ç¼–ç ä¸­åªå ç”¨ 1 ä¸ªå­—èŠ‚</span><br><span class=\"line\">    assert_eq!(slice1, &quot;h&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">    let slice2 = &amp;s[7..10];// æç¤º: `ä¸–` åœ¨ UTF-8 ç¼–ç ä¸­å ç”¨ 3 ä¸ªå­—èŠ‚</span><br><span class=\"line\">    assert_eq!(slice2, &quot;ä¸–&quot;);</span><br><span class=\"line\">    </span><br><span class=\"line\">    // è¿­ä»£ s ä¸­çš„æ‰€æœ‰å­—ç¬¦</span><br><span class=\"line\">    for (i, c) in s.chars().enumerate() &#123;</span><br><span class=\"line\">        if i == 7 &#123;</span><br><span class=\"line\">            assert_eq!(c, &#x27;ä¸–&#x27;)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    println!(&quot;Success!&quot;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">// å¡«ç©º</span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let mut s = String::new();</span><br><span class=\"line\">     s.push_str(&quot;hello&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">    let v = vec![104, 101, 108, 108, 111];</span><br><span class=\"line\"></span><br><span class=\"line\">    // å°†å­—èŠ‚æ•°ç»„è½¬æ¢æˆ String</span><br><span class=\"line\">    let s1 = String::from_utf8(v).unwrap();</span><br><span class=\"line\">    </span><br><span class=\"line\">    </span><br><span class=\"line\">    assert_eq!(s, s1);</span><br><span class=\"line\"></span><br><span class=\"line\">    println!(&quot;Success!&quot;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">// å¡«ç©º</span><br><span class=\"line\">use std::mem;</span><br><span class=\"line\"></span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let story = String::from(&quot;Rust By Practice&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">    // é˜»æ­¢ String çš„æ•°æ®è¢«è‡ªåŠ¨ drop</span><br><span class=\"line\">    let mut story = mem::ManuallyDrop::new(story);</span><br><span class=\"line\"></span><br><span class=\"line\">    let ptr = story.as_mut_ptr();</span><br><span class=\"line\">    let len = story.len();</span><br><span class=\"line\">    let capacity = story.capacity();</span><br><span class=\"line\"></span><br><span class=\"line\">    assert_eq!(16, len);</span><br><span class=\"line\"></span><br><span class=\"line\">    // æˆ‘ä»¬å¯ä»¥åŸºäº ptr æŒ‡é’ˆã€é•¿åº¦å’Œå®¹é‡æ¥é‡æ–°æ„å»º String. </span><br><span class=\"line\">    // è¿™ç§æ“ä½œå¿…é¡»æ ‡è®°ä¸º unsafeï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦è‡ªå·±æ¥ç¡®ä¿è¿™é‡Œçš„æ“ä½œæ˜¯å®‰å…¨çš„</span><br><span class=\"line\">    let s = unsafe &#123; String::from_raw_parts(ptr, len, capacity) &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    assert_eq!(*story, s);</span><br><span class=\"line\"></span><br><span class=\"line\">    println!(&quot;Success!&quot;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"2-å…ƒç»„\"><a href=\"#2-å…ƒç»„\" class=\"headerlink\" title=\"2.å…ƒç»„\"></a>2.<a href=\"https://course.rs/basic/compound-type/tuple.html#%E5%85%83%E7%BB%84\">å…ƒç»„</a></h1><h1 id=\"3-å…ƒç»„\"><a href=\"#3-å…ƒç»„\" class=\"headerlink\" title=\"3. å…ƒç»„\"></a>3. å…ƒç»„</h1><h1 id=\"4-test\"><a href=\"#4-test\" class=\"headerlink\" title=\"4. test\"></a>4. test</h1><p>å¾…ç»­ã€‚ã€‚ã€‚</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"1-å­—ç¬¦ä¸²å’Œåˆ‡ç‰‡\"><a href=\"#1-å­—ç¬¦ä¸²å’Œåˆ‡ç‰‡\" class=\"headerlink\" title=\"1.å­—ç¬¦ä¸²å’Œåˆ‡ç‰‡\"></a>1.å­—ç¬¦ä¸²å’Œåˆ‡ç‰‡</h1><h2 id=\"ä»€ä¹ˆæ˜¯å­—ç¬¦ä¸²\"><a href=\"#ä»€ä¹ˆæ˜¯å­—ç¬¦ä¸²\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯å­—ç¬¦ä¸²?\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E4%BB%80%E4%B9%88%E6%98%AF%E5%AD%97%E7%AC%A6%E4%B8%B2\">ä»€ä¹ˆæ˜¯å­—ç¬¦ä¸²?</a></h2><p><strong>Rust ä¸­çš„å­—ç¬¦æ˜¯ Unicode ç±»å‹ï¼Œå› æ­¤æ¯ä¸ªå­—ç¬¦å æ® 4 ä¸ªå­—èŠ‚å†…å­˜ç©ºé—´ï¼Œä½†æ˜¯åœ¨å­—ç¬¦ä¸²ä¸­ä¸ä¸€æ ·ï¼Œå­—ç¬¦ä¸²æ˜¯ UTF-8 ç¼–ç ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦æ‰€å çš„å­—èŠ‚æ•°æ˜¯å˜åŒ–çš„(1 - 4)</strong></p>\n<p><code>str</code> ç±»å‹æ˜¯ç¡¬ç¼–ç è¿›å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¹Ÿæ— æ³•è¢«ä¿®æ”¹ï¼Œä½†æ˜¯ <code>String</code> åˆ™æ˜¯ä¸€ä¸ªå¯å¢é•¿ã€å¯æ”¹å˜ä¸”å…·æœ‰æ‰€æœ‰æƒçš„ UTF-8 ç¼–ç å­—ç¬¦ä¸²ï¼Œ<strong>å½“ Rust ç”¨æˆ·æåˆ°å­—ç¬¦ä¸²æ—¶ï¼Œå¾€å¾€æŒ‡çš„å°±æ˜¯ <code>String</code> ç±»å‹å’Œ <code>&amp;str</code> å­—ç¬¦ä¸²åˆ‡ç‰‡ç±»å‹ï¼Œè¿™ä¸¤ä¸ªç±»å‹éƒ½æ˜¯ UTF-8 ç¼–ç </strong>ã€‚</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">let a = [1, 2, 3, 4, 5];</span><br><span class=\"line\"></span><br><span class=\"line\">let slice = &amp;a[1..3];</span><br><span class=\"line\"></span><br><span class=\"line\">assert_eq!(slice, &amp;[2, 3]);</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"String-ä¸-str-çš„è½¬æ¢\"><a href=\"#String-ä¸-str-çš„è½¬æ¢\" class=\"headerlink\" title=\"String ä¸ &amp;str çš„è½¬æ¢\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#string-%E4%B8%8E-str-%E7%9A%84%E8%BD%AC%E6%8D%A2\">String ä¸ &amp;str çš„è½¬æ¢</a></h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let s = String::from(&quot;hello,world!&quot;);</span><br><span class=\"line\">    say_hello(&amp;s);</span><br><span class=\"line\">    say_hello(&amp;s[..]);</span><br><span class=\"line\">    say_hello(s.as_str());</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">fn say_hello(s: &amp;str) &#123;</span><br><span class=\"line\">    println!(&quot;&#123;&#125;&quot;,s);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"å­—ç¬¦ä¸²ç´¢å¼•\"><a href=\"#å­—ç¬¦ä¸²ç´¢å¼•\" class=\"headerlink\" title=\"å­—ç¬¦ä¸²ç´¢å¼•\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B4%A2%E5%BC%95\">å­—ç¬¦ä¸²ç´¢å¼•</a></h2><h2 id=\"å­—ç¬¦ä¸²åˆ‡ç‰‡\"><a href=\"#å­—ç¬¦ä¸²åˆ‡ç‰‡\" class=\"headerlink\" title=\"å­—ç¬¦ä¸²åˆ‡ç‰‡\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%88%87%E7%89%87\">å­—ç¬¦ä¸²åˆ‡ç‰‡</a></h2><p>é€šè¿‡ç´¢å¼•åŒºé—´æ¥è®¿é—®å­—ç¬¦ä¸²æ—¶ï¼Œ<strong>éœ€è¦æ ¼å¤–çš„å°å¿ƒ</strong>ï¼Œä¸€ä¸æ³¨æ„ï¼Œå°±ä¼šå¯¼è‡´ä½ ç¨‹åºçš„å´©æºƒï¼</p>\n<h2 id=\"æ“ä½œå­—ç¬¦ä¸²\"><a href=\"#æ“ä½œå­—ç¬¦ä¸²\" class=\"headerlink\" title=\"æ“ä½œå­—ç¬¦ä¸²\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E6%93%8D%E4%BD%9C%E5%AD%97%E7%AC%A6%E4%B8%B2\">æ“ä½œå­—ç¬¦ä¸²</a></h2><h4 id=\"è¿½åŠ -Push\"><a href=\"#è¿½åŠ -Push\" class=\"headerlink\" title=\"è¿½åŠ  (Push)\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E8%BF%BD%E5%8A%A0-push\">è¿½åŠ  (Push)</a></h4><h4 id=\"æ’å…¥-Insert\"><a href=\"#æ’å…¥-Insert\" class=\"headerlink\" title=\"æ’å…¥ (Insert)\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E6%8F%92%E5%85%A5-insert\">æ’å…¥ (Insert)</a></h4><h4 id=\"æ›¿æ¢-Replace\"><a href=\"#æ›¿æ¢-Replace\" class=\"headerlink\" title=\"æ›¿æ¢ (Replace)\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E6%9B%BF%E6%8D%A2-replace\">æ›¿æ¢ (Replace)</a></h4><h4 id=\"åˆ é™¤-Delete\"><a href=\"#åˆ é™¤-Delete\" class=\"headerlink\" title=\"åˆ é™¤ (Delete)\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E5%88%A0%E9%99%A4-delete\">åˆ é™¤ (Delete)</a></h4><h4 id=\"è¿æ¥-Concatenate\"><a href=\"#è¿æ¥-Concatenate\" class=\"headerlink\" title=\"è¿æ¥ (Concatenate)\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E8%BF%9E%E6%8E%A5-concatenate\">è¿æ¥ (Concatenate)</a></h4><h2 id=\"å­—ç¬¦ä¸²è½¬ä¹‰\"><a href=\"#å­—ç¬¦ä¸²è½¬ä¹‰\" class=\"headerlink\" title=\"å­—ç¬¦ä¸²è½¬ä¹‰\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BD%AC%E4%B9%89\">å­—ç¬¦ä¸²è½¬ä¹‰</a></h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    println!(&quot;&#123;&#125;&quot;, &quot;hello \\\\x52\\\\x75\\\\x73\\\\x74&quot;);</span><br><span class=\"line\">    let raw_str = r&quot;Escapes don&#x27;t work here: \\x3F \\u&#123;211D&#125;&quot;;</span><br><span class=\"line\">    println!(&quot;&#123;&#125;&quot;, raw_str);</span><br><span class=\"line\"></span><br><span class=\"line\">    // å¦‚æœå­—ç¬¦ä¸²åŒ…å«åŒå¼•å·ï¼Œå¯ä»¥åœ¨å¼€å¤´å’Œç»“å°¾åŠ  #</span><br><span class=\"line\">    let quotes = r#&quot;And then I said: &quot;There is no escape!&quot;&quot;#;</span><br><span class=\"line\">    println!(&quot;&#123;&#125;&quot;, quotes);</span><br><span class=\"line\"></span><br><span class=\"line\">    // å¦‚æœè¿˜æ˜¯æœ‰æ­§ä¹‰ï¼Œå¯ä»¥ç»§ç»­å¢åŠ ï¼Œæ²¡æœ‰é™åˆ¶</span><br><span class=\"line\">    let longer_delimiter = r###&quot;A string with &quot;# in it. And even &quot;##!&quot;###;</span><br><span class=\"line\">    println!(&quot;&#123;&#125;&quot;, longer_delimiter);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"æ“ä½œ-UTF-8-å­—ç¬¦ä¸²\"><a href=\"#æ“ä½œ-UTF-8-å­—ç¬¦ä¸²\" class=\"headerlink\" title=\"æ“ä½œ UTF-8 å­—ç¬¦ä¸²\"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E6%93%8D%E4%BD%9C-utf-8-%E5%AD%97%E7%AC%A6%E4%B8%B2\">æ“ä½œ UTF-8 å­—ç¬¦ä¸²</a></h2><p><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E8%AF%BE%E5%90%8E%E7%BB%83%E4%B9%A0\">å­—ç¬¦ä¸²ä¸åˆ‡ç‰‡ - Rustè¯­è¨€åœ£ç»(Rust Course)</a></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">for c in &quot;ä¸­å›½äºº&quot;.chars() &#123;</span><br><span class=\"line\">    println!(&quot;&#123;&#125;&quot;, c);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"è¯¾åç»ƒä¹ \"><a href=\"#è¯¾åç»ƒä¹ \" class=\"headerlink\" title=\"è¯¾åç»ƒä¹ \"></a><a href=\"https://course.rs/basic/compound-type/string-slice.html#%E8%AF%BE%E5%90%8E%E7%BB%83%E4%B9%A0\">è¯¾åç»ƒä¹ </a></h2><blockquote>\n<p>Rust By Practiceï¼Œæ”¯æŒä»£ç åœ¨çº¿ç¼–è¾‘å’Œè¿è¡Œï¼Œå¹¶æä¾›è¯¦ç»†çš„ä¹ é¢˜è§£ç­”ã€‚</p>\n<ul>\n<li><a href=\"https://zh.practice.rs/compound-types/string.html\">å­—ç¬¦ä¸²</a><ul>\n<li><a href=\"https://github.com/sunface/rust-by-practice/blob/master/solutions/compound-types/string.md\">ä¹ é¢˜è§£ç­”</a></li>\n</ul>\n</li>\n<li><a href=\"https://zh.practice.rs/compound-types/slice.html\">åˆ‡ç‰‡</a><ul>\n<li><a href=\"https://github.com/sunface/rust-by-practice/blob/master/solutions/compound-types/slice.md\">ä¹ é¢˜è§£ç­”</a></li>\n</ul>\n</li>\n<li><a href=\"https://zh.practice.rs/collections/String.html\">String</a><ul>\n<li><a href=\"https://github.com/sunface/rust-by-practice/blob/master/solutions/collections/String.md\">ä¹ é¢˜è§£ç­”</a></li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">// å¡«ç©ºå¹¶ä¿®å¤é”™è¯¯</span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let s = String::from(&quot;hello, ä¸–ç•Œ&quot;);</span><br><span class=\"line\">    let slice1 = &amp;s[0..1]; //æç¤º: `h` åœ¨ UTF-8 ç¼–ç ä¸­åªå ç”¨ 1 ä¸ªå­—èŠ‚</span><br><span class=\"line\">    assert_eq!(slice1, &quot;h&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">    let slice2 = &amp;s[7..10];// æç¤º: `ä¸–` åœ¨ UTF-8 ç¼–ç ä¸­å ç”¨ 3 ä¸ªå­—èŠ‚</span><br><span class=\"line\">    assert_eq!(slice2, &quot;ä¸–&quot;);</span><br><span class=\"line\">    </span><br><span class=\"line\">    // è¿­ä»£ s ä¸­çš„æ‰€æœ‰å­—ç¬¦</span><br><span class=\"line\">    for (i, c) in s.chars().enumerate() &#123;</span><br><span class=\"line\">        if i == 7 &#123;</span><br><span class=\"line\">            assert_eq!(c, &#x27;ä¸–&#x27;)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    println!(&quot;Success!&quot;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">// å¡«ç©º</span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let mut s = String::new();</span><br><span class=\"line\">     s.push_str(&quot;hello&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">    let v = vec![104, 101, 108, 108, 111];</span><br><span class=\"line\"></span><br><span class=\"line\">    // å°†å­—èŠ‚æ•°ç»„è½¬æ¢æˆ String</span><br><span class=\"line\">    let s1 = String::from_utf8(v).unwrap();</span><br><span class=\"line\">    </span><br><span class=\"line\">    </span><br><span class=\"line\">    assert_eq!(s, s1);</span><br><span class=\"line\"></span><br><span class=\"line\">    println!(&quot;Success!&quot;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">// å¡«ç©º</span><br><span class=\"line\">use std::mem;</span><br><span class=\"line\"></span><br><span class=\"line\">fn main() &#123;</span><br><span class=\"line\">    let story = String::from(&quot;Rust By Practice&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">    // é˜»æ­¢ String çš„æ•°æ®è¢«è‡ªåŠ¨ drop</span><br><span class=\"line\">    let mut story = mem::ManuallyDrop::new(story);</span><br><span class=\"line\"></span><br><span class=\"line\">    let ptr = story.as_mut_ptr();</span><br><span class=\"line\">    let len = story.len();</span><br><span class=\"line\">    let capacity = story.capacity();</span><br><span class=\"line\"></span><br><span class=\"line\">    assert_eq!(16, len);</span><br><span class=\"line\"></span><br><span class=\"line\">    // æˆ‘ä»¬å¯ä»¥åŸºäº ptr æŒ‡é’ˆã€é•¿åº¦å’Œå®¹é‡æ¥é‡æ–°æ„å»º String. </span><br><span class=\"line\">    // è¿™ç§æ“ä½œå¿…é¡»æ ‡è®°ä¸º unsafeï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦è‡ªå·±æ¥ç¡®ä¿è¿™é‡Œçš„æ“ä½œæ˜¯å®‰å…¨çš„</span><br><span class=\"line\">    let s = unsafe &#123; String::from_raw_parts(ptr, len, capacity) &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    assert_eq!(*story, s);</span><br><span class=\"line\"></span><br><span class=\"line\">    println!(&quot;Success!&quot;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"2-å…ƒç»„\"><a href=\"#2-å…ƒç»„\" class=\"headerlink\" title=\"2.å…ƒç»„\"></a>2.<a href=\"https://course.rs/basic/compound-type/tuple.html#%E5%85%83%E7%BB%84\">å…ƒç»„</a></h1><h1 id=\"3-å…ƒç»„\"><a href=\"#3-å…ƒç»„\" class=\"headerlink\" title=\"3. å…ƒç»„\"></a>3. å…ƒç»„</h1><h1 id=\"4-test\"><a href=\"#4-test\" class=\"headerlink\" title=\"4. test\"></a>4. test</h1><p>å¾…ç»­ã€‚ã€‚ã€‚</p>\n"},{"title":"OSTEP-40-VSFS","date":"2024-05-15T06:40:25.000Z","_content":"\nhttps://pages.cs.wisc.edu/~remzi/OSTEP/Chinese/40.pdf\n\nç£ç›˜ä¸Šçš„å“ªäº›ç»“æ„å­˜å‚¨æ–‡ä»¶ç³»ç»Ÿçš„æ•°æ®å’Œå…ƒæ•°æ®ï¼Ÿ\n\nå½“ä¸€ä¸ªè¿›ç¨‹æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ\n\nåœ¨è¯»å–æˆ–å†™å…¥æœŸé—´è®¿é—®å“ªäº›ç£ç›˜ç»“æ„ï¼Ÿ\n","source":"_posts/OSTEP-40-VSFS.md","raw":"---\ntitle: OSTEP-40-VSFS\ndate: 2024-05-15 14:40:25\ncategories:\n- OSTEP\ntags:\n- vsfs\n---\n\nhttps://pages.cs.wisc.edu/~remzi/OSTEP/Chinese/40.pdf\n\nç£ç›˜ä¸Šçš„å“ªäº›ç»“æ„å­˜å‚¨æ–‡ä»¶ç³»ç»Ÿçš„æ•°æ®å’Œå…ƒæ•°æ®ï¼Ÿ\n\nå½“ä¸€ä¸ªè¿›ç¨‹æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ\n\nåœ¨è¯»å–æˆ–å†™å…¥æœŸé—´è®¿é—®å“ªäº›ç£ç›˜ç»“æ„ï¼Ÿ\n","slug":"OSTEP-40-VSFS","published":1,"updated":"2024-05-15T06:52:52.721Z","_id":"clw7gjvto00004zw06cc94zms","comments":1,"layout":"post","photos":[],"link":"","content":"<p><a href=\"https://pages.cs.wisc.edu/~remzi/OSTEP/Chinese/40.pdf\">https://pages.cs.wisc.edu/~remzi/OSTEP/Chinese/40.pdf</a></p>\n<p>ç£ç›˜ä¸Šçš„å“ªäº›ç»“æ„å­˜å‚¨æ–‡ä»¶ç³»ç»Ÿçš„æ•°æ®å’Œå…ƒæ•°æ®ï¼Ÿ</p>\n<p>å½“ä¸€ä¸ªè¿›ç¨‹æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p>\n<p>åœ¨è¯»å–æˆ–å†™å…¥æœŸé—´è®¿é—®å“ªäº›ç£ç›˜ç»“æ„ï¼Ÿ</p>\n","site":{"data":{}},"excerpt":"","more":"<p><a href=\"https://pages.cs.wisc.edu/~remzi/OSTEP/Chinese/40.pdf\">https://pages.cs.wisc.edu/~remzi/OSTEP/Chinese/40.pdf</a></p>\n<p>ç£ç›˜ä¸Šçš„å“ªäº›ç»“æ„å­˜å‚¨æ–‡ä»¶ç³»ç»Ÿçš„æ•°æ®å’Œå…ƒæ•°æ®ï¼Ÿ</p>\n<p>å½“ä¸€ä¸ªè¿›ç¨‹æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p>\n<p>åœ¨è¯»å–æˆ–å†™å…¥æœŸé—´è®¿é—®å“ªäº›ç£ç›˜ç»“æ„ï¼Ÿ</p>\n"},{"title":"linux-block","date":"2024-05-15T06:36:36.000Z","_content":"\n# å—è®¾å¤‡é©±åŠ¨\n\n\n\nå—è®¾å¤‡çš„ä¸»è¦ç‰¹ç‚¹æ˜¯ï¼Œcpuå’Œæ€»çº¿è¯»å†™æ•°æ®æ‰€èŠ±æ—¶é—´ä¸ç¡¬ç›˜ç¡¬ä»¶çš„é€Ÿåº¦ä¸åŒ¹é…ã€‚\n","source":"_posts/linux-block.md","raw":"---\ntitle: linux-block\ndate: 2024-05-15 14:36:36\ncategories:\n- driver\ntags:\n- block\n\n---\n\n# å—è®¾å¤‡é©±åŠ¨\n\n\n\nå—è®¾å¤‡çš„ä¸»è¦ç‰¹ç‚¹æ˜¯ï¼Œcpuå’Œæ€»çº¿è¯»å†™æ•°æ®æ‰€èŠ±æ—¶é—´ä¸ç¡¬ç›˜ç¡¬ä»¶çš„é€Ÿåº¦ä¸åŒ¹é…ã€‚\n","slug":"linux-block","published":1,"updated":"2024-05-15T06:51:56.921Z","_id":"clw7gjvtr00014zw0fnm7f1ci","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"å—è®¾å¤‡é©±åŠ¨\"><a href=\"#å—è®¾å¤‡é©±åŠ¨\" class=\"headerlink\" title=\"å—è®¾å¤‡é©±åŠ¨\"></a>å—è®¾å¤‡é©±åŠ¨</h1><p>å—è®¾å¤‡çš„ä¸»è¦ç‰¹ç‚¹æ˜¯ï¼Œcpuå’Œæ€»çº¿è¯»å†™æ•°æ®æ‰€èŠ±æ—¶é—´ä¸ç¡¬ç›˜ç¡¬ä»¶çš„é€Ÿåº¦ä¸åŒ¹é…ã€‚</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"å—è®¾å¤‡é©±åŠ¨\"><a href=\"#å—è®¾å¤‡é©±åŠ¨\" class=\"headerlink\" title=\"å—è®¾å¤‡é©±åŠ¨\"></a>å—è®¾å¤‡é©±åŠ¨</h1><p>å—è®¾å¤‡çš„ä¸»è¦ç‰¹ç‚¹æ˜¯ï¼Œcpuå’Œæ€»çº¿è¯»å†™æ•°æ®æ‰€èŠ±æ—¶é—´ä¸ç¡¬ç›˜ç¡¬ä»¶çš„é€Ÿåº¦ä¸åŒ¹é…ã€‚</p>\n"},{"title":"U-Boot-fdt-GPT","date":"2024-05-15T06:37:05.000Z","_content":"\nU-Bootå®˜ç½‘:https://docs.u-boot.org/en/latest/\n\nu-bootå¯åŠ¨æµç¨‹\n\n- æ¿å­ä¸Šç”µä»¥åï¼Œé¦–å…ˆæ‰§è¡Œçš„æ˜¯ROMä¸­çš„ä¸€æ®µå¯åŠ¨ä»£ç ã€‚å¯åŠ¨ä»£ç **æ ¹æ®å¯„å­˜å™¨/å¤–éƒ¨ç®¡è„šé…ç½®**ï¼Œç¡®å®šæ˜¯è¿›å…¥ä¸‹è½½æ¨¡å¼ï¼Œè¿˜æ˜¯ä»æŸä»‹è´¨(Flash/EMMC/SDå¡ç­‰å­˜å‚¨è®¾å¤‡)å¯åŠ¨u-boot\n\n> ROMä¸­çš„ä»£ç æ˜¯å›ºåŒ–çš„ï¼Œæ— æ³•ä¿®æ”¹\n\n# ä¸€ã€ä»‹ç»\n\n> FDTï¼Œflatted device treeï¼Œæ‰å¹³è®¾å¤‡æ ‘ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯å°†éƒ¨åˆ†è®¾å¤‡ä¿¡æ¯ç»“æ„å­˜æ”¾åˆ°device treeæ–‡ä»¶ä¸­ã€‚\n>\n> ubootæœ€ç»ˆå°†å…¶ç¼–è¯‘æˆdtbæ–‡ä»¶ï¼Œä½¿ç”¨è¿‡ç¨‹ä¸­é€šè¿‡è§£æè¯¥dtbæ¥è·å–æ¿çº§è®¾å¤‡ä¿¡æ¯ã€‚  \n\n> U-bootçš„dtbå’Œkernelä¸­çš„dtbæ˜¯ä¸€è‡´çš„ï¼Œæœ‰å…³fdtçš„è¯¦ç»†ä»‹ç»ï¼Œå‚è€ƒdoc/README.fdt-control\n\n### dtbåœ¨U-bootä¸­çš„ä½ç½®\n\n- dtbèƒ½å¤Ÿä»¥ä¸¤ç§å½¢å¼ç¼–è¯‘åˆ°U-bootçš„é•œåƒä¸­\n\n1. dtbå’Œu-bootçš„binæ–‡ä»¶åˆ†ç¦»(imx6qä¸­ä½¿ç”¨çš„è¿™ç§æ–¹å¼ï¼Œåœ¨.configæ–‡ä»¶ä¸­å¯ä»¥æŸ¥çœ‹åˆ°)\n\n> é€šè¿‡CONFIG_OF_SEPARATEå®å®šä¹‰ä½¿èƒ½ï¼Œdtbæœ€åä¼šè¿½åŠ åˆ°u-bootçš„binæ–‡ä»¶çš„æœ€åé¢ï¼Œé€šè¿‡u-bootçš„ç»“æŸåœ°å€ç¬¦å·_endç¬¦å·æ¥è·å–dtbçš„åœ°å€\n\n1. dtbé›†æˆåˆ°u-bootçš„binæ–‡ä»¶å†…éƒ¨\n\n> é€šè¿‡CONFIG_OF_EMBEDå®å®šä¹‰ä½¿èƒ½ï¼Œdtbä¼šä½äºu-bootçš„.dtb.init.rodataæ®µä¸­ï¼Œé€šè¿‡__dtb_dt_beginç¬¦å·æ¥è·å–dtb\n\n1. è·å–dtsæ–‡ä»¶çš„åœ°å€gd->fdt_blob\n\n```\n// å®ç”¨æ¥è¡¨ç¤ºæ˜¯å¦æŠŠdtbæ–‡ä»¶æ”¾åœ¨uboot.binçš„æ–‡ä»¶ä¸­\nCONFIG_OF_EMBED\n\n// å•ç‹¬ç¼–è¯‘dtbæ–‡ä»¶\nCONFIG_OF_SEPARATEï¼Œç¼–è¯‘å‡ºæ¥çš„dtbæ”¾åœ¨uboot.binçš„æœ€åé¢ï¼Œå°±æ˜¯dtbè¿½åŠ åˆ°ubootçš„binæ–‡ä»¶åé¢æ—¶ï¼Œé€šè¿‡_endç¬¦å·æ¥è·å–dtbåœ°å€\n\ngd->fdt_blob = (ulong *)&_end;\n\n// å¯ä»¥é€šè¿‡fdtcontroladdrç¯å¢ƒå˜é‡æ¥æŒ‡å®šfdtçš„åœ°å€\ngd->fdt_blob = (void *)getenv_ulong(\"fdtcontroladdr\", 16,\n\t\t\t\t\t\t(uintptr_t)gd->fdt_blob); \n```\n\n###  dtbè§£ææ¥å£\n\n- å®šä¹‰åœ¨lib/fdtdec.cæ–‡ä»¶ä¸­ï¼ŒèŠ‚ç‚¹å˜é‡nodeä¸­å­˜æ”¾çš„æ˜¯åç§»åœ°å€\n\n```\n// è·å¾—dtbä¸‹æŸä¸ªèŠ‚ç‚¹çš„è·¯å¾„pathçš„åç§»ï¼Œåç§»å°±ä»£è¡¨è¿™ä¸ªèŠ‚ç‚¹\nint fdt_path_offset(const void *fdt, const char *path)\negï¼šnode = fdt_path_offset(gd->fdt_blob, â€œ/aliasesâ€);\n\n// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªå­—ç¬¦ä¸²å±æ€§å€¼\nconst void *fdt_getprop(const void *fdt, int nodeoffset, const char *name, int *lenp)\negï¼š mac = fdt_getprop(gd->fdt_blob, node, â€œmac-addressâ€, &len);\n\n// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ•´å½¢æ•°ç»„å±æ€§å€¼\nint fdtdec_get_int_array(const void *blob, int node, const char *prop_name, u32 *array, int count)\negï¼š ret = fdtdec_get_int_array(blob, node, â€œinterruptsâ€, cell, ARRAY_SIZE(cell));\n\n// è·å¾—èŠ‚ç‚¹nodeçš„åœ°å€å±æ€§å€¼\nfdt_addr_t fdtdec_get_addr(const void *blob, int node, const char *prop_name)\negï¼šfdtdec_get_addr(blob, node, â€œregâ€);\n\n// è·å¾—configèŠ‚ç‚¹ä¸‹çš„æ•´å½¢å±æ€§ã€boolå±æ€§ã€å­—ç¬¦ä¸²ç­‰ç­‰\nfdtdec_get_config_intã€fdtdec_get_config_boolã€fdtdec_get_config_string\n\n// è·å¾—chosenä¸‹çš„nameèŠ‚ç‚¹çš„åç§»\nint fdtdec_get_chosen_node(const void *blob, const char *name)\n\n// è·å¾—chosenä¸‹nameå±æ€§çš„å€¼\nconst char *fdtdec_get_chosen_prop(const void *blob, const char *name)\n```\n\n- å®šä¹‰åœ¨lib/fdtdec_common.cæ–‡ä»¶ä¸­\n\n```\n// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ•´å½¢å±æ€§å€¼\nint fdtdec_get_int(const void *blob, int node, const char *prop_name, int default_val)\negï¼š bus->udelay = fdtdec_get_int(blob, node, â€œi2c-gpio,delay-usâ€, DEFAULT_UDELAY);\n\n// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ— ç¬¦å·æ•´å½¢å±æ€§å€¼\nfdtdec_get_uint\n```\n\n## fdt å‘½ä»¤\n\nå¯¹äºu-bootæä¾›äº†fdtçš„ç›¸å…³å‘½ä»¤\n\n```\nfdt - flattened device tree utility commands\n\nUsage:\nfdt addr [-c]  <addr> [<length>]   - Set the [control] fdt location to <addr>\nfdt apply <addr>                    - Apply overlay to the DT\nfdt move   <fdt> <newaddr> <length> - Copy the fdt to <addr> and make it active\nfdt resize [<extrasize>]            - Resize fdt to size + padding to 4k addr + some optional <extrasize> if needed\nfdt print  <path> [<prop>]          - Recursive print starting at <path>\nfdt list   <path> [<prop>]          - Print one level starting at <path>\nfdt get value <var> <path> <prop>   - Get <property> and store in <var>\nfdt get name <var> <path> <index>   - Get name of node <index> and store in <var>\nfdt get addr <var> <path> <prop>    - Get start address of <property> and store in <var>\nfdt get size <var> <path> [<prop>]  - Get size of [<property>] or num nodes and store in <var>\nfdt set    <path> <prop> [<val>]    - Set <property> [to <val>]\nfdt mknode <path> <node>            - Create a new node after <path>\nfdt rm     <path> [<prop>]          - Delete the node or <property>\nfdt header                          - Display header info\nfdt bootcpu <id>                    - Set boot cpuid\nfdt memory <addr> <size>            - Add/Update memory node\nfdt rsvmem print                    - Show current mem reserves\nfdt rsvmem add <addr> <size>        - Add a mem reserve\nfdt rsvmem delete <index>           - Delete a mem reserves\nfdt chosen [<start> <end>]          - Add/update the /chosen branch in the tree\n                                        <start>/<end> - initrd start/end addr\nNOTE: Dereference aliases by omitting the leading '/', e.g. fdt print ethernet0.\n```\n\nfdt printåŠ pathå‚æ•°ï¼Œåˆ™æ‰“pathå†…å®¹ï¼Œå¦‚ä¸‹(å…¶ä¸­/memoryæ˜¯path)ï¼š\n\n```c\nU-Boot> fdt print /memory\nmemory {\ndevice_type = \"memory\";\nreg = <0x70000000 0x4000000>;\n};\n\nU-Boot> fdt print #ä¸åŠ å‚æ•°æ—¶ï¼Œæ‰“å°å‡ºæ•´é¢—æ ‘\n```\n\n\n\n# äºŒã€u-boot è·å–GPTåˆ†åŒºè¡¨\n\nåœ¨ubootä¸­é€šè¿‡å‘½ä»¤æ‰“å°åˆ†åŒºè¡¨\n\n```\npart list mmc 0\n```\n\n## 3588-android-uboot\n\n```c\n#include <common.h>\n#include <command.h>\n#include <android_image.h>\n#include <mmc.h>\n#include <stdlib.h>\n#include <memalign.h>\n#include <fdtdec.h>\n\n#define PART_MAX_COUNT  128\n#define\tLAB_SIZE\t\t512\n#define\tHEADER_OFFSET\tLAB_SIZE\n#define\tENTRY_OFFSET\t(2 * LAB_SIZE)\n#define\tVAL1_OFFSET\t\tsizeof(u64)\n#define\tVAL2_OFFSET\t\t(2 * sizeof(u64))\n\nstatic u64 get_gpt_blk_cnt_and_print(struct blk_desc *dev_desc,\n\t\t\t  gpt_header *gpt_head, gpt_entry **gpt_pte) {\n\tchar efi_str[PARTNAME_SZ + 1];\n\tu64 gpt_part_size, gpt_blk_cnt = 0;\n\tgpt_entry *gpt_e;\n\tint i;\n\n\tgpt_e = *gpt_pte;\n\tfor (i = 0; i < gpt_head->num_partition_entries; i++) {\n\n\t\traite_gpt_convert_efi_name_to_char(efi_str, gpt_e[i].partition_name,\n\t\t\t\t\t     PARTNAME_SZ + 1);\n\n\t\tprintf(\"%s: part: %2d name - GPT: %16s \",\n\t\t      __func__, i, efi_str);\n\t\tgpt_part_size = le64_to_cpu(gpt_e[i].ending_lba) -\n\t\t\tle64_to_cpu(gpt_e[i].starting_lba) + 1;\n\t\tgpt_blk_cnt += gpt_part_size;\n\t\t\n\t\tif(gpt_part_size == 1) \n\t\t\tbreak;\n\t\t\n\t\tprintf(\"size(LBA) - GPT: %8llu \",\n\t\t      (unsigned long long)gpt_part_size);\n\n\t\tprintf(\"start LBA - GPT: %8llu \\n\",\n\t\t      le64_to_cpu(gpt_e[i].starting_lba));\n\t}\n\n\treturn gpt_blk_cnt + gpt_e[0].starting_lba - 1;\n}\n\nstatic int get_gpt_meta_data(u64 *data_size, void **data)\n{\n    gpt_header *pgpt_head;\n\tgpt_entry *entries;\n\tvoid *meta_data;\n\tu64 meta_data_size, gpt_entries_size;\n\tstruct blk_desc *dev_desc = NULL;\n\tstruct mmc *mmc = NULL;\n\tu64 blk_size = 0;\n\tu64 blk_cnt = 0;\n\tu64 tag = 0x55AA;\n\tlbaint_t lba;\n    \n\tif (!data_size || !data) {\n\t\tprintf(\"%s *** ERROR: Invalid Argument(s) ***\\n\", __func__);\n\t\treturn -1;\n\t}\n    \n    mmc = do_returnmmc();\n\tif (!mmc)\n\t\treturn CMD_RET_FAILURE;\n    \n    dev_desc = mmc_get_blk_desc(mmc);\n\tif (!dev_desc) {\n\t\tprintf(\"%s *** ERROR: mmc_get_blk_desc err ***\\n\", __func__);\n\t\treturn -1;\n\t}\n\n\tgpt_entries_size = sizeof(gpt_entry) * PART_MAX_COUNT;\n\tmeta_data_size = LAB_SIZE + sizeof(gpt_header) + gpt_entries_size;\n\tmeta_data = malloc(meta_data_size);\n\tif(!meta_data) {\n\t\tprintf(\"%s *** ERROR: malloc memory (gpt meta data) ***\\n\", __func__);\n\t\treturn -1;\n\t}\n    \n    memset(meta_data, 0, meta_data_size);\n\tpgpt_head = (gpt_header *)((char *)meta_data + HEADER_OFFSET);\n\tentries = (gpt_entry *)((char *)meta_data + ENTRY_OFFSET);\n\tALLOC_CACHE_ALIGN_BUFFER(legacy_mbr, mbr, dev_desc->blksz);\n\n\t/* Read MBR Header from device */\n\tlba = 0; /* MBR is always at 0 */\n\tblk_cnt = 1; /* MBR (1 block) */\n\tif (blk_dread(dev_desc, lba, blk_cnt, (ulong *)mbr) != 1) {\n\t\tprintf(\"*** ERROR: Can't read MBR header ***\\n\");\n\t\tgoto ERROR_OUT;\n\t}\n\n\t/* Read GPT Header from device */\n\tlba = GPT_PRIMARY_PARTITION_TABLE_LBA;\n\tblk_cnt = 1; /* GPT Header (1 block) */\n\tif (blk_dread(dev_desc, lba, blk_cnt, pgpt_head) != 1) {\n    \tprintf(\"%s *** ERROR: Can't read GPT header ***\\n\", __func__);\n\t\tgoto ERROR_OUT;\n\t}\n\n\tlba = GPT_PRIMARY_PARTITION_TABLE_LBA;\n\tif (validate_gpt_header(pgpt_head, lba, dev_desc->lba)) {\n\t\tprintf(\"%s *** ERROR: validate_gpt_header GPT header ***\\n\", __func__);\n\t\tgoto ERROR_OUT;\n\t}\n\n\tif (dev_desc->sig_type == SIG_TYPE_NONE) {\n\t\tefi_guid_t empty = {};\n\t\tif (memcmp(&pgpt_head->disk_guid, &empty, sizeof(empty))) {\n\t\t\tdev_desc->sig_type = SIG_TYPE_GUID;\n\t\t\tmemcpy(&dev_desc->guid_sig, &pgpt_head->disk_guid,\n\t\t\t      sizeof(empty));\n\t\t} else if (mbr->unique_mbr_signature != 0) {\n\t\t\tdev_desc->sig_type = SIG_TYPE_MBR;\n\t\t\tdev_desc->mbr_sig = mbr->unique_mbr_signature;\n\t\t}\n\t}\n\n\t/* Read GPT Entries from device */\n\tlba = le64_to_cpu(pgpt_head->partition_entry_lba);\n\tblk_cnt = BLOCK_CNT((le32_to_cpu(pgpt_head->num_partition_entries) *\n\t\t\t\t   \tle32_to_cpu(pgpt_head->sizeof_partition_entry)),\n\t\t\t\t  \tdev_desc);\n\tif (blk_dread(dev_desc, lba, blk_cnt, entries) != blk_cnt) {\n\t\tprintf(\"%s *** ERROR:read entries (lba=%llu) ***\\n\",\n\t\t\t\t__func__, pgpt_head->partition_entry_lba);\n\t\tgoto ERROR_OUT;\n\t}\n\t\n\tblk_size = dev_desc->blksz;\n\tvalidate_gpt_entries(pgpt_head, entries);\n\t\n\tdebug(\"%s read entries lba %llu (blk_cnt %llu blk_size=%llu)\\n\",\n\t\t\t\t__func__, (unsigned long long)(ulong)lba, blk_cnt, blk_size);\n\t\n\tblk_cnt = get_gpt_blk_cnt(dev_desc, pgpt_head, &entries);\n    \n    /* \n\t * build info, layout of meta_data:\n\t * u64 tag | u64 blk_size | u64 blk_cnt | 488 bytes | gpt header | gpt entries\n\t */\n\tblk_cnt = get_gpt_blk_cnt(dev_desc, pgpt_head, &entries);\n\t/*this value makes we known the reserved memory is available*/\n\tmemcpy(meta_data, (void *)&tag, sizeof(u64));\n\tmemcpy(meta_data + VAL1_OFFSET, (void *)&blk_size, sizeof(u64));\n\tmemcpy(meta_data + VAL2_OFFSET, (void *)&blk_cnt, sizeof(u64));\n\n\t*data_size = meta_data_size;\n\t*data = meta_data;\n\n\treturn 0;\n\nERROR_OUT:\n\tfree(meta_data);\n\tmeta_data = NULL;\n\treturn -1;\n}\n```\n\n\n\nå‚è€ƒï¼š\n\n[Device Treeï¼ˆå››ï¼‰ï¼šæ–‡ä»¶ç»“æ„è§£æ (wowotech.net)](http://www.wowotech.net/device_model/dt-code-file-struct-parse.html)\n\n[Linuxè®¾å¤‡æ ‘è¯­æ³•åˆ†æè¯¦è§£æ•™ç¨‹(ä¸‰)u-bootè®¾å¤‡æ ‘çš„ä¼ é€’ - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/376295326)\n\n[Linuxè®¾å¤‡æ ‘è¯­æ³•åˆ†æè¯¦è§£æ•™ç¨‹(å››)kernelçš„è§£æ - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/376296222)\n\nhttps://www.cnblogs.com/solo666/p/16518154.html\n","source":"_posts/U-Boot-fdt-GPT.md","raw":"---\ntitle: U-Boot-fdt-GPT\ndate: 2024-05-15 14:37:05\ncategories:\n- uboot\ntags:\n- fdt\n- GPT\n- rk3588\n---\n\nU-Bootå®˜ç½‘:https://docs.u-boot.org/en/latest/\n\nu-bootå¯åŠ¨æµç¨‹\n\n- æ¿å­ä¸Šç”µä»¥åï¼Œé¦–å…ˆæ‰§è¡Œçš„æ˜¯ROMä¸­çš„ä¸€æ®µå¯åŠ¨ä»£ç ã€‚å¯åŠ¨ä»£ç **æ ¹æ®å¯„å­˜å™¨/å¤–éƒ¨ç®¡è„šé…ç½®**ï¼Œç¡®å®šæ˜¯è¿›å…¥ä¸‹è½½æ¨¡å¼ï¼Œè¿˜æ˜¯ä»æŸä»‹è´¨(Flash/EMMC/SDå¡ç­‰å­˜å‚¨è®¾å¤‡)å¯åŠ¨u-boot\n\n> ROMä¸­çš„ä»£ç æ˜¯å›ºåŒ–çš„ï¼Œæ— æ³•ä¿®æ”¹\n\n# ä¸€ã€ä»‹ç»\n\n> FDTï¼Œflatted device treeï¼Œæ‰å¹³è®¾å¤‡æ ‘ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯å°†éƒ¨åˆ†è®¾å¤‡ä¿¡æ¯ç»“æ„å­˜æ”¾åˆ°device treeæ–‡ä»¶ä¸­ã€‚\n>\n> ubootæœ€ç»ˆå°†å…¶ç¼–è¯‘æˆdtbæ–‡ä»¶ï¼Œä½¿ç”¨è¿‡ç¨‹ä¸­é€šè¿‡è§£æè¯¥dtbæ¥è·å–æ¿çº§è®¾å¤‡ä¿¡æ¯ã€‚  \n\n> U-bootçš„dtbå’Œkernelä¸­çš„dtbæ˜¯ä¸€è‡´çš„ï¼Œæœ‰å…³fdtçš„è¯¦ç»†ä»‹ç»ï¼Œå‚è€ƒdoc/README.fdt-control\n\n### dtbåœ¨U-bootä¸­çš„ä½ç½®\n\n- dtbèƒ½å¤Ÿä»¥ä¸¤ç§å½¢å¼ç¼–è¯‘åˆ°U-bootçš„é•œåƒä¸­\n\n1. dtbå’Œu-bootçš„binæ–‡ä»¶åˆ†ç¦»(imx6qä¸­ä½¿ç”¨çš„è¿™ç§æ–¹å¼ï¼Œåœ¨.configæ–‡ä»¶ä¸­å¯ä»¥æŸ¥çœ‹åˆ°)\n\n> é€šè¿‡CONFIG_OF_SEPARATEå®å®šä¹‰ä½¿èƒ½ï¼Œdtbæœ€åä¼šè¿½åŠ åˆ°u-bootçš„binæ–‡ä»¶çš„æœ€åé¢ï¼Œé€šè¿‡u-bootçš„ç»“æŸåœ°å€ç¬¦å·_endç¬¦å·æ¥è·å–dtbçš„åœ°å€\n\n1. dtbé›†æˆåˆ°u-bootçš„binæ–‡ä»¶å†…éƒ¨\n\n> é€šè¿‡CONFIG_OF_EMBEDå®å®šä¹‰ä½¿èƒ½ï¼Œdtbä¼šä½äºu-bootçš„.dtb.init.rodataæ®µä¸­ï¼Œé€šè¿‡__dtb_dt_beginç¬¦å·æ¥è·å–dtb\n\n1. è·å–dtsæ–‡ä»¶çš„åœ°å€gd->fdt_blob\n\n```\n// å®ç”¨æ¥è¡¨ç¤ºæ˜¯å¦æŠŠdtbæ–‡ä»¶æ”¾åœ¨uboot.binçš„æ–‡ä»¶ä¸­\nCONFIG_OF_EMBED\n\n// å•ç‹¬ç¼–è¯‘dtbæ–‡ä»¶\nCONFIG_OF_SEPARATEï¼Œç¼–è¯‘å‡ºæ¥çš„dtbæ”¾åœ¨uboot.binçš„æœ€åé¢ï¼Œå°±æ˜¯dtbè¿½åŠ åˆ°ubootçš„binæ–‡ä»¶åé¢æ—¶ï¼Œé€šè¿‡_endç¬¦å·æ¥è·å–dtbåœ°å€\n\ngd->fdt_blob = (ulong *)&_end;\n\n// å¯ä»¥é€šè¿‡fdtcontroladdrç¯å¢ƒå˜é‡æ¥æŒ‡å®šfdtçš„åœ°å€\ngd->fdt_blob = (void *)getenv_ulong(\"fdtcontroladdr\", 16,\n\t\t\t\t\t\t(uintptr_t)gd->fdt_blob); \n```\n\n###  dtbè§£ææ¥å£\n\n- å®šä¹‰åœ¨lib/fdtdec.cæ–‡ä»¶ä¸­ï¼ŒèŠ‚ç‚¹å˜é‡nodeä¸­å­˜æ”¾çš„æ˜¯åç§»åœ°å€\n\n```\n// è·å¾—dtbä¸‹æŸä¸ªèŠ‚ç‚¹çš„è·¯å¾„pathçš„åç§»ï¼Œåç§»å°±ä»£è¡¨è¿™ä¸ªèŠ‚ç‚¹\nint fdt_path_offset(const void *fdt, const char *path)\negï¼šnode = fdt_path_offset(gd->fdt_blob, â€œ/aliasesâ€);\n\n// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªå­—ç¬¦ä¸²å±æ€§å€¼\nconst void *fdt_getprop(const void *fdt, int nodeoffset, const char *name, int *lenp)\negï¼š mac = fdt_getprop(gd->fdt_blob, node, â€œmac-addressâ€, &len);\n\n// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ•´å½¢æ•°ç»„å±æ€§å€¼\nint fdtdec_get_int_array(const void *blob, int node, const char *prop_name, u32 *array, int count)\negï¼š ret = fdtdec_get_int_array(blob, node, â€œinterruptsâ€, cell, ARRAY_SIZE(cell));\n\n// è·å¾—èŠ‚ç‚¹nodeçš„åœ°å€å±æ€§å€¼\nfdt_addr_t fdtdec_get_addr(const void *blob, int node, const char *prop_name)\negï¼šfdtdec_get_addr(blob, node, â€œregâ€);\n\n// è·å¾—configèŠ‚ç‚¹ä¸‹çš„æ•´å½¢å±æ€§ã€boolå±æ€§ã€å­—ç¬¦ä¸²ç­‰ç­‰\nfdtdec_get_config_intã€fdtdec_get_config_boolã€fdtdec_get_config_string\n\n// è·å¾—chosenä¸‹çš„nameèŠ‚ç‚¹çš„åç§»\nint fdtdec_get_chosen_node(const void *blob, const char *name)\n\n// è·å¾—chosenä¸‹nameå±æ€§çš„å€¼\nconst char *fdtdec_get_chosen_prop(const void *blob, const char *name)\n```\n\n- å®šä¹‰åœ¨lib/fdtdec_common.cæ–‡ä»¶ä¸­\n\n```\n// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ•´å½¢å±æ€§å€¼\nint fdtdec_get_int(const void *blob, int node, const char *prop_name, int default_val)\negï¼š bus->udelay = fdtdec_get_int(blob, node, â€œi2c-gpio,delay-usâ€, DEFAULT_UDELAY);\n\n// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ— ç¬¦å·æ•´å½¢å±æ€§å€¼\nfdtdec_get_uint\n```\n\n## fdt å‘½ä»¤\n\nå¯¹äºu-bootæä¾›äº†fdtçš„ç›¸å…³å‘½ä»¤\n\n```\nfdt - flattened device tree utility commands\n\nUsage:\nfdt addr [-c]  <addr> [<length>]   - Set the [control] fdt location to <addr>\nfdt apply <addr>                    - Apply overlay to the DT\nfdt move   <fdt> <newaddr> <length> - Copy the fdt to <addr> and make it active\nfdt resize [<extrasize>]            - Resize fdt to size + padding to 4k addr + some optional <extrasize> if needed\nfdt print  <path> [<prop>]          - Recursive print starting at <path>\nfdt list   <path> [<prop>]          - Print one level starting at <path>\nfdt get value <var> <path> <prop>   - Get <property> and store in <var>\nfdt get name <var> <path> <index>   - Get name of node <index> and store in <var>\nfdt get addr <var> <path> <prop>    - Get start address of <property> and store in <var>\nfdt get size <var> <path> [<prop>]  - Get size of [<property>] or num nodes and store in <var>\nfdt set    <path> <prop> [<val>]    - Set <property> [to <val>]\nfdt mknode <path> <node>            - Create a new node after <path>\nfdt rm     <path> [<prop>]          - Delete the node or <property>\nfdt header                          - Display header info\nfdt bootcpu <id>                    - Set boot cpuid\nfdt memory <addr> <size>            - Add/Update memory node\nfdt rsvmem print                    - Show current mem reserves\nfdt rsvmem add <addr> <size>        - Add a mem reserve\nfdt rsvmem delete <index>           - Delete a mem reserves\nfdt chosen [<start> <end>]          - Add/update the /chosen branch in the tree\n                                        <start>/<end> - initrd start/end addr\nNOTE: Dereference aliases by omitting the leading '/', e.g. fdt print ethernet0.\n```\n\nfdt printåŠ pathå‚æ•°ï¼Œåˆ™æ‰“pathå†…å®¹ï¼Œå¦‚ä¸‹(å…¶ä¸­/memoryæ˜¯path)ï¼š\n\n```c\nU-Boot> fdt print /memory\nmemory {\ndevice_type = \"memory\";\nreg = <0x70000000 0x4000000>;\n};\n\nU-Boot> fdt print #ä¸åŠ å‚æ•°æ—¶ï¼Œæ‰“å°å‡ºæ•´é¢—æ ‘\n```\n\n\n\n# äºŒã€u-boot è·å–GPTåˆ†åŒºè¡¨\n\nåœ¨ubootä¸­é€šè¿‡å‘½ä»¤æ‰“å°åˆ†åŒºè¡¨\n\n```\npart list mmc 0\n```\n\n## 3588-android-uboot\n\n```c\n#include <common.h>\n#include <command.h>\n#include <android_image.h>\n#include <mmc.h>\n#include <stdlib.h>\n#include <memalign.h>\n#include <fdtdec.h>\n\n#define PART_MAX_COUNT  128\n#define\tLAB_SIZE\t\t512\n#define\tHEADER_OFFSET\tLAB_SIZE\n#define\tENTRY_OFFSET\t(2 * LAB_SIZE)\n#define\tVAL1_OFFSET\t\tsizeof(u64)\n#define\tVAL2_OFFSET\t\t(2 * sizeof(u64))\n\nstatic u64 get_gpt_blk_cnt_and_print(struct blk_desc *dev_desc,\n\t\t\t  gpt_header *gpt_head, gpt_entry **gpt_pte) {\n\tchar efi_str[PARTNAME_SZ + 1];\n\tu64 gpt_part_size, gpt_blk_cnt = 0;\n\tgpt_entry *gpt_e;\n\tint i;\n\n\tgpt_e = *gpt_pte;\n\tfor (i = 0; i < gpt_head->num_partition_entries; i++) {\n\n\t\traite_gpt_convert_efi_name_to_char(efi_str, gpt_e[i].partition_name,\n\t\t\t\t\t     PARTNAME_SZ + 1);\n\n\t\tprintf(\"%s: part: %2d name - GPT: %16s \",\n\t\t      __func__, i, efi_str);\n\t\tgpt_part_size = le64_to_cpu(gpt_e[i].ending_lba) -\n\t\t\tle64_to_cpu(gpt_e[i].starting_lba) + 1;\n\t\tgpt_blk_cnt += gpt_part_size;\n\t\t\n\t\tif(gpt_part_size == 1) \n\t\t\tbreak;\n\t\t\n\t\tprintf(\"size(LBA) - GPT: %8llu \",\n\t\t      (unsigned long long)gpt_part_size);\n\n\t\tprintf(\"start LBA - GPT: %8llu \\n\",\n\t\t      le64_to_cpu(gpt_e[i].starting_lba));\n\t}\n\n\treturn gpt_blk_cnt + gpt_e[0].starting_lba - 1;\n}\n\nstatic int get_gpt_meta_data(u64 *data_size, void **data)\n{\n    gpt_header *pgpt_head;\n\tgpt_entry *entries;\n\tvoid *meta_data;\n\tu64 meta_data_size, gpt_entries_size;\n\tstruct blk_desc *dev_desc = NULL;\n\tstruct mmc *mmc = NULL;\n\tu64 blk_size = 0;\n\tu64 blk_cnt = 0;\n\tu64 tag = 0x55AA;\n\tlbaint_t lba;\n    \n\tif (!data_size || !data) {\n\t\tprintf(\"%s *** ERROR: Invalid Argument(s) ***\\n\", __func__);\n\t\treturn -1;\n\t}\n    \n    mmc = do_returnmmc();\n\tif (!mmc)\n\t\treturn CMD_RET_FAILURE;\n    \n    dev_desc = mmc_get_blk_desc(mmc);\n\tif (!dev_desc) {\n\t\tprintf(\"%s *** ERROR: mmc_get_blk_desc err ***\\n\", __func__);\n\t\treturn -1;\n\t}\n\n\tgpt_entries_size = sizeof(gpt_entry) * PART_MAX_COUNT;\n\tmeta_data_size = LAB_SIZE + sizeof(gpt_header) + gpt_entries_size;\n\tmeta_data = malloc(meta_data_size);\n\tif(!meta_data) {\n\t\tprintf(\"%s *** ERROR: malloc memory (gpt meta data) ***\\n\", __func__);\n\t\treturn -1;\n\t}\n    \n    memset(meta_data, 0, meta_data_size);\n\tpgpt_head = (gpt_header *)((char *)meta_data + HEADER_OFFSET);\n\tentries = (gpt_entry *)((char *)meta_data + ENTRY_OFFSET);\n\tALLOC_CACHE_ALIGN_BUFFER(legacy_mbr, mbr, dev_desc->blksz);\n\n\t/* Read MBR Header from device */\n\tlba = 0; /* MBR is always at 0 */\n\tblk_cnt = 1; /* MBR (1 block) */\n\tif (blk_dread(dev_desc, lba, blk_cnt, (ulong *)mbr) != 1) {\n\t\tprintf(\"*** ERROR: Can't read MBR header ***\\n\");\n\t\tgoto ERROR_OUT;\n\t}\n\n\t/* Read GPT Header from device */\n\tlba = GPT_PRIMARY_PARTITION_TABLE_LBA;\n\tblk_cnt = 1; /* GPT Header (1 block) */\n\tif (blk_dread(dev_desc, lba, blk_cnt, pgpt_head) != 1) {\n    \tprintf(\"%s *** ERROR: Can't read GPT header ***\\n\", __func__);\n\t\tgoto ERROR_OUT;\n\t}\n\n\tlba = GPT_PRIMARY_PARTITION_TABLE_LBA;\n\tif (validate_gpt_header(pgpt_head, lba, dev_desc->lba)) {\n\t\tprintf(\"%s *** ERROR: validate_gpt_header GPT header ***\\n\", __func__);\n\t\tgoto ERROR_OUT;\n\t}\n\n\tif (dev_desc->sig_type == SIG_TYPE_NONE) {\n\t\tefi_guid_t empty = {};\n\t\tif (memcmp(&pgpt_head->disk_guid, &empty, sizeof(empty))) {\n\t\t\tdev_desc->sig_type = SIG_TYPE_GUID;\n\t\t\tmemcpy(&dev_desc->guid_sig, &pgpt_head->disk_guid,\n\t\t\t      sizeof(empty));\n\t\t} else if (mbr->unique_mbr_signature != 0) {\n\t\t\tdev_desc->sig_type = SIG_TYPE_MBR;\n\t\t\tdev_desc->mbr_sig = mbr->unique_mbr_signature;\n\t\t}\n\t}\n\n\t/* Read GPT Entries from device */\n\tlba = le64_to_cpu(pgpt_head->partition_entry_lba);\n\tblk_cnt = BLOCK_CNT((le32_to_cpu(pgpt_head->num_partition_entries) *\n\t\t\t\t   \tle32_to_cpu(pgpt_head->sizeof_partition_entry)),\n\t\t\t\t  \tdev_desc);\n\tif (blk_dread(dev_desc, lba, blk_cnt, entries) != blk_cnt) {\n\t\tprintf(\"%s *** ERROR:read entries (lba=%llu) ***\\n\",\n\t\t\t\t__func__, pgpt_head->partition_entry_lba);\n\t\tgoto ERROR_OUT;\n\t}\n\t\n\tblk_size = dev_desc->blksz;\n\tvalidate_gpt_entries(pgpt_head, entries);\n\t\n\tdebug(\"%s read entries lba %llu (blk_cnt %llu blk_size=%llu)\\n\",\n\t\t\t\t__func__, (unsigned long long)(ulong)lba, blk_cnt, blk_size);\n\t\n\tblk_cnt = get_gpt_blk_cnt(dev_desc, pgpt_head, &entries);\n    \n    /* \n\t * build info, layout of meta_data:\n\t * u64 tag | u64 blk_size | u64 blk_cnt | 488 bytes | gpt header | gpt entries\n\t */\n\tblk_cnt = get_gpt_blk_cnt(dev_desc, pgpt_head, &entries);\n\t/*this value makes we known the reserved memory is available*/\n\tmemcpy(meta_data, (void *)&tag, sizeof(u64));\n\tmemcpy(meta_data + VAL1_OFFSET, (void *)&blk_size, sizeof(u64));\n\tmemcpy(meta_data + VAL2_OFFSET, (void *)&blk_cnt, sizeof(u64));\n\n\t*data_size = meta_data_size;\n\t*data = meta_data;\n\n\treturn 0;\n\nERROR_OUT:\n\tfree(meta_data);\n\tmeta_data = NULL;\n\treturn -1;\n}\n```\n\n\n\nå‚è€ƒï¼š\n\n[Device Treeï¼ˆå››ï¼‰ï¼šæ–‡ä»¶ç»“æ„è§£æ (wowotech.net)](http://www.wowotech.net/device_model/dt-code-file-struct-parse.html)\n\n[Linuxè®¾å¤‡æ ‘è¯­æ³•åˆ†æè¯¦è§£æ•™ç¨‹(ä¸‰)u-bootè®¾å¤‡æ ‘çš„ä¼ é€’ - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/376295326)\n\n[Linuxè®¾å¤‡æ ‘è¯­æ³•åˆ†æè¯¦è§£æ•™ç¨‹(å››)kernelçš„è§£æ - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/376296222)\n\nhttps://www.cnblogs.com/solo666/p/16518154.html\n","slug":"U-Boot-fdt-GPT","published":1,"updated":"2024-05-15T06:50:22.548Z","_id":"clw7gjvtv00044zw001hi1y1n","comments":1,"layout":"post","photos":[],"link":"","content":"<p>U-Bootå®˜ç½‘:<a href=\"https://docs.u-boot.org/en/latest/\">https://docs.u-boot.org/en/latest/</a></p>\n<p>u-bootå¯åŠ¨æµç¨‹</p>\n<ul>\n<li>æ¿å­ä¸Šç”µä»¥åï¼Œé¦–å…ˆæ‰§è¡Œçš„æ˜¯ROMä¸­çš„ä¸€æ®µå¯åŠ¨ä»£ç ã€‚å¯åŠ¨ä»£ç <strong>æ ¹æ®å¯„å­˜å™¨&#x2F;å¤–éƒ¨ç®¡è„šé…ç½®</strong>ï¼Œç¡®å®šæ˜¯è¿›å…¥ä¸‹è½½æ¨¡å¼ï¼Œè¿˜æ˜¯ä»æŸä»‹è´¨(Flash&#x2F;EMMC&#x2F;SDå¡ç­‰å­˜å‚¨è®¾å¤‡)å¯åŠ¨u-boot</li>\n</ul>\n<blockquote>\n<p>ROMä¸­çš„ä»£ç æ˜¯å›ºåŒ–çš„ï¼Œæ— æ³•ä¿®æ”¹</p>\n</blockquote>\n<h1 id=\"ä¸€ã€ä»‹ç»\"><a href=\"#ä¸€ã€ä»‹ç»\" class=\"headerlink\" title=\"ä¸€ã€ä»‹ç»\"></a>ä¸€ã€ä»‹ç»</h1><blockquote>\n<p>FDTï¼Œflatted device treeï¼Œæ‰å¹³è®¾å¤‡æ ‘ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯å°†éƒ¨åˆ†è®¾å¤‡ä¿¡æ¯ç»“æ„å­˜æ”¾åˆ°device treeæ–‡ä»¶ä¸­ã€‚</p>\n<p>ubootæœ€ç»ˆå°†å…¶ç¼–è¯‘æˆdtbæ–‡ä»¶ï¼Œä½¿ç”¨è¿‡ç¨‹ä¸­é€šè¿‡è§£æè¯¥dtbæ¥è·å–æ¿çº§è®¾å¤‡ä¿¡æ¯ã€‚  </p>\n</blockquote>\n<blockquote>\n<p>U-bootçš„dtbå’Œkernelä¸­çš„dtbæ˜¯ä¸€è‡´çš„ï¼Œæœ‰å…³fdtçš„è¯¦ç»†ä»‹ç»ï¼Œå‚è€ƒdoc&#x2F;README.fdt-control</p>\n</blockquote>\n<h3 id=\"dtbåœ¨U-bootä¸­çš„ä½ç½®\"><a href=\"#dtbåœ¨U-bootä¸­çš„ä½ç½®\" class=\"headerlink\" title=\"dtbåœ¨U-bootä¸­çš„ä½ç½®\"></a>dtbåœ¨U-bootä¸­çš„ä½ç½®</h3><ul>\n<li>dtbèƒ½å¤Ÿä»¥ä¸¤ç§å½¢å¼ç¼–è¯‘åˆ°U-bootçš„é•œåƒä¸­</li>\n</ul>\n<ol>\n<li>dtbå’Œu-bootçš„binæ–‡ä»¶åˆ†ç¦»(imx6qä¸­ä½¿ç”¨çš„è¿™ç§æ–¹å¼ï¼Œåœ¨.configæ–‡ä»¶ä¸­å¯ä»¥æŸ¥çœ‹åˆ°)</li>\n</ol>\n<blockquote>\n<p>é€šè¿‡CONFIG_OF_SEPARATEå®å®šä¹‰ä½¿èƒ½ï¼Œdtbæœ€åä¼šè¿½åŠ åˆ°u-bootçš„binæ–‡ä»¶çš„æœ€åé¢ï¼Œé€šè¿‡u-bootçš„ç»“æŸåœ°å€ç¬¦å·_endç¬¦å·æ¥è·å–dtbçš„åœ°å€</p>\n</blockquote>\n<ol>\n<li>dtbé›†æˆåˆ°u-bootçš„binæ–‡ä»¶å†…éƒ¨</li>\n</ol>\n<blockquote>\n<p>é€šè¿‡CONFIG_OF_EMBEDå®å®šä¹‰ä½¿èƒ½ï¼Œdtbä¼šä½äºu-bootçš„.dtb.init.rodataæ®µä¸­ï¼Œé€šè¿‡__dtb_dt_beginç¬¦å·æ¥è·å–dtb</p>\n</blockquote>\n<ol>\n<li>è·å–dtsæ–‡ä»¶çš„åœ°å€gd-&gt;fdt_blob</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// å®ç”¨æ¥è¡¨ç¤ºæ˜¯å¦æŠŠdtbæ–‡ä»¶æ”¾åœ¨uboot.binçš„æ–‡ä»¶ä¸­</span><br><span class=\"line\">CONFIG_OF_EMBED</span><br><span class=\"line\"></span><br><span class=\"line\">// å•ç‹¬ç¼–è¯‘dtbæ–‡ä»¶</span><br><span class=\"line\">CONFIG_OF_SEPARATEï¼Œç¼–è¯‘å‡ºæ¥çš„dtbæ”¾åœ¨uboot.binçš„æœ€åé¢ï¼Œå°±æ˜¯dtbè¿½åŠ åˆ°ubootçš„binæ–‡ä»¶åé¢æ—¶ï¼Œé€šè¿‡_endç¬¦å·æ¥è·å–dtbåœ°å€</span><br><span class=\"line\"></span><br><span class=\"line\">gd-&gt;fdt_blob = (ulong *)&amp;_end;</span><br><span class=\"line\"></span><br><span class=\"line\">// å¯ä»¥é€šè¿‡fdtcontroladdrç¯å¢ƒå˜é‡æ¥æŒ‡å®šfdtçš„åœ°å€</span><br><span class=\"line\">gd-&gt;fdt_blob = (void *)getenv_ulong(&quot;fdtcontroladdr&quot;, 16,</span><br><span class=\"line\">\t\t\t\t\t\t(uintptr_t)gd-&gt;fdt_blob); </span><br></pre></td></tr></table></figure>\n\n<h3 id=\"dtbè§£ææ¥å£\"><a href=\"#dtbè§£ææ¥å£\" class=\"headerlink\" title=\"dtbè§£ææ¥å£\"></a>dtbè§£ææ¥å£</h3><ul>\n<li>å®šä¹‰åœ¨lib&#x2F;fdtdec.cæ–‡ä»¶ä¸­ï¼ŒèŠ‚ç‚¹å˜é‡nodeä¸­å­˜æ”¾çš„æ˜¯åç§»åœ°å€</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// è·å¾—dtbä¸‹æŸä¸ªèŠ‚ç‚¹çš„è·¯å¾„pathçš„åç§»ï¼Œåç§»å°±ä»£è¡¨è¿™ä¸ªèŠ‚ç‚¹</span><br><span class=\"line\">int fdt_path_offset(const void *fdt, const char *path)</span><br><span class=\"line\">egï¼šnode = fdt_path_offset(gd-&gt;fdt_blob, â€œ/aliasesâ€);</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªå­—ç¬¦ä¸²å±æ€§å€¼</span><br><span class=\"line\">const void *fdt_getprop(const void *fdt, int nodeoffset, const char *name, int *lenp)</span><br><span class=\"line\">egï¼š mac = fdt_getprop(gd-&gt;fdt_blob, node, â€œmac-addressâ€, &amp;len);</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ•´å½¢æ•°ç»„å±æ€§å€¼</span><br><span class=\"line\">int fdtdec_get_int_array(const void *blob, int node, const char *prop_name, u32 *array, int count)</span><br><span class=\"line\">egï¼š ret = fdtdec_get_int_array(blob, node, â€œinterruptsâ€, cell, ARRAY_SIZE(cell));</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—èŠ‚ç‚¹nodeçš„åœ°å€å±æ€§å€¼</span><br><span class=\"line\">fdt_addr_t fdtdec_get_addr(const void *blob, int node, const char *prop_name)</span><br><span class=\"line\">egï¼šfdtdec_get_addr(blob, node, â€œregâ€);</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—configèŠ‚ç‚¹ä¸‹çš„æ•´å½¢å±æ€§ã€boolå±æ€§ã€å­—ç¬¦ä¸²ç­‰ç­‰</span><br><span class=\"line\">fdtdec_get_config_intã€fdtdec_get_config_boolã€fdtdec_get_config_string</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—chosenä¸‹çš„nameèŠ‚ç‚¹çš„åç§»</span><br><span class=\"line\">int fdtdec_get_chosen_node(const void *blob, const char *name)</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—chosenä¸‹nameå±æ€§çš„å€¼</span><br><span class=\"line\">const char *fdtdec_get_chosen_prop(const void *blob, const char *name)</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>å®šä¹‰åœ¨lib&#x2F;fdtdec_common.cæ–‡ä»¶ä¸­</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ•´å½¢å±æ€§å€¼</span><br><span class=\"line\">int fdtdec_get_int(const void *blob, int node, const char *prop_name, int default_val)</span><br><span class=\"line\">egï¼š bus-&gt;udelay = fdtdec_get_int(blob, node, â€œi2c-gpio,delay-usâ€, DEFAULT_UDELAY);</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ— ç¬¦å·æ•´å½¢å±æ€§å€¼</span><br><span class=\"line\">fdtdec_get_uint</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"fdt-å‘½ä»¤\"><a href=\"#fdt-å‘½ä»¤\" class=\"headerlink\" title=\"fdt å‘½ä»¤\"></a>fdt å‘½ä»¤</h2><p>å¯¹äºu-bootæä¾›äº†fdtçš„ç›¸å…³å‘½ä»¤</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fdt - flattened device tree utility commands</span><br><span class=\"line\"></span><br><span class=\"line\">Usage:</span><br><span class=\"line\">fdt addr [-c]  &lt;addr&gt; [&lt;length&gt;]   - Set the [control] fdt location to &lt;addr&gt;</span><br><span class=\"line\">fdt apply &lt;addr&gt;                    - Apply overlay to the DT</span><br><span class=\"line\">fdt move   &lt;fdt&gt; &lt;newaddr&gt; &lt;length&gt; - Copy the fdt to &lt;addr&gt; and make it active</span><br><span class=\"line\">fdt resize [&lt;extrasize&gt;]            - Resize fdt to size + padding to 4k addr + some optional &lt;extrasize&gt; if needed</span><br><span class=\"line\">fdt print  &lt;path&gt; [&lt;prop&gt;]          - Recursive print starting at &lt;path&gt;</span><br><span class=\"line\">fdt list   &lt;path&gt; [&lt;prop&gt;]          - Print one level starting at &lt;path&gt;</span><br><span class=\"line\">fdt get value &lt;var&gt; &lt;path&gt; &lt;prop&gt;   - Get &lt;property&gt; and store in &lt;var&gt;</span><br><span class=\"line\">fdt get name &lt;var&gt; &lt;path&gt; &lt;index&gt;   - Get name of node &lt;index&gt; and store in &lt;var&gt;</span><br><span class=\"line\">fdt get addr &lt;var&gt; &lt;path&gt; &lt;prop&gt;    - Get start address of &lt;property&gt; and store in &lt;var&gt;</span><br><span class=\"line\">fdt get size &lt;var&gt; &lt;path&gt; [&lt;prop&gt;]  - Get size of [&lt;property&gt;] or num nodes and store in &lt;var&gt;</span><br><span class=\"line\">fdt set    &lt;path&gt; &lt;prop&gt; [&lt;val&gt;]    - Set &lt;property&gt; [to &lt;val&gt;]</span><br><span class=\"line\">fdt mknode &lt;path&gt; &lt;node&gt;            - Create a new node after &lt;path&gt;</span><br><span class=\"line\">fdt rm     &lt;path&gt; [&lt;prop&gt;]          - Delete the node or &lt;property&gt;</span><br><span class=\"line\">fdt header                          - Display header info</span><br><span class=\"line\">fdt bootcpu &lt;id&gt;                    - Set boot cpuid</span><br><span class=\"line\">fdt memory &lt;addr&gt; &lt;size&gt;            - Add/Update memory node</span><br><span class=\"line\">fdt rsvmem print                    - Show current mem reserves</span><br><span class=\"line\">fdt rsvmem add &lt;addr&gt; &lt;size&gt;        - Add a mem reserve</span><br><span class=\"line\">fdt rsvmem delete &lt;index&gt;           - Delete a mem reserves</span><br><span class=\"line\">fdt chosen [&lt;start&gt; &lt;end&gt;]          - Add/update the /chosen branch in the tree</span><br><span class=\"line\">                                        &lt;start&gt;/&lt;end&gt; - initrd start/end addr</span><br><span class=\"line\">NOTE: Dereference aliases by omitting the leading &#x27;/&#x27;, e.g. fdt print ethernet0.</span><br></pre></td></tr></table></figure>\n\n<p>fdt printåŠ pathå‚æ•°ï¼Œåˆ™æ‰“pathå†…å®¹ï¼Œå¦‚ä¸‹(å…¶ä¸­&#x2F;memoryæ˜¯path)ï¼š</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">U-Boot&gt; fdt print /memory</span><br><span class=\"line\">memory &#123;</span><br><span class=\"line\">device_type = <span class=\"string\">&quot;memory&quot;</span>;</span><br><span class=\"line\">reg = &lt;<span class=\"number\">0x70000000</span> <span class=\"number\">0x4000000</span>&gt;;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">U-Boot&gt; fdt print #ä¸åŠ å‚æ•°æ—¶ï¼Œæ‰“å°å‡ºæ•´é¢—æ ‘</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"äºŒã€u-boot-è·å–GPTåˆ†åŒºè¡¨\"><a href=\"#äºŒã€u-boot-è·å–GPTåˆ†åŒºè¡¨\" class=\"headerlink\" title=\"äºŒã€u-boot è·å–GPTåˆ†åŒºè¡¨\"></a>äºŒã€u-boot è·å–GPTåˆ†åŒºè¡¨</h1><p>åœ¨ubootä¸­é€šè¿‡å‘½ä»¤æ‰“å°åˆ†åŒºè¡¨</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">part list mmc 0</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3588-android-uboot\"><a href=\"#3588-android-uboot\" class=\"headerlink\" title=\"3588-android-uboot\"></a>3588-android-uboot</h2><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;common.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;command.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;android_image.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;mmc.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;memalign.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;fdtdec.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> PART_MAX_COUNT  128</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span>\tLAB_SIZE\t\t512</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span>\tHEADER_OFFSET\tLAB_SIZE</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span>\tENTRY_OFFSET\t(2 * LAB_SIZE)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span>\tVAL1_OFFSET\t\tsizeof(u64)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span>\tVAL2_OFFSET\t\t(2 * sizeof(u64))</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">static</span> u64 <span class=\"title function_\">get_gpt_blk_cnt_and_print</span><span class=\"params\">(<span class=\"keyword\">struct</span> blk_desc *dev_desc,</span></span><br><span class=\"line\"><span class=\"params\">\t\t\t  gpt_header *gpt_head, gpt_entry **gpt_pte)</span> &#123;</span><br><span class=\"line\">\t<span class=\"type\">char</span> efi_str[PARTNAME_SZ + <span class=\"number\">1</span>];</span><br><span class=\"line\">\tu64 gpt_part_size, gpt_blk_cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\">\tgpt_entry *gpt_e;</span><br><span class=\"line\">\t<span class=\"type\">int</span> i;</span><br><span class=\"line\"></span><br><span class=\"line\">\tgpt_e = *gpt_pte;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (i = <span class=\"number\">0</span>; i &lt; gpt_head-&gt;num_partition_entries; i++) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\traite_gpt_convert_efi_name_to_char(efi_str, gpt_e[i].partition_name,</span><br><span class=\"line\">\t\t\t\t\t     PARTNAME_SZ + <span class=\"number\">1</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s: part: %2d name - GPT: %16s &quot;</span>,</span><br><span class=\"line\">\t\t      __func__, i, efi_str);</span><br><span class=\"line\">\t\tgpt_part_size = le64_to_cpu(gpt_e[i].ending_lba) -</span><br><span class=\"line\">\t\t\tle64_to_cpu(gpt_e[i].starting_lba) + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\tgpt_blk_cnt += gpt_part_size;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(gpt_part_size == <span class=\"number\">1</span>) </span><br><span class=\"line\">\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;size(LBA) - GPT: %8llu &quot;</span>,</span><br><span class=\"line\">\t\t      (<span class=\"type\">unsigned</span> <span class=\"type\">long</span> <span class=\"type\">long</span>)gpt_part_size);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;start LBA - GPT: %8llu \\n&quot;</span>,</span><br><span class=\"line\">\t\t      le64_to_cpu(gpt_e[i].starting_lba));</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> gpt_blk_cnt + gpt_e[<span class=\"number\">0</span>].starting_lba - <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">static</span> <span class=\"type\">int</span> <span class=\"title function_\">get_gpt_meta_data</span><span class=\"params\">(u64 *data_size, <span class=\"type\">void</span> **data)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    gpt_header *pgpt_head;</span><br><span class=\"line\">\tgpt_entry *entries;</span><br><span class=\"line\">\t<span class=\"type\">void</span> *meta_data;</span><br><span class=\"line\">\tu64 meta_data_size, gpt_entries_size;</span><br><span class=\"line\">\t<span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">blk_desc</span> *<span class=\"title\">dev_desc</span> =</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">\t<span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">mmc</span> *<span class=\"title\">mmc</span> =</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">\tu64 blk_size = <span class=\"number\">0</span>;</span><br><span class=\"line\">\tu64 blk_cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\">\tu64 tag = <span class=\"number\">0x55AA</span>;</span><br><span class=\"line\">\t<span class=\"type\">lbaint_t</span> lba;</span><br><span class=\"line\">    </span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (!data_size || !data) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR: Invalid Argument(s) ***\\n&quot;</span>, __func__);</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    mmc = do_returnmmc();</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (!mmc)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> CMD_RET_FAILURE;</span><br><span class=\"line\">    </span><br><span class=\"line\">    dev_desc = mmc_get_blk_desc(mmc);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (!dev_desc) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR: mmc_get_blk_desc err ***\\n&quot;</span>, __func__);</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tgpt_entries_size = <span class=\"keyword\">sizeof</span>(gpt_entry) * PART_MAX_COUNT;</span><br><span class=\"line\">\tmeta_data_size = LAB_SIZE + <span class=\"keyword\">sizeof</span>(gpt_header) + gpt_entries_size;</span><br><span class=\"line\">\tmeta_data = <span class=\"built_in\">malloc</span>(meta_data_size);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(!meta_data) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR: malloc memory (gpt meta data) ***\\n&quot;</span>, __func__);</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"built_in\">memset</span>(meta_data, <span class=\"number\">0</span>, meta_data_size);</span><br><span class=\"line\">\tpgpt_head = (gpt_header *)((<span class=\"type\">char</span> *)meta_data + HEADER_OFFSET);</span><br><span class=\"line\">\tentries = (gpt_entry *)((<span class=\"type\">char</span> *)meta_data + ENTRY_OFFSET);</span><br><span class=\"line\">\tALLOC_CACHE_ALIGN_BUFFER(legacy_mbr, mbr, dev_desc-&gt;blksz);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/* Read MBR Header from device */</span></span><br><span class=\"line\">\tlba = <span class=\"number\">0</span>; <span class=\"comment\">/* MBR is always at 0 */</span></span><br><span class=\"line\">\tblk_cnt = <span class=\"number\">1</span>; <span class=\"comment\">/* MBR (1 block) */</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (blk_dread(dev_desc, lba, blk_cnt, (ulong *)mbr) != <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;*** ERROR: Can&#x27;t read MBR header ***\\n&quot;</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">goto</span> ERROR_OUT;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/* Read GPT Header from device */</span></span><br><span class=\"line\">\tlba = GPT_PRIMARY_PARTITION_TABLE_LBA;</span><br><span class=\"line\">\tblk_cnt = <span class=\"number\">1</span>; <span class=\"comment\">/* GPT Header (1 block) */</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (blk_dread(dev_desc, lba, blk_cnt, pgpt_head) != <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">    \t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR: Can&#x27;t read GPT header ***\\n&quot;</span>, __func__);</span><br><span class=\"line\">\t\t<span class=\"keyword\">goto</span> ERROR_OUT;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tlba = GPT_PRIMARY_PARTITION_TABLE_LBA;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (validate_gpt_header(pgpt_head, lba, dev_desc-&gt;lba)) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR: validate_gpt_header GPT header ***\\n&quot;</span>, __func__);</span><br><span class=\"line\">\t\t<span class=\"keyword\">goto</span> ERROR_OUT;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (dev_desc-&gt;sig_type == SIG_TYPE_NONE) &#123;</span><br><span class=\"line\">\t\t<span class=\"type\">efi_guid_t</span> empty = &#123;&#125;;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (<span class=\"built_in\">memcmp</span>(&amp;pgpt_head-&gt;disk_guid, &amp;empty, <span class=\"keyword\">sizeof</span>(empty))) &#123;</span><br><span class=\"line\">\t\t\tdev_desc-&gt;sig_type = SIG_TYPE_GUID;</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">memcpy</span>(&amp;dev_desc-&gt;guid_sig, &amp;pgpt_head-&gt;disk_guid,</span><br><span class=\"line\">\t\t\t      <span class=\"keyword\">sizeof</span>(empty));</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (mbr-&gt;unique_mbr_signature != <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">\t\t\tdev_desc-&gt;sig_type = SIG_TYPE_MBR;</span><br><span class=\"line\">\t\t\tdev_desc-&gt;mbr_sig = mbr-&gt;unique_mbr_signature;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/* Read GPT Entries from device */</span></span><br><span class=\"line\">\tlba = le64_to_cpu(pgpt_head-&gt;partition_entry_lba);</span><br><span class=\"line\">\tblk_cnt = BLOCK_CNT((le32_to_cpu(pgpt_head-&gt;num_partition_entries) *</span><br><span class=\"line\">\t\t\t\t   \tle32_to_cpu(pgpt_head-&gt;sizeof_partition_entry)),</span><br><span class=\"line\">\t\t\t\t  \tdev_desc);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (blk_dread(dev_desc, lba, blk_cnt, entries) != blk_cnt) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR:read entries (lba=%llu) ***\\n&quot;</span>,</span><br><span class=\"line\">\t\t\t\t__func__, pgpt_head-&gt;partition_entry_lba);</span><br><span class=\"line\">\t\t<span class=\"keyword\">goto</span> ERROR_OUT;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tblk_size = dev_desc-&gt;blksz;</span><br><span class=\"line\">\tvalidate_gpt_entries(pgpt_head, entries);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tdebug(<span class=\"string\">&quot;%s read entries lba %llu (blk_cnt %llu blk_size=%llu)\\n&quot;</span>,</span><br><span class=\"line\">\t\t\t\t__func__, (<span class=\"type\">unsigned</span> <span class=\"type\">long</span> <span class=\"type\">long</span>)(ulong)lba, blk_cnt, blk_size);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tblk_cnt = get_gpt_blk_cnt(dev_desc, pgpt_head, &amp;entries);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/* </span></span><br><span class=\"line\"><span class=\"comment\">\t * build info, layout of meta_data:</span></span><br><span class=\"line\"><span class=\"comment\">\t * u64 tag | u64 blk_size | u64 blk_cnt | 488 bytes | gpt header | gpt entries</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\tblk_cnt = get_gpt_blk_cnt(dev_desc, pgpt_head, &amp;entries);</span><br><span class=\"line\">\t<span class=\"comment\">/*this value makes we known the reserved memory is available*/</span></span><br><span class=\"line\">\t<span class=\"built_in\">memcpy</span>(meta_data, (<span class=\"type\">void</span> *)&amp;tag, <span class=\"keyword\">sizeof</span>(u64));</span><br><span class=\"line\">\t<span class=\"built_in\">memcpy</span>(meta_data + VAL1_OFFSET, (<span class=\"type\">void</span> *)&amp;blk_size, <span class=\"keyword\">sizeof</span>(u64));</span><br><span class=\"line\">\t<span class=\"built_in\">memcpy</span>(meta_data + VAL2_OFFSET, (<span class=\"type\">void</span> *)&amp;blk_cnt, <span class=\"keyword\">sizeof</span>(u64));</span><br><span class=\"line\"></span><br><span class=\"line\">\t*data_size = meta_data_size;</span><br><span class=\"line\">\t*data = meta_data;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">ERROR_OUT:</span><br><span class=\"line\">\t<span class=\"built_in\">free</span>(meta_data);</span><br><span class=\"line\">\tmeta_data = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<p>å‚è€ƒï¼š</p>\n<p><a href=\"http://www.wowotech.net/device_model/dt-code-file-struct-parse.html\">Device Treeï¼ˆå››ï¼‰ï¼šæ–‡ä»¶ç»“æ„è§£æ (wowotech.net)</a></p>\n<p><a href=\"https://zhuanlan.zhihu.com/p/376295326\">Linuxè®¾å¤‡æ ‘è¯­æ³•åˆ†æè¯¦è§£æ•™ç¨‹(ä¸‰)u-bootè®¾å¤‡æ ‘çš„ä¼ é€’ - çŸ¥ä¹ (zhihu.com)</a></p>\n<p><a href=\"https://zhuanlan.zhihu.com/p/376296222\">Linuxè®¾å¤‡æ ‘è¯­æ³•åˆ†æè¯¦è§£æ•™ç¨‹(å››)kernelçš„è§£æ - çŸ¥ä¹ (zhihu.com)</a></p>\n<p><a href=\"https://www.cnblogs.com/solo666/p/16518154.html\">https://www.cnblogs.com/solo666/p/16518154.html</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p>U-Bootå®˜ç½‘:<a href=\"https://docs.u-boot.org/en/latest/\">https://docs.u-boot.org/en/latest/</a></p>\n<p>u-bootå¯åŠ¨æµç¨‹</p>\n<ul>\n<li>æ¿å­ä¸Šç”µä»¥åï¼Œé¦–å…ˆæ‰§è¡Œçš„æ˜¯ROMä¸­çš„ä¸€æ®µå¯åŠ¨ä»£ç ã€‚å¯åŠ¨ä»£ç <strong>æ ¹æ®å¯„å­˜å™¨&#x2F;å¤–éƒ¨ç®¡è„šé…ç½®</strong>ï¼Œç¡®å®šæ˜¯è¿›å…¥ä¸‹è½½æ¨¡å¼ï¼Œè¿˜æ˜¯ä»æŸä»‹è´¨(Flash&#x2F;EMMC&#x2F;SDå¡ç­‰å­˜å‚¨è®¾å¤‡)å¯åŠ¨u-boot</li>\n</ul>\n<blockquote>\n<p>ROMä¸­çš„ä»£ç æ˜¯å›ºåŒ–çš„ï¼Œæ— æ³•ä¿®æ”¹</p>\n</blockquote>\n<h1 id=\"ä¸€ã€ä»‹ç»\"><a href=\"#ä¸€ã€ä»‹ç»\" class=\"headerlink\" title=\"ä¸€ã€ä»‹ç»\"></a>ä¸€ã€ä»‹ç»</h1><blockquote>\n<p>FDTï¼Œflatted device treeï¼Œæ‰å¹³è®¾å¤‡æ ‘ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯å°†éƒ¨åˆ†è®¾å¤‡ä¿¡æ¯ç»“æ„å­˜æ”¾åˆ°device treeæ–‡ä»¶ä¸­ã€‚</p>\n<p>ubootæœ€ç»ˆå°†å…¶ç¼–è¯‘æˆdtbæ–‡ä»¶ï¼Œä½¿ç”¨è¿‡ç¨‹ä¸­é€šè¿‡è§£æè¯¥dtbæ¥è·å–æ¿çº§è®¾å¤‡ä¿¡æ¯ã€‚  </p>\n</blockquote>\n<blockquote>\n<p>U-bootçš„dtbå’Œkernelä¸­çš„dtbæ˜¯ä¸€è‡´çš„ï¼Œæœ‰å…³fdtçš„è¯¦ç»†ä»‹ç»ï¼Œå‚è€ƒdoc&#x2F;README.fdt-control</p>\n</blockquote>\n<h3 id=\"dtbåœ¨U-bootä¸­çš„ä½ç½®\"><a href=\"#dtbåœ¨U-bootä¸­çš„ä½ç½®\" class=\"headerlink\" title=\"dtbåœ¨U-bootä¸­çš„ä½ç½®\"></a>dtbåœ¨U-bootä¸­çš„ä½ç½®</h3><ul>\n<li>dtbèƒ½å¤Ÿä»¥ä¸¤ç§å½¢å¼ç¼–è¯‘åˆ°U-bootçš„é•œåƒä¸­</li>\n</ul>\n<ol>\n<li>dtbå’Œu-bootçš„binæ–‡ä»¶åˆ†ç¦»(imx6qä¸­ä½¿ç”¨çš„è¿™ç§æ–¹å¼ï¼Œåœ¨.configæ–‡ä»¶ä¸­å¯ä»¥æŸ¥çœ‹åˆ°)</li>\n</ol>\n<blockquote>\n<p>é€šè¿‡CONFIG_OF_SEPARATEå®å®šä¹‰ä½¿èƒ½ï¼Œdtbæœ€åä¼šè¿½åŠ åˆ°u-bootçš„binæ–‡ä»¶çš„æœ€åé¢ï¼Œé€šè¿‡u-bootçš„ç»“æŸåœ°å€ç¬¦å·_endç¬¦å·æ¥è·å–dtbçš„åœ°å€</p>\n</blockquote>\n<ol>\n<li>dtbé›†æˆåˆ°u-bootçš„binæ–‡ä»¶å†…éƒ¨</li>\n</ol>\n<blockquote>\n<p>é€šè¿‡CONFIG_OF_EMBEDå®å®šä¹‰ä½¿èƒ½ï¼Œdtbä¼šä½äºu-bootçš„.dtb.init.rodataæ®µä¸­ï¼Œé€šè¿‡__dtb_dt_beginç¬¦å·æ¥è·å–dtb</p>\n</blockquote>\n<ol>\n<li>è·å–dtsæ–‡ä»¶çš„åœ°å€gd-&gt;fdt_blob</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// å®ç”¨æ¥è¡¨ç¤ºæ˜¯å¦æŠŠdtbæ–‡ä»¶æ”¾åœ¨uboot.binçš„æ–‡ä»¶ä¸­</span><br><span class=\"line\">CONFIG_OF_EMBED</span><br><span class=\"line\"></span><br><span class=\"line\">// å•ç‹¬ç¼–è¯‘dtbæ–‡ä»¶</span><br><span class=\"line\">CONFIG_OF_SEPARATEï¼Œç¼–è¯‘å‡ºæ¥çš„dtbæ”¾åœ¨uboot.binçš„æœ€åé¢ï¼Œå°±æ˜¯dtbè¿½åŠ åˆ°ubootçš„binæ–‡ä»¶åé¢æ—¶ï¼Œé€šè¿‡_endç¬¦å·æ¥è·å–dtbåœ°å€</span><br><span class=\"line\"></span><br><span class=\"line\">gd-&gt;fdt_blob = (ulong *)&amp;_end;</span><br><span class=\"line\"></span><br><span class=\"line\">// å¯ä»¥é€šè¿‡fdtcontroladdrç¯å¢ƒå˜é‡æ¥æŒ‡å®šfdtçš„åœ°å€</span><br><span class=\"line\">gd-&gt;fdt_blob = (void *)getenv_ulong(&quot;fdtcontroladdr&quot;, 16,</span><br><span class=\"line\">\t\t\t\t\t\t(uintptr_t)gd-&gt;fdt_blob); </span><br></pre></td></tr></table></figure>\n\n<h3 id=\"dtbè§£ææ¥å£\"><a href=\"#dtbè§£ææ¥å£\" class=\"headerlink\" title=\"dtbè§£ææ¥å£\"></a>dtbè§£ææ¥å£</h3><ul>\n<li>å®šä¹‰åœ¨lib&#x2F;fdtdec.cæ–‡ä»¶ä¸­ï¼ŒèŠ‚ç‚¹å˜é‡nodeä¸­å­˜æ”¾çš„æ˜¯åç§»åœ°å€</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// è·å¾—dtbä¸‹æŸä¸ªèŠ‚ç‚¹çš„è·¯å¾„pathçš„åç§»ï¼Œåç§»å°±ä»£è¡¨è¿™ä¸ªèŠ‚ç‚¹</span><br><span class=\"line\">int fdt_path_offset(const void *fdt, const char *path)</span><br><span class=\"line\">egï¼šnode = fdt_path_offset(gd-&gt;fdt_blob, â€œ/aliasesâ€);</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªå­—ç¬¦ä¸²å±æ€§å€¼</span><br><span class=\"line\">const void *fdt_getprop(const void *fdt, int nodeoffset, const char *name, int *lenp)</span><br><span class=\"line\">egï¼š mac = fdt_getprop(gd-&gt;fdt_blob, node, â€œmac-addressâ€, &amp;len);</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ•´å½¢æ•°ç»„å±æ€§å€¼</span><br><span class=\"line\">int fdtdec_get_int_array(const void *blob, int node, const char *prop_name, u32 *array, int count)</span><br><span class=\"line\">egï¼š ret = fdtdec_get_int_array(blob, node, â€œinterruptsâ€, cell, ARRAY_SIZE(cell));</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—èŠ‚ç‚¹nodeçš„åœ°å€å±æ€§å€¼</span><br><span class=\"line\">fdt_addr_t fdtdec_get_addr(const void *blob, int node, const char *prop_name)</span><br><span class=\"line\">egï¼šfdtdec_get_addr(blob, node, â€œregâ€);</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—configèŠ‚ç‚¹ä¸‹çš„æ•´å½¢å±æ€§ã€boolå±æ€§ã€å­—ç¬¦ä¸²ç­‰ç­‰</span><br><span class=\"line\">fdtdec_get_config_intã€fdtdec_get_config_boolã€fdtdec_get_config_string</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—chosenä¸‹çš„nameèŠ‚ç‚¹çš„åç§»</span><br><span class=\"line\">int fdtdec_get_chosen_node(const void *blob, const char *name)</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—chosenä¸‹nameå±æ€§çš„å€¼</span><br><span class=\"line\">const char *fdtdec_get_chosen_prop(const void *blob, const char *name)</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>å®šä¹‰åœ¨lib&#x2F;fdtdec_common.cæ–‡ä»¶ä¸­</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ•´å½¢å±æ€§å€¼</span><br><span class=\"line\">int fdtdec_get_int(const void *blob, int node, const char *prop_name, int default_val)</span><br><span class=\"line\">egï¼š bus-&gt;udelay = fdtdec_get_int(blob, node, â€œi2c-gpio,delay-usâ€, DEFAULT_UDELAY);</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å¾—èŠ‚ç‚¹nodeçš„æŸä¸ªæ— ç¬¦å·æ•´å½¢å±æ€§å€¼</span><br><span class=\"line\">fdtdec_get_uint</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"fdt-å‘½ä»¤\"><a href=\"#fdt-å‘½ä»¤\" class=\"headerlink\" title=\"fdt å‘½ä»¤\"></a>fdt å‘½ä»¤</h2><p>å¯¹äºu-bootæä¾›äº†fdtçš„ç›¸å…³å‘½ä»¤</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fdt - flattened device tree utility commands</span><br><span class=\"line\"></span><br><span class=\"line\">Usage:</span><br><span class=\"line\">fdt addr [-c]  &lt;addr&gt; [&lt;length&gt;]   - Set the [control] fdt location to &lt;addr&gt;</span><br><span class=\"line\">fdt apply &lt;addr&gt;                    - Apply overlay to the DT</span><br><span class=\"line\">fdt move   &lt;fdt&gt; &lt;newaddr&gt; &lt;length&gt; - Copy the fdt to &lt;addr&gt; and make it active</span><br><span class=\"line\">fdt resize [&lt;extrasize&gt;]            - Resize fdt to size + padding to 4k addr + some optional &lt;extrasize&gt; if needed</span><br><span class=\"line\">fdt print  &lt;path&gt; [&lt;prop&gt;]          - Recursive print starting at &lt;path&gt;</span><br><span class=\"line\">fdt list   &lt;path&gt; [&lt;prop&gt;]          - Print one level starting at &lt;path&gt;</span><br><span class=\"line\">fdt get value &lt;var&gt; &lt;path&gt; &lt;prop&gt;   - Get &lt;property&gt; and store in &lt;var&gt;</span><br><span class=\"line\">fdt get name &lt;var&gt; &lt;path&gt; &lt;index&gt;   - Get name of node &lt;index&gt; and store in &lt;var&gt;</span><br><span class=\"line\">fdt get addr &lt;var&gt; &lt;path&gt; &lt;prop&gt;    - Get start address of &lt;property&gt; and store in &lt;var&gt;</span><br><span class=\"line\">fdt get size &lt;var&gt; &lt;path&gt; [&lt;prop&gt;]  - Get size of [&lt;property&gt;] or num nodes and store in &lt;var&gt;</span><br><span class=\"line\">fdt set    &lt;path&gt; &lt;prop&gt; [&lt;val&gt;]    - Set &lt;property&gt; [to &lt;val&gt;]</span><br><span class=\"line\">fdt mknode &lt;path&gt; &lt;node&gt;            - Create a new node after &lt;path&gt;</span><br><span class=\"line\">fdt rm     &lt;path&gt; [&lt;prop&gt;]          - Delete the node or &lt;property&gt;</span><br><span class=\"line\">fdt header                          - Display header info</span><br><span class=\"line\">fdt bootcpu &lt;id&gt;                    - Set boot cpuid</span><br><span class=\"line\">fdt memory &lt;addr&gt; &lt;size&gt;            - Add/Update memory node</span><br><span class=\"line\">fdt rsvmem print                    - Show current mem reserves</span><br><span class=\"line\">fdt rsvmem add &lt;addr&gt; &lt;size&gt;        - Add a mem reserve</span><br><span class=\"line\">fdt rsvmem delete &lt;index&gt;           - Delete a mem reserves</span><br><span class=\"line\">fdt chosen [&lt;start&gt; &lt;end&gt;]          - Add/update the /chosen branch in the tree</span><br><span class=\"line\">                                        &lt;start&gt;/&lt;end&gt; - initrd start/end addr</span><br><span class=\"line\">NOTE: Dereference aliases by omitting the leading &#x27;/&#x27;, e.g. fdt print ethernet0.</span><br></pre></td></tr></table></figure>\n\n<p>fdt printåŠ pathå‚æ•°ï¼Œåˆ™æ‰“pathå†…å®¹ï¼Œå¦‚ä¸‹(å…¶ä¸­&#x2F;memoryæ˜¯path)ï¼š</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">U-Boot&gt; fdt print /memory</span><br><span class=\"line\">memory &#123;</span><br><span class=\"line\">device_type = <span class=\"string\">&quot;memory&quot;</span>;</span><br><span class=\"line\">reg = &lt;<span class=\"number\">0x70000000</span> <span class=\"number\">0x4000000</span>&gt;;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">U-Boot&gt; fdt print #ä¸åŠ å‚æ•°æ—¶ï¼Œæ‰“å°å‡ºæ•´é¢—æ ‘</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"äºŒã€u-boot-è·å–GPTåˆ†åŒºè¡¨\"><a href=\"#äºŒã€u-boot-è·å–GPTåˆ†åŒºè¡¨\" class=\"headerlink\" title=\"äºŒã€u-boot è·å–GPTåˆ†åŒºè¡¨\"></a>äºŒã€u-boot è·å–GPTåˆ†åŒºè¡¨</h1><p>åœ¨ubootä¸­é€šè¿‡å‘½ä»¤æ‰“å°åˆ†åŒºè¡¨</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">part list mmc 0</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3588-android-uboot\"><a href=\"#3588-android-uboot\" class=\"headerlink\" title=\"3588-android-uboot\"></a>3588-android-uboot</h2><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;common.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;command.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;android_image.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;mmc.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;memalign.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;fdtdec.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> PART_MAX_COUNT  128</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span>\tLAB_SIZE\t\t512</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span>\tHEADER_OFFSET\tLAB_SIZE</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span>\tENTRY_OFFSET\t(2 * LAB_SIZE)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span>\tVAL1_OFFSET\t\tsizeof(u64)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span>\tVAL2_OFFSET\t\t(2 * sizeof(u64))</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">static</span> u64 <span class=\"title function_\">get_gpt_blk_cnt_and_print</span><span class=\"params\">(<span class=\"keyword\">struct</span> blk_desc *dev_desc,</span></span><br><span class=\"line\"><span class=\"params\">\t\t\t  gpt_header *gpt_head, gpt_entry **gpt_pte)</span> &#123;</span><br><span class=\"line\">\t<span class=\"type\">char</span> efi_str[PARTNAME_SZ + <span class=\"number\">1</span>];</span><br><span class=\"line\">\tu64 gpt_part_size, gpt_blk_cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\">\tgpt_entry *gpt_e;</span><br><span class=\"line\">\t<span class=\"type\">int</span> i;</span><br><span class=\"line\"></span><br><span class=\"line\">\tgpt_e = *gpt_pte;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (i = <span class=\"number\">0</span>; i &lt; gpt_head-&gt;num_partition_entries; i++) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\traite_gpt_convert_efi_name_to_char(efi_str, gpt_e[i].partition_name,</span><br><span class=\"line\">\t\t\t\t\t     PARTNAME_SZ + <span class=\"number\">1</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s: part: %2d name - GPT: %16s &quot;</span>,</span><br><span class=\"line\">\t\t      __func__, i, efi_str);</span><br><span class=\"line\">\t\tgpt_part_size = le64_to_cpu(gpt_e[i].ending_lba) -</span><br><span class=\"line\">\t\t\tle64_to_cpu(gpt_e[i].starting_lba) + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\tgpt_blk_cnt += gpt_part_size;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(gpt_part_size == <span class=\"number\">1</span>) </span><br><span class=\"line\">\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;size(LBA) - GPT: %8llu &quot;</span>,</span><br><span class=\"line\">\t\t      (<span class=\"type\">unsigned</span> <span class=\"type\">long</span> <span class=\"type\">long</span>)gpt_part_size);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;start LBA - GPT: %8llu \\n&quot;</span>,</span><br><span class=\"line\">\t\t      le64_to_cpu(gpt_e[i].starting_lba));</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> gpt_blk_cnt + gpt_e[<span class=\"number\">0</span>].starting_lba - <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">static</span> <span class=\"type\">int</span> <span class=\"title function_\">get_gpt_meta_data</span><span class=\"params\">(u64 *data_size, <span class=\"type\">void</span> **data)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    gpt_header *pgpt_head;</span><br><span class=\"line\">\tgpt_entry *entries;</span><br><span class=\"line\">\t<span class=\"type\">void</span> *meta_data;</span><br><span class=\"line\">\tu64 meta_data_size, gpt_entries_size;</span><br><span class=\"line\">\t<span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">blk_desc</span> *<span class=\"title\">dev_desc</span> =</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">\t<span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">mmc</span> *<span class=\"title\">mmc</span> =</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">\tu64 blk_size = <span class=\"number\">0</span>;</span><br><span class=\"line\">\tu64 blk_cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\">\tu64 tag = <span class=\"number\">0x55AA</span>;</span><br><span class=\"line\">\t<span class=\"type\">lbaint_t</span> lba;</span><br><span class=\"line\">    </span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (!data_size || !data) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR: Invalid Argument(s) ***\\n&quot;</span>, __func__);</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    mmc = do_returnmmc();</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (!mmc)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> CMD_RET_FAILURE;</span><br><span class=\"line\">    </span><br><span class=\"line\">    dev_desc = mmc_get_blk_desc(mmc);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (!dev_desc) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR: mmc_get_blk_desc err ***\\n&quot;</span>, __func__);</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tgpt_entries_size = <span class=\"keyword\">sizeof</span>(gpt_entry) * PART_MAX_COUNT;</span><br><span class=\"line\">\tmeta_data_size = LAB_SIZE + <span class=\"keyword\">sizeof</span>(gpt_header) + gpt_entries_size;</span><br><span class=\"line\">\tmeta_data = <span class=\"built_in\">malloc</span>(meta_data_size);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(!meta_data) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR: malloc memory (gpt meta data) ***\\n&quot;</span>, __func__);</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"built_in\">memset</span>(meta_data, <span class=\"number\">0</span>, meta_data_size);</span><br><span class=\"line\">\tpgpt_head = (gpt_header *)((<span class=\"type\">char</span> *)meta_data + HEADER_OFFSET);</span><br><span class=\"line\">\tentries = (gpt_entry *)((<span class=\"type\">char</span> *)meta_data + ENTRY_OFFSET);</span><br><span class=\"line\">\tALLOC_CACHE_ALIGN_BUFFER(legacy_mbr, mbr, dev_desc-&gt;blksz);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/* Read MBR Header from device */</span></span><br><span class=\"line\">\tlba = <span class=\"number\">0</span>; <span class=\"comment\">/* MBR is always at 0 */</span></span><br><span class=\"line\">\tblk_cnt = <span class=\"number\">1</span>; <span class=\"comment\">/* MBR (1 block) */</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (blk_dread(dev_desc, lba, blk_cnt, (ulong *)mbr) != <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;*** ERROR: Can&#x27;t read MBR header ***\\n&quot;</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">goto</span> ERROR_OUT;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/* Read GPT Header from device */</span></span><br><span class=\"line\">\tlba = GPT_PRIMARY_PARTITION_TABLE_LBA;</span><br><span class=\"line\">\tblk_cnt = <span class=\"number\">1</span>; <span class=\"comment\">/* GPT Header (1 block) */</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (blk_dread(dev_desc, lba, blk_cnt, pgpt_head) != <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">    \t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR: Can&#x27;t read GPT header ***\\n&quot;</span>, __func__);</span><br><span class=\"line\">\t\t<span class=\"keyword\">goto</span> ERROR_OUT;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tlba = GPT_PRIMARY_PARTITION_TABLE_LBA;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (validate_gpt_header(pgpt_head, lba, dev_desc-&gt;lba)) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR: validate_gpt_header GPT header ***\\n&quot;</span>, __func__);</span><br><span class=\"line\">\t\t<span class=\"keyword\">goto</span> ERROR_OUT;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (dev_desc-&gt;sig_type == SIG_TYPE_NONE) &#123;</span><br><span class=\"line\">\t\t<span class=\"type\">efi_guid_t</span> empty = &#123;&#125;;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (<span class=\"built_in\">memcmp</span>(&amp;pgpt_head-&gt;disk_guid, &amp;empty, <span class=\"keyword\">sizeof</span>(empty))) &#123;</span><br><span class=\"line\">\t\t\tdev_desc-&gt;sig_type = SIG_TYPE_GUID;</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">memcpy</span>(&amp;dev_desc-&gt;guid_sig, &amp;pgpt_head-&gt;disk_guid,</span><br><span class=\"line\">\t\t\t      <span class=\"keyword\">sizeof</span>(empty));</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (mbr-&gt;unique_mbr_signature != <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">\t\t\tdev_desc-&gt;sig_type = SIG_TYPE_MBR;</span><br><span class=\"line\">\t\t\tdev_desc-&gt;mbr_sig = mbr-&gt;unique_mbr_signature;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/* Read GPT Entries from device */</span></span><br><span class=\"line\">\tlba = le64_to_cpu(pgpt_head-&gt;partition_entry_lba);</span><br><span class=\"line\">\tblk_cnt = BLOCK_CNT((le32_to_cpu(pgpt_head-&gt;num_partition_entries) *</span><br><span class=\"line\">\t\t\t\t   \tle32_to_cpu(pgpt_head-&gt;sizeof_partition_entry)),</span><br><span class=\"line\">\t\t\t\t  \tdev_desc);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (blk_dread(dev_desc, lba, blk_cnt, entries) != blk_cnt) &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s *** ERROR:read entries (lba=%llu) ***\\n&quot;</span>,</span><br><span class=\"line\">\t\t\t\t__func__, pgpt_head-&gt;partition_entry_lba);</span><br><span class=\"line\">\t\t<span class=\"keyword\">goto</span> ERROR_OUT;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tblk_size = dev_desc-&gt;blksz;</span><br><span class=\"line\">\tvalidate_gpt_entries(pgpt_head, entries);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tdebug(<span class=\"string\">&quot;%s read entries lba %llu (blk_cnt %llu blk_size=%llu)\\n&quot;</span>,</span><br><span class=\"line\">\t\t\t\t__func__, (<span class=\"type\">unsigned</span> <span class=\"type\">long</span> <span class=\"type\">long</span>)(ulong)lba, blk_cnt, blk_size);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tblk_cnt = get_gpt_blk_cnt(dev_desc, pgpt_head, &amp;entries);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/* </span></span><br><span class=\"line\"><span class=\"comment\">\t * build info, layout of meta_data:</span></span><br><span class=\"line\"><span class=\"comment\">\t * u64 tag | u64 blk_size | u64 blk_cnt | 488 bytes | gpt header | gpt entries</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\tblk_cnt = get_gpt_blk_cnt(dev_desc, pgpt_head, &amp;entries);</span><br><span class=\"line\">\t<span class=\"comment\">/*this value makes we known the reserved memory is available*/</span></span><br><span class=\"line\">\t<span class=\"built_in\">memcpy</span>(meta_data, (<span class=\"type\">void</span> *)&amp;tag, <span class=\"keyword\">sizeof</span>(u64));</span><br><span class=\"line\">\t<span class=\"built_in\">memcpy</span>(meta_data + VAL1_OFFSET, (<span class=\"type\">void</span> *)&amp;blk_size, <span class=\"keyword\">sizeof</span>(u64));</span><br><span class=\"line\">\t<span class=\"built_in\">memcpy</span>(meta_data + VAL2_OFFSET, (<span class=\"type\">void</span> *)&amp;blk_cnt, <span class=\"keyword\">sizeof</span>(u64));</span><br><span class=\"line\"></span><br><span class=\"line\">\t*data_size = meta_data_size;</span><br><span class=\"line\">\t*data = meta_data;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">ERROR_OUT:</span><br><span class=\"line\">\t<span class=\"built_in\">free</span>(meta_data);</span><br><span class=\"line\">\tmeta_data = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<p>å‚è€ƒï¼š</p>\n<p><a href=\"http://www.wowotech.net/device_model/dt-code-file-struct-parse.html\">Device Treeï¼ˆå››ï¼‰ï¼šæ–‡ä»¶ç»“æ„è§£æ (wowotech.net)</a></p>\n<p><a href=\"https://zhuanlan.zhihu.com/p/376295326\">Linuxè®¾å¤‡æ ‘è¯­æ³•åˆ†æè¯¦è§£æ•™ç¨‹(ä¸‰)u-bootè®¾å¤‡æ ‘çš„ä¼ é€’ - çŸ¥ä¹ (zhihu.com)</a></p>\n<p><a href=\"https://zhuanlan.zhihu.com/p/376296222\">Linuxè®¾å¤‡æ ‘è¯­æ³•åˆ†æè¯¦è§£æ•™ç¨‹(å››)kernelçš„è§£æ - çŸ¥ä¹ (zhihu.com)</a></p>\n<p><a href=\"https://www.cnblogs.com/solo666/p/16518154.html\">https://www.cnblogs.com/solo666/p/16518154.html</a></p>\n"},{"title":"uboot-01-æ¦‚å¿µ","date":"2024-05-15T13:59:01.000Z","_content":"\nuboot(Universal Boot Loader)\n\nuboot å®˜ç½‘ä¸º http://www.denx.de/wiki/U-Boot/\n\nLinux ç³»ç»Ÿè¦å¯åŠ¨å°±å¿…é¡»éœ€è¦ä¸€ä¸ª bootloader ç¨‹åºï¼Œä¹Ÿå°±è¯´èŠ¯ç‰‡ä¸Šç”µä»¥åå…ˆè¿è¡Œä¸€æ®µ\nbootloader ç¨‹åºã€‚è¿™æ®µ bootloader ç¨‹åºä¼šå…ˆåˆå§‹åŒ–DDR ç­‰å¤–è®¾ï¼Œç„¶åå°† Linux å†…æ ¸ä» flash(NANDï¼Œ\nNOR FLASHï¼ŒSDï¼ŒMMC ç­‰)æ‹·è´åˆ° DDR ä¸­ï¼Œæœ€åå¯åŠ¨ Linux å†…æ ¸\n\nubootä¸»è¦ç›®çš„æ˜¯ä¸ºç³»ç»Ÿå¯åŠ¨åšå‡†å¤‡\n\nubootæ˜¯ä¸€ç§é€šç”¨çš„bootloaderï¼Œæ”¯æŒå¤šç§æ¶æ„\n\n\n\n\n\n\n\n# ubootå¸¸è§å‘½ä»¤\n\n\n\n\n\n","source":"_posts/uboot-01-æ¦‚å¿µ.md","raw":"---\ntitle: uboot-01-æ¦‚å¿µ\ncategories:\n  - uboot\ntags:\n  - ubootæ¦‚å¿µ\ndate: 2024-05-15 21:59:01\n\n---\n\nuboot(Universal Boot Loader)\n\nuboot å®˜ç½‘ä¸º http://www.denx.de/wiki/U-Boot/\n\nLinux ç³»ç»Ÿè¦å¯åŠ¨å°±å¿…é¡»éœ€è¦ä¸€ä¸ª bootloader ç¨‹åºï¼Œä¹Ÿå°±è¯´èŠ¯ç‰‡ä¸Šç”µä»¥åå…ˆè¿è¡Œä¸€æ®µ\nbootloader ç¨‹åºã€‚è¿™æ®µ bootloader ç¨‹åºä¼šå…ˆåˆå§‹åŒ–DDR ç­‰å¤–è®¾ï¼Œç„¶åå°† Linux å†…æ ¸ä» flash(NANDï¼Œ\nNOR FLASHï¼ŒSDï¼ŒMMC ç­‰)æ‹·è´åˆ° DDR ä¸­ï¼Œæœ€åå¯åŠ¨ Linux å†…æ ¸\n\nubootä¸»è¦ç›®çš„æ˜¯ä¸ºç³»ç»Ÿå¯åŠ¨åšå‡†å¤‡\n\nubootæ˜¯ä¸€ç§é€šç”¨çš„bootloaderï¼Œæ”¯æŒå¤šç§æ¶æ„\n\n\n\n\n\n\n\n# ubootå¸¸è§å‘½ä»¤\n\n\n\n\n\n","slug":"uboot-01-æ¦‚å¿µ","published":1,"updated":"2024-05-16T05:31:36.959Z","_id":"clw7y3oy60000zfapahvk834m","comments":1,"layout":"post","photos":[],"link":"","content":"<p>uboot(Universal Boot Loader)</p>\n<p>uboot å®˜ç½‘ä¸º <a href=\"http://www.denx.de/wiki/U-Boot/\">http://www.denx.de/wiki/U-Boot/</a></p>\n<p>Linux ç³»ç»Ÿè¦å¯åŠ¨å°±å¿…é¡»éœ€è¦ä¸€ä¸ª bootloader ç¨‹åºï¼Œä¹Ÿå°±è¯´èŠ¯ç‰‡ä¸Šç”µä»¥åå…ˆè¿è¡Œä¸€æ®µ<br>bootloader ç¨‹åºã€‚è¿™æ®µ bootloader ç¨‹åºä¼šå…ˆåˆå§‹åŒ–DDR ç­‰å¤–è®¾ï¼Œç„¶åå°† Linux å†…æ ¸ä» flash(NANDï¼Œ<br>NOR FLASHï¼ŒSDï¼ŒMMC ç­‰)æ‹·è´åˆ° DDR ä¸­ï¼Œæœ€åå¯åŠ¨ Linux å†…æ ¸</p>\n<p>ubootä¸»è¦ç›®çš„æ˜¯ä¸ºç³»ç»Ÿå¯åŠ¨åšå‡†å¤‡</p>\n<p>ubootæ˜¯ä¸€ç§é€šç”¨çš„bootloaderï¼Œæ”¯æŒå¤šç§æ¶æ„</p>\n<h1 id=\"ubootå¸¸è§å‘½ä»¤\"><a href=\"#ubootå¸¸è§å‘½ä»¤\" class=\"headerlink\" title=\"ubootå¸¸è§å‘½ä»¤\"></a>ubootå¸¸è§å‘½ä»¤</h1>","site":{"data":{}},"excerpt":"","more":"<p>uboot(Universal Boot Loader)</p>\n<p>uboot å®˜ç½‘ä¸º <a href=\"http://www.denx.de/wiki/U-Boot/\">http://www.denx.de/wiki/U-Boot/</a></p>\n<p>Linux ç³»ç»Ÿè¦å¯åŠ¨å°±å¿…é¡»éœ€è¦ä¸€ä¸ª bootloader ç¨‹åºï¼Œä¹Ÿå°±è¯´èŠ¯ç‰‡ä¸Šç”µä»¥åå…ˆè¿è¡Œä¸€æ®µ<br>bootloader ç¨‹åºã€‚è¿™æ®µ bootloader ç¨‹åºä¼šå…ˆåˆå§‹åŒ–DDR ç­‰å¤–è®¾ï¼Œç„¶åå°† Linux å†…æ ¸ä» flash(NANDï¼Œ<br>NOR FLASHï¼ŒSDï¼ŒMMC ç­‰)æ‹·è´åˆ° DDR ä¸­ï¼Œæœ€åå¯åŠ¨ Linux å†…æ ¸</p>\n<p>ubootä¸»è¦ç›®çš„æ˜¯ä¸ºç³»ç»Ÿå¯åŠ¨åšå‡†å¤‡</p>\n<p>ubootæ˜¯ä¸€ç§é€šç”¨çš„bootloaderï¼Œæ”¯æŒå¤šç§æ¶æ„</p>\n<h1 id=\"ubootå¸¸è§å‘½ä»¤\"><a href=\"#ubootå¸¸è§å‘½ä»¤\" class=\"headerlink\" title=\"ubootå¸¸è§å‘½ä»¤\"></a>ubootå¸¸è§å‘½ä»¤</h1>"},{"title":"cgroup","date":"2024-05-16T07:30:33.000Z","_content":"\n[toc]\n\ncgroupæ˜¯linuxå†…æ ¸å®ç°ã€ç”¨äºæ§åˆ¶linuxç³»ç»Ÿèµ„æºçš„ç»„ä»¶ã€‚å› æ­¤è¦äº†è§£cgroupï¼Œé¦–å…ˆä»å¼•å…¥è¿™ä¸ªç»„ä»¶çš„kernelæ–‡æ¡£ä¸­å¯»æ‰¾ã€‚\n\nå»åˆ°ä¸¾ä¸–é—»åçš„www.kernel.org\n\næ‰¾åˆ°ä»‹ç»æ–‡æ¡£ï¼šDocumentation/cgroup-v1/cgroups.txt\n\n## 1 ä»€ä¹ˆæ˜¯cgroup?\n\n>cgroup ï¼Œæ§åˆ¶ç»„ï¼Œå®ƒæä¾›äº†ä¸€å¥—æœºåˆ¶ç”¨äºæ§åˆ¶ä¸€ç»„ç‰¹å®šè¿›ç¨‹å¯¹èµ„æºçš„ä½¿ç”¨ã€‚cgroupç»‘å®šä¸€ä¸ªè¿›ç¨‹é›†åˆåˆ°ä¸€ä¸ªæˆ–å¤šä¸ªå­ç³»ç»Ÿä¸Šã€‚\n>\n>subsystemï¼Œå­ç³»ç»Ÿï¼Œä¸€ä¸ªé€šè¿‡cgroupæä¾›çš„å·¥å…·å’Œæ¥å£æ¥ç®¡ç†è¿›ç¨‹é›†åˆçš„æ¨¡å—ã€‚ä¸€ä¸ªå­ç³»ç»Ÿå°±æ˜¯ä¸€ä¸ªå…¸å‹çš„â€œèµ„æºæ§åˆ¶å™¨â€ï¼Œç”¨æ¥è°ƒåº¦èµ„æºæˆ–è€…æ§åˆ¶èµ„æºä½¿ç”¨çš„ä¸Šé™ã€‚å…¶å®æ¯ç§èµ„æºå°±æ˜¯ä¸€ä¸ªå­ç³»ç»Ÿã€‚å­ç³»ç»Ÿå¯ä»¥æ˜¯ä»¥è¿›ç¨‹ä¸ºå•ä½çš„ä»»ä½•ä¸œè¥¿ï¼Œæ¯”å¦‚è™šæ‹ŸåŒ–å­ç³»ç»Ÿã€å†…å­˜å­ç³»ç»Ÿã€‚\n>\n>hierarchyï¼Œå±‚çº§æ ‘ï¼Œå¤šä¸ªcgroupçš„é›†åˆï¼Œè¿™äº›é›†åˆæ„æˆçš„æ ‘å«hierarchyã€‚å¯ä»¥è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªèµ„æºæ ‘ï¼Œé™„ç€åœ¨è¿™ä¸Šé¢çš„è¿›ç¨‹å¯ä»¥ä½¿ç”¨çš„èµ„æºä¸Šé™å¿…é¡»å—æ ‘ä¸ŠèŠ‚ç‚¹ï¼ˆcgroupï¼‰çš„æ§åˆ¶ã€‚hierarchyä¸Šçš„å±‚æ¬¡å…³ç³»é€šè¿‡cgroupfsè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿæ˜¾ç¤ºã€‚ç³»ç»Ÿå…è®¸å¤šä¸ªhierarchyåŒæ—¶å­˜åœ¨ï¼Œæ¯ä¸ªhierachyåŒ…å«ç³»ç»Ÿä¸­çš„éƒ¨åˆ†æˆ–è€…å…¨éƒ¨è¿›ç¨‹é›†åˆã€‚\n>\n>cgroupfsæ˜¯ç”¨æˆ·ç®¡ç†æ“çºµcgroupçš„ä¸»è¦æ¥å£ï¼šé€šè¿‡åœ¨cgroupfsæ–‡ä»¶ç³»ç»Ÿä¸­åˆ›å»ºç›®å½•ï¼Œå®ç°cgroupçš„åˆ›å»ºï¼›é€šè¿‡å‘ç›®å½•ä¸‹çš„å±æ€§æ–‡ä»¶å†™å…¥å†…å®¹ï¼Œè®¾ç½®cgroupå¯¹èµ„æºçš„æ§åˆ¶ï¼›å‘taskå±æ€§æ–‡ä»¶å†™å…¥è¿›ç¨‹IDï¼Œå¯ä»¥å°†è¿›ç¨‹ç»‘å®šåˆ°æŸä¸ªcgroupï¼Œä»¥æ­¤è¾¾åˆ°æ§åˆ¶è¿›ç¨‹èµ„æºä½¿ç”¨çš„ç›®çš„ï¼›ä¹Ÿå¯ä»¥åˆ—å‡ºcgroupåŒ…å«çš„è¿›ç¨‹pidã€‚è¿™äº›æ“ä½œå½±å“çš„æ˜¯sysfså…³è”çš„hierarchyï¼Œå¯¹å…¶å®ƒhierarchyæ²¡æœ‰å½±å“ã€‚\n>\n>å¯¹äºcgroupï¼Œå…¶æœ¬èº«çš„ä½œç”¨åªæ˜¯ä»»åŠ¡è·Ÿè¸ªã€‚ä½†å…¶å®ƒç³»ç»Ÿï¼ˆæ¯”å¦‚cpusetsï¼Œcpuacctï¼‰ï¼Œå¯ä»¥åˆ©ç”¨cgroupçš„è¿™ä¸ªåŠŸèƒ½å®ç°ä¸€äº›æ–°çš„å±æ€§ï¼Œæ¯”å¦‚ç»Ÿè®¡æˆ–è€…æ§åˆ¶ä¸€ä¸ªcgroupä¸­è¿›ç¨‹å¯ä»¥è®¿é—®çš„èµ„æºã€‚ä¸¾ä¸ªä¾‹å­ï¼Œcpusetså­ç³»ç»Ÿå¯ä»¥å°†è¿›ç¨‹ç»‘å®šåˆ°ç‰¹å®šçš„cpuå’Œå†…å­˜èŠ‚ç‚¹ä¸Šã€‚\n\n2 ä¸ºä»€ä¹ˆéœ€è¦cgroup?\n\n>\n>\n>è¿™ä¸ªé—®é¢˜ç›¸å½“äºé—®cgroupé‡è¦å—ï¼Ÿæœ‰å“ªäº›åœ°æ–¹ç”¨åˆ°äº†ã€‚å›ç­”æ˜¯é‡è¦ï¼Œåˆä¸é‡è¦ã€‚å¦‚æœä½ ç”¨åˆ°äº†ï¼Œé‚£å°±é‡è¦ï¼Œå¦‚æœæ²¡æœ‰ç”¨åˆ°ï¼Œé‚£å°±ä¸é‡è¦ã€‚å‘µå‘µå‘µ~~~~å…¶å®æŒºé‡è¦çš„ã€‚cgroupçš„ä¸»è¦è¿ç”¨æ˜¯èµ„æºè·Ÿè¸ªã€‚æˆ‘æ¥è§¦çš„åœºæ™¯å°±æ˜¯ç”¨cgroupæ§åˆ¶è™šæ‹Ÿæœºè¿›ç¨‹æˆ–è€…dockerè¿›ç¨‹å¯ä»¥ä½¿ç”¨çš„èµ„æºã€‚å½“ä½ æƒ³åœ¨linuxå¯¹åº”ç”¨è¿›ç¨‹åšèµ„æºè®¿é—®æ§åˆ¶çš„æ—¶å€™ï¼Œcgroupå°±æ´¾ä¸Šç”¨åœºäº†ã€‚\n\n## 3 cgroupæ€ä¹ˆå®ç°çš„ï¼Ÿ\n\n>â€”â€”    ç³»ç»Ÿä¸­çš„æ¯ä¸ªè¿›ç¨‹ï¼ˆtask_structï¼Œåé¢ç”¨taskä»£æŒ‡ï¼‰éƒ½æŒæœ‰ä¸€ä¸ªæŒ‡å‘css_setç»“æ„çš„æŒ‡é’ˆã€‚\n>\n>â€”â€”    ä¸€ä¸ªcss_setç»“æ„ä½“åŒ…å«äº†ä¸€ç»„æŒ‡å‘cgroup_subsys_stateå¯¹è±¡çš„æŒ‡é’ˆï¼ˆæ‰€ä»¥ä¸€ä¸ªtaskå¯ä»¥é™„åŠ åˆ°å¤šä¸ªcgroupä¸Šï¼‰ï¼Œæ¯ä¸ªcgroup_subsys_stateåœ¨ç³»ç»Ÿä¸­éƒ½æœ‰æ³¨å†Œã€‚taskç»“æ„ä½“æ²¡æœ‰ç›´æ¥æŒ‡å‘hierarchyä¸­ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆcgroupï¼‰çš„æŒ‡é’ˆã€‚ä½†å¯ä»¥é€šè¿‡å…¶åŒ…å«çš„cgroup_subsys_stateé—´æ¥ç¡®å®šã€‚è¿™æ ·è®¾è®¡çš„åŸå› æ˜¯cpuå¯¹subsystem stateçš„è®¿é—®å¾ˆé¢‘ç¹ï¼Œä½†æ¶‰åŠåˆ°å°†taskç»‘å®šåˆ°cgroupçš„æ“ä½œå´ä¸å¤šã€‚taskä¸­è¿˜æœ‰ä¸ªåŒå‘é“¾è¡¨cg_listï¼Œè¿™ä¸ªé“¾è¡¨ç»´æŠ¤æ‰€æœ‰åŒå±äºä¸€ä¸ªcss_setçš„tasksã€‚\n>\n>â€”â€”    ç”¨æˆ·å¯ä»¥é€šè¿‡cgroupfsæ–‡ä»¶ç³»ç»Ÿæ¥æµè§ˆcgroup hierarchyã€‚\n>\n>â€”â€”    ç”¨æˆ·å¯ä»¥åˆ—å‡ºä»»æ„ä¸€ä¸ªcgroupä¸Šé™„ç€çš„task PID\n>\n>cgroupåœ¨kernelä¸­é™¤äº†æœ¬èº«åŠŸèƒ½çš„å®ç°å¤–ï¼Œåœ¨kernelä¸­è¿˜æœ‰ä¸¤å¤„ä¿®æ”¹ï¼š\n>\n>â€”â€”    åœ¨kernelå¯åŠ¨æ—¶å¯¹root cgroupçš„åˆå§‹åŒ–å’Œcss_setç»“æ„ä½“çš„åˆå§‹åŒ–ã€‚è¿™ä¸ªåœ¨init/main.cæ–‡ä»¶ä¸­å®ç°ã€‚\n>\n>â€”â€”    åœ¨taskçš„åˆ›å»ºï¼ˆforkï¼‰å’Œé€€å‡ºï¼ˆexitï¼‰é˜¶æ®µï¼Œå¯¹åº”åœ°å°†taskä¸css_setè¿›è¡Œç»‘å®šå’Œè§£ç»‘ã€‚\n>\n>å¦å¤–ï¼Œcgroupä¸ºäº†å‘ç”¨æˆ·æä¾›æ“ä½œæ¥å£ï¼Œç‰¹åˆ«å¼€å‘äº†ä¸€ä¸ªè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿç±»å‹ï¼ˆcgroupfsï¼‰ï¼Œè¿™ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸sysfsï¼Œprocç±»ä¼¼ã€‚cgroupfsæ˜¯å‘ç”¨æˆ·å±•ç¤ºcgroupçš„hierarchyï¼Œé€šçŸ¥kernelç”¨æˆ·å¯¹cgroupæ”¹åŠ¨çš„çª—å£ã€‚æŒ‚è½½cgroupfsæ—¶é€šè¿‡é€‰é¡¹ï¼ˆ-otypeï¼‰æŒ‡å®šè¦æŒ‚è½½çš„å­ç³»ç»Ÿç±»å‹ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œé»˜è®¤æŒ‚è½½æ‰€æœ‰çš„æ³¨å†Œçš„å­ç³»ç»Ÿã€‚\n>\n>å¦‚æœæ–°æŒ‚è½½çš„cgroupå…³è”çš„hierachyä¸ç³»ç»Ÿä¸­å­˜åœ¨çš„hierarchyå®Œå…¨ä¸€æ ·ï¼Œé‚£ä¹ˆcgroupfsä¼šæ‹’ç»æŒ‚è½½ã€‚å¦‚æœæ²¡æœ‰åŒ¹é…åˆ°ç›¸åŒçš„hierarchyï¼Œä½†æ–°æŒ‚è½½hierachyå£°æ˜çš„èµ„æºæ­£åœ¨è¢«å·²ç»å­˜åœ¨çš„hierarchyä½¿ç”¨ï¼ŒæŒ‚è½½ä¼šæŠ¥-EBUSYé”™è¯¯ã€‚\n>\n>å½“å‰cgroupè¿˜æ²¡æœ‰å®ç°å‘å·²ç»å­˜åœ¨çš„cgroup hierarchyç»‘å®šæ–°å­ç³»ç»Ÿçš„æ“ä½œï¼Œå°†å­ç³»ç»Ÿä»cgroup hierachyè§£ç»‘ä¹Ÿä¸å…è®¸ã€‚è¿™äº›æ“ä½œåœ¨æœªæ¥ä¹Ÿè®¸ä¼šæ”¯æŒï¼Œä½†ä¹Ÿå¯èƒ½ä¼šè¿›ä¸€æ­¥äº§ç”Ÿé”™è¯¯æ¢å¤çš„ä¸€ç³»åˆ—é—®é¢˜ã€‚\n>\n>å¸è½½cgroupfsæ—¶ï¼Œå¦‚æœå®ƒçš„å­cgroupfsè¿˜åœ¨æ´»åŠ¨ï¼Œé‚£ä¹ˆå­cgroupfsè¿˜æ˜¯ä¼šæŒç»­ç”Ÿæ•ˆã€‚ç›´åˆ°æ‰€æœ‰çš„å­cgroupfsä¸å†æ´»åŠ¨ï¼Œå¸è½½cgroupfsæ‰ä¼šçœŸæ­£ç”Ÿæ•ˆã€‚\n>\n>cgroupfsä¸‹ä¸èƒ½å†æŒ‚è½½å…¶å®ƒç±»å‹çš„æ–‡ä»¶ç³»ç»Ÿã€‚æ‰€æœ‰å¯¹cgroupçš„æŸ¥è¯¢ä¿®æ”¹éƒ½åªé€šè¿‡cgroupfsæ–‡ä»¶ç³»ç»Ÿæ¥å®Œæˆã€‚\n>\n>ç³»ç»Ÿä¸­çš„æ‰€æœ‰taskï¼Œåœ¨/proc/pidç›®å½•ä¸‹éƒ½æœ‰ä¸€ä¸ªåä¸ºcgroupçš„æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶å±•ç¤ºäº†è¯¥taskç›¸å¯¹cgroupfs æ ¹çš„è·¯å¾„ã€‚é€šè¿‡æŸ¥çœ‹è¿™ä¸ªæ–‡ä»¶ï¼Œå¯ä»¥äº†è§£ä¸€ä¸ªè¿›ç¨‹åœ¨cgroup hierarchyçš„ä½ç½®ã€‚ä»¥æ­¤å¾—åˆ°taskå¯ä»¥ä½¿ç”¨çš„èµ„æºä¿¡æ¯ã€‚\n>\n>cgroupfsä¸­ç›®å½•è¡¨ç¤ºcgroupï¼Œæ¯ä¸ªç›®å½•åœ¨åˆ›å»ºæ—¶é»˜è®¤ç”Ÿæˆå¦‚ä¸‹çš„å±æ€§æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶æè¿°äº†cgroupçš„ä¿¡æ¯ï¼š\n>\n>â€”â€”    tasks: æ‰€æœ‰é™„å±äºè¿™ä¸ªcgroupçš„è¿›ç¨‹IDåˆ—è¡¨ã€‚tasksæ–‡ä»¶ä¸­å¢åŠ è¿›ç¨‹IDï¼Œè¡¨ç¤ºå°†è¿›ç¨‹åŠ å…¥è¿™ä¸ªcgroupï¼Œè¿›ç¨‹èƒ½å¤Ÿä½¿ç”¨çš„èµ„æºå—cgroupé™åˆ¶ã€‚\n>\n>â€”â€”    cgroup.procs: æ‰€æœ‰é™„å±äºè¿™ä¸ªcgroupçº¿ç¨‹ç»„IDï¼Œå°†TGIDå†™å…¥è¿™ä¸ªæ–‡ä»¶åï¼ŒTGIDæ‰€åœ¨è¿›ç¨‹åŒ…å«çš„æ‰€æœ‰çº¿ç¨‹éƒ½åŠ å…¥è¿™ä¸ªcgroupï¼Œè¿™äº›çº¿ç¨‹å—cgroupé™åˆ¶ã€‚\n\n> PIDï¼šè¿™æ˜¯ Linux ä¸­åœ¨å…¶å‘½åç©ºé—´ä¸­å”¯ä¸€æ ‡è¯†è¿›ç¨‹è€Œåˆ†é…ç»™å®ƒçš„ä¸€ä¸ªå·ç ï¼Œç§°åšè¿›ç¨‹IDå·ï¼Œç®€ç§°PIDã€‚åœ¨ä½¿ç”¨ fork æˆ– clone ç³»ç»Ÿè°ƒç”¨æ—¶äº§ç”Ÿçš„è¿›ç¨‹å‡ä¼šç”±å†…æ ¸åˆ†é…ä¸€ä¸ªæ–°çš„å”¯ä¸€çš„PIDå€¼ã€‚\n> TGIDï¼šåœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œå¦‚æœä»¥CLONE_THREADæ ‡å¿—æ¥è°ƒç”¨cloneå»ºç«‹çš„è¿›ç¨‹å°±æ˜¯è¯¥è¿›ç¨‹çš„ä¸€ä¸ªçº¿ç¨‹ï¼Œå®ƒä»¬å¤„äºä¸€ä¸ªçº¿ç¨‹ç»„ï¼Œè¯¥çº¿ç¨‹ç»„çš„IDå«åšTGIDã€‚å¤„äºç›¸åŒçš„çº¿ç¨‹ç»„ä¸­çš„æ‰€æœ‰è¿›ç¨‹éƒ½æœ‰ç›¸åŒçš„TGIDï¼›çº¿ç¨‹ç»„ç»„é•¿çš„TGIDä¸å…¶PIDç›¸åŒï¼›ä¸€ä¸ªè¿›ç¨‹æ²¡æœ‰ä½¿ç”¨çº¿ç¨‹ï¼Œåˆ™å…¶TGIDä¸PIDä¹Ÿç›¸åŒã€‚\n> PGIDï¼šå¦å¤–ï¼Œç‹¬ç«‹çš„è¿›ç¨‹å¯ä»¥ç»„æˆè¿›ç¨‹ç»„ï¼ˆä½¿ç”¨setpgrpç³»ç»Ÿè°ƒç”¨ï¼‰ï¼Œè¿›ç¨‹ç»„å¯ä»¥ç®€åŒ–å‘æ‰€æœ‰ç»„å†…è¿›ç¨‹å‘é€ä¿¡å·çš„æ“ä½œï¼Œä¾‹å¦‚ç”¨ç®¡é“è¿æ¥çš„è¿›ç¨‹å¤„åœ¨åŒä¸€è¿›ç¨‹ç»„å†…ã€‚è¿›ç¨‹ç»„IDå«åšPGIDï¼Œè¿›ç¨‹ç»„å†…çš„æ‰€æœ‰è¿›ç¨‹éƒ½æœ‰ç›¸åŒçš„PGIDï¼Œç­‰äºè¯¥ç»„ç»„é•¿çš„PIDã€‚\n> SIDï¼šå‡ ä¸ªè¿›ç¨‹ç»„å¯ä»¥åˆå¹¶æˆä¸€ä¸ªä¼šè¯ç»„ï¼ˆä½¿ç”¨setsidç³»ç»Ÿè°ƒç”¨ï¼‰ï¼Œå¯ä»¥ç”¨äºç»ˆç«¯ç¨‹åºè®¾è®¡ã€‚ä¼šè¯ç»„ä¸­æ‰€æœ‰è¿›ç¨‹éƒ½æœ‰ç›¸åŒçš„SIDã€‚\n> â€”â€”    notify_on_release flag: æ ‡è®°é€€å‡ºæ—¶æ˜¯å¦è¿è¡Œrelease agent\n>\n> â€”â€”    release_agent: åˆ¶å®šè¦è¿è¡Œçš„release agentçš„è·¯å¾„ï¼Œè¿™ä¸ªå±æ€§æ–‡ä»¶åªåœ¨cgroupçš„é¡¶å±‚ç›®å½•ä¸­å­˜åœ¨ã€‚\n>\n> ä»¥ä¸Šæ–‡ä»¶æ˜¯æ¯ä¸ªcgroupåŸºæœ¬çš„å±æ€§æ–‡ä»¶ï¼Œå¯¹äºä¸åŒçš„å­ç³»ç»Ÿï¼Œå¯¹åº”çš„cgroupå¯èƒ½ä¼šæœ‰å…¶å®ƒé™„åŠ çš„å±æ€§æ–‡ä»¶ï¼Œå­˜åœ¨äºå…¶å¯¹åº”çš„cgroupç›®å½•ä¹‹ä¸‹ã€‚\n>\n> é€šè¿‡mkdirå‘½ä»¤åˆ›å»ºcgroupï¼Œé€šè¿‡å‘ç›®å½•ä¸‹çš„æ–‡ä»¶å†™å…¥é€‚å½“çš„æ•°å€¼è®¾ç½®ä¿®æ”¹cgroupçš„å±æ€§ã€‚\n>\n> åµŒå¥—çš„cgroupsï¼ŒæŒ‡å®šäº†å±‚çº§ç»“æ„ï¼Œä»¥æ­¤å°†ç³»ç»Ÿèµ„æºåˆ’åˆ†æˆåµŒå¥—çš„ï¼ŒåŠ¨æ€å¯å˜çš„æ›´å°çš„èµ„æºå—ã€‚\n>\n> ä¸€ä¸ªè¿›ç¨‹å¯ä»¥é™„åŠ åˆ°å¤šä¸ªä¸åŒçš„cgroupä¸­ï¼Œåªè¦è¿™äº›cgroupä¸åœ¨åŒä¸€ä¸ªå±‚çº§æ ‘ä¸Šå³å¯ã€‚å› ä¸ºcgroupfsä¼šä¿è¯æ–°æŒ‚è½½çš„cgroupå…³è”çš„å±‚çº§æ ‘å…¨å±€å”¯ä¸€ã€‚å­è¿›ç¨‹åœ¨è¢«åˆ›å»ºåé»˜è®¤é™„åŠ åˆ°çˆ¶è¿›ç¨‹æ‰€åœ¨çš„cgroupï¼Œåé¢ç”¨æˆ·å¯ä»¥æ ¹æ®éœ€è¦å°†å…¶ç§»åŠ¨åˆ°åˆ«çš„cgroupã€‚\n>\n> å½“è¿›ç¨‹ä»ä¸€ä¸ªcgroupè¢«ç§»åŠ¨åˆ°å¦ä¸€ä¸ªcgroupã€‚è¿›ç¨‹çš„task_structä¼šè·å–ä¸€ä¸ªæ–°çš„css_setæŒ‡é’ˆï¼šå¦‚æœè¿™ä¸ªcgroupæ‰€åœ¨çš„css_setå·²ç»å­˜åœ¨å°±é‡ç”¨è¿™ä¸ªcss_setï¼Œå¦åˆ™å°±æ–°åˆ†é…ä¸€ä¸ªcss_setã€‚kernelä¼šåœ¨å…¨å±€çš„hashè¡¨ä¸­æŸ¥æ‰¾ç¡®è®¤cgroupæ‰€å±çš„css_setæ˜¯å¦å­˜åœ¨ã€‚\n\n## 4 notify_on_release æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ\n\n>å¦‚æœcgroupä¸­ä½¿èƒ½notify_on_releaseï¼Œcgroupä¸­çš„æœ€åä¸€ä¸ªè¿›ç¨‹è¢«ç§»é™¤ï¼Œæœ€åä¸€ä¸ªå­cgroupä¹Ÿè¢«åˆ é™¤æ—¶ï¼Œcgroupä¼šä¸»åŠ¨é€šçŸ¥kernelã€‚æ¥æ”¶åˆ°æ¶ˆæ¯çš„kernelä¼šæ‰§è¡Œrelease_agentæ–‡ä»¶ä¸­æŒ‡å®šçš„ç¨‹åºã€‚notify_on_releaseé»˜è®¤æ˜¯å…³é—­çš„ï¼Œrelease_agentçš„å†…å®¹é»˜è®¤ä¸ºç©ºï¼Œå­cgroupåœ¨åˆ›å»ºæ—¶ä¼šç»§æ‰¿çˆ¶cgroupä¸­notify_on_relaseå’Œrelease_agentçš„å±æ€§ã€‚æ‰€ä»¥è¿™ä¸¤ä¸ªæ–‡ä»¶åªå­˜åœ¨äºcgroupfsçš„é¡¶å±‚ç›®å½•ä¸­ã€‚\n\n\n\n## 5 clone_childrenæœ‰ä»€ä¹ˆç”¨ï¼Ÿ\n\n> clone_chilrenä»…é’ˆå¯¹cpuç»‘å®šï¼ˆcpusetï¼‰ï¼Œå¦‚æœclone_childrenä½¿èƒ½ï¼Œæ–°çš„cpuset cgroupåœ¨åˆå§‹åŒ–æ—¶ä¼šç»§æ‰¿çˆ¶cgroupçš„å±æ€§ã€‚\n\n## 6 cgroupæ€ä¹ˆç”¨ï¼Ÿ\n\n>\n>\n>å‡è®¾ç°åœ¨è¦å°†ä¸€ä¸ªæ–°çš„ä»»åŠ¡åŠ å…¥åˆ°cgroupï¼ŒåŠŸèƒ½æ˜¯å°†è¯¥ä»»åŠ¡çš„è¿›ç¨‹åœ¨æŒ‡å®šçš„cpuä¸Šè¿è¡Œï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨\"cpuset\"cgroup å­ç³»ç»Ÿï¼Œæ“ä½œçš„å¤§è‡´æ­¥éª¤å¦‚ä¸‹ï¼š\n>\n>1ï¼‰mount -t tmpfs cgroup_root /sys/fs/cgroup \n>\n>æŒ‚è½½cgroupæ ¹æ–‡ä»¶ç³»ç»Ÿï¼Œç±»å‹ä¸ºtmpfs\n>\n>2ï¼‰mkdir /sys/fs/cgroup/cpuset\n>\n>åœ¨cgroupfsæ ¹ç›®å½•ä¸‹åˆ›å»ºå­cgroupï¼Œåä¸ºcpuset\n>\n>3ï¼‰mount -t cgroup -o cpuset cpuset /sys/fs/cgroup/cpuset\n>\n>å°†åä¸ºcpusetçš„cgroupå…³è”åˆ°cpusetå­ç³»ç»Ÿ\n>\n>4ï¼‰åœ¨cpusetç›®å½•ä¸‹åˆ›å»ºç›®å½•ï¼Œç”Ÿæˆä¸€ä¸ªå­cgroupï¼Œå±æ€§æ–‡ä»¶ä¸­å†™å…¥ç›¸åº”å†…å®¹ï¼Œè®¾ç½®å±æ€§ã€‚\n>\n>5ï¼‰å¯åŠ¨éœ€è¦é™åˆ¶çš„è¿›ç¨‹ï¼ŒæŸ¥æ‰¾å…¶å¯¹åº”çš„è¿›ç¨‹IDï¼Œå°†å…¶å†™å…¥å¯¹åº”çš„taskæ–‡ä»¶ä¸­\n>\n>ä»¥ä¸‹æ“ä½œæ­¥éª¤æ˜¯åˆ›å»ºä¸€ä¸ªåä¸º\"Charlie\"çš„cgroupï¼Œè¿™ä¸ªcgroupçš„èµ„æºåŒ…å«cpu2ï¼Œcpu3å’Œå†…å­˜èŠ‚ç‚¹1ï¼Œå°†shellè¿›ç¨‹é™„åŠ åˆ°è¿™ä¸ªcgroupã€‚\n>\n>mount -t tmpfs cgroup_root /sys/fs/cgroup\n>\n>mkdir /sys/fs/cgroup/cpuset\n>\n>mount -t cgroup cpuset -o cpuset /sys/fs/cgroup/cpuset\n>\n>cd /sys/fs/cgroup/cpuset\n>\n>mkdir Charlie\n>\n>cd Charlie\n>\n>echo 2-3 > cpuset.cpus\n>\n>echo 1 > cpuset.mems\n>\n>echo $$ > tasks\n>\n>sh\n>\n>cat /proc/self/cgroup\n\nè½¬ï¼š\n\n https://blog.csdn.net/huang987246510/article/details/80765628\n","source":"_posts/cgroup.md","raw":"---\ntitle: cgroup\ncategories:\n  - kernel\ntags:\n  - cgroup\ndate: 2024-05-16 15:30:33\n---\n\n[toc]\n\ncgroupæ˜¯linuxå†…æ ¸å®ç°ã€ç”¨äºæ§åˆ¶linuxç³»ç»Ÿèµ„æºçš„ç»„ä»¶ã€‚å› æ­¤è¦äº†è§£cgroupï¼Œé¦–å…ˆä»å¼•å…¥è¿™ä¸ªç»„ä»¶çš„kernelæ–‡æ¡£ä¸­å¯»æ‰¾ã€‚\n\nå»åˆ°ä¸¾ä¸–é—»åçš„www.kernel.org\n\næ‰¾åˆ°ä»‹ç»æ–‡æ¡£ï¼šDocumentation/cgroup-v1/cgroups.txt\n\n## 1 ä»€ä¹ˆæ˜¯cgroup?\n\n>cgroup ï¼Œæ§åˆ¶ç»„ï¼Œå®ƒæä¾›äº†ä¸€å¥—æœºåˆ¶ç”¨äºæ§åˆ¶ä¸€ç»„ç‰¹å®šè¿›ç¨‹å¯¹èµ„æºçš„ä½¿ç”¨ã€‚cgroupç»‘å®šä¸€ä¸ªè¿›ç¨‹é›†åˆåˆ°ä¸€ä¸ªæˆ–å¤šä¸ªå­ç³»ç»Ÿä¸Šã€‚\n>\n>subsystemï¼Œå­ç³»ç»Ÿï¼Œä¸€ä¸ªé€šè¿‡cgroupæä¾›çš„å·¥å…·å’Œæ¥å£æ¥ç®¡ç†è¿›ç¨‹é›†åˆçš„æ¨¡å—ã€‚ä¸€ä¸ªå­ç³»ç»Ÿå°±æ˜¯ä¸€ä¸ªå…¸å‹çš„â€œèµ„æºæ§åˆ¶å™¨â€ï¼Œç”¨æ¥è°ƒåº¦èµ„æºæˆ–è€…æ§åˆ¶èµ„æºä½¿ç”¨çš„ä¸Šé™ã€‚å…¶å®æ¯ç§èµ„æºå°±æ˜¯ä¸€ä¸ªå­ç³»ç»Ÿã€‚å­ç³»ç»Ÿå¯ä»¥æ˜¯ä»¥è¿›ç¨‹ä¸ºå•ä½çš„ä»»ä½•ä¸œè¥¿ï¼Œæ¯”å¦‚è™šæ‹ŸåŒ–å­ç³»ç»Ÿã€å†…å­˜å­ç³»ç»Ÿã€‚\n>\n>hierarchyï¼Œå±‚çº§æ ‘ï¼Œå¤šä¸ªcgroupçš„é›†åˆï¼Œè¿™äº›é›†åˆæ„æˆçš„æ ‘å«hierarchyã€‚å¯ä»¥è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªèµ„æºæ ‘ï¼Œé™„ç€åœ¨è¿™ä¸Šé¢çš„è¿›ç¨‹å¯ä»¥ä½¿ç”¨çš„èµ„æºä¸Šé™å¿…é¡»å—æ ‘ä¸ŠèŠ‚ç‚¹ï¼ˆcgroupï¼‰çš„æ§åˆ¶ã€‚hierarchyä¸Šçš„å±‚æ¬¡å…³ç³»é€šè¿‡cgroupfsè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿæ˜¾ç¤ºã€‚ç³»ç»Ÿå…è®¸å¤šä¸ªhierarchyåŒæ—¶å­˜åœ¨ï¼Œæ¯ä¸ªhierachyåŒ…å«ç³»ç»Ÿä¸­çš„éƒ¨åˆ†æˆ–è€…å…¨éƒ¨è¿›ç¨‹é›†åˆã€‚\n>\n>cgroupfsæ˜¯ç”¨æˆ·ç®¡ç†æ“çºµcgroupçš„ä¸»è¦æ¥å£ï¼šé€šè¿‡åœ¨cgroupfsæ–‡ä»¶ç³»ç»Ÿä¸­åˆ›å»ºç›®å½•ï¼Œå®ç°cgroupçš„åˆ›å»ºï¼›é€šè¿‡å‘ç›®å½•ä¸‹çš„å±æ€§æ–‡ä»¶å†™å…¥å†…å®¹ï¼Œè®¾ç½®cgroupå¯¹èµ„æºçš„æ§åˆ¶ï¼›å‘taskå±æ€§æ–‡ä»¶å†™å…¥è¿›ç¨‹IDï¼Œå¯ä»¥å°†è¿›ç¨‹ç»‘å®šåˆ°æŸä¸ªcgroupï¼Œä»¥æ­¤è¾¾åˆ°æ§åˆ¶è¿›ç¨‹èµ„æºä½¿ç”¨çš„ç›®çš„ï¼›ä¹Ÿå¯ä»¥åˆ—å‡ºcgroupåŒ…å«çš„è¿›ç¨‹pidã€‚è¿™äº›æ“ä½œå½±å“çš„æ˜¯sysfså…³è”çš„hierarchyï¼Œå¯¹å…¶å®ƒhierarchyæ²¡æœ‰å½±å“ã€‚\n>\n>å¯¹äºcgroupï¼Œå…¶æœ¬èº«çš„ä½œç”¨åªæ˜¯ä»»åŠ¡è·Ÿè¸ªã€‚ä½†å…¶å®ƒç³»ç»Ÿï¼ˆæ¯”å¦‚cpusetsï¼Œcpuacctï¼‰ï¼Œå¯ä»¥åˆ©ç”¨cgroupçš„è¿™ä¸ªåŠŸèƒ½å®ç°ä¸€äº›æ–°çš„å±æ€§ï¼Œæ¯”å¦‚ç»Ÿè®¡æˆ–è€…æ§åˆ¶ä¸€ä¸ªcgroupä¸­è¿›ç¨‹å¯ä»¥è®¿é—®çš„èµ„æºã€‚ä¸¾ä¸ªä¾‹å­ï¼Œcpusetså­ç³»ç»Ÿå¯ä»¥å°†è¿›ç¨‹ç»‘å®šåˆ°ç‰¹å®šçš„cpuå’Œå†…å­˜èŠ‚ç‚¹ä¸Šã€‚\n\n2 ä¸ºä»€ä¹ˆéœ€è¦cgroup?\n\n>\n>\n>è¿™ä¸ªé—®é¢˜ç›¸å½“äºé—®cgroupé‡è¦å—ï¼Ÿæœ‰å“ªäº›åœ°æ–¹ç”¨åˆ°äº†ã€‚å›ç­”æ˜¯é‡è¦ï¼Œåˆä¸é‡è¦ã€‚å¦‚æœä½ ç”¨åˆ°äº†ï¼Œé‚£å°±é‡è¦ï¼Œå¦‚æœæ²¡æœ‰ç”¨åˆ°ï¼Œé‚£å°±ä¸é‡è¦ã€‚å‘µå‘µå‘µ~~~~å…¶å®æŒºé‡è¦çš„ã€‚cgroupçš„ä¸»è¦è¿ç”¨æ˜¯èµ„æºè·Ÿè¸ªã€‚æˆ‘æ¥è§¦çš„åœºæ™¯å°±æ˜¯ç”¨cgroupæ§åˆ¶è™šæ‹Ÿæœºè¿›ç¨‹æˆ–è€…dockerè¿›ç¨‹å¯ä»¥ä½¿ç”¨çš„èµ„æºã€‚å½“ä½ æƒ³åœ¨linuxå¯¹åº”ç”¨è¿›ç¨‹åšèµ„æºè®¿é—®æ§åˆ¶çš„æ—¶å€™ï¼Œcgroupå°±æ´¾ä¸Šç”¨åœºäº†ã€‚\n\n## 3 cgroupæ€ä¹ˆå®ç°çš„ï¼Ÿ\n\n>â€”â€”    ç³»ç»Ÿä¸­çš„æ¯ä¸ªè¿›ç¨‹ï¼ˆtask_structï¼Œåé¢ç”¨taskä»£æŒ‡ï¼‰éƒ½æŒæœ‰ä¸€ä¸ªæŒ‡å‘css_setç»“æ„çš„æŒ‡é’ˆã€‚\n>\n>â€”â€”    ä¸€ä¸ªcss_setç»“æ„ä½“åŒ…å«äº†ä¸€ç»„æŒ‡å‘cgroup_subsys_stateå¯¹è±¡çš„æŒ‡é’ˆï¼ˆæ‰€ä»¥ä¸€ä¸ªtaskå¯ä»¥é™„åŠ åˆ°å¤šä¸ªcgroupä¸Šï¼‰ï¼Œæ¯ä¸ªcgroup_subsys_stateåœ¨ç³»ç»Ÿä¸­éƒ½æœ‰æ³¨å†Œã€‚taskç»“æ„ä½“æ²¡æœ‰ç›´æ¥æŒ‡å‘hierarchyä¸­ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆcgroupï¼‰çš„æŒ‡é’ˆã€‚ä½†å¯ä»¥é€šè¿‡å…¶åŒ…å«çš„cgroup_subsys_stateé—´æ¥ç¡®å®šã€‚è¿™æ ·è®¾è®¡çš„åŸå› æ˜¯cpuå¯¹subsystem stateçš„è®¿é—®å¾ˆé¢‘ç¹ï¼Œä½†æ¶‰åŠåˆ°å°†taskç»‘å®šåˆ°cgroupçš„æ“ä½œå´ä¸å¤šã€‚taskä¸­è¿˜æœ‰ä¸ªåŒå‘é“¾è¡¨cg_listï¼Œè¿™ä¸ªé“¾è¡¨ç»´æŠ¤æ‰€æœ‰åŒå±äºä¸€ä¸ªcss_setçš„tasksã€‚\n>\n>â€”â€”    ç”¨æˆ·å¯ä»¥é€šè¿‡cgroupfsæ–‡ä»¶ç³»ç»Ÿæ¥æµè§ˆcgroup hierarchyã€‚\n>\n>â€”â€”    ç”¨æˆ·å¯ä»¥åˆ—å‡ºä»»æ„ä¸€ä¸ªcgroupä¸Šé™„ç€çš„task PID\n>\n>cgroupåœ¨kernelä¸­é™¤äº†æœ¬èº«åŠŸèƒ½çš„å®ç°å¤–ï¼Œåœ¨kernelä¸­è¿˜æœ‰ä¸¤å¤„ä¿®æ”¹ï¼š\n>\n>â€”â€”    åœ¨kernelå¯åŠ¨æ—¶å¯¹root cgroupçš„åˆå§‹åŒ–å’Œcss_setç»“æ„ä½“çš„åˆå§‹åŒ–ã€‚è¿™ä¸ªåœ¨init/main.cæ–‡ä»¶ä¸­å®ç°ã€‚\n>\n>â€”â€”    åœ¨taskçš„åˆ›å»ºï¼ˆforkï¼‰å’Œé€€å‡ºï¼ˆexitï¼‰é˜¶æ®µï¼Œå¯¹åº”åœ°å°†taskä¸css_setè¿›è¡Œç»‘å®šå’Œè§£ç»‘ã€‚\n>\n>å¦å¤–ï¼Œcgroupä¸ºäº†å‘ç”¨æˆ·æä¾›æ“ä½œæ¥å£ï¼Œç‰¹åˆ«å¼€å‘äº†ä¸€ä¸ªè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿç±»å‹ï¼ˆcgroupfsï¼‰ï¼Œè¿™ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸sysfsï¼Œprocç±»ä¼¼ã€‚cgroupfsæ˜¯å‘ç”¨æˆ·å±•ç¤ºcgroupçš„hierarchyï¼Œé€šçŸ¥kernelç”¨æˆ·å¯¹cgroupæ”¹åŠ¨çš„çª—å£ã€‚æŒ‚è½½cgroupfsæ—¶é€šè¿‡é€‰é¡¹ï¼ˆ-otypeï¼‰æŒ‡å®šè¦æŒ‚è½½çš„å­ç³»ç»Ÿç±»å‹ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œé»˜è®¤æŒ‚è½½æ‰€æœ‰çš„æ³¨å†Œçš„å­ç³»ç»Ÿã€‚\n>\n>å¦‚æœæ–°æŒ‚è½½çš„cgroupå…³è”çš„hierachyä¸ç³»ç»Ÿä¸­å­˜åœ¨çš„hierarchyå®Œå…¨ä¸€æ ·ï¼Œé‚£ä¹ˆcgroupfsä¼šæ‹’ç»æŒ‚è½½ã€‚å¦‚æœæ²¡æœ‰åŒ¹é…åˆ°ç›¸åŒçš„hierarchyï¼Œä½†æ–°æŒ‚è½½hierachyå£°æ˜çš„èµ„æºæ­£åœ¨è¢«å·²ç»å­˜åœ¨çš„hierarchyä½¿ç”¨ï¼ŒæŒ‚è½½ä¼šæŠ¥-EBUSYé”™è¯¯ã€‚\n>\n>å½“å‰cgroupè¿˜æ²¡æœ‰å®ç°å‘å·²ç»å­˜åœ¨çš„cgroup hierarchyç»‘å®šæ–°å­ç³»ç»Ÿçš„æ“ä½œï¼Œå°†å­ç³»ç»Ÿä»cgroup hierachyè§£ç»‘ä¹Ÿä¸å…è®¸ã€‚è¿™äº›æ“ä½œåœ¨æœªæ¥ä¹Ÿè®¸ä¼šæ”¯æŒï¼Œä½†ä¹Ÿå¯èƒ½ä¼šè¿›ä¸€æ­¥äº§ç”Ÿé”™è¯¯æ¢å¤çš„ä¸€ç³»åˆ—é—®é¢˜ã€‚\n>\n>å¸è½½cgroupfsæ—¶ï¼Œå¦‚æœå®ƒçš„å­cgroupfsè¿˜åœ¨æ´»åŠ¨ï¼Œé‚£ä¹ˆå­cgroupfsè¿˜æ˜¯ä¼šæŒç»­ç”Ÿæ•ˆã€‚ç›´åˆ°æ‰€æœ‰çš„å­cgroupfsä¸å†æ´»åŠ¨ï¼Œå¸è½½cgroupfsæ‰ä¼šçœŸæ­£ç”Ÿæ•ˆã€‚\n>\n>cgroupfsä¸‹ä¸èƒ½å†æŒ‚è½½å…¶å®ƒç±»å‹çš„æ–‡ä»¶ç³»ç»Ÿã€‚æ‰€æœ‰å¯¹cgroupçš„æŸ¥è¯¢ä¿®æ”¹éƒ½åªé€šè¿‡cgroupfsæ–‡ä»¶ç³»ç»Ÿæ¥å®Œæˆã€‚\n>\n>ç³»ç»Ÿä¸­çš„æ‰€æœ‰taskï¼Œåœ¨/proc/pidç›®å½•ä¸‹éƒ½æœ‰ä¸€ä¸ªåä¸ºcgroupçš„æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶å±•ç¤ºäº†è¯¥taskç›¸å¯¹cgroupfs æ ¹çš„è·¯å¾„ã€‚é€šè¿‡æŸ¥çœ‹è¿™ä¸ªæ–‡ä»¶ï¼Œå¯ä»¥äº†è§£ä¸€ä¸ªè¿›ç¨‹åœ¨cgroup hierarchyçš„ä½ç½®ã€‚ä»¥æ­¤å¾—åˆ°taskå¯ä»¥ä½¿ç”¨çš„èµ„æºä¿¡æ¯ã€‚\n>\n>cgroupfsä¸­ç›®å½•è¡¨ç¤ºcgroupï¼Œæ¯ä¸ªç›®å½•åœ¨åˆ›å»ºæ—¶é»˜è®¤ç”Ÿæˆå¦‚ä¸‹çš„å±æ€§æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶æè¿°äº†cgroupçš„ä¿¡æ¯ï¼š\n>\n>â€”â€”    tasks: æ‰€æœ‰é™„å±äºè¿™ä¸ªcgroupçš„è¿›ç¨‹IDåˆ—è¡¨ã€‚tasksæ–‡ä»¶ä¸­å¢åŠ è¿›ç¨‹IDï¼Œè¡¨ç¤ºå°†è¿›ç¨‹åŠ å…¥è¿™ä¸ªcgroupï¼Œè¿›ç¨‹èƒ½å¤Ÿä½¿ç”¨çš„èµ„æºå—cgroupé™åˆ¶ã€‚\n>\n>â€”â€”    cgroup.procs: æ‰€æœ‰é™„å±äºè¿™ä¸ªcgroupçº¿ç¨‹ç»„IDï¼Œå°†TGIDå†™å…¥è¿™ä¸ªæ–‡ä»¶åï¼ŒTGIDæ‰€åœ¨è¿›ç¨‹åŒ…å«çš„æ‰€æœ‰çº¿ç¨‹éƒ½åŠ å…¥è¿™ä¸ªcgroupï¼Œè¿™äº›çº¿ç¨‹å—cgroupé™åˆ¶ã€‚\n\n> PIDï¼šè¿™æ˜¯ Linux ä¸­åœ¨å…¶å‘½åç©ºé—´ä¸­å”¯ä¸€æ ‡è¯†è¿›ç¨‹è€Œåˆ†é…ç»™å®ƒçš„ä¸€ä¸ªå·ç ï¼Œç§°åšè¿›ç¨‹IDå·ï¼Œç®€ç§°PIDã€‚åœ¨ä½¿ç”¨ fork æˆ– clone ç³»ç»Ÿè°ƒç”¨æ—¶äº§ç”Ÿçš„è¿›ç¨‹å‡ä¼šç”±å†…æ ¸åˆ†é…ä¸€ä¸ªæ–°çš„å”¯ä¸€çš„PIDå€¼ã€‚\n> TGIDï¼šåœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œå¦‚æœä»¥CLONE_THREADæ ‡å¿—æ¥è°ƒç”¨cloneå»ºç«‹çš„è¿›ç¨‹å°±æ˜¯è¯¥è¿›ç¨‹çš„ä¸€ä¸ªçº¿ç¨‹ï¼Œå®ƒä»¬å¤„äºä¸€ä¸ªçº¿ç¨‹ç»„ï¼Œè¯¥çº¿ç¨‹ç»„çš„IDå«åšTGIDã€‚å¤„äºç›¸åŒçš„çº¿ç¨‹ç»„ä¸­çš„æ‰€æœ‰è¿›ç¨‹éƒ½æœ‰ç›¸åŒçš„TGIDï¼›çº¿ç¨‹ç»„ç»„é•¿çš„TGIDä¸å…¶PIDç›¸åŒï¼›ä¸€ä¸ªè¿›ç¨‹æ²¡æœ‰ä½¿ç”¨çº¿ç¨‹ï¼Œåˆ™å…¶TGIDä¸PIDä¹Ÿç›¸åŒã€‚\n> PGIDï¼šå¦å¤–ï¼Œç‹¬ç«‹çš„è¿›ç¨‹å¯ä»¥ç»„æˆè¿›ç¨‹ç»„ï¼ˆä½¿ç”¨setpgrpç³»ç»Ÿè°ƒç”¨ï¼‰ï¼Œè¿›ç¨‹ç»„å¯ä»¥ç®€åŒ–å‘æ‰€æœ‰ç»„å†…è¿›ç¨‹å‘é€ä¿¡å·çš„æ“ä½œï¼Œä¾‹å¦‚ç”¨ç®¡é“è¿æ¥çš„è¿›ç¨‹å¤„åœ¨åŒä¸€è¿›ç¨‹ç»„å†…ã€‚è¿›ç¨‹ç»„IDå«åšPGIDï¼Œè¿›ç¨‹ç»„å†…çš„æ‰€æœ‰è¿›ç¨‹éƒ½æœ‰ç›¸åŒçš„PGIDï¼Œç­‰äºè¯¥ç»„ç»„é•¿çš„PIDã€‚\n> SIDï¼šå‡ ä¸ªè¿›ç¨‹ç»„å¯ä»¥åˆå¹¶æˆä¸€ä¸ªä¼šè¯ç»„ï¼ˆä½¿ç”¨setsidç³»ç»Ÿè°ƒç”¨ï¼‰ï¼Œå¯ä»¥ç”¨äºç»ˆç«¯ç¨‹åºè®¾è®¡ã€‚ä¼šè¯ç»„ä¸­æ‰€æœ‰è¿›ç¨‹éƒ½æœ‰ç›¸åŒçš„SIDã€‚\n> â€”â€”    notify_on_release flag: æ ‡è®°é€€å‡ºæ—¶æ˜¯å¦è¿è¡Œrelease agent\n>\n> â€”â€”    release_agent: åˆ¶å®šè¦è¿è¡Œçš„release agentçš„è·¯å¾„ï¼Œè¿™ä¸ªå±æ€§æ–‡ä»¶åªåœ¨cgroupçš„é¡¶å±‚ç›®å½•ä¸­å­˜åœ¨ã€‚\n>\n> ä»¥ä¸Šæ–‡ä»¶æ˜¯æ¯ä¸ªcgroupåŸºæœ¬çš„å±æ€§æ–‡ä»¶ï¼Œå¯¹äºä¸åŒçš„å­ç³»ç»Ÿï¼Œå¯¹åº”çš„cgroupå¯èƒ½ä¼šæœ‰å…¶å®ƒé™„åŠ çš„å±æ€§æ–‡ä»¶ï¼Œå­˜åœ¨äºå…¶å¯¹åº”çš„cgroupç›®å½•ä¹‹ä¸‹ã€‚\n>\n> é€šè¿‡mkdirå‘½ä»¤åˆ›å»ºcgroupï¼Œé€šè¿‡å‘ç›®å½•ä¸‹çš„æ–‡ä»¶å†™å…¥é€‚å½“çš„æ•°å€¼è®¾ç½®ä¿®æ”¹cgroupçš„å±æ€§ã€‚\n>\n> åµŒå¥—çš„cgroupsï¼ŒæŒ‡å®šäº†å±‚çº§ç»“æ„ï¼Œä»¥æ­¤å°†ç³»ç»Ÿèµ„æºåˆ’åˆ†æˆåµŒå¥—çš„ï¼ŒåŠ¨æ€å¯å˜çš„æ›´å°çš„èµ„æºå—ã€‚\n>\n> ä¸€ä¸ªè¿›ç¨‹å¯ä»¥é™„åŠ åˆ°å¤šä¸ªä¸åŒçš„cgroupä¸­ï¼Œåªè¦è¿™äº›cgroupä¸åœ¨åŒä¸€ä¸ªå±‚çº§æ ‘ä¸Šå³å¯ã€‚å› ä¸ºcgroupfsä¼šä¿è¯æ–°æŒ‚è½½çš„cgroupå…³è”çš„å±‚çº§æ ‘å…¨å±€å”¯ä¸€ã€‚å­è¿›ç¨‹åœ¨è¢«åˆ›å»ºåé»˜è®¤é™„åŠ åˆ°çˆ¶è¿›ç¨‹æ‰€åœ¨çš„cgroupï¼Œåé¢ç”¨æˆ·å¯ä»¥æ ¹æ®éœ€è¦å°†å…¶ç§»åŠ¨åˆ°åˆ«çš„cgroupã€‚\n>\n> å½“è¿›ç¨‹ä»ä¸€ä¸ªcgroupè¢«ç§»åŠ¨åˆ°å¦ä¸€ä¸ªcgroupã€‚è¿›ç¨‹çš„task_structä¼šè·å–ä¸€ä¸ªæ–°çš„css_setæŒ‡é’ˆï¼šå¦‚æœè¿™ä¸ªcgroupæ‰€åœ¨çš„css_setå·²ç»å­˜åœ¨å°±é‡ç”¨è¿™ä¸ªcss_setï¼Œå¦åˆ™å°±æ–°åˆ†é…ä¸€ä¸ªcss_setã€‚kernelä¼šåœ¨å…¨å±€çš„hashè¡¨ä¸­æŸ¥æ‰¾ç¡®è®¤cgroupæ‰€å±çš„css_setæ˜¯å¦å­˜åœ¨ã€‚\n\n## 4 notify_on_release æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ\n\n>å¦‚æœcgroupä¸­ä½¿èƒ½notify_on_releaseï¼Œcgroupä¸­çš„æœ€åä¸€ä¸ªè¿›ç¨‹è¢«ç§»é™¤ï¼Œæœ€åä¸€ä¸ªå­cgroupä¹Ÿè¢«åˆ é™¤æ—¶ï¼Œcgroupä¼šä¸»åŠ¨é€šçŸ¥kernelã€‚æ¥æ”¶åˆ°æ¶ˆæ¯çš„kernelä¼šæ‰§è¡Œrelease_agentæ–‡ä»¶ä¸­æŒ‡å®šçš„ç¨‹åºã€‚notify_on_releaseé»˜è®¤æ˜¯å…³é—­çš„ï¼Œrelease_agentçš„å†…å®¹é»˜è®¤ä¸ºç©ºï¼Œå­cgroupåœ¨åˆ›å»ºæ—¶ä¼šç»§æ‰¿çˆ¶cgroupä¸­notify_on_relaseå’Œrelease_agentçš„å±æ€§ã€‚æ‰€ä»¥è¿™ä¸¤ä¸ªæ–‡ä»¶åªå­˜åœ¨äºcgroupfsçš„é¡¶å±‚ç›®å½•ä¸­ã€‚\n\n\n\n## 5 clone_childrenæœ‰ä»€ä¹ˆç”¨ï¼Ÿ\n\n> clone_chilrenä»…é’ˆå¯¹cpuç»‘å®šï¼ˆcpusetï¼‰ï¼Œå¦‚æœclone_childrenä½¿èƒ½ï¼Œæ–°çš„cpuset cgroupåœ¨åˆå§‹åŒ–æ—¶ä¼šç»§æ‰¿çˆ¶cgroupçš„å±æ€§ã€‚\n\n## 6 cgroupæ€ä¹ˆç”¨ï¼Ÿ\n\n>\n>\n>å‡è®¾ç°åœ¨è¦å°†ä¸€ä¸ªæ–°çš„ä»»åŠ¡åŠ å…¥åˆ°cgroupï¼ŒåŠŸèƒ½æ˜¯å°†è¯¥ä»»åŠ¡çš„è¿›ç¨‹åœ¨æŒ‡å®šçš„cpuä¸Šè¿è¡Œï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨\"cpuset\"cgroup å­ç³»ç»Ÿï¼Œæ“ä½œçš„å¤§è‡´æ­¥éª¤å¦‚ä¸‹ï¼š\n>\n>1ï¼‰mount -t tmpfs cgroup_root /sys/fs/cgroup \n>\n>æŒ‚è½½cgroupæ ¹æ–‡ä»¶ç³»ç»Ÿï¼Œç±»å‹ä¸ºtmpfs\n>\n>2ï¼‰mkdir /sys/fs/cgroup/cpuset\n>\n>åœ¨cgroupfsæ ¹ç›®å½•ä¸‹åˆ›å»ºå­cgroupï¼Œåä¸ºcpuset\n>\n>3ï¼‰mount -t cgroup -o cpuset cpuset /sys/fs/cgroup/cpuset\n>\n>å°†åä¸ºcpusetçš„cgroupå…³è”åˆ°cpusetå­ç³»ç»Ÿ\n>\n>4ï¼‰åœ¨cpusetç›®å½•ä¸‹åˆ›å»ºç›®å½•ï¼Œç”Ÿæˆä¸€ä¸ªå­cgroupï¼Œå±æ€§æ–‡ä»¶ä¸­å†™å…¥ç›¸åº”å†…å®¹ï¼Œè®¾ç½®å±æ€§ã€‚\n>\n>5ï¼‰å¯åŠ¨éœ€è¦é™åˆ¶çš„è¿›ç¨‹ï¼ŒæŸ¥æ‰¾å…¶å¯¹åº”çš„è¿›ç¨‹IDï¼Œå°†å…¶å†™å…¥å¯¹åº”çš„taskæ–‡ä»¶ä¸­\n>\n>ä»¥ä¸‹æ“ä½œæ­¥éª¤æ˜¯åˆ›å»ºä¸€ä¸ªåä¸º\"Charlie\"çš„cgroupï¼Œè¿™ä¸ªcgroupçš„èµ„æºåŒ…å«cpu2ï¼Œcpu3å’Œå†…å­˜èŠ‚ç‚¹1ï¼Œå°†shellè¿›ç¨‹é™„åŠ åˆ°è¿™ä¸ªcgroupã€‚\n>\n>mount -t tmpfs cgroup_root /sys/fs/cgroup\n>\n>mkdir /sys/fs/cgroup/cpuset\n>\n>mount -t cgroup cpuset -o cpuset /sys/fs/cgroup/cpuset\n>\n>cd /sys/fs/cgroup/cpuset\n>\n>mkdir Charlie\n>\n>cd Charlie\n>\n>echo 2-3 > cpuset.cpus\n>\n>echo 1 > cpuset.mems\n>\n>echo $$ > tasks\n>\n>sh\n>\n>cat /proc/self/cgroup\n\nè½¬ï¼š\n\n https://blog.csdn.net/huang987246510/article/details/80765628\n","slug":"cgroup","published":1,"updated":"2024-05-16T10:00:13.008Z","_id":"clw8xrfbp00009gw0cohxazat","comments":1,"layout":"post","photos":[],"link":"","content":"<p>[toc]</p>\n<p>cgroupæ˜¯linuxå†…æ ¸å®ç°ã€ç”¨äºæ§åˆ¶linuxç³»ç»Ÿèµ„æºçš„ç»„ä»¶ã€‚å› æ­¤è¦äº†è§£cgroupï¼Œé¦–å…ˆä»å¼•å…¥è¿™ä¸ªç»„ä»¶çš„kernelæ–‡æ¡£ä¸­å¯»æ‰¾ã€‚</p>\n<p>å»åˆ°ä¸¾ä¸–é—»åçš„<a href=\"http://www.kernel.org/\">www.kernel.org</a></p>\n<p>æ‰¾åˆ°ä»‹ç»æ–‡æ¡£ï¼šDocumentation&#x2F;cgroup-v1&#x2F;cgroups.txt</p>\n<h2 id=\"1-ä»€ä¹ˆæ˜¯cgroup\"><a href=\"#1-ä»€ä¹ˆæ˜¯cgroup\" class=\"headerlink\" title=\"1 ä»€ä¹ˆæ˜¯cgroup?\"></a>1 ä»€ä¹ˆæ˜¯cgroup?</h2><blockquote>\n<p>cgroup ï¼Œæ§åˆ¶ç»„ï¼Œå®ƒæä¾›äº†ä¸€å¥—æœºåˆ¶ç”¨äºæ§åˆ¶ä¸€ç»„ç‰¹å®šè¿›ç¨‹å¯¹èµ„æºçš„ä½¿ç”¨ã€‚cgroupç»‘å®šä¸€ä¸ªè¿›ç¨‹é›†åˆåˆ°ä¸€ä¸ªæˆ–å¤šä¸ªå­ç³»ç»Ÿä¸Šã€‚</p>\n<p>subsystemï¼Œå­ç³»ç»Ÿï¼Œä¸€ä¸ªé€šè¿‡cgroupæä¾›çš„å·¥å…·å’Œæ¥å£æ¥ç®¡ç†è¿›ç¨‹é›†åˆçš„æ¨¡å—ã€‚ä¸€ä¸ªå­ç³»ç»Ÿå°±æ˜¯ä¸€ä¸ªå…¸å‹çš„â€œèµ„æºæ§åˆ¶å™¨â€ï¼Œç”¨æ¥è°ƒåº¦èµ„æºæˆ–è€…æ§åˆ¶èµ„æºä½¿ç”¨çš„ä¸Šé™ã€‚å…¶å®æ¯ç§èµ„æºå°±æ˜¯ä¸€ä¸ªå­ç³»ç»Ÿã€‚å­ç³»ç»Ÿå¯ä»¥æ˜¯ä»¥è¿›ç¨‹ä¸ºå•ä½çš„ä»»ä½•ä¸œè¥¿ï¼Œæ¯”å¦‚è™šæ‹ŸåŒ–å­ç³»ç»Ÿã€å†…å­˜å­ç³»ç»Ÿã€‚</p>\n<p>hierarchyï¼Œå±‚çº§æ ‘ï¼Œå¤šä¸ªcgroupçš„é›†åˆï¼Œè¿™äº›é›†åˆæ„æˆçš„æ ‘å«hierarchyã€‚å¯ä»¥è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªèµ„æºæ ‘ï¼Œé™„ç€åœ¨è¿™ä¸Šé¢çš„è¿›ç¨‹å¯ä»¥ä½¿ç”¨çš„èµ„æºä¸Šé™å¿…é¡»å—æ ‘ä¸ŠèŠ‚ç‚¹ï¼ˆcgroupï¼‰çš„æ§åˆ¶ã€‚hierarchyä¸Šçš„å±‚æ¬¡å…³ç³»é€šè¿‡cgroupfsè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿæ˜¾ç¤ºã€‚ç³»ç»Ÿå…è®¸å¤šä¸ªhierarchyåŒæ—¶å­˜åœ¨ï¼Œæ¯ä¸ªhierachyåŒ…å«ç³»ç»Ÿä¸­çš„éƒ¨åˆ†æˆ–è€…å…¨éƒ¨è¿›ç¨‹é›†åˆã€‚</p>\n<p>cgroupfsæ˜¯ç”¨æˆ·ç®¡ç†æ“çºµcgroupçš„ä¸»è¦æ¥å£ï¼šé€šè¿‡åœ¨cgroupfsæ–‡ä»¶ç³»ç»Ÿä¸­åˆ›å»ºç›®å½•ï¼Œå®ç°cgroupçš„åˆ›å»ºï¼›é€šè¿‡å‘ç›®å½•ä¸‹çš„å±æ€§æ–‡ä»¶å†™å…¥å†…å®¹ï¼Œè®¾ç½®cgroupå¯¹èµ„æºçš„æ§åˆ¶ï¼›å‘taskå±æ€§æ–‡ä»¶å†™å…¥è¿›ç¨‹IDï¼Œå¯ä»¥å°†è¿›ç¨‹ç»‘å®šåˆ°æŸä¸ªcgroupï¼Œä»¥æ­¤è¾¾åˆ°æ§åˆ¶è¿›ç¨‹èµ„æºä½¿ç”¨çš„ç›®çš„ï¼›ä¹Ÿå¯ä»¥åˆ—å‡ºcgroupåŒ…å«çš„è¿›ç¨‹pidã€‚è¿™äº›æ“ä½œå½±å“çš„æ˜¯sysfså…³è”çš„hierarchyï¼Œå¯¹å…¶å®ƒhierarchyæ²¡æœ‰å½±å“ã€‚</p>\n<p>å¯¹äºcgroupï¼Œå…¶æœ¬èº«çš„ä½œç”¨åªæ˜¯ä»»åŠ¡è·Ÿè¸ªã€‚ä½†å…¶å®ƒç³»ç»Ÿï¼ˆæ¯”å¦‚cpusetsï¼Œcpuacctï¼‰ï¼Œå¯ä»¥åˆ©ç”¨cgroupçš„è¿™ä¸ªåŠŸèƒ½å®ç°ä¸€äº›æ–°çš„å±æ€§ï¼Œæ¯”å¦‚ç»Ÿè®¡æˆ–è€…æ§åˆ¶ä¸€ä¸ªcgroupä¸­è¿›ç¨‹å¯ä»¥è®¿é—®çš„èµ„æºã€‚ä¸¾ä¸ªä¾‹å­ï¼Œcpusetså­ç³»ç»Ÿå¯ä»¥å°†è¿›ç¨‹ç»‘å®šåˆ°ç‰¹å®šçš„cpuå’Œå†…å­˜èŠ‚ç‚¹ä¸Šã€‚</p>\n</blockquote>\n<p>2 ä¸ºä»€ä¹ˆéœ€è¦cgroup?</p>\n<blockquote>\n<p>è¿™ä¸ªé—®é¢˜ç›¸å½“äºé—®cgroupé‡è¦å—ï¼Ÿæœ‰å“ªäº›åœ°æ–¹ç”¨åˆ°äº†ã€‚å›ç­”æ˜¯é‡è¦ï¼Œåˆä¸é‡è¦ã€‚å¦‚æœä½ ç”¨åˆ°äº†ï¼Œé‚£å°±é‡è¦ï¼Œå¦‚æœæ²¡æœ‰ç”¨åˆ°ï¼Œé‚£å°±ä¸é‡è¦ã€‚å‘µå‘µå‘µ~~~~å…¶å®æŒºé‡è¦çš„ã€‚cgroupçš„ä¸»è¦è¿ç”¨æ˜¯èµ„æºè·Ÿè¸ªã€‚æˆ‘æ¥è§¦çš„åœºæ™¯å°±æ˜¯ç”¨cgroupæ§åˆ¶è™šæ‹Ÿæœºè¿›ç¨‹æˆ–è€…dockerè¿›ç¨‹å¯ä»¥ä½¿ç”¨çš„èµ„æºã€‚å½“ä½ æƒ³åœ¨linuxå¯¹åº”ç”¨è¿›ç¨‹åšèµ„æºè®¿é—®æ§åˆ¶çš„æ—¶å€™ï¼Œcgroupå°±æ´¾ä¸Šç”¨åœºäº†ã€‚</p>\n</blockquote>\n<h2 id=\"3-cgroupæ€ä¹ˆå®ç°çš„ï¼Ÿ\"><a href=\"#3-cgroupæ€ä¹ˆå®ç°çš„ï¼Ÿ\" class=\"headerlink\" title=\"3 cgroupæ€ä¹ˆå®ç°çš„ï¼Ÿ\"></a>3 cgroupæ€ä¹ˆå®ç°çš„ï¼Ÿ</h2><blockquote>\n<p>â€”â€”    ç³»ç»Ÿä¸­çš„æ¯ä¸ªè¿›ç¨‹ï¼ˆtask_structï¼Œåé¢ç”¨taskä»£æŒ‡ï¼‰éƒ½æŒæœ‰ä¸€ä¸ªæŒ‡å‘css_setç»“æ„çš„æŒ‡é’ˆã€‚</p>\n<p>â€”â€”    ä¸€ä¸ªcss_setç»“æ„ä½“åŒ…å«äº†ä¸€ç»„æŒ‡å‘cgroup_subsys_stateå¯¹è±¡çš„æŒ‡é’ˆï¼ˆæ‰€ä»¥ä¸€ä¸ªtaskå¯ä»¥é™„åŠ åˆ°å¤šä¸ªcgroupä¸Šï¼‰ï¼Œæ¯ä¸ªcgroup_subsys_stateåœ¨ç³»ç»Ÿä¸­éƒ½æœ‰æ³¨å†Œã€‚taskç»“æ„ä½“æ²¡æœ‰ç›´æ¥æŒ‡å‘hierarchyä¸­ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆcgroupï¼‰çš„æŒ‡é’ˆã€‚ä½†å¯ä»¥é€šè¿‡å…¶åŒ…å«çš„cgroup_subsys_stateé—´æ¥ç¡®å®šã€‚è¿™æ ·è®¾è®¡çš„åŸå› æ˜¯cpuå¯¹subsystem stateçš„è®¿é—®å¾ˆé¢‘ç¹ï¼Œä½†æ¶‰åŠåˆ°å°†taskç»‘å®šåˆ°cgroupçš„æ“ä½œå´ä¸å¤šã€‚taskä¸­è¿˜æœ‰ä¸ªåŒå‘é“¾è¡¨cg_listï¼Œè¿™ä¸ªé“¾è¡¨ç»´æŠ¤æ‰€æœ‰åŒå±äºä¸€ä¸ªcss_setçš„tasksã€‚</p>\n<p>â€”â€”    ç”¨æˆ·å¯ä»¥é€šè¿‡cgroupfsæ–‡ä»¶ç³»ç»Ÿæ¥æµè§ˆcgroup hierarchyã€‚</p>\n<p>â€”â€”    ç”¨æˆ·å¯ä»¥åˆ—å‡ºä»»æ„ä¸€ä¸ªcgroupä¸Šé™„ç€çš„task PID</p>\n<p>cgroupåœ¨kernelä¸­é™¤äº†æœ¬èº«åŠŸèƒ½çš„å®ç°å¤–ï¼Œåœ¨kernelä¸­è¿˜æœ‰ä¸¤å¤„ä¿®æ”¹ï¼š</p>\n<p>â€”â€”    åœ¨kernelå¯åŠ¨æ—¶å¯¹root cgroupçš„åˆå§‹åŒ–å’Œcss_setç»“æ„ä½“çš„åˆå§‹åŒ–ã€‚è¿™ä¸ªåœ¨init&#x2F;main.cæ–‡ä»¶ä¸­å®ç°ã€‚</p>\n<p>â€”â€”    åœ¨taskçš„åˆ›å»ºï¼ˆforkï¼‰å’Œé€€å‡ºï¼ˆexitï¼‰é˜¶æ®µï¼Œå¯¹åº”åœ°å°†taskä¸css_setè¿›è¡Œç»‘å®šå’Œè§£ç»‘ã€‚</p>\n<p>å¦å¤–ï¼Œcgroupä¸ºäº†å‘ç”¨æˆ·æä¾›æ“ä½œæ¥å£ï¼Œç‰¹åˆ«å¼€å‘äº†ä¸€ä¸ªè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿç±»å‹ï¼ˆcgroupfsï¼‰ï¼Œè¿™ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸sysfsï¼Œprocç±»ä¼¼ã€‚cgroupfsæ˜¯å‘ç”¨æˆ·å±•ç¤ºcgroupçš„hierarchyï¼Œé€šçŸ¥kernelç”¨æˆ·å¯¹cgroupæ”¹åŠ¨çš„çª—å£ã€‚æŒ‚è½½cgroupfsæ—¶é€šè¿‡é€‰é¡¹ï¼ˆ-otypeï¼‰æŒ‡å®šè¦æŒ‚è½½çš„å­ç³»ç»Ÿç±»å‹ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œé»˜è®¤æŒ‚è½½æ‰€æœ‰çš„æ³¨å†Œçš„å­ç³»ç»Ÿã€‚</p>\n<p>å¦‚æœæ–°æŒ‚è½½çš„cgroupå…³è”çš„hierachyä¸ç³»ç»Ÿä¸­å­˜åœ¨çš„hierarchyå®Œå…¨ä¸€æ ·ï¼Œé‚£ä¹ˆcgroupfsä¼šæ‹’ç»æŒ‚è½½ã€‚å¦‚æœæ²¡æœ‰åŒ¹é…åˆ°ç›¸åŒçš„hierarchyï¼Œä½†æ–°æŒ‚è½½hierachyå£°æ˜çš„èµ„æºæ­£åœ¨è¢«å·²ç»å­˜åœ¨çš„hierarchyä½¿ç”¨ï¼ŒæŒ‚è½½ä¼šæŠ¥-EBUSYé”™è¯¯ã€‚</p>\n<p>å½“å‰cgroupè¿˜æ²¡æœ‰å®ç°å‘å·²ç»å­˜åœ¨çš„cgroup hierarchyç»‘å®šæ–°å­ç³»ç»Ÿçš„æ“ä½œï¼Œå°†å­ç³»ç»Ÿä»cgroup hierachyè§£ç»‘ä¹Ÿä¸å…è®¸ã€‚è¿™äº›æ“ä½œåœ¨æœªæ¥ä¹Ÿè®¸ä¼šæ”¯æŒï¼Œä½†ä¹Ÿå¯èƒ½ä¼šè¿›ä¸€æ­¥äº§ç”Ÿé”™è¯¯æ¢å¤çš„ä¸€ç³»åˆ—é—®é¢˜ã€‚</p>\n<p>å¸è½½cgroupfsæ—¶ï¼Œå¦‚æœå®ƒçš„å­cgroupfsè¿˜åœ¨æ´»åŠ¨ï¼Œé‚£ä¹ˆå­cgroupfsè¿˜æ˜¯ä¼šæŒç»­ç”Ÿæ•ˆã€‚ç›´åˆ°æ‰€æœ‰çš„å­cgroupfsä¸å†æ´»åŠ¨ï¼Œå¸è½½cgroupfsæ‰ä¼šçœŸæ­£ç”Ÿæ•ˆã€‚</p>\n<p>cgroupfsä¸‹ä¸èƒ½å†æŒ‚è½½å…¶å®ƒç±»å‹çš„æ–‡ä»¶ç³»ç»Ÿã€‚æ‰€æœ‰å¯¹cgroupçš„æŸ¥è¯¢ä¿®æ”¹éƒ½åªé€šè¿‡cgroupfsæ–‡ä»¶ç³»ç»Ÿæ¥å®Œæˆã€‚</p>\n<p>ç³»ç»Ÿä¸­çš„æ‰€æœ‰taskï¼Œåœ¨&#x2F;proc&#x2F;pidç›®å½•ä¸‹éƒ½æœ‰ä¸€ä¸ªåä¸ºcgroupçš„æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶å±•ç¤ºäº†è¯¥taskç›¸å¯¹cgroupfs æ ¹çš„è·¯å¾„ã€‚é€šè¿‡æŸ¥çœ‹è¿™ä¸ªæ–‡ä»¶ï¼Œå¯ä»¥äº†è§£ä¸€ä¸ªè¿›ç¨‹åœ¨cgroup hierarchyçš„ä½ç½®ã€‚ä»¥æ­¤å¾—åˆ°taskå¯ä»¥ä½¿ç”¨çš„èµ„æºä¿¡æ¯ã€‚</p>\n<p>cgroupfsä¸­ç›®å½•è¡¨ç¤ºcgroupï¼Œæ¯ä¸ªç›®å½•åœ¨åˆ›å»ºæ—¶é»˜è®¤ç”Ÿæˆå¦‚ä¸‹çš„å±æ€§æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶æè¿°äº†cgroupçš„ä¿¡æ¯ï¼š</p>\n<p>â€”â€”    tasks: æ‰€æœ‰é™„å±äºè¿™ä¸ªcgroupçš„è¿›ç¨‹IDåˆ—è¡¨ã€‚tasksæ–‡ä»¶ä¸­å¢åŠ è¿›ç¨‹IDï¼Œè¡¨ç¤ºå°†è¿›ç¨‹åŠ å…¥è¿™ä¸ªcgroupï¼Œè¿›ç¨‹èƒ½å¤Ÿä½¿ç”¨çš„èµ„æºå—cgroupé™åˆ¶ã€‚</p>\n<p>â€”â€”    cgroup.procs: æ‰€æœ‰é™„å±äºè¿™ä¸ªcgroupçº¿ç¨‹ç»„IDï¼Œå°†TGIDå†™å…¥è¿™ä¸ªæ–‡ä»¶åï¼ŒTGIDæ‰€åœ¨è¿›ç¨‹åŒ…å«çš„æ‰€æœ‰çº¿ç¨‹éƒ½åŠ å…¥è¿™ä¸ªcgroupï¼Œè¿™äº›çº¿ç¨‹å—cgroupé™åˆ¶ã€‚</p>\n</blockquote>\n<blockquote>\n<p>PIDï¼šè¿™æ˜¯ Linux ä¸­åœ¨å…¶å‘½åç©ºé—´ä¸­å”¯ä¸€æ ‡è¯†è¿›ç¨‹è€Œåˆ†é…ç»™å®ƒçš„ä¸€ä¸ªå·ç ï¼Œç§°åšè¿›ç¨‹IDå·ï¼Œç®€ç§°PIDã€‚åœ¨ä½¿ç”¨ fork æˆ– clone ç³»ç»Ÿè°ƒç”¨æ—¶äº§ç”Ÿçš„è¿›ç¨‹å‡ä¼šç”±å†…æ ¸åˆ†é…ä¸€ä¸ªæ–°çš„å”¯ä¸€çš„PIDå€¼ã€‚<br>TGIDï¼šåœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œå¦‚æœä»¥CLONE_THREADæ ‡å¿—æ¥è°ƒç”¨cloneå»ºç«‹çš„è¿›ç¨‹å°±æ˜¯è¯¥è¿›ç¨‹çš„ä¸€ä¸ªçº¿ç¨‹ï¼Œå®ƒä»¬å¤„äºä¸€ä¸ªçº¿ç¨‹ç»„ï¼Œè¯¥çº¿ç¨‹ç»„çš„IDå«åšTGIDã€‚å¤„äºç›¸åŒçš„çº¿ç¨‹ç»„ä¸­çš„æ‰€æœ‰è¿›ç¨‹éƒ½æœ‰ç›¸åŒçš„TGIDï¼›çº¿ç¨‹ç»„ç»„é•¿çš„TGIDä¸å…¶PIDç›¸åŒï¼›ä¸€ä¸ªè¿›ç¨‹æ²¡æœ‰ä½¿ç”¨çº¿ç¨‹ï¼Œåˆ™å…¶TGIDä¸PIDä¹Ÿç›¸åŒã€‚<br>PGIDï¼šå¦å¤–ï¼Œç‹¬ç«‹çš„è¿›ç¨‹å¯ä»¥ç»„æˆè¿›ç¨‹ç»„ï¼ˆä½¿ç”¨setpgrpç³»ç»Ÿè°ƒç”¨ï¼‰ï¼Œè¿›ç¨‹ç»„å¯ä»¥ç®€åŒ–å‘æ‰€æœ‰ç»„å†…è¿›ç¨‹å‘é€ä¿¡å·çš„æ“ä½œï¼Œä¾‹å¦‚ç”¨ç®¡é“è¿æ¥çš„è¿›ç¨‹å¤„åœ¨åŒä¸€è¿›ç¨‹ç»„å†…ã€‚è¿›ç¨‹ç»„IDå«åšPGIDï¼Œè¿›ç¨‹ç»„å†…çš„æ‰€æœ‰è¿›ç¨‹éƒ½æœ‰ç›¸åŒçš„PGIDï¼Œç­‰äºè¯¥ç»„ç»„é•¿çš„PIDã€‚<br>SIDï¼šå‡ ä¸ªè¿›ç¨‹ç»„å¯ä»¥åˆå¹¶æˆä¸€ä¸ªä¼šè¯ç»„ï¼ˆä½¿ç”¨setsidç³»ç»Ÿè°ƒç”¨ï¼‰ï¼Œå¯ä»¥ç”¨äºç»ˆç«¯ç¨‹åºè®¾è®¡ã€‚ä¼šè¯ç»„ä¸­æ‰€æœ‰è¿›ç¨‹éƒ½æœ‰ç›¸åŒçš„SIDã€‚<br>â€”â€”    notify_on_release flag: æ ‡è®°é€€å‡ºæ—¶æ˜¯å¦è¿è¡Œrelease agent</p>\n<p>â€”â€”    release_agent: åˆ¶å®šè¦è¿è¡Œçš„release agentçš„è·¯å¾„ï¼Œè¿™ä¸ªå±æ€§æ–‡ä»¶åªåœ¨cgroupçš„é¡¶å±‚ç›®å½•ä¸­å­˜åœ¨ã€‚</p>\n<p>ä»¥ä¸Šæ–‡ä»¶æ˜¯æ¯ä¸ªcgroupåŸºæœ¬çš„å±æ€§æ–‡ä»¶ï¼Œå¯¹äºä¸åŒçš„å­ç³»ç»Ÿï¼Œå¯¹åº”çš„cgroupå¯èƒ½ä¼šæœ‰å…¶å®ƒé™„åŠ çš„å±æ€§æ–‡ä»¶ï¼Œå­˜åœ¨äºå…¶å¯¹åº”çš„cgroupç›®å½•ä¹‹ä¸‹ã€‚</p>\n<p>é€šè¿‡mkdirå‘½ä»¤åˆ›å»ºcgroupï¼Œé€šè¿‡å‘ç›®å½•ä¸‹çš„æ–‡ä»¶å†™å…¥é€‚å½“çš„æ•°å€¼è®¾ç½®ä¿®æ”¹cgroupçš„å±æ€§ã€‚</p>\n<p>åµŒå¥—çš„cgroupsï¼ŒæŒ‡å®šäº†å±‚çº§ç»“æ„ï¼Œä»¥æ­¤å°†ç³»ç»Ÿèµ„æºåˆ’åˆ†æˆåµŒå¥—çš„ï¼ŒåŠ¨æ€å¯å˜çš„æ›´å°çš„èµ„æºå—ã€‚</p>\n<p>ä¸€ä¸ªè¿›ç¨‹å¯ä»¥é™„åŠ åˆ°å¤šä¸ªä¸åŒçš„cgroupä¸­ï¼Œåªè¦è¿™äº›cgroupä¸åœ¨åŒä¸€ä¸ªå±‚çº§æ ‘ä¸Šå³å¯ã€‚å› ä¸ºcgroupfsä¼šä¿è¯æ–°æŒ‚è½½çš„cgroupå…³è”çš„å±‚çº§æ ‘å…¨å±€å”¯ä¸€ã€‚å­è¿›ç¨‹åœ¨è¢«åˆ›å»ºåé»˜è®¤é™„åŠ åˆ°çˆ¶è¿›ç¨‹æ‰€åœ¨çš„cgroupï¼Œåé¢ç”¨æˆ·å¯ä»¥æ ¹æ®éœ€è¦å°†å…¶ç§»åŠ¨åˆ°åˆ«çš„cgroupã€‚</p>\n<p>å½“è¿›ç¨‹ä»ä¸€ä¸ªcgroupè¢«ç§»åŠ¨åˆ°å¦ä¸€ä¸ªcgroupã€‚è¿›ç¨‹çš„task_structä¼šè·å–ä¸€ä¸ªæ–°çš„css_setæŒ‡é’ˆï¼šå¦‚æœè¿™ä¸ªcgroupæ‰€åœ¨çš„css_setå·²ç»å­˜åœ¨å°±é‡ç”¨è¿™ä¸ªcss_setï¼Œå¦åˆ™å°±æ–°åˆ†é…ä¸€ä¸ªcss_setã€‚kernelä¼šåœ¨å…¨å±€çš„hashè¡¨ä¸­æŸ¥æ‰¾ç¡®è®¤cgroupæ‰€å±çš„css_setæ˜¯å¦å­˜åœ¨ã€‚</p>\n</blockquote>\n<h2 id=\"4-notify-on-release-æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ\"><a href=\"#4-notify-on-release-æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ\" class=\"headerlink\" title=\"4 notify_on_release æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ\"></a>4 notify_on_release æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ</h2><blockquote>\n<p>å¦‚æœcgroupä¸­ä½¿èƒ½notify_on_releaseï¼Œcgroupä¸­çš„æœ€åä¸€ä¸ªè¿›ç¨‹è¢«ç§»é™¤ï¼Œæœ€åä¸€ä¸ªå­cgroupä¹Ÿè¢«åˆ é™¤æ—¶ï¼Œcgroupä¼šä¸»åŠ¨é€šçŸ¥kernelã€‚æ¥æ”¶åˆ°æ¶ˆæ¯çš„kernelä¼šæ‰§è¡Œrelease_agentæ–‡ä»¶ä¸­æŒ‡å®šçš„ç¨‹åºã€‚notify_on_releaseé»˜è®¤æ˜¯å…³é—­çš„ï¼Œrelease_agentçš„å†…å®¹é»˜è®¤ä¸ºç©ºï¼Œå­cgroupåœ¨åˆ›å»ºæ—¶ä¼šç»§æ‰¿çˆ¶cgroupä¸­notify_on_relaseå’Œrelease_agentçš„å±æ€§ã€‚æ‰€ä»¥è¿™ä¸¤ä¸ªæ–‡ä»¶åªå­˜åœ¨äºcgroupfsçš„é¡¶å±‚ç›®å½•ä¸­ã€‚</p>\n</blockquote>\n<h2 id=\"5-clone-childrenæœ‰ä»€ä¹ˆç”¨ï¼Ÿ\"><a href=\"#5-clone-childrenæœ‰ä»€ä¹ˆç”¨ï¼Ÿ\" class=\"headerlink\" title=\"5 clone_childrenæœ‰ä»€ä¹ˆç”¨ï¼Ÿ\"></a>5 clone_childrenæœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h2><blockquote>\n<p>clone_chilrenä»…é’ˆå¯¹cpuç»‘å®šï¼ˆcpusetï¼‰ï¼Œå¦‚æœclone_childrenä½¿èƒ½ï¼Œæ–°çš„cpuset cgroupåœ¨åˆå§‹åŒ–æ—¶ä¼šç»§æ‰¿çˆ¶cgroupçš„å±æ€§ã€‚</p>\n</blockquote>\n<h2 id=\"6-cgroupæ€ä¹ˆç”¨ï¼Ÿ\"><a href=\"#6-cgroupæ€ä¹ˆç”¨ï¼Ÿ\" class=\"headerlink\" title=\"6 cgroupæ€ä¹ˆç”¨ï¼Ÿ\"></a>6 cgroupæ€ä¹ˆç”¨ï¼Ÿ</h2><blockquote>\n<p>å‡è®¾ç°åœ¨è¦å°†ä¸€ä¸ªæ–°çš„ä»»åŠ¡åŠ å…¥åˆ°cgroupï¼ŒåŠŸèƒ½æ˜¯å°†è¯¥ä»»åŠ¡çš„è¿›ç¨‹åœ¨æŒ‡å®šçš„cpuä¸Šè¿è¡Œï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨â€cpusetâ€cgroup å­ç³»ç»Ÿï¼Œæ“ä½œçš„å¤§è‡´æ­¥éª¤å¦‚ä¸‹ï¼š</p>\n<p>1ï¼‰mount -t tmpfs cgroup_root &#x2F;sys&#x2F;fs&#x2F;cgroup </p>\n<p>æŒ‚è½½cgroupæ ¹æ–‡ä»¶ç³»ç»Ÿï¼Œç±»å‹ä¸ºtmpfs</p>\n<p>2ï¼‰mkdir &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;cpuset</p>\n<p>åœ¨cgroupfsæ ¹ç›®å½•ä¸‹åˆ›å»ºå­cgroupï¼Œåä¸ºcpuset</p>\n<p>3ï¼‰mount -t cgroup -o cpuset cpuset &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;cpuset</p>\n<p>å°†åä¸ºcpusetçš„cgroupå…³è”åˆ°cpusetå­ç³»ç»Ÿ</p>\n<p>4ï¼‰åœ¨cpusetç›®å½•ä¸‹åˆ›å»ºç›®å½•ï¼Œç”Ÿæˆä¸€ä¸ªå­cgroupï¼Œå±æ€§æ–‡ä»¶ä¸­å†™å…¥ç›¸åº”å†…å®¹ï¼Œè®¾ç½®å±æ€§ã€‚</p>\n<p>5ï¼‰å¯åŠ¨éœ€è¦é™åˆ¶çš„è¿›ç¨‹ï¼ŒæŸ¥æ‰¾å…¶å¯¹åº”çš„è¿›ç¨‹IDï¼Œå°†å…¶å†™å…¥å¯¹åº”çš„taskæ–‡ä»¶ä¸­</p>\n<p>ä»¥ä¸‹æ“ä½œæ­¥éª¤æ˜¯åˆ›å»ºä¸€ä¸ªåä¸ºâ€Charlieâ€çš„cgroupï¼Œè¿™ä¸ªcgroupçš„èµ„æºåŒ…å«cpu2ï¼Œcpu3å’Œå†…å­˜èŠ‚ç‚¹1ï¼Œå°†shellè¿›ç¨‹é™„åŠ åˆ°è¿™ä¸ªcgroupã€‚</p>\n<p>mount -t tmpfs cgroup_root &#x2F;sys&#x2F;fs&#x2F;cgroup</p>\n<p>mkdir &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;cpuset</p>\n<p>mount -t cgroup cpuset -o cpuset &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;cpuset</p>\n<p>cd &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;cpuset</p>\n<p>mkdir Charlie</p>\n<p>cd Charlie</p>\n<p>echo 2-3 &gt; cpuset.cpus</p>\n<p>echo 1 &gt; cpuset.mems</p>\n<p>echo $$ &gt; tasks</p>\n<p>sh</p>\n<p>cat &#x2F;proc&#x2F;self&#x2F;cgroup</p>\n</blockquote>\n<p>è½¬ï¼š</p>\n<p> <a href=\"https://blog.csdn.net/huang987246510/article/details/80765628\">https://blog.csdn.net/huang987246510/article/details/80765628</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p>[toc]</p>\n<p>cgroupæ˜¯linuxå†…æ ¸å®ç°ã€ç”¨äºæ§åˆ¶linuxç³»ç»Ÿèµ„æºçš„ç»„ä»¶ã€‚å› æ­¤è¦äº†è§£cgroupï¼Œé¦–å…ˆä»å¼•å…¥è¿™ä¸ªç»„ä»¶çš„kernelæ–‡æ¡£ä¸­å¯»æ‰¾ã€‚</p>\n<p>å»åˆ°ä¸¾ä¸–é—»åçš„<a href=\"http://www.kernel.org/\">www.kernel.org</a></p>\n<p>æ‰¾åˆ°ä»‹ç»æ–‡æ¡£ï¼šDocumentation&#x2F;cgroup-v1&#x2F;cgroups.txt</p>\n<h2 id=\"1-ä»€ä¹ˆæ˜¯cgroup\"><a href=\"#1-ä»€ä¹ˆæ˜¯cgroup\" class=\"headerlink\" title=\"1 ä»€ä¹ˆæ˜¯cgroup?\"></a>1 ä»€ä¹ˆæ˜¯cgroup?</h2><blockquote>\n<p>cgroup ï¼Œæ§åˆ¶ç»„ï¼Œå®ƒæä¾›äº†ä¸€å¥—æœºåˆ¶ç”¨äºæ§åˆ¶ä¸€ç»„ç‰¹å®šè¿›ç¨‹å¯¹èµ„æºçš„ä½¿ç”¨ã€‚cgroupç»‘å®šä¸€ä¸ªè¿›ç¨‹é›†åˆåˆ°ä¸€ä¸ªæˆ–å¤šä¸ªå­ç³»ç»Ÿä¸Šã€‚</p>\n<p>subsystemï¼Œå­ç³»ç»Ÿï¼Œä¸€ä¸ªé€šè¿‡cgroupæä¾›çš„å·¥å…·å’Œæ¥å£æ¥ç®¡ç†è¿›ç¨‹é›†åˆçš„æ¨¡å—ã€‚ä¸€ä¸ªå­ç³»ç»Ÿå°±æ˜¯ä¸€ä¸ªå…¸å‹çš„â€œèµ„æºæ§åˆ¶å™¨â€ï¼Œç”¨æ¥è°ƒåº¦èµ„æºæˆ–è€…æ§åˆ¶èµ„æºä½¿ç”¨çš„ä¸Šé™ã€‚å…¶å®æ¯ç§èµ„æºå°±æ˜¯ä¸€ä¸ªå­ç³»ç»Ÿã€‚å­ç³»ç»Ÿå¯ä»¥æ˜¯ä»¥è¿›ç¨‹ä¸ºå•ä½çš„ä»»ä½•ä¸œè¥¿ï¼Œæ¯”å¦‚è™šæ‹ŸåŒ–å­ç³»ç»Ÿã€å†…å­˜å­ç³»ç»Ÿã€‚</p>\n<p>hierarchyï¼Œå±‚çº§æ ‘ï¼Œå¤šä¸ªcgroupçš„é›†åˆï¼Œè¿™äº›é›†åˆæ„æˆçš„æ ‘å«hierarchyã€‚å¯ä»¥è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªèµ„æºæ ‘ï¼Œé™„ç€åœ¨è¿™ä¸Šé¢çš„è¿›ç¨‹å¯ä»¥ä½¿ç”¨çš„èµ„æºä¸Šé™å¿…é¡»å—æ ‘ä¸ŠèŠ‚ç‚¹ï¼ˆcgroupï¼‰çš„æ§åˆ¶ã€‚hierarchyä¸Šçš„å±‚æ¬¡å…³ç³»é€šè¿‡cgroupfsè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿæ˜¾ç¤ºã€‚ç³»ç»Ÿå…è®¸å¤šä¸ªhierarchyåŒæ—¶å­˜åœ¨ï¼Œæ¯ä¸ªhierachyåŒ…å«ç³»ç»Ÿä¸­çš„éƒ¨åˆ†æˆ–è€…å…¨éƒ¨è¿›ç¨‹é›†åˆã€‚</p>\n<p>cgroupfsæ˜¯ç”¨æˆ·ç®¡ç†æ“çºµcgroupçš„ä¸»è¦æ¥å£ï¼šé€šè¿‡åœ¨cgroupfsæ–‡ä»¶ç³»ç»Ÿä¸­åˆ›å»ºç›®å½•ï¼Œå®ç°cgroupçš„åˆ›å»ºï¼›é€šè¿‡å‘ç›®å½•ä¸‹çš„å±æ€§æ–‡ä»¶å†™å…¥å†…å®¹ï¼Œè®¾ç½®cgroupå¯¹èµ„æºçš„æ§åˆ¶ï¼›å‘taskå±æ€§æ–‡ä»¶å†™å…¥è¿›ç¨‹IDï¼Œå¯ä»¥å°†è¿›ç¨‹ç»‘å®šåˆ°æŸä¸ªcgroupï¼Œä»¥æ­¤è¾¾åˆ°æ§åˆ¶è¿›ç¨‹èµ„æºä½¿ç”¨çš„ç›®çš„ï¼›ä¹Ÿå¯ä»¥åˆ—å‡ºcgroupåŒ…å«çš„è¿›ç¨‹pidã€‚è¿™äº›æ“ä½œå½±å“çš„æ˜¯sysfså…³è”çš„hierarchyï¼Œå¯¹å…¶å®ƒhierarchyæ²¡æœ‰å½±å“ã€‚</p>\n<p>å¯¹äºcgroupï¼Œå…¶æœ¬èº«çš„ä½œç”¨åªæ˜¯ä»»åŠ¡è·Ÿè¸ªã€‚ä½†å…¶å®ƒç³»ç»Ÿï¼ˆæ¯”å¦‚cpusetsï¼Œcpuacctï¼‰ï¼Œå¯ä»¥åˆ©ç”¨cgroupçš„è¿™ä¸ªåŠŸèƒ½å®ç°ä¸€äº›æ–°çš„å±æ€§ï¼Œæ¯”å¦‚ç»Ÿè®¡æˆ–è€…æ§åˆ¶ä¸€ä¸ªcgroupä¸­è¿›ç¨‹å¯ä»¥è®¿é—®çš„èµ„æºã€‚ä¸¾ä¸ªä¾‹å­ï¼Œcpusetså­ç³»ç»Ÿå¯ä»¥å°†è¿›ç¨‹ç»‘å®šåˆ°ç‰¹å®šçš„cpuå’Œå†…å­˜èŠ‚ç‚¹ä¸Šã€‚</p>\n</blockquote>\n<p>2 ä¸ºä»€ä¹ˆéœ€è¦cgroup?</p>\n<blockquote>\n<p>è¿™ä¸ªé—®é¢˜ç›¸å½“äºé—®cgroupé‡è¦å—ï¼Ÿæœ‰å“ªäº›åœ°æ–¹ç”¨åˆ°äº†ã€‚å›ç­”æ˜¯é‡è¦ï¼Œåˆä¸é‡è¦ã€‚å¦‚æœä½ ç”¨åˆ°äº†ï¼Œé‚£å°±é‡è¦ï¼Œå¦‚æœæ²¡æœ‰ç”¨åˆ°ï¼Œé‚£å°±ä¸é‡è¦ã€‚å‘µå‘µå‘µ~~~~å…¶å®æŒºé‡è¦çš„ã€‚cgroupçš„ä¸»è¦è¿ç”¨æ˜¯èµ„æºè·Ÿè¸ªã€‚æˆ‘æ¥è§¦çš„åœºæ™¯å°±æ˜¯ç”¨cgroupæ§åˆ¶è™šæ‹Ÿæœºè¿›ç¨‹æˆ–è€…dockerè¿›ç¨‹å¯ä»¥ä½¿ç”¨çš„èµ„æºã€‚å½“ä½ æƒ³åœ¨linuxå¯¹åº”ç”¨è¿›ç¨‹åšèµ„æºè®¿é—®æ§åˆ¶çš„æ—¶å€™ï¼Œcgroupå°±æ´¾ä¸Šç”¨åœºäº†ã€‚</p>\n</blockquote>\n<h2 id=\"3-cgroupæ€ä¹ˆå®ç°çš„ï¼Ÿ\"><a href=\"#3-cgroupæ€ä¹ˆå®ç°çš„ï¼Ÿ\" class=\"headerlink\" title=\"3 cgroupæ€ä¹ˆå®ç°çš„ï¼Ÿ\"></a>3 cgroupæ€ä¹ˆå®ç°çš„ï¼Ÿ</h2><blockquote>\n<p>â€”â€”    ç³»ç»Ÿä¸­çš„æ¯ä¸ªè¿›ç¨‹ï¼ˆtask_structï¼Œåé¢ç”¨taskä»£æŒ‡ï¼‰éƒ½æŒæœ‰ä¸€ä¸ªæŒ‡å‘css_setç»“æ„çš„æŒ‡é’ˆã€‚</p>\n<p>â€”â€”    ä¸€ä¸ªcss_setç»“æ„ä½“åŒ…å«äº†ä¸€ç»„æŒ‡å‘cgroup_subsys_stateå¯¹è±¡çš„æŒ‡é’ˆï¼ˆæ‰€ä»¥ä¸€ä¸ªtaskå¯ä»¥é™„åŠ åˆ°å¤šä¸ªcgroupä¸Šï¼‰ï¼Œæ¯ä¸ªcgroup_subsys_stateåœ¨ç³»ç»Ÿä¸­éƒ½æœ‰æ³¨å†Œã€‚taskç»“æ„ä½“æ²¡æœ‰ç›´æ¥æŒ‡å‘hierarchyä¸­ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆcgroupï¼‰çš„æŒ‡é’ˆã€‚ä½†å¯ä»¥é€šè¿‡å…¶åŒ…å«çš„cgroup_subsys_stateé—´æ¥ç¡®å®šã€‚è¿™æ ·è®¾è®¡çš„åŸå› æ˜¯cpuå¯¹subsystem stateçš„è®¿é—®å¾ˆé¢‘ç¹ï¼Œä½†æ¶‰åŠåˆ°å°†taskç»‘å®šåˆ°cgroupçš„æ“ä½œå´ä¸å¤šã€‚taskä¸­è¿˜æœ‰ä¸ªåŒå‘é“¾è¡¨cg_listï¼Œè¿™ä¸ªé“¾è¡¨ç»´æŠ¤æ‰€æœ‰åŒå±äºä¸€ä¸ªcss_setçš„tasksã€‚</p>\n<p>â€”â€”    ç”¨æˆ·å¯ä»¥é€šè¿‡cgroupfsæ–‡ä»¶ç³»ç»Ÿæ¥æµè§ˆcgroup hierarchyã€‚</p>\n<p>â€”â€”    ç”¨æˆ·å¯ä»¥åˆ—å‡ºä»»æ„ä¸€ä¸ªcgroupä¸Šé™„ç€çš„task PID</p>\n<p>cgroupåœ¨kernelä¸­é™¤äº†æœ¬èº«åŠŸèƒ½çš„å®ç°å¤–ï¼Œåœ¨kernelä¸­è¿˜æœ‰ä¸¤å¤„ä¿®æ”¹ï¼š</p>\n<p>â€”â€”    åœ¨kernelå¯åŠ¨æ—¶å¯¹root cgroupçš„åˆå§‹åŒ–å’Œcss_setç»“æ„ä½“çš„åˆå§‹åŒ–ã€‚è¿™ä¸ªåœ¨init&#x2F;main.cæ–‡ä»¶ä¸­å®ç°ã€‚</p>\n<p>â€”â€”    åœ¨taskçš„åˆ›å»ºï¼ˆforkï¼‰å’Œé€€å‡ºï¼ˆexitï¼‰é˜¶æ®µï¼Œå¯¹åº”åœ°å°†taskä¸css_setè¿›è¡Œç»‘å®šå’Œè§£ç»‘ã€‚</p>\n<p>å¦å¤–ï¼Œcgroupä¸ºäº†å‘ç”¨æˆ·æä¾›æ“ä½œæ¥å£ï¼Œç‰¹åˆ«å¼€å‘äº†ä¸€ä¸ªè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿç±»å‹ï¼ˆcgroupfsï¼‰ï¼Œè¿™ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸sysfsï¼Œprocç±»ä¼¼ã€‚cgroupfsæ˜¯å‘ç”¨æˆ·å±•ç¤ºcgroupçš„hierarchyï¼Œé€šçŸ¥kernelç”¨æˆ·å¯¹cgroupæ”¹åŠ¨çš„çª—å£ã€‚æŒ‚è½½cgroupfsæ—¶é€šè¿‡é€‰é¡¹ï¼ˆ-otypeï¼‰æŒ‡å®šè¦æŒ‚è½½çš„å­ç³»ç»Ÿç±»å‹ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œé»˜è®¤æŒ‚è½½æ‰€æœ‰çš„æ³¨å†Œçš„å­ç³»ç»Ÿã€‚</p>\n<p>å¦‚æœæ–°æŒ‚è½½çš„cgroupå…³è”çš„hierachyä¸ç³»ç»Ÿä¸­å­˜åœ¨çš„hierarchyå®Œå…¨ä¸€æ ·ï¼Œé‚£ä¹ˆcgroupfsä¼šæ‹’ç»æŒ‚è½½ã€‚å¦‚æœæ²¡æœ‰åŒ¹é…åˆ°ç›¸åŒçš„hierarchyï¼Œä½†æ–°æŒ‚è½½hierachyå£°æ˜çš„èµ„æºæ­£åœ¨è¢«å·²ç»å­˜åœ¨çš„hierarchyä½¿ç”¨ï¼ŒæŒ‚è½½ä¼šæŠ¥-EBUSYé”™è¯¯ã€‚</p>\n<p>å½“å‰cgroupè¿˜æ²¡æœ‰å®ç°å‘å·²ç»å­˜åœ¨çš„cgroup hierarchyç»‘å®šæ–°å­ç³»ç»Ÿçš„æ“ä½œï¼Œå°†å­ç³»ç»Ÿä»cgroup hierachyè§£ç»‘ä¹Ÿä¸å…è®¸ã€‚è¿™äº›æ“ä½œåœ¨æœªæ¥ä¹Ÿè®¸ä¼šæ”¯æŒï¼Œä½†ä¹Ÿå¯èƒ½ä¼šè¿›ä¸€æ­¥äº§ç”Ÿé”™è¯¯æ¢å¤çš„ä¸€ç³»åˆ—é—®é¢˜ã€‚</p>\n<p>å¸è½½cgroupfsæ—¶ï¼Œå¦‚æœå®ƒçš„å­cgroupfsè¿˜åœ¨æ´»åŠ¨ï¼Œé‚£ä¹ˆå­cgroupfsè¿˜æ˜¯ä¼šæŒç»­ç”Ÿæ•ˆã€‚ç›´åˆ°æ‰€æœ‰çš„å­cgroupfsä¸å†æ´»åŠ¨ï¼Œå¸è½½cgroupfsæ‰ä¼šçœŸæ­£ç”Ÿæ•ˆã€‚</p>\n<p>cgroupfsä¸‹ä¸èƒ½å†æŒ‚è½½å…¶å®ƒç±»å‹çš„æ–‡ä»¶ç³»ç»Ÿã€‚æ‰€æœ‰å¯¹cgroupçš„æŸ¥è¯¢ä¿®æ”¹éƒ½åªé€šè¿‡cgroupfsæ–‡ä»¶ç³»ç»Ÿæ¥å®Œæˆã€‚</p>\n<p>ç³»ç»Ÿä¸­çš„æ‰€æœ‰taskï¼Œåœ¨&#x2F;proc&#x2F;pidç›®å½•ä¸‹éƒ½æœ‰ä¸€ä¸ªåä¸ºcgroupçš„æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶å±•ç¤ºäº†è¯¥taskç›¸å¯¹cgroupfs æ ¹çš„è·¯å¾„ã€‚é€šè¿‡æŸ¥çœ‹è¿™ä¸ªæ–‡ä»¶ï¼Œå¯ä»¥äº†è§£ä¸€ä¸ªè¿›ç¨‹åœ¨cgroup hierarchyçš„ä½ç½®ã€‚ä»¥æ­¤å¾—åˆ°taskå¯ä»¥ä½¿ç”¨çš„èµ„æºä¿¡æ¯ã€‚</p>\n<p>cgroupfsä¸­ç›®å½•è¡¨ç¤ºcgroupï¼Œæ¯ä¸ªç›®å½•åœ¨åˆ›å»ºæ—¶é»˜è®¤ç”Ÿæˆå¦‚ä¸‹çš„å±æ€§æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶æè¿°äº†cgroupçš„ä¿¡æ¯ï¼š</p>\n<p>â€”â€”    tasks: æ‰€æœ‰é™„å±äºè¿™ä¸ªcgroupçš„è¿›ç¨‹IDåˆ—è¡¨ã€‚tasksæ–‡ä»¶ä¸­å¢åŠ è¿›ç¨‹IDï¼Œè¡¨ç¤ºå°†è¿›ç¨‹åŠ å…¥è¿™ä¸ªcgroupï¼Œè¿›ç¨‹èƒ½å¤Ÿä½¿ç”¨çš„èµ„æºå—cgroupé™åˆ¶ã€‚</p>\n<p>â€”â€”    cgroup.procs: æ‰€æœ‰é™„å±äºè¿™ä¸ªcgroupçº¿ç¨‹ç»„IDï¼Œå°†TGIDå†™å…¥è¿™ä¸ªæ–‡ä»¶åï¼ŒTGIDæ‰€åœ¨è¿›ç¨‹åŒ…å«çš„æ‰€æœ‰çº¿ç¨‹éƒ½åŠ å…¥è¿™ä¸ªcgroupï¼Œè¿™äº›çº¿ç¨‹å—cgroupé™åˆ¶ã€‚</p>\n</blockquote>\n<blockquote>\n<p>PIDï¼šè¿™æ˜¯ Linux ä¸­åœ¨å…¶å‘½åç©ºé—´ä¸­å”¯ä¸€æ ‡è¯†è¿›ç¨‹è€Œåˆ†é…ç»™å®ƒçš„ä¸€ä¸ªå·ç ï¼Œç§°åšè¿›ç¨‹IDå·ï¼Œç®€ç§°PIDã€‚åœ¨ä½¿ç”¨ fork æˆ– clone ç³»ç»Ÿè°ƒç”¨æ—¶äº§ç”Ÿçš„è¿›ç¨‹å‡ä¼šç”±å†…æ ¸åˆ†é…ä¸€ä¸ªæ–°çš„å”¯ä¸€çš„PIDå€¼ã€‚<br>TGIDï¼šåœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œå¦‚æœä»¥CLONE_THREADæ ‡å¿—æ¥è°ƒç”¨cloneå»ºç«‹çš„è¿›ç¨‹å°±æ˜¯è¯¥è¿›ç¨‹çš„ä¸€ä¸ªçº¿ç¨‹ï¼Œå®ƒä»¬å¤„äºä¸€ä¸ªçº¿ç¨‹ç»„ï¼Œè¯¥çº¿ç¨‹ç»„çš„IDå«åšTGIDã€‚å¤„äºç›¸åŒçš„çº¿ç¨‹ç»„ä¸­çš„æ‰€æœ‰è¿›ç¨‹éƒ½æœ‰ç›¸åŒçš„TGIDï¼›çº¿ç¨‹ç»„ç»„é•¿çš„TGIDä¸å…¶PIDç›¸åŒï¼›ä¸€ä¸ªè¿›ç¨‹æ²¡æœ‰ä½¿ç”¨çº¿ç¨‹ï¼Œåˆ™å…¶TGIDä¸PIDä¹Ÿç›¸åŒã€‚<br>PGIDï¼šå¦å¤–ï¼Œç‹¬ç«‹çš„è¿›ç¨‹å¯ä»¥ç»„æˆè¿›ç¨‹ç»„ï¼ˆä½¿ç”¨setpgrpç³»ç»Ÿè°ƒç”¨ï¼‰ï¼Œè¿›ç¨‹ç»„å¯ä»¥ç®€åŒ–å‘æ‰€æœ‰ç»„å†…è¿›ç¨‹å‘é€ä¿¡å·çš„æ“ä½œï¼Œä¾‹å¦‚ç”¨ç®¡é“è¿æ¥çš„è¿›ç¨‹å¤„åœ¨åŒä¸€è¿›ç¨‹ç»„å†…ã€‚è¿›ç¨‹ç»„IDå«åšPGIDï¼Œè¿›ç¨‹ç»„å†…çš„æ‰€æœ‰è¿›ç¨‹éƒ½æœ‰ç›¸åŒçš„PGIDï¼Œç­‰äºè¯¥ç»„ç»„é•¿çš„PIDã€‚<br>SIDï¼šå‡ ä¸ªè¿›ç¨‹ç»„å¯ä»¥åˆå¹¶æˆä¸€ä¸ªä¼šè¯ç»„ï¼ˆä½¿ç”¨setsidç³»ç»Ÿè°ƒç”¨ï¼‰ï¼Œå¯ä»¥ç”¨äºç»ˆç«¯ç¨‹åºè®¾è®¡ã€‚ä¼šè¯ç»„ä¸­æ‰€æœ‰è¿›ç¨‹éƒ½æœ‰ç›¸åŒçš„SIDã€‚<br>â€”â€”    notify_on_release flag: æ ‡è®°é€€å‡ºæ—¶æ˜¯å¦è¿è¡Œrelease agent</p>\n<p>â€”â€”    release_agent: åˆ¶å®šè¦è¿è¡Œçš„release agentçš„è·¯å¾„ï¼Œè¿™ä¸ªå±æ€§æ–‡ä»¶åªåœ¨cgroupçš„é¡¶å±‚ç›®å½•ä¸­å­˜åœ¨ã€‚</p>\n<p>ä»¥ä¸Šæ–‡ä»¶æ˜¯æ¯ä¸ªcgroupåŸºæœ¬çš„å±æ€§æ–‡ä»¶ï¼Œå¯¹äºä¸åŒçš„å­ç³»ç»Ÿï¼Œå¯¹åº”çš„cgroupå¯èƒ½ä¼šæœ‰å…¶å®ƒé™„åŠ çš„å±æ€§æ–‡ä»¶ï¼Œå­˜åœ¨äºå…¶å¯¹åº”çš„cgroupç›®å½•ä¹‹ä¸‹ã€‚</p>\n<p>é€šè¿‡mkdirå‘½ä»¤åˆ›å»ºcgroupï¼Œé€šè¿‡å‘ç›®å½•ä¸‹çš„æ–‡ä»¶å†™å…¥é€‚å½“çš„æ•°å€¼è®¾ç½®ä¿®æ”¹cgroupçš„å±æ€§ã€‚</p>\n<p>åµŒå¥—çš„cgroupsï¼ŒæŒ‡å®šäº†å±‚çº§ç»“æ„ï¼Œä»¥æ­¤å°†ç³»ç»Ÿèµ„æºåˆ’åˆ†æˆåµŒå¥—çš„ï¼ŒåŠ¨æ€å¯å˜çš„æ›´å°çš„èµ„æºå—ã€‚</p>\n<p>ä¸€ä¸ªè¿›ç¨‹å¯ä»¥é™„åŠ åˆ°å¤šä¸ªä¸åŒçš„cgroupä¸­ï¼Œåªè¦è¿™äº›cgroupä¸åœ¨åŒä¸€ä¸ªå±‚çº§æ ‘ä¸Šå³å¯ã€‚å› ä¸ºcgroupfsä¼šä¿è¯æ–°æŒ‚è½½çš„cgroupå…³è”çš„å±‚çº§æ ‘å…¨å±€å”¯ä¸€ã€‚å­è¿›ç¨‹åœ¨è¢«åˆ›å»ºåé»˜è®¤é™„åŠ åˆ°çˆ¶è¿›ç¨‹æ‰€åœ¨çš„cgroupï¼Œåé¢ç”¨æˆ·å¯ä»¥æ ¹æ®éœ€è¦å°†å…¶ç§»åŠ¨åˆ°åˆ«çš„cgroupã€‚</p>\n<p>å½“è¿›ç¨‹ä»ä¸€ä¸ªcgroupè¢«ç§»åŠ¨åˆ°å¦ä¸€ä¸ªcgroupã€‚è¿›ç¨‹çš„task_structä¼šè·å–ä¸€ä¸ªæ–°çš„css_setæŒ‡é’ˆï¼šå¦‚æœè¿™ä¸ªcgroupæ‰€åœ¨çš„css_setå·²ç»å­˜åœ¨å°±é‡ç”¨è¿™ä¸ªcss_setï¼Œå¦åˆ™å°±æ–°åˆ†é…ä¸€ä¸ªcss_setã€‚kernelä¼šåœ¨å…¨å±€çš„hashè¡¨ä¸­æŸ¥æ‰¾ç¡®è®¤cgroupæ‰€å±çš„css_setæ˜¯å¦å­˜åœ¨ã€‚</p>\n</blockquote>\n<h2 id=\"4-notify-on-release-æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ\"><a href=\"#4-notify-on-release-æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ\" class=\"headerlink\" title=\"4 notify_on_release æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ\"></a>4 notify_on_release æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ</h2><blockquote>\n<p>å¦‚æœcgroupä¸­ä½¿èƒ½notify_on_releaseï¼Œcgroupä¸­çš„æœ€åä¸€ä¸ªè¿›ç¨‹è¢«ç§»é™¤ï¼Œæœ€åä¸€ä¸ªå­cgroupä¹Ÿè¢«åˆ é™¤æ—¶ï¼Œcgroupä¼šä¸»åŠ¨é€šçŸ¥kernelã€‚æ¥æ”¶åˆ°æ¶ˆæ¯çš„kernelä¼šæ‰§è¡Œrelease_agentæ–‡ä»¶ä¸­æŒ‡å®šçš„ç¨‹åºã€‚notify_on_releaseé»˜è®¤æ˜¯å…³é—­çš„ï¼Œrelease_agentçš„å†…å®¹é»˜è®¤ä¸ºç©ºï¼Œå­cgroupåœ¨åˆ›å»ºæ—¶ä¼šç»§æ‰¿çˆ¶cgroupä¸­notify_on_relaseå’Œrelease_agentçš„å±æ€§ã€‚æ‰€ä»¥è¿™ä¸¤ä¸ªæ–‡ä»¶åªå­˜åœ¨äºcgroupfsçš„é¡¶å±‚ç›®å½•ä¸­ã€‚</p>\n</blockquote>\n<h2 id=\"5-clone-childrenæœ‰ä»€ä¹ˆç”¨ï¼Ÿ\"><a href=\"#5-clone-childrenæœ‰ä»€ä¹ˆç”¨ï¼Ÿ\" class=\"headerlink\" title=\"5 clone_childrenæœ‰ä»€ä¹ˆç”¨ï¼Ÿ\"></a>5 clone_childrenæœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h2><blockquote>\n<p>clone_chilrenä»…é’ˆå¯¹cpuç»‘å®šï¼ˆcpusetï¼‰ï¼Œå¦‚æœclone_childrenä½¿èƒ½ï¼Œæ–°çš„cpuset cgroupåœ¨åˆå§‹åŒ–æ—¶ä¼šç»§æ‰¿çˆ¶cgroupçš„å±æ€§ã€‚</p>\n</blockquote>\n<h2 id=\"6-cgroupæ€ä¹ˆç”¨ï¼Ÿ\"><a href=\"#6-cgroupæ€ä¹ˆç”¨ï¼Ÿ\" class=\"headerlink\" title=\"6 cgroupæ€ä¹ˆç”¨ï¼Ÿ\"></a>6 cgroupæ€ä¹ˆç”¨ï¼Ÿ</h2><blockquote>\n<p>å‡è®¾ç°åœ¨è¦å°†ä¸€ä¸ªæ–°çš„ä»»åŠ¡åŠ å…¥åˆ°cgroupï¼ŒåŠŸèƒ½æ˜¯å°†è¯¥ä»»åŠ¡çš„è¿›ç¨‹åœ¨æŒ‡å®šçš„cpuä¸Šè¿è¡Œï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨â€cpusetâ€cgroup å­ç³»ç»Ÿï¼Œæ“ä½œçš„å¤§è‡´æ­¥éª¤å¦‚ä¸‹ï¼š</p>\n<p>1ï¼‰mount -t tmpfs cgroup_root &#x2F;sys&#x2F;fs&#x2F;cgroup </p>\n<p>æŒ‚è½½cgroupæ ¹æ–‡ä»¶ç³»ç»Ÿï¼Œç±»å‹ä¸ºtmpfs</p>\n<p>2ï¼‰mkdir &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;cpuset</p>\n<p>åœ¨cgroupfsæ ¹ç›®å½•ä¸‹åˆ›å»ºå­cgroupï¼Œåä¸ºcpuset</p>\n<p>3ï¼‰mount -t cgroup -o cpuset cpuset &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;cpuset</p>\n<p>å°†åä¸ºcpusetçš„cgroupå…³è”åˆ°cpusetå­ç³»ç»Ÿ</p>\n<p>4ï¼‰åœ¨cpusetç›®å½•ä¸‹åˆ›å»ºç›®å½•ï¼Œç”Ÿæˆä¸€ä¸ªå­cgroupï¼Œå±æ€§æ–‡ä»¶ä¸­å†™å…¥ç›¸åº”å†…å®¹ï¼Œè®¾ç½®å±æ€§ã€‚</p>\n<p>5ï¼‰å¯åŠ¨éœ€è¦é™åˆ¶çš„è¿›ç¨‹ï¼ŒæŸ¥æ‰¾å…¶å¯¹åº”çš„è¿›ç¨‹IDï¼Œå°†å…¶å†™å…¥å¯¹åº”çš„taskæ–‡ä»¶ä¸­</p>\n<p>ä»¥ä¸‹æ“ä½œæ­¥éª¤æ˜¯åˆ›å»ºä¸€ä¸ªåä¸ºâ€Charlieâ€çš„cgroupï¼Œè¿™ä¸ªcgroupçš„èµ„æºåŒ…å«cpu2ï¼Œcpu3å’Œå†…å­˜èŠ‚ç‚¹1ï¼Œå°†shellè¿›ç¨‹é™„åŠ åˆ°è¿™ä¸ªcgroupã€‚</p>\n<p>mount -t tmpfs cgroup_root &#x2F;sys&#x2F;fs&#x2F;cgroup</p>\n<p>mkdir &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;cpuset</p>\n<p>mount -t cgroup cpuset -o cpuset &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;cpuset</p>\n<p>cd &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;cpuset</p>\n<p>mkdir Charlie</p>\n<p>cd Charlie</p>\n<p>echo 2-3 &gt; cpuset.cpus</p>\n<p>echo 1 &gt; cpuset.mems</p>\n<p>echo $$ &gt; tasks</p>\n<p>sh</p>\n<p>cat &#x2F;proc&#x2F;self&#x2F;cgroup</p>\n</blockquote>\n<p>è½¬ï¼š</p>\n<p> <a href=\"https://blog.csdn.net/huang987246510/article/details/80765628\">https://blog.csdn.net/huang987246510/article/details/80765628</a></p>\n"},{"title":"pinctrl","date":"2024-05-16T05:33:03.000Z","_content":"\n\n\n\n\n\n\n# \n\næŸ¥çœ‹å…·ä½“è®¾å¤‡æ ‘ä¸­çš„å®å®šä¹‰\n\ninclude/dt-bindings/gpio/gpio.h\n\ninclude/dt-bindings/pinctrl/rockchip.h\n\ndt-bindings/clock/rk3588-cru.h\n\n\n\næŸ¥çœ‹ç‰©ç†å•ç³»ç»Ÿä¸­çš„pinctrlé…ç½®ï¼Œè·å–ç‰©ç†å¤–è®¾çœŸå®çš„device name\n\n  cat /sys/kernel/debug/pinctrl/pinctrl-maps\n","source":"_posts/pinctrl.md","raw":"---\ntitle: pinctrl\ncategories:\n  - kernel\ntags:\n  - pinctrl\ndate: 2024-05-16 13:33:03\n---\n\n\n\n\n\n\n\n# \n\næŸ¥çœ‹å…·ä½“è®¾å¤‡æ ‘ä¸­çš„å®å®šä¹‰\n\ninclude/dt-bindings/gpio/gpio.h\n\ninclude/dt-bindings/pinctrl/rockchip.h\n\ndt-bindings/clock/rk3588-cru.h\n\n\n\næŸ¥çœ‹ç‰©ç†å•ç³»ç»Ÿä¸­çš„pinctrlé…ç½®ï¼Œè·å–ç‰©ç†å¤–è®¾çœŸå®çš„device name\n\n  cat /sys/kernel/debug/pinctrl/pinctrl-maps\n","slug":"pinctrl","published":1,"updated":"2024-05-16T07:34:35.594Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clw8xrfby00029gw0eobh98nt","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>æŸ¥çœ‹å…·ä½“è®¾å¤‡æ ‘ä¸­çš„å®å®šä¹‰</p>\n<p>include&#x2F;dt-bindings&#x2F;gpio&#x2F;gpio.h</p>\n<p>include&#x2F;dt-bindings&#x2F;pinctrl&#x2F;rockchip.h</p>\n<p>dt-bindings&#x2F;clock&#x2F;rk3588-cru.h</p>\n<p>æŸ¥çœ‹ç‰©ç†å•ç³»ç»Ÿä¸­çš„pinctrlé…ç½®ï¼Œè·å–ç‰©ç†å¤–è®¾çœŸå®çš„device name</p>\n<p>  cat &#x2F;sys&#x2F;kernel&#x2F;debug&#x2F;pinctrl&#x2F;pinctrl-maps</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>æŸ¥çœ‹å…·ä½“è®¾å¤‡æ ‘ä¸­çš„å®å®šä¹‰</p>\n<p>include&#x2F;dt-bindings&#x2F;gpio&#x2F;gpio.h</p>\n<p>include&#x2F;dt-bindings&#x2F;pinctrl&#x2F;rockchip.h</p>\n<p>dt-bindings&#x2F;clock&#x2F;rk3588-cru.h</p>\n<p>æŸ¥çœ‹ç‰©ç†å•ç³»ç»Ÿä¸­çš„pinctrlé…ç½®ï¼Œè·å–ç‰©ç†å¤–è®¾çœŸå®çš„device name</p>\n<p>  cat &#x2F;sys&#x2F;kernel&#x2F;debug&#x2F;pinctrl&#x2F;pinctrl-maps</p>\n"},{"title":"PHYèŠ¯ç‰‡","date":"2024-05-16T10:58:06.000Z","_content":"\n\n\n# PHYï¼ˆphysical Layerï¼ŒPHYï¼‰\n\n## ä»€ä¹ˆæ˜¯PHYï¼Ÿ\n\nç‰©ç†å±‚èŠ¯ç‰‡ç§°ä¸ºPHYã€æ•°æ®é“¾è·¯å±‚èŠ¯ç‰‡ç§°ä¸ºMAC\n\nå¯ä»¥çœ‹åˆ°PHYçš„æ•°æ®æ˜¯[RJ45](https://so.csdn.net/so/search?q=RJ45&spm=1001.2101.3001.7020)ç½‘ç»œæ¥å£ï¼ˆç½‘çº¿å£ï¼‰ç©¿è¿‡äº†çš„å·®åˆ†ä¿¡å·ï¼Œè€ŒPHYä½œç”¨å°±æ˜¯å°†å·®åˆ†ä¿¡å·è½¬ä¸ºæ•°å­—ä¿¡å·ï¼Œè¿™å—å†…å®¹ä¸ç”¨æ·±ç©¶ï¼Œåˆ¶é€ å•†éƒ½è®¾è®¡å¥½äº†ã€‚\n\né‚£æˆ‘ä»¬å¹²ä»€ä¹ˆå‘¢ï¼Ÿï¼ˆä¸»è¦æ˜¯å¯¹phyèŠ¯ç‰‡è¿›è¡Œæ¨¡å¼é€‰æ‹©ï¼Œæ¯”å¦‚å·¥ä½œé€Ÿç‡ï¼Œå·¥ä½œæ¨¡å¼ï¼‰\n\n## ä»€ä¹ˆæ˜¯RJ45æ¥å£ï¼Ÿ\n\nRJ45æ¥å£é€šå¸¸ç”¨äºæ•°æ®ä¼ è¾“ï¼Œæœ€å¸¸è§çš„åº”ç”¨ä¸ºç½‘å¡æ¥å£ã€‚RJ-45ç«¯å£æ˜¯æˆ‘ä»¬æœ€å¸¸è§çš„ç«¯å£ä¹‹ä¸€ï¼Œæ˜¯æ¯”è¾ƒå¸¸è§çš„[åŒç»çº¿](https://www.zhihu.com/search?q=åŒç»çº¿&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra={\"sourceType\"%3A\"answer\"%2C\"sourceId\"%3A3477234795})ä»¥å¤ªç½‘ç«¯å£ï¼Œå› ä¸ºåœ¨å¿«é€Ÿä»¥å¤ªç½‘ä¸­ä¹Ÿä¸»è¦é‡‡ç”¨åŒç»çº¿ä½œä¸ºä¼ è¾“ä»‹è´¨ã€‚\n\nRJ45å‹ç½‘çº¿æ’å¤´åˆç§°æ°´æ™¶å¤´ï¼Œå…±ç”±å…«èŠ¯åšæˆï¼Œå¹¿æ³›åº”ç”¨äºå±€åŸŸç½‘å’ŒADSLå®½å¸¦ä¸Šç½‘ç”¨æˆ·çš„ç½‘ç»œè®¾å¤‡é—´ç½‘çº¿ï¼ˆç§°ä½œäº”ç±»çº¿æˆ–åŒç»çº¿ï¼‰çš„è¿æ¥ã€‚\n\nRJ45æ¥å¤´æ ¹æ®çº¿çš„æ’åºä¸åŒä¸»è¦åˆ†ä¸¤ç§ï¼Œä¸€ç§æ˜¯æ©™ç™½ã€æ©™ã€ç»¿ç™½ã€è“ã€è“ç™½ã€ç»¿ã€æ£•ç™½ã€æ£•ï¼›å¦ä¸€ç§æ˜¯ç»¿ç™½ã€ç»¿ã€æ©™ç™½ã€è“ã€è“ç™½ã€æ©™ã€æ£•ç™½ã€æ£•ï¼›å› æ­¤ä½¿ç”¨RJ45æ¥å¤´çš„çº¿ä¹Ÿæœ‰ä¸¤ç§å³ï¼šç›´é€šçº¿ã€äº¤å‰çº¿ã€‚åˆ†åˆ«ç§°ä½œ[T568Açº¿åº](https://www.zhihu.com/search?q=T568Açº¿åº&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra={\"sourceType\"%3A\"answer\"%2C\"sourceId\"%3A3477234795})å’ŒT568Bçº¿åºã€‚\n\nRJ45æ’åº§è¿æ¥å™¨æ¥å£å†…éƒ¨æ˜¯é‡‘å±ï¼Œæ³¨æ„ä¸èƒ½å—æ½®æˆ–è€…æ¥è§¦åˆ°æ°´ï¼Œå¦åˆ™ä¼šé€ æˆçŸ­è·¯ç°è±¡ã€‚\n\n## ä¸ºä»€ä¹ˆè¦ç†Ÿæ‚‰RJ45ç½‘å£\n\nä¸Šé¢è¯´åˆ°é’ˆå¯¹phyèŠ¯ç‰‡æˆ‘ä»¬åªè¦è¿›è¡Œæ¨¡å¼é€‰æ‹©ï¼ˆä¸‹æ–‡ä¼šä»‹ç»ä½¿ç”¨[mdio](https://so.csdn.net/so/search?q=mdio&spm=1001.2101.3001.7020)æ¥å£ï¼Œé€šè¿‡å¯„å­˜å™¨æ§åˆ¶ï¼‰\n\né‚£æ¨¡å¼é€‰æ‹©åï¼Œå¦‚ä½•æŸ¥çœ‹æ˜¯å¦æœ‰æ•ˆå‘¢ï¼Ÿæœ€ç®€å•ç›´æ¥çš„å°±æ˜¯é€šè¿‡RJ45ç½‘å£çš„æŒ‡ç¤ºç¯æŸ¥çœ‹\n\n![img](../imgs/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_18,color_FFFFFF,t_70,g_se,x_16-17158590663256.png)\n\nRJ45 åº§å­ä¸Šä¸€èˆ¬æœ‰ä¸¤ä¸ªç¯ï¼Œä¸€ä¸ªé»„è‰²(æ©™è‰²)ï¼Œä¸€ä¸ªç»¿è‰²ï¼Œ**ç»¿è‰²äº®çš„è¯è¡¨ç¤ºç½‘ç»œè¿æ¥æ­£å¸¸ï¼Œé»„è‰²é—ªçƒçš„è¯è¯´æ˜å½“å‰æ­£åœ¨è¿›è¡Œç½‘ç»œé€šä¿¡**ï¼Œ**é»„ç¯é—ªåŠ¨é¢‘ç‡å¿«è¡¨ç¤ºç½‘é€Ÿ**å¥½ï¼Œè¿™ä¸¤ä¸ªç¯ç”± PHY èŠ¯ç‰‡æ§åˆ¶ã€‚\n\n## ç½‘ç»œä¸ƒå±‚åè®®\n\n![img](../img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_16,color_FFFFFF,t_70,g_se,x_16.png)\n\n## ä¸¤ä¸ªæ¨¡å—è¿›è¡Œé€šä¿¡\n\nä¸‹å›¾æ˜¯ä¸¤ä¸ªä¸»æ§ç›´æ¥çš„é€šä¿¡ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„ç”µè„‘ å’Œ è·¯ç”±å™¨ ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰ä¸­é—´çš„ä»‹è´¨è¿˜èƒ½è¿æ¥ç½‘ç»œå—ï¼Ÿç­”æ¡ˆæ˜¯å¯ä»¥çš„\n\nå¦‚æœphyèŠ¯ç‰‡æ²¡æœ‰ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥é€šè¿‡ä¸¤ä¸ªmacè¿æ¥è¿›è¡Œé€šä¿¡ï¼Œä¹‹æ‰€ä»¥éœ€è¦mac ã€phyã€å˜å‹å™¨çš„ç›®çš„æ˜¯ä¸ºäº†è½¬æ¢æ•°æ®ç±»å‹é€‚é…æ‰€ä»¥çš„ç½‘çº¿ï¼Œä½†æ˜¯åœ¨ä¸€äº›ç”µè·¯ä¸Šï¼Œæ²¡å¿…è¦åŠ è¿™ä¹ˆå¤šä¸œè¥¿\n\næ¯”å¦‚æ­è½½ Linuxç³»ç»Ÿçš„armèŠ¯ç‰‡æƒ³è¦ç½‘ç»œï¼Œå¯ä»¥ç›´æ¥é€šè¿‡macå’Œç½‘å¡èŠ¯ç‰‡è¿æ¥è·å–ï¼Œè¿™æ—¶å€™å°±éœ€è¦é€šè¿‡RGMIIæ¥å£æˆ–è€…MIIæ¥å£ å’Œ MDIO è¿æ¥ç½‘å¡èŠ¯ç‰‡ã€‚\n\nï¼ˆç½‘å¡èŠ¯ç‰‡å†…ç½®ä¹Ÿæ˜¯mac+phyï¼Œæœ‰çš„åªæœ‰mac å±‚è¿™ä¸ªè¦çœ‹å…·ä½“çš„æ‰‹å†Œï¼‰\n\n![img](../img/84b0b5e31bb246c0a970ace7c71a3f82.png)\n\n## ä»€ä¹ˆæ˜¯MDIOåè®®\n\nmidoåè®®å³SMIåè®®\n\nSMIåè®®ä¹Ÿæ˜¯ä¸€ç§é€šä¿¡åè®®ç±»ä¼¼ä¸I2Cåè®®ä½†æ˜¯é€šä¿¡æ–¹å¼ä¸ä¸€æ ·\n\nSMIåŒ…å«ä¸¤æ ¹ä¿¡å·çº¿ï¼Œä¸€ä¸ªMDCæ—¶é’Ÿçº¿ï¼Œä¸€ä¸ªMDIOåŒå‘ä¼ è¾“çš„æ•°æ®çº¿ï¼Œ\n\nå¦‚å›¾ä¸ºSMIåº”ç”¨æ¡†å›¾ã€‚STAè®¾å¤‡é€šè¿‡MDIOæ¥å£ä¸PHYé€šä¿¡ã€‚STAï¼ˆStaTIon Managementï¼‰ä¸ºä¸»æ§è®¾å¤‡ï¼Œæ¯”å¦‚MCUã€MACã€ONUç­‰ã€‚PHYä¸ºä»è®¾å¤‡ã€‚ä¸€ä¸ªSTAæœ€å¤šç®¡ç†32ä¸ªPHYã€‚MDCä¿¡å·ç”±STAæ§åˆ¶ï¼ŒMDIOä¿¡å·æ ¹æ®é€šä¿¡æ–¹å¼çš„ä¸åŒå¯ä»¥ç”±STAæˆ–è€…PHYæ¥ç®¡æ§åˆ¶ã€‚å¦‚å›¾é€šå¸¸MDIOä¼šæ¥ä¸€ä¸ªç”µé˜»ä¸Šæ‹‰è‡³æ¥å£ç”µæºã€‚\n\n![img](../img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_16,color_FFFFFF,t_70,g_se,x_16.png)\n\n\n\n## MDIOçš„ä½œç”¨ \n\nä»ä¸Šé¢çš„è¿æ¥å›¾å¯ä»¥çœ‹åˆ°MDIOæ˜¯ç”¨æ¥è¿æ¥ä¸»è®¾å¤‡å’Œå¤šä¸ªPHYè®¾å¤‡ï¼Œå¹¶ä¸”é€šè¿‡MDIOæ¥ä¼ è¾“æ•°æ®\n\né‚£ä¹ˆä¼ è¾“çš„æ˜¯æ•°æ®æ˜¯å“ªäº›å‘¢ï¼Ÿä¸»è¦æ˜¯ä¼ è¾“é“¾æ¥çŠ¶æ€ã€ä¼ è¾“é€Ÿåº¦ä¸é€‰æ‹©ã€æ–­ç”µã€ä½åŠŸç‡[ä¼‘çœ çŠ¶æ€](https://baike.baidu.com/item/ä¼‘çœ çŠ¶æ€?fromModule=lemma_inlink)ã€TX/RXæ¨¡å¼é€‰æ‹©ã€[è‡ªåŠ¨åå•†](https://baike.baidu.com/item/è‡ªåŠ¨åå•†/7765053?fromModule=lemma_inlink)æ§åˆ¶ã€ç¯å›æ¨¡å¼æ§åˆ¶ç­‰ã€‚\n\n\n\n### MDIOæ²¡é‚£ä¹ˆé‡è¦\n\nMDIOåœ¨ä¸Šé¢è¯´åˆ°çš„ä¸¤ä¸ªæ¨¡å—é€šä¿¡ï¼Œæˆ‘æåˆ°äº† armèŠ¯ç‰‡å’Œç½‘å¡èŠ¯ç‰‡ç›´æ¥éœ€è¦ï¼Œé‚£ä¹ˆè¿™ä¸ªçœŸçš„æœ‰å¿…è¦å—ï¼Ÿå…¶å®æ²¡å¿…è¦è¿æ¥ï¼ï¼ï¼\n\næ¢ä¸ªè¯è¯´ ä¸è¿æ¥ä¹Ÿå¯ä»¥ä½¿å¾—ç½‘ç»œç•…é€šï¼Œå› ä¸ºç½‘ç»œçš„æ•°æ®ä¼ è¾“æ—¶é RGMIIä¸æ˜¯é MDIOï¼ŒMDIOçš„ä½œç”¨ä»…ä»…åªæ˜¯ç”¨æ¥æŸ¥çœ‹ä¸€äº›çŠ¶æ€å’ŒåŠŸèƒ½ï¼Œè¿˜æœ‰ç®€å•çš„æ§åˆ¶ï¼Œè€Œè¿™äº›ç®€å•çš„æ§åˆ¶æ˜¯å®Œå…¨å¯ä»¥æœ‰ç½‘å¡èŠ¯ç‰‡å†…ç½®å»å†™æ­»ï¼Œarmå±‚åªè¦å’Œç½‘å¡çš„å†™çš„ä¸€ç›´å°±å¯ä»¥é€šè®¯ã€‚\n\nä½†æ˜¯ä¸ºä»€ä¹ˆå¾ˆå¤šæ—¶å€™éœ€è¦é€šè¿‡mdioæ¥è¿›è¡Œè¯»å†™æ§åˆ¶ï¼Œè¿™ä¸ªåªæ˜¯åœ¨ç½‘ç»œé€šè®¯æ­£å¸¸åçš„å‡çº§ä¼˜åŒ–ï¼Œç”¨æ¥æ–¹ä¾¿æŸ¥çœ‹çŠ¶æ€ï¼Œå°±åƒå†™äº†ä¸ªå‰ç«¯ç½‘é¡µæ¥çœ‹åå°æ•°æ®ã€‚\n\nå¦‚æœmidoæ²¡æœ‰è¯»é€šï¼Œæˆ–è€…è¯»å–çš„æ•°æ®æ˜¯0xfffffï¼Œé‚£ä¹ˆä¸ä¸€å®šæ˜¯mdioçš„é—®é¢˜ï¼Œå¾ˆå¤šæ—¶å€™æ˜¯ç½‘å¡æœ¬èº«æ²¡æœ‰å¯åŠ¨ï¼\n\n\n## MDIOè¯»å†™æ—¶åº\n\n![img](../img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_18,color_FFFFFF,t_70,g_se,x_16.png)\n\nPreambleï¼š32bitsçš„å‰å¯¼ç \n\nStartï¼š2bitçš„å¼€å§‹ä½ã€‚\n\nOP Codeï¼š2bitsçš„æ“ä½œç ï¼Œ10è¡¨ç¤ºè¯»ï¼Œ01è¡¨ç¤ºå†™ã€‚\n\nPHYADï¼š5bitsçš„PHYåœ°å€ã€‚\n\nREGADï¼š5bitsçš„å¯„å­˜å™¨åœ°å€ï¼Œå³è¦è¯»æˆ–å†™çš„å¯„å­˜å™¨ã€‚\n\nTurn Aroundï¼š2bitsçš„TAï¼Œåœ¨è¯»å‘½ä»¤ä¸­ï¼ŒMDIOåœ¨æ­¤æ—¶ç”±MACé©±åŠ¨æ”¹ä¸ºPHYé©±åŠ¨ï¼Œå¹¶ç­‰å¾…ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸå‡†å¤‡å‘é€æ•°æ®ã€‚åœ¨å†™å‘½ä»¤ä¸­ï¼Œä¸éœ€è¦MDIOæ–¹å‘å‘ç”Ÿå˜åŒ–ï¼Œåˆ™åªæ˜¯ç­‰å¾…ä¸¤ä¸ªæ—¶é’Ÿå‘¨æœŸå‡†å¤‡å†™å…¥æ•°æ®ã€‚\n\nDataï¼š16bitsæ•°æ®ï¼Œåœ¨è¯»å‘½ä»¤ä¸­ï¼ŒPHYèŠ¯ç‰‡å°†è¯»åˆ°çš„å¯¹åº”PHYADçš„REGADå¯„å­˜å™¨çš„æ•°æ®å†™åˆ°Dataä¸­ï¼Œåœ¨å†™å‘½ä»¤ä¸­ï¼ŒMACå°†è¦å†™å…¥å¯¹åº”PHYADçš„REGADå¯„å­˜å™¨çš„å€¼å†™å…¥Dataä¸­ã€‚\n\nIdleï¼šç©ºé—²çŠ¶æ€ï¼Œæ­¤æ—¶MDIOæ— æºé©±åŠ¨ï¼Œå¤„é«˜é˜»çŠ¶æ€ï¼Œä½†ä¸€èˆ¬ç”¨ä¸Šæ‹‰ç”µé˜»ä½¿å…¶å¤„åœ¨é«˜ç”µå¹³ï¼Œä¸Šæ‹‰ç”µé˜»ä¸€èˆ¬ä¸º1.5Kã€‚\nä¸ºä»€ä¹ˆè¯´è¯»å–çš„phyæœ€å¤š32ä¸ª\nå› ä¸ºmdioä¸­è¯»å–çš„phyåªæä¾›5bitçš„å­—èŠ‚å³æœ€é«˜11111 è½¬æˆåè¿›åˆ¶å°±æ˜¯31å³0-31å°±æ˜¯32ä¸ªï¼Œä½†è¿™æ˜¯ä»è¯»å–çš„æ–¹å¼åˆ¤æ–­çš„ï¼Œè€Œmdioè¯»å–æ˜¯ä¾ç…§phyèŠ¯ç‰‡æœ¬èº«åœ°å€ç©ºé—´å°±5ä¸º\n\n## ä¸ºä»€ä¹ˆè¯´regåœ°å€æœ€å¤š32ä¸ª\n\nåŒæ ·mdioä¸­è¯»å–çš„regåªæä¾›5bitçš„å­—èŠ‚å³æœ€é«˜11111 è½¬æˆåè¿›åˆ¶å°±æ˜¯31å³0-31å°±æ˜¯32ä¸ª\n\n PHY èŠ¯ç‰‡å¯„å­˜å™¨åœ°å€ç©ºé—´ä¸º 5 ä½ï¼Œåœ°å€ 0-31 å…± 32 ä¸ªå¯„å­˜å™¨ï¼Œ IEEE å®šä¹‰äº† 0-15 è¿™ 16 ä¸ªå¯„å­˜å™¨çš„åŠŸèƒ½ï¼Œ 16~31 è¿™ 16 ä¸ªå¯„å­˜å™¨ç”±å‚å•†è‡ªè¡Œå®ç°ã€‚ ä¹Ÿå°±æ˜¯è¯´ä¸ç®¡ä½ ç”¨çš„å“ªä¸ªå‚å®¶çš„ PHY èŠ¯ç‰‡ï¼Œå…¶ä¸­ 0~15 è¿™ 16 ä¸ªå¯„å­˜å™¨æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚ ä»…é è¿™ 16 ä¸ªå¯„å­˜å™¨æ˜¯å®Œå…¨å¯ä»¥é©±åŠ¨èµ· PHY èŠ¯ç‰‡çš„ï¼Œè‡³å°‘èƒ½ä¿è¯åŸºæœ¬çš„ç½‘ç»œæ•°æ®é€šä¿¡ã€‚\n\n \n\n\n\nè½¬ï¼š\n\n[PHYèŠ¯ç‰‡å¿«é€Ÿæ·±åº¦ç†è§£ï¼ˆæŒç»­æ›´æ–°ä¸­â€¦â€¦ï¼‰-CSDNåšå®¢](https://blog.csdn.net/qq_40715266/article/details/124095801)\n\n\n\n[PHYï¼ˆPhysical Layerï¼ŒPHYï¼‰ - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/148538791)\n","source":"_posts/PHYèŠ¯ç‰‡.md","raw":"---\ntitle: PHYèŠ¯ç‰‡\ncategories:\n  - test\ntags:\n  - PHYèŠ¯ç‰‡\ndate: 2024-05-16 18:58:06\n---\n\n\n\n# PHYï¼ˆphysical Layerï¼ŒPHYï¼‰\n\n## ä»€ä¹ˆæ˜¯PHYï¼Ÿ\n\nç‰©ç†å±‚èŠ¯ç‰‡ç§°ä¸ºPHYã€æ•°æ®é“¾è·¯å±‚èŠ¯ç‰‡ç§°ä¸ºMAC\n\nå¯ä»¥çœ‹åˆ°PHYçš„æ•°æ®æ˜¯[RJ45](https://so.csdn.net/so/search?q=RJ45&spm=1001.2101.3001.7020)ç½‘ç»œæ¥å£ï¼ˆç½‘çº¿å£ï¼‰ç©¿è¿‡äº†çš„å·®åˆ†ä¿¡å·ï¼Œè€ŒPHYä½œç”¨å°±æ˜¯å°†å·®åˆ†ä¿¡å·è½¬ä¸ºæ•°å­—ä¿¡å·ï¼Œè¿™å—å†…å®¹ä¸ç”¨æ·±ç©¶ï¼Œåˆ¶é€ å•†éƒ½è®¾è®¡å¥½äº†ã€‚\n\né‚£æˆ‘ä»¬å¹²ä»€ä¹ˆå‘¢ï¼Ÿï¼ˆä¸»è¦æ˜¯å¯¹phyèŠ¯ç‰‡è¿›è¡Œæ¨¡å¼é€‰æ‹©ï¼Œæ¯”å¦‚å·¥ä½œé€Ÿç‡ï¼Œå·¥ä½œæ¨¡å¼ï¼‰\n\n## ä»€ä¹ˆæ˜¯RJ45æ¥å£ï¼Ÿ\n\nRJ45æ¥å£é€šå¸¸ç”¨äºæ•°æ®ä¼ è¾“ï¼Œæœ€å¸¸è§çš„åº”ç”¨ä¸ºç½‘å¡æ¥å£ã€‚RJ-45ç«¯å£æ˜¯æˆ‘ä»¬æœ€å¸¸è§çš„ç«¯å£ä¹‹ä¸€ï¼Œæ˜¯æ¯”è¾ƒå¸¸è§çš„[åŒç»çº¿](https://www.zhihu.com/search?q=åŒç»çº¿&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra={\"sourceType\"%3A\"answer\"%2C\"sourceId\"%3A3477234795})ä»¥å¤ªç½‘ç«¯å£ï¼Œå› ä¸ºåœ¨å¿«é€Ÿä»¥å¤ªç½‘ä¸­ä¹Ÿä¸»è¦é‡‡ç”¨åŒç»çº¿ä½œä¸ºä¼ è¾“ä»‹è´¨ã€‚\n\nRJ45å‹ç½‘çº¿æ’å¤´åˆç§°æ°´æ™¶å¤´ï¼Œå…±ç”±å…«èŠ¯åšæˆï¼Œå¹¿æ³›åº”ç”¨äºå±€åŸŸç½‘å’ŒADSLå®½å¸¦ä¸Šç½‘ç”¨æˆ·çš„ç½‘ç»œè®¾å¤‡é—´ç½‘çº¿ï¼ˆç§°ä½œäº”ç±»çº¿æˆ–åŒç»çº¿ï¼‰çš„è¿æ¥ã€‚\n\nRJ45æ¥å¤´æ ¹æ®çº¿çš„æ’åºä¸åŒä¸»è¦åˆ†ä¸¤ç§ï¼Œä¸€ç§æ˜¯æ©™ç™½ã€æ©™ã€ç»¿ç™½ã€è“ã€è“ç™½ã€ç»¿ã€æ£•ç™½ã€æ£•ï¼›å¦ä¸€ç§æ˜¯ç»¿ç™½ã€ç»¿ã€æ©™ç™½ã€è“ã€è“ç™½ã€æ©™ã€æ£•ç™½ã€æ£•ï¼›å› æ­¤ä½¿ç”¨RJ45æ¥å¤´çš„çº¿ä¹Ÿæœ‰ä¸¤ç§å³ï¼šç›´é€šçº¿ã€äº¤å‰çº¿ã€‚åˆ†åˆ«ç§°ä½œ[T568Açº¿åº](https://www.zhihu.com/search?q=T568Açº¿åº&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra={\"sourceType\"%3A\"answer\"%2C\"sourceId\"%3A3477234795})å’ŒT568Bçº¿åºã€‚\n\nRJ45æ’åº§è¿æ¥å™¨æ¥å£å†…éƒ¨æ˜¯é‡‘å±ï¼Œæ³¨æ„ä¸èƒ½å—æ½®æˆ–è€…æ¥è§¦åˆ°æ°´ï¼Œå¦åˆ™ä¼šé€ æˆçŸ­è·¯ç°è±¡ã€‚\n\n## ä¸ºä»€ä¹ˆè¦ç†Ÿæ‚‰RJ45ç½‘å£\n\nä¸Šé¢è¯´åˆ°é’ˆå¯¹phyèŠ¯ç‰‡æˆ‘ä»¬åªè¦è¿›è¡Œæ¨¡å¼é€‰æ‹©ï¼ˆä¸‹æ–‡ä¼šä»‹ç»ä½¿ç”¨[mdio](https://so.csdn.net/so/search?q=mdio&spm=1001.2101.3001.7020)æ¥å£ï¼Œé€šè¿‡å¯„å­˜å™¨æ§åˆ¶ï¼‰\n\né‚£æ¨¡å¼é€‰æ‹©åï¼Œå¦‚ä½•æŸ¥çœ‹æ˜¯å¦æœ‰æ•ˆå‘¢ï¼Ÿæœ€ç®€å•ç›´æ¥çš„å°±æ˜¯é€šè¿‡RJ45ç½‘å£çš„æŒ‡ç¤ºç¯æŸ¥çœ‹\n\n![img](../imgs/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_18,color_FFFFFF,t_70,g_se,x_16-17158590663256.png)\n\nRJ45 åº§å­ä¸Šä¸€èˆ¬æœ‰ä¸¤ä¸ªç¯ï¼Œä¸€ä¸ªé»„è‰²(æ©™è‰²)ï¼Œä¸€ä¸ªç»¿è‰²ï¼Œ**ç»¿è‰²äº®çš„è¯è¡¨ç¤ºç½‘ç»œè¿æ¥æ­£å¸¸ï¼Œé»„è‰²é—ªçƒçš„è¯è¯´æ˜å½“å‰æ­£åœ¨è¿›è¡Œç½‘ç»œé€šä¿¡**ï¼Œ**é»„ç¯é—ªåŠ¨é¢‘ç‡å¿«è¡¨ç¤ºç½‘é€Ÿ**å¥½ï¼Œè¿™ä¸¤ä¸ªç¯ç”± PHY èŠ¯ç‰‡æ§åˆ¶ã€‚\n\n## ç½‘ç»œä¸ƒå±‚åè®®\n\n![img](../img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_16,color_FFFFFF,t_70,g_se,x_16.png)\n\n## ä¸¤ä¸ªæ¨¡å—è¿›è¡Œé€šä¿¡\n\nä¸‹å›¾æ˜¯ä¸¤ä¸ªä¸»æ§ç›´æ¥çš„é€šä¿¡ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„ç”µè„‘ å’Œ è·¯ç”±å™¨ ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰ä¸­é—´çš„ä»‹è´¨è¿˜èƒ½è¿æ¥ç½‘ç»œå—ï¼Ÿç­”æ¡ˆæ˜¯å¯ä»¥çš„\n\nå¦‚æœphyèŠ¯ç‰‡æ²¡æœ‰ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥é€šè¿‡ä¸¤ä¸ªmacè¿æ¥è¿›è¡Œé€šä¿¡ï¼Œä¹‹æ‰€ä»¥éœ€è¦mac ã€phyã€å˜å‹å™¨çš„ç›®çš„æ˜¯ä¸ºäº†è½¬æ¢æ•°æ®ç±»å‹é€‚é…æ‰€ä»¥çš„ç½‘çº¿ï¼Œä½†æ˜¯åœ¨ä¸€äº›ç”µè·¯ä¸Šï¼Œæ²¡å¿…è¦åŠ è¿™ä¹ˆå¤šä¸œè¥¿\n\næ¯”å¦‚æ­è½½ Linuxç³»ç»Ÿçš„armèŠ¯ç‰‡æƒ³è¦ç½‘ç»œï¼Œå¯ä»¥ç›´æ¥é€šè¿‡macå’Œç½‘å¡èŠ¯ç‰‡è¿æ¥è·å–ï¼Œè¿™æ—¶å€™å°±éœ€è¦é€šè¿‡RGMIIæ¥å£æˆ–è€…MIIæ¥å£ å’Œ MDIO è¿æ¥ç½‘å¡èŠ¯ç‰‡ã€‚\n\nï¼ˆç½‘å¡èŠ¯ç‰‡å†…ç½®ä¹Ÿæ˜¯mac+phyï¼Œæœ‰çš„åªæœ‰mac å±‚è¿™ä¸ªè¦çœ‹å…·ä½“çš„æ‰‹å†Œï¼‰\n\n![img](../img/84b0b5e31bb246c0a970ace7c71a3f82.png)\n\n## ä»€ä¹ˆæ˜¯MDIOåè®®\n\nmidoåè®®å³SMIåè®®\n\nSMIåè®®ä¹Ÿæ˜¯ä¸€ç§é€šä¿¡åè®®ç±»ä¼¼ä¸I2Cåè®®ä½†æ˜¯é€šä¿¡æ–¹å¼ä¸ä¸€æ ·\n\nSMIåŒ…å«ä¸¤æ ¹ä¿¡å·çº¿ï¼Œä¸€ä¸ªMDCæ—¶é’Ÿçº¿ï¼Œä¸€ä¸ªMDIOåŒå‘ä¼ è¾“çš„æ•°æ®çº¿ï¼Œ\n\nå¦‚å›¾ä¸ºSMIåº”ç”¨æ¡†å›¾ã€‚STAè®¾å¤‡é€šè¿‡MDIOæ¥å£ä¸PHYé€šä¿¡ã€‚STAï¼ˆStaTIon Managementï¼‰ä¸ºä¸»æ§è®¾å¤‡ï¼Œæ¯”å¦‚MCUã€MACã€ONUç­‰ã€‚PHYä¸ºä»è®¾å¤‡ã€‚ä¸€ä¸ªSTAæœ€å¤šç®¡ç†32ä¸ªPHYã€‚MDCä¿¡å·ç”±STAæ§åˆ¶ï¼ŒMDIOä¿¡å·æ ¹æ®é€šä¿¡æ–¹å¼çš„ä¸åŒå¯ä»¥ç”±STAæˆ–è€…PHYæ¥ç®¡æ§åˆ¶ã€‚å¦‚å›¾é€šå¸¸MDIOä¼šæ¥ä¸€ä¸ªç”µé˜»ä¸Šæ‹‰è‡³æ¥å£ç”µæºã€‚\n\n![img](../img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_16,color_FFFFFF,t_70,g_se,x_16.png)\n\n\n\n## MDIOçš„ä½œç”¨ \n\nä»ä¸Šé¢çš„è¿æ¥å›¾å¯ä»¥çœ‹åˆ°MDIOæ˜¯ç”¨æ¥è¿æ¥ä¸»è®¾å¤‡å’Œå¤šä¸ªPHYè®¾å¤‡ï¼Œå¹¶ä¸”é€šè¿‡MDIOæ¥ä¼ è¾“æ•°æ®\n\né‚£ä¹ˆä¼ è¾“çš„æ˜¯æ•°æ®æ˜¯å“ªäº›å‘¢ï¼Ÿä¸»è¦æ˜¯ä¼ è¾“é“¾æ¥çŠ¶æ€ã€ä¼ è¾“é€Ÿåº¦ä¸é€‰æ‹©ã€æ–­ç”µã€ä½åŠŸç‡[ä¼‘çœ çŠ¶æ€](https://baike.baidu.com/item/ä¼‘çœ çŠ¶æ€?fromModule=lemma_inlink)ã€TX/RXæ¨¡å¼é€‰æ‹©ã€[è‡ªåŠ¨åå•†](https://baike.baidu.com/item/è‡ªåŠ¨åå•†/7765053?fromModule=lemma_inlink)æ§åˆ¶ã€ç¯å›æ¨¡å¼æ§åˆ¶ç­‰ã€‚\n\n\n\n### MDIOæ²¡é‚£ä¹ˆé‡è¦\n\nMDIOåœ¨ä¸Šé¢è¯´åˆ°çš„ä¸¤ä¸ªæ¨¡å—é€šä¿¡ï¼Œæˆ‘æåˆ°äº† armèŠ¯ç‰‡å’Œç½‘å¡èŠ¯ç‰‡ç›´æ¥éœ€è¦ï¼Œé‚£ä¹ˆè¿™ä¸ªçœŸçš„æœ‰å¿…è¦å—ï¼Ÿå…¶å®æ²¡å¿…è¦è¿æ¥ï¼ï¼ï¼\n\næ¢ä¸ªè¯è¯´ ä¸è¿æ¥ä¹Ÿå¯ä»¥ä½¿å¾—ç½‘ç»œç•…é€šï¼Œå› ä¸ºç½‘ç»œçš„æ•°æ®ä¼ è¾“æ—¶é RGMIIä¸æ˜¯é MDIOï¼ŒMDIOçš„ä½œç”¨ä»…ä»…åªæ˜¯ç”¨æ¥æŸ¥çœ‹ä¸€äº›çŠ¶æ€å’ŒåŠŸèƒ½ï¼Œè¿˜æœ‰ç®€å•çš„æ§åˆ¶ï¼Œè€Œè¿™äº›ç®€å•çš„æ§åˆ¶æ˜¯å®Œå…¨å¯ä»¥æœ‰ç½‘å¡èŠ¯ç‰‡å†…ç½®å»å†™æ­»ï¼Œarmå±‚åªè¦å’Œç½‘å¡çš„å†™çš„ä¸€ç›´å°±å¯ä»¥é€šè®¯ã€‚\n\nä½†æ˜¯ä¸ºä»€ä¹ˆå¾ˆå¤šæ—¶å€™éœ€è¦é€šè¿‡mdioæ¥è¿›è¡Œè¯»å†™æ§åˆ¶ï¼Œè¿™ä¸ªåªæ˜¯åœ¨ç½‘ç»œé€šè®¯æ­£å¸¸åçš„å‡çº§ä¼˜åŒ–ï¼Œç”¨æ¥æ–¹ä¾¿æŸ¥çœ‹çŠ¶æ€ï¼Œå°±åƒå†™äº†ä¸ªå‰ç«¯ç½‘é¡µæ¥çœ‹åå°æ•°æ®ã€‚\n\nå¦‚æœmidoæ²¡æœ‰è¯»é€šï¼Œæˆ–è€…è¯»å–çš„æ•°æ®æ˜¯0xfffffï¼Œé‚£ä¹ˆä¸ä¸€å®šæ˜¯mdioçš„é—®é¢˜ï¼Œå¾ˆå¤šæ—¶å€™æ˜¯ç½‘å¡æœ¬èº«æ²¡æœ‰å¯åŠ¨ï¼\n\n\n## MDIOè¯»å†™æ—¶åº\n\n![img](../img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_18,color_FFFFFF,t_70,g_se,x_16.png)\n\nPreambleï¼š32bitsçš„å‰å¯¼ç \n\nStartï¼š2bitçš„å¼€å§‹ä½ã€‚\n\nOP Codeï¼š2bitsçš„æ“ä½œç ï¼Œ10è¡¨ç¤ºè¯»ï¼Œ01è¡¨ç¤ºå†™ã€‚\n\nPHYADï¼š5bitsçš„PHYåœ°å€ã€‚\n\nREGADï¼š5bitsçš„å¯„å­˜å™¨åœ°å€ï¼Œå³è¦è¯»æˆ–å†™çš„å¯„å­˜å™¨ã€‚\n\nTurn Aroundï¼š2bitsçš„TAï¼Œåœ¨è¯»å‘½ä»¤ä¸­ï¼ŒMDIOåœ¨æ­¤æ—¶ç”±MACé©±åŠ¨æ”¹ä¸ºPHYé©±åŠ¨ï¼Œå¹¶ç­‰å¾…ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸå‡†å¤‡å‘é€æ•°æ®ã€‚åœ¨å†™å‘½ä»¤ä¸­ï¼Œä¸éœ€è¦MDIOæ–¹å‘å‘ç”Ÿå˜åŒ–ï¼Œåˆ™åªæ˜¯ç­‰å¾…ä¸¤ä¸ªæ—¶é’Ÿå‘¨æœŸå‡†å¤‡å†™å…¥æ•°æ®ã€‚\n\nDataï¼š16bitsæ•°æ®ï¼Œåœ¨è¯»å‘½ä»¤ä¸­ï¼ŒPHYèŠ¯ç‰‡å°†è¯»åˆ°çš„å¯¹åº”PHYADçš„REGADå¯„å­˜å™¨çš„æ•°æ®å†™åˆ°Dataä¸­ï¼Œåœ¨å†™å‘½ä»¤ä¸­ï¼ŒMACå°†è¦å†™å…¥å¯¹åº”PHYADçš„REGADå¯„å­˜å™¨çš„å€¼å†™å…¥Dataä¸­ã€‚\n\nIdleï¼šç©ºé—²çŠ¶æ€ï¼Œæ­¤æ—¶MDIOæ— æºé©±åŠ¨ï¼Œå¤„é«˜é˜»çŠ¶æ€ï¼Œä½†ä¸€èˆ¬ç”¨ä¸Šæ‹‰ç”µé˜»ä½¿å…¶å¤„åœ¨é«˜ç”µå¹³ï¼Œä¸Šæ‹‰ç”µé˜»ä¸€èˆ¬ä¸º1.5Kã€‚\nä¸ºä»€ä¹ˆè¯´è¯»å–çš„phyæœ€å¤š32ä¸ª\nå› ä¸ºmdioä¸­è¯»å–çš„phyåªæä¾›5bitçš„å­—èŠ‚å³æœ€é«˜11111 è½¬æˆåè¿›åˆ¶å°±æ˜¯31å³0-31å°±æ˜¯32ä¸ªï¼Œä½†è¿™æ˜¯ä»è¯»å–çš„æ–¹å¼åˆ¤æ–­çš„ï¼Œè€Œmdioè¯»å–æ˜¯ä¾ç…§phyèŠ¯ç‰‡æœ¬èº«åœ°å€ç©ºé—´å°±5ä¸º\n\n## ä¸ºä»€ä¹ˆè¯´regåœ°å€æœ€å¤š32ä¸ª\n\nåŒæ ·mdioä¸­è¯»å–çš„regåªæä¾›5bitçš„å­—èŠ‚å³æœ€é«˜11111 è½¬æˆåè¿›åˆ¶å°±æ˜¯31å³0-31å°±æ˜¯32ä¸ª\n\n PHY èŠ¯ç‰‡å¯„å­˜å™¨åœ°å€ç©ºé—´ä¸º 5 ä½ï¼Œåœ°å€ 0-31 å…± 32 ä¸ªå¯„å­˜å™¨ï¼Œ IEEE å®šä¹‰äº† 0-15 è¿™ 16 ä¸ªå¯„å­˜å™¨çš„åŠŸèƒ½ï¼Œ 16~31 è¿™ 16 ä¸ªå¯„å­˜å™¨ç”±å‚å•†è‡ªè¡Œå®ç°ã€‚ ä¹Ÿå°±æ˜¯è¯´ä¸ç®¡ä½ ç”¨çš„å“ªä¸ªå‚å®¶çš„ PHY èŠ¯ç‰‡ï¼Œå…¶ä¸­ 0~15 è¿™ 16 ä¸ªå¯„å­˜å™¨æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚ ä»…é è¿™ 16 ä¸ªå¯„å­˜å™¨æ˜¯å®Œå…¨å¯ä»¥é©±åŠ¨èµ· PHY èŠ¯ç‰‡çš„ï¼Œè‡³å°‘èƒ½ä¿è¯åŸºæœ¬çš„ç½‘ç»œæ•°æ®é€šä¿¡ã€‚\n\n \n\n\n\nè½¬ï¼š\n\n[PHYèŠ¯ç‰‡å¿«é€Ÿæ·±åº¦ç†è§£ï¼ˆæŒç»­æ›´æ–°ä¸­â€¦â€¦ï¼‰-CSDNåšå®¢](https://blog.csdn.net/qq_40715266/article/details/124095801)\n\n\n\n[PHYï¼ˆPhysical Layerï¼ŒPHYï¼‰ - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/148538791)\n","slug":"PHYèŠ¯ç‰‡","published":1,"updated":"2024-05-16T11:51:50.145Z","_id":"clw95434m0001auw046z4fp3s","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"PHYï¼ˆphysical-Layerï¼ŒPHYï¼‰\"><a href=\"#PHYï¼ˆphysical-Layerï¼ŒPHYï¼‰\" class=\"headerlink\" title=\"PHYï¼ˆphysical Layerï¼ŒPHYï¼‰\"></a>PHYï¼ˆphysical Layerï¼ŒPHYï¼‰</h1><h2 id=\"ä»€ä¹ˆæ˜¯PHYï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯PHYï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯PHYï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯PHYï¼Ÿ</h2><p>ç‰©ç†å±‚èŠ¯ç‰‡ç§°ä¸ºPHYã€æ•°æ®é“¾è·¯å±‚èŠ¯ç‰‡ç§°ä¸ºMAC</p>\n<p>å¯ä»¥çœ‹åˆ°PHYçš„æ•°æ®æ˜¯<a href=\"https://so.csdn.net/so/search?q=RJ45&spm=1001.2101.3001.7020\">RJ45</a>ç½‘ç»œæ¥å£ï¼ˆç½‘çº¿å£ï¼‰ç©¿è¿‡äº†çš„å·®åˆ†ä¿¡å·ï¼Œè€ŒPHYä½œç”¨å°±æ˜¯å°†å·®åˆ†ä¿¡å·è½¬ä¸ºæ•°å­—ä¿¡å·ï¼Œè¿™å—å†…å®¹ä¸ç”¨æ·±ç©¶ï¼Œåˆ¶é€ å•†éƒ½è®¾è®¡å¥½äº†ã€‚</p>\n<p>é‚£æˆ‘ä»¬å¹²ä»€ä¹ˆå‘¢ï¼Ÿï¼ˆä¸»è¦æ˜¯å¯¹phyèŠ¯ç‰‡è¿›è¡Œæ¨¡å¼é€‰æ‹©ï¼Œæ¯”å¦‚å·¥ä½œé€Ÿç‡ï¼Œå·¥ä½œæ¨¡å¼ï¼‰</p>\n<h2 id=\"ä»€ä¹ˆæ˜¯RJ45æ¥å£ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯RJ45æ¥å£ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯RJ45æ¥å£ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯RJ45æ¥å£ï¼Ÿ</h2><p>RJ45æ¥å£é€šå¸¸ç”¨äºæ•°æ®ä¼ è¾“ï¼Œæœ€å¸¸è§çš„åº”ç”¨ä¸ºç½‘å¡æ¥å£ã€‚RJ-45ç«¯å£æ˜¯æˆ‘ä»¬æœ€å¸¸è§çš„ç«¯å£ä¹‹ä¸€ï¼Œæ˜¯æ¯”è¾ƒå¸¸è§çš„<a href=\"https://www.zhihu.com/search?q=%E5%8F%8C%E7%BB%9E%E7%BA%BF&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22answer%22,%22sourceId%22:3477234795%7D\">åŒç»çº¿</a>ä»¥å¤ªç½‘ç«¯å£ï¼Œå› ä¸ºåœ¨å¿«é€Ÿä»¥å¤ªç½‘ä¸­ä¹Ÿä¸»è¦é‡‡ç”¨åŒç»çº¿ä½œä¸ºä¼ è¾“ä»‹è´¨ã€‚</p>\n<p>RJ45å‹ç½‘çº¿æ’å¤´åˆç§°æ°´æ™¶å¤´ï¼Œå…±ç”±å…«èŠ¯åšæˆï¼Œå¹¿æ³›åº”ç”¨äºå±€åŸŸç½‘å’ŒADSLå®½å¸¦ä¸Šç½‘ç”¨æˆ·çš„ç½‘ç»œè®¾å¤‡é—´ç½‘çº¿ï¼ˆç§°ä½œäº”ç±»çº¿æˆ–åŒç»çº¿ï¼‰çš„è¿æ¥ã€‚</p>\n<p>RJ45æ¥å¤´æ ¹æ®çº¿çš„æ’åºä¸åŒä¸»è¦åˆ†ä¸¤ç§ï¼Œä¸€ç§æ˜¯æ©™ç™½ã€æ©™ã€ç»¿ç™½ã€è“ã€è“ç™½ã€ç»¿ã€æ£•ç™½ã€æ£•ï¼›å¦ä¸€ç§æ˜¯ç»¿ç™½ã€ç»¿ã€æ©™ç™½ã€è“ã€è“ç™½ã€æ©™ã€æ£•ç™½ã€æ£•ï¼›å› æ­¤ä½¿ç”¨RJ45æ¥å¤´çš„çº¿ä¹Ÿæœ‰ä¸¤ç§å³ï¼šç›´é€šçº¿ã€äº¤å‰çº¿ã€‚åˆ†åˆ«ç§°ä½œ<a href=\"https://www.zhihu.com/search?q=T568A%E7%BA%BF%E5%BA%8F&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22answer%22,%22sourceId%22:3477234795%7D\">T568Açº¿åº</a>å’ŒT568Bçº¿åºã€‚</p>\n<p>RJ45æ’åº§è¿æ¥å™¨æ¥å£å†…éƒ¨æ˜¯é‡‘å±ï¼Œæ³¨æ„ä¸èƒ½å—æ½®æˆ–è€…æ¥è§¦åˆ°æ°´ï¼Œå¦åˆ™ä¼šé€ æˆçŸ­è·¯ç°è±¡ã€‚</p>\n<h2 id=\"ä¸ºä»€ä¹ˆè¦ç†Ÿæ‚‰RJ45ç½‘å£\"><a href=\"#ä¸ºä»€ä¹ˆè¦ç†Ÿæ‚‰RJ45ç½‘å£\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆè¦ç†Ÿæ‚‰RJ45ç½‘å£\"></a>ä¸ºä»€ä¹ˆè¦ç†Ÿæ‚‰RJ45ç½‘å£</h2><p>ä¸Šé¢è¯´åˆ°é’ˆå¯¹phyèŠ¯ç‰‡æˆ‘ä»¬åªè¦è¿›è¡Œæ¨¡å¼é€‰æ‹©ï¼ˆä¸‹æ–‡ä¼šä»‹ç»ä½¿ç”¨<a href=\"https://so.csdn.net/so/search?q=mdio&spm=1001.2101.3001.7020\">mdio</a>æ¥å£ï¼Œé€šè¿‡å¯„å­˜å™¨æ§åˆ¶ï¼‰</p>\n<p>é‚£æ¨¡å¼é€‰æ‹©åï¼Œå¦‚ä½•æŸ¥çœ‹æ˜¯å¦æœ‰æ•ˆå‘¢ï¼Ÿæœ€ç®€å•ç›´æ¥çš„å°±æ˜¯é€šè¿‡RJ45ç½‘å£çš„æŒ‡ç¤ºç¯æŸ¥çœ‹</p>\n<p><img src=\"/../imgs/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_18,color_FFFFFF,t_70,g_se,x_16-17158590663256.png\" alt=\"img\"></p>\n<p>RJ45 åº§å­ä¸Šä¸€èˆ¬æœ‰ä¸¤ä¸ªç¯ï¼Œä¸€ä¸ªé»„è‰²(æ©™è‰²)ï¼Œä¸€ä¸ªç»¿è‰²ï¼Œ<strong>ç»¿è‰²äº®çš„è¯è¡¨ç¤ºç½‘ç»œè¿æ¥æ­£å¸¸ï¼Œé»„è‰²é—ªçƒçš„è¯è¯´æ˜å½“å‰æ­£åœ¨è¿›è¡Œç½‘ç»œé€šä¿¡</strong>ï¼Œ<strong>é»„ç¯é—ªåŠ¨é¢‘ç‡å¿«è¡¨ç¤ºç½‘é€Ÿ</strong>å¥½ï¼Œè¿™ä¸¤ä¸ªç¯ç”± PHY èŠ¯ç‰‡æ§åˆ¶ã€‚</p>\n<h2 id=\"ç½‘ç»œä¸ƒå±‚åè®®\"><a href=\"#ç½‘ç»œä¸ƒå±‚åè®®\" class=\"headerlink\" title=\"ç½‘ç»œä¸ƒå±‚åè®®\"></a>ç½‘ç»œä¸ƒå±‚åè®®</h2><p><img src=\"/../img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_16,color_FFFFFF,t_70,g_se,x_16.png\" alt=\"img\"></p>\n<h2 id=\"ä¸¤ä¸ªæ¨¡å—è¿›è¡Œé€šä¿¡\"><a href=\"#ä¸¤ä¸ªæ¨¡å—è¿›è¡Œé€šä¿¡\" class=\"headerlink\" title=\"ä¸¤ä¸ªæ¨¡å—è¿›è¡Œé€šä¿¡\"></a>ä¸¤ä¸ªæ¨¡å—è¿›è¡Œé€šä¿¡</h2><p>ä¸‹å›¾æ˜¯ä¸¤ä¸ªä¸»æ§ç›´æ¥çš„é€šä¿¡ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„ç”µè„‘ å’Œ è·¯ç”±å™¨ ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰ä¸­é—´çš„ä»‹è´¨è¿˜èƒ½è¿æ¥ç½‘ç»œå—ï¼Ÿç­”æ¡ˆæ˜¯å¯ä»¥çš„</p>\n<p>å¦‚æœphyèŠ¯ç‰‡æ²¡æœ‰ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥é€šè¿‡ä¸¤ä¸ªmacè¿æ¥è¿›è¡Œé€šä¿¡ï¼Œä¹‹æ‰€ä»¥éœ€è¦mac ã€phyã€å˜å‹å™¨çš„ç›®çš„æ˜¯ä¸ºäº†è½¬æ¢æ•°æ®ç±»å‹é€‚é…æ‰€ä»¥çš„ç½‘çº¿ï¼Œä½†æ˜¯åœ¨ä¸€äº›ç”µè·¯ä¸Šï¼Œæ²¡å¿…è¦åŠ è¿™ä¹ˆå¤šä¸œè¥¿</p>\n<p>æ¯”å¦‚æ­è½½ Linuxç³»ç»Ÿçš„armèŠ¯ç‰‡æƒ³è¦ç½‘ç»œï¼Œå¯ä»¥ç›´æ¥é€šè¿‡macå’Œç½‘å¡èŠ¯ç‰‡è¿æ¥è·å–ï¼Œè¿™æ—¶å€™å°±éœ€è¦é€šè¿‡RGMIIæ¥å£æˆ–è€…MIIæ¥å£ å’Œ MDIO è¿æ¥ç½‘å¡èŠ¯ç‰‡ã€‚</p>\n<p>ï¼ˆç½‘å¡èŠ¯ç‰‡å†…ç½®ä¹Ÿæ˜¯mac+phyï¼Œæœ‰çš„åªæœ‰mac å±‚è¿™ä¸ªè¦çœ‹å…·ä½“çš„æ‰‹å†Œï¼‰</p>\n<p><img src=\"/../img/84b0b5e31bb246c0a970ace7c71a3f82.png\" alt=\"img\"></p>\n<h2 id=\"ä»€ä¹ˆæ˜¯MDIOåè®®\"><a href=\"#ä»€ä¹ˆæ˜¯MDIOåè®®\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯MDIOåè®®\"></a>ä»€ä¹ˆæ˜¯MDIOåè®®</h2><p>midoåè®®å³SMIåè®®</p>\n<p>SMIåè®®ä¹Ÿæ˜¯ä¸€ç§é€šä¿¡åè®®ç±»ä¼¼ä¸I2Cåè®®ä½†æ˜¯é€šä¿¡æ–¹å¼ä¸ä¸€æ ·</p>\n<p>SMIåŒ…å«ä¸¤æ ¹ä¿¡å·çº¿ï¼Œä¸€ä¸ªMDCæ—¶é’Ÿçº¿ï¼Œä¸€ä¸ªMDIOåŒå‘ä¼ è¾“çš„æ•°æ®çº¿ï¼Œ</p>\n<p>å¦‚å›¾ä¸ºSMIåº”ç”¨æ¡†å›¾ã€‚STAè®¾å¤‡é€šè¿‡MDIOæ¥å£ä¸PHYé€šä¿¡ã€‚STAï¼ˆStaTIon Managementï¼‰ä¸ºä¸»æ§è®¾å¤‡ï¼Œæ¯”å¦‚MCUã€MACã€ONUç­‰ã€‚PHYä¸ºä»è®¾å¤‡ã€‚ä¸€ä¸ªSTAæœ€å¤šç®¡ç†32ä¸ªPHYã€‚MDCä¿¡å·ç”±STAæ§åˆ¶ï¼ŒMDIOä¿¡å·æ ¹æ®é€šä¿¡æ–¹å¼çš„ä¸åŒå¯ä»¥ç”±STAæˆ–è€…PHYæ¥ç®¡æ§åˆ¶ã€‚å¦‚å›¾é€šå¸¸MDIOä¼šæ¥ä¸€ä¸ªç”µé˜»ä¸Šæ‹‰è‡³æ¥å£ç”µæºã€‚</p>\n<p><img src=\"/../img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_16,color_FFFFFF,t_70,g_se,x_16.png\" alt=\"img\"></p>\n<h2 id=\"MDIOçš„ä½œç”¨\"><a href=\"#MDIOçš„ä½œç”¨\" class=\"headerlink\" title=\"MDIOçš„ä½œç”¨\"></a>MDIOçš„ä½œç”¨</h2><p>ä»ä¸Šé¢çš„è¿æ¥å›¾å¯ä»¥çœ‹åˆ°MDIOæ˜¯ç”¨æ¥è¿æ¥ä¸»è®¾å¤‡å’Œå¤šä¸ªPHYè®¾å¤‡ï¼Œå¹¶ä¸”é€šè¿‡MDIOæ¥ä¼ è¾“æ•°æ®</p>\n<p>é‚£ä¹ˆä¼ è¾“çš„æ˜¯æ•°æ®æ˜¯å“ªäº›å‘¢ï¼Ÿä¸»è¦æ˜¯ä¼ è¾“é“¾æ¥çŠ¶æ€ã€ä¼ è¾“é€Ÿåº¦ä¸é€‰æ‹©ã€æ–­ç”µã€ä½åŠŸç‡<a href=\"https://baike.baidu.com/item/%E4%BC%91%E7%9C%A0%E7%8A%B6%E6%80%81?fromModule=lemma_inlink\">ä¼‘çœ çŠ¶æ€</a>ã€TX&#x2F;RXæ¨¡å¼é€‰æ‹©ã€<a href=\"https://baike.baidu.com/item/%E8%87%AA%E5%8A%A8%E5%8D%8F%E5%95%86/7765053?fromModule=lemma_inlink\">è‡ªåŠ¨åå•†</a>æ§åˆ¶ã€ç¯å›æ¨¡å¼æ§åˆ¶ç­‰ã€‚</p>\n<h3 id=\"MDIOæ²¡é‚£ä¹ˆé‡è¦\"><a href=\"#MDIOæ²¡é‚£ä¹ˆé‡è¦\" class=\"headerlink\" title=\"MDIOæ²¡é‚£ä¹ˆé‡è¦\"></a>MDIOæ²¡é‚£ä¹ˆé‡è¦</h3><p>MDIOåœ¨ä¸Šé¢è¯´åˆ°çš„ä¸¤ä¸ªæ¨¡å—é€šä¿¡ï¼Œæˆ‘æåˆ°äº† armèŠ¯ç‰‡å’Œç½‘å¡èŠ¯ç‰‡ç›´æ¥éœ€è¦ï¼Œé‚£ä¹ˆè¿™ä¸ªçœŸçš„æœ‰å¿…è¦å—ï¼Ÿå…¶å®æ²¡å¿…è¦è¿æ¥ï¼ï¼ï¼</p>\n<p>æ¢ä¸ªè¯è¯´ ä¸è¿æ¥ä¹Ÿå¯ä»¥ä½¿å¾—ç½‘ç»œç•…é€šï¼Œå› ä¸ºç½‘ç»œçš„æ•°æ®ä¼ è¾“æ—¶é RGMIIä¸æ˜¯é MDIOï¼ŒMDIOçš„ä½œç”¨ä»…ä»…åªæ˜¯ç”¨æ¥æŸ¥çœ‹ä¸€äº›çŠ¶æ€å’ŒåŠŸèƒ½ï¼Œè¿˜æœ‰ç®€å•çš„æ§åˆ¶ï¼Œè€Œè¿™äº›ç®€å•çš„æ§åˆ¶æ˜¯å®Œå…¨å¯ä»¥æœ‰ç½‘å¡èŠ¯ç‰‡å†…ç½®å»å†™æ­»ï¼Œarmå±‚åªè¦å’Œç½‘å¡çš„å†™çš„ä¸€ç›´å°±å¯ä»¥é€šè®¯ã€‚</p>\n<p>ä½†æ˜¯ä¸ºä»€ä¹ˆå¾ˆå¤šæ—¶å€™éœ€è¦é€šè¿‡mdioæ¥è¿›è¡Œè¯»å†™æ§åˆ¶ï¼Œè¿™ä¸ªåªæ˜¯åœ¨ç½‘ç»œé€šè®¯æ­£å¸¸åçš„å‡çº§ä¼˜åŒ–ï¼Œç”¨æ¥æ–¹ä¾¿æŸ¥çœ‹çŠ¶æ€ï¼Œå°±åƒå†™äº†ä¸ªå‰ç«¯ç½‘é¡µæ¥çœ‹åå°æ•°æ®ã€‚</p>\n<p>å¦‚æœmidoæ²¡æœ‰è¯»é€šï¼Œæˆ–è€…è¯»å–çš„æ•°æ®æ˜¯0xfffffï¼Œé‚£ä¹ˆä¸ä¸€å®šæ˜¯mdioçš„é—®é¢˜ï¼Œå¾ˆå¤šæ—¶å€™æ˜¯ç½‘å¡æœ¬èº«æ²¡æœ‰å¯åŠ¨ï¼</p>\n<h2 id=\"MDIOè¯»å†™æ—¶åº\"><a href=\"#MDIOè¯»å†™æ—¶åº\" class=\"headerlink\" title=\"MDIOè¯»å†™æ—¶åº\"></a>MDIOè¯»å†™æ—¶åº</h2><p><img src=\"/../img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_18,color_FFFFFF,t_70,g_se,x_16.png\" alt=\"img\"></p>\n<p>Preambleï¼š32bitsçš„å‰å¯¼ç </p>\n<p>Startï¼š2bitçš„å¼€å§‹ä½ã€‚</p>\n<p>OP Codeï¼š2bitsçš„æ“ä½œç ï¼Œ10è¡¨ç¤ºè¯»ï¼Œ01è¡¨ç¤ºå†™ã€‚</p>\n<p>PHYADï¼š5bitsçš„PHYåœ°å€ã€‚</p>\n<p>REGADï¼š5bitsçš„å¯„å­˜å™¨åœ°å€ï¼Œå³è¦è¯»æˆ–å†™çš„å¯„å­˜å™¨ã€‚</p>\n<p>Turn Aroundï¼š2bitsçš„TAï¼Œåœ¨è¯»å‘½ä»¤ä¸­ï¼ŒMDIOåœ¨æ­¤æ—¶ç”±MACé©±åŠ¨æ”¹ä¸ºPHYé©±åŠ¨ï¼Œå¹¶ç­‰å¾…ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸå‡†å¤‡å‘é€æ•°æ®ã€‚åœ¨å†™å‘½ä»¤ä¸­ï¼Œä¸éœ€è¦MDIOæ–¹å‘å‘ç”Ÿå˜åŒ–ï¼Œåˆ™åªæ˜¯ç­‰å¾…ä¸¤ä¸ªæ—¶é’Ÿå‘¨æœŸå‡†å¤‡å†™å…¥æ•°æ®ã€‚</p>\n<p>Dataï¼š16bitsæ•°æ®ï¼Œåœ¨è¯»å‘½ä»¤ä¸­ï¼ŒPHYèŠ¯ç‰‡å°†è¯»åˆ°çš„å¯¹åº”PHYADçš„REGADå¯„å­˜å™¨çš„æ•°æ®å†™åˆ°Dataä¸­ï¼Œåœ¨å†™å‘½ä»¤ä¸­ï¼ŒMACå°†è¦å†™å…¥å¯¹åº”PHYADçš„REGADå¯„å­˜å™¨çš„å€¼å†™å…¥Dataä¸­ã€‚</p>\n<p>Idleï¼šç©ºé—²çŠ¶æ€ï¼Œæ­¤æ—¶MDIOæ— æºé©±åŠ¨ï¼Œå¤„é«˜é˜»çŠ¶æ€ï¼Œä½†ä¸€èˆ¬ç”¨ä¸Šæ‹‰ç”µé˜»ä½¿å…¶å¤„åœ¨é«˜ç”µå¹³ï¼Œä¸Šæ‹‰ç”µé˜»ä¸€èˆ¬ä¸º1.5Kã€‚<br>ä¸ºä»€ä¹ˆè¯´è¯»å–çš„phyæœ€å¤š32ä¸ª<br>å› ä¸ºmdioä¸­è¯»å–çš„phyåªæä¾›5bitçš„å­—èŠ‚å³æœ€é«˜11111 è½¬æˆåè¿›åˆ¶å°±æ˜¯31å³0-31å°±æ˜¯32ä¸ªï¼Œä½†è¿™æ˜¯ä»è¯»å–çš„æ–¹å¼åˆ¤æ–­çš„ï¼Œè€Œmdioè¯»å–æ˜¯ä¾ç…§phyèŠ¯ç‰‡æœ¬èº«åœ°å€ç©ºé—´å°±5ä¸º</p>\n<h2 id=\"ä¸ºä»€ä¹ˆè¯´regåœ°å€æœ€å¤š32ä¸ª\"><a href=\"#ä¸ºä»€ä¹ˆè¯´regåœ°å€æœ€å¤š32ä¸ª\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆè¯´regåœ°å€æœ€å¤š32ä¸ª\"></a>ä¸ºä»€ä¹ˆè¯´regåœ°å€æœ€å¤š32ä¸ª</h2><p>åŒæ ·mdioä¸­è¯»å–çš„regåªæä¾›5bitçš„å­—èŠ‚å³æœ€é«˜11111 è½¬æˆåè¿›åˆ¶å°±æ˜¯31å³0-31å°±æ˜¯32ä¸ª</p>\n<p> PHY èŠ¯ç‰‡å¯„å­˜å™¨åœ°å€ç©ºé—´ä¸º 5 ä½ï¼Œåœ°å€ 0-31 å…± 32 ä¸ªå¯„å­˜å™¨ï¼Œ IEEE å®šä¹‰äº† 0-15 è¿™ 16 ä¸ªå¯„å­˜å™¨çš„åŠŸèƒ½ï¼Œ 16<del>31 è¿™ 16 ä¸ªå¯„å­˜å™¨ç”±å‚å•†è‡ªè¡Œå®ç°ã€‚ ä¹Ÿå°±æ˜¯è¯´ä¸ç®¡ä½ ç”¨çš„å“ªä¸ªå‚å®¶çš„ PHY èŠ¯ç‰‡ï¼Œå…¶ä¸­ 0</del>15 è¿™ 16 ä¸ªå¯„å­˜å™¨æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚ ä»…é è¿™ 16 ä¸ªå¯„å­˜å™¨æ˜¯å®Œå…¨å¯ä»¥é©±åŠ¨èµ· PHY èŠ¯ç‰‡çš„ï¼Œè‡³å°‘èƒ½ä¿è¯åŸºæœ¬çš„ç½‘ç»œæ•°æ®é€šä¿¡ã€‚</p>\n<p>è½¬ï¼š</p>\n<p><a href=\"https://blog.csdn.net/qq_40715266/article/details/124095801\">PHYèŠ¯ç‰‡å¿«é€Ÿæ·±åº¦ç†è§£ï¼ˆæŒç»­æ›´æ–°ä¸­â€¦â€¦ï¼‰-CSDNåšå®¢</a></p>\n<p><a href=\"https://zhuanlan.zhihu.com/p/148538791\">PHYï¼ˆPhysical Layerï¼ŒPHYï¼‰ - çŸ¥ä¹ (zhihu.com)</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"PHYï¼ˆphysical-Layerï¼ŒPHYï¼‰\"><a href=\"#PHYï¼ˆphysical-Layerï¼ŒPHYï¼‰\" class=\"headerlink\" title=\"PHYï¼ˆphysical Layerï¼ŒPHYï¼‰\"></a>PHYï¼ˆphysical Layerï¼ŒPHYï¼‰</h1><h2 id=\"ä»€ä¹ˆæ˜¯PHYï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯PHYï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯PHYï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯PHYï¼Ÿ</h2><p>ç‰©ç†å±‚èŠ¯ç‰‡ç§°ä¸ºPHYã€æ•°æ®é“¾è·¯å±‚èŠ¯ç‰‡ç§°ä¸ºMAC</p>\n<p>å¯ä»¥çœ‹åˆ°PHYçš„æ•°æ®æ˜¯<a href=\"https://so.csdn.net/so/search?q=RJ45&spm=1001.2101.3001.7020\">RJ45</a>ç½‘ç»œæ¥å£ï¼ˆç½‘çº¿å£ï¼‰ç©¿è¿‡äº†çš„å·®åˆ†ä¿¡å·ï¼Œè€ŒPHYä½œç”¨å°±æ˜¯å°†å·®åˆ†ä¿¡å·è½¬ä¸ºæ•°å­—ä¿¡å·ï¼Œè¿™å—å†…å®¹ä¸ç”¨æ·±ç©¶ï¼Œåˆ¶é€ å•†éƒ½è®¾è®¡å¥½äº†ã€‚</p>\n<p>é‚£æˆ‘ä»¬å¹²ä»€ä¹ˆå‘¢ï¼Ÿï¼ˆä¸»è¦æ˜¯å¯¹phyèŠ¯ç‰‡è¿›è¡Œæ¨¡å¼é€‰æ‹©ï¼Œæ¯”å¦‚å·¥ä½œé€Ÿç‡ï¼Œå·¥ä½œæ¨¡å¼ï¼‰</p>\n<h2 id=\"ä»€ä¹ˆæ˜¯RJ45æ¥å£ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯RJ45æ¥å£ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯RJ45æ¥å£ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯RJ45æ¥å£ï¼Ÿ</h2><p>RJ45æ¥å£é€šå¸¸ç”¨äºæ•°æ®ä¼ è¾“ï¼Œæœ€å¸¸è§çš„åº”ç”¨ä¸ºç½‘å¡æ¥å£ã€‚RJ-45ç«¯å£æ˜¯æˆ‘ä»¬æœ€å¸¸è§çš„ç«¯å£ä¹‹ä¸€ï¼Œæ˜¯æ¯”è¾ƒå¸¸è§çš„<a href=\"https://www.zhihu.com/search?q=%E5%8F%8C%E7%BB%9E%E7%BA%BF&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22answer%22,%22sourceId%22:3477234795%7D\">åŒç»çº¿</a>ä»¥å¤ªç½‘ç«¯å£ï¼Œå› ä¸ºåœ¨å¿«é€Ÿä»¥å¤ªç½‘ä¸­ä¹Ÿä¸»è¦é‡‡ç”¨åŒç»çº¿ä½œä¸ºä¼ è¾“ä»‹è´¨ã€‚</p>\n<p>RJ45å‹ç½‘çº¿æ’å¤´åˆç§°æ°´æ™¶å¤´ï¼Œå…±ç”±å…«èŠ¯åšæˆï¼Œå¹¿æ³›åº”ç”¨äºå±€åŸŸç½‘å’ŒADSLå®½å¸¦ä¸Šç½‘ç”¨æˆ·çš„ç½‘ç»œè®¾å¤‡é—´ç½‘çº¿ï¼ˆç§°ä½œäº”ç±»çº¿æˆ–åŒç»çº¿ï¼‰çš„è¿æ¥ã€‚</p>\n<p>RJ45æ¥å¤´æ ¹æ®çº¿çš„æ’åºä¸åŒä¸»è¦åˆ†ä¸¤ç§ï¼Œä¸€ç§æ˜¯æ©™ç™½ã€æ©™ã€ç»¿ç™½ã€è“ã€è“ç™½ã€ç»¿ã€æ£•ç™½ã€æ£•ï¼›å¦ä¸€ç§æ˜¯ç»¿ç™½ã€ç»¿ã€æ©™ç™½ã€è“ã€è“ç™½ã€æ©™ã€æ£•ç™½ã€æ£•ï¼›å› æ­¤ä½¿ç”¨RJ45æ¥å¤´çš„çº¿ä¹Ÿæœ‰ä¸¤ç§å³ï¼šç›´é€šçº¿ã€äº¤å‰çº¿ã€‚åˆ†åˆ«ç§°ä½œ<a href=\"https://www.zhihu.com/search?q=T568A%E7%BA%BF%E5%BA%8F&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22answer%22,%22sourceId%22:3477234795%7D\">T568Açº¿åº</a>å’ŒT568Bçº¿åºã€‚</p>\n<p>RJ45æ’åº§è¿æ¥å™¨æ¥å£å†…éƒ¨æ˜¯é‡‘å±ï¼Œæ³¨æ„ä¸èƒ½å—æ½®æˆ–è€…æ¥è§¦åˆ°æ°´ï¼Œå¦åˆ™ä¼šé€ æˆçŸ­è·¯ç°è±¡ã€‚</p>\n<h2 id=\"ä¸ºä»€ä¹ˆè¦ç†Ÿæ‚‰RJ45ç½‘å£\"><a href=\"#ä¸ºä»€ä¹ˆè¦ç†Ÿæ‚‰RJ45ç½‘å£\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆè¦ç†Ÿæ‚‰RJ45ç½‘å£\"></a>ä¸ºä»€ä¹ˆè¦ç†Ÿæ‚‰RJ45ç½‘å£</h2><p>ä¸Šé¢è¯´åˆ°é’ˆå¯¹phyèŠ¯ç‰‡æˆ‘ä»¬åªè¦è¿›è¡Œæ¨¡å¼é€‰æ‹©ï¼ˆä¸‹æ–‡ä¼šä»‹ç»ä½¿ç”¨<a href=\"https://so.csdn.net/so/search?q=mdio&spm=1001.2101.3001.7020\">mdio</a>æ¥å£ï¼Œé€šè¿‡å¯„å­˜å™¨æ§åˆ¶ï¼‰</p>\n<p>é‚£æ¨¡å¼é€‰æ‹©åï¼Œå¦‚ä½•æŸ¥çœ‹æ˜¯å¦æœ‰æ•ˆå‘¢ï¼Ÿæœ€ç®€å•ç›´æ¥çš„å°±æ˜¯é€šè¿‡RJ45ç½‘å£çš„æŒ‡ç¤ºç¯æŸ¥çœ‹</p>\n<p><img src=\"/../imgs/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_18,color_FFFFFF,t_70,g_se,x_16-17158590663256.png\" alt=\"img\"></p>\n<p>RJ45 åº§å­ä¸Šä¸€èˆ¬æœ‰ä¸¤ä¸ªç¯ï¼Œä¸€ä¸ªé»„è‰²(æ©™è‰²)ï¼Œä¸€ä¸ªç»¿è‰²ï¼Œ<strong>ç»¿è‰²äº®çš„è¯è¡¨ç¤ºç½‘ç»œè¿æ¥æ­£å¸¸ï¼Œé»„è‰²é—ªçƒçš„è¯è¯´æ˜å½“å‰æ­£åœ¨è¿›è¡Œç½‘ç»œé€šä¿¡</strong>ï¼Œ<strong>é»„ç¯é—ªåŠ¨é¢‘ç‡å¿«è¡¨ç¤ºç½‘é€Ÿ</strong>å¥½ï¼Œè¿™ä¸¤ä¸ªç¯ç”± PHY èŠ¯ç‰‡æ§åˆ¶ã€‚</p>\n<h2 id=\"ç½‘ç»œä¸ƒå±‚åè®®\"><a href=\"#ç½‘ç»œä¸ƒå±‚åè®®\" class=\"headerlink\" title=\"ç½‘ç»œä¸ƒå±‚åè®®\"></a>ç½‘ç»œä¸ƒå±‚åè®®</h2><p><img src=\"/../img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_16,color_FFFFFF,t_70,g_se,x_16.png\" alt=\"img\"></p>\n<h2 id=\"ä¸¤ä¸ªæ¨¡å—è¿›è¡Œé€šä¿¡\"><a href=\"#ä¸¤ä¸ªæ¨¡å—è¿›è¡Œé€šä¿¡\" class=\"headerlink\" title=\"ä¸¤ä¸ªæ¨¡å—è¿›è¡Œé€šä¿¡\"></a>ä¸¤ä¸ªæ¨¡å—è¿›è¡Œé€šä¿¡</h2><p>ä¸‹å›¾æ˜¯ä¸¤ä¸ªä¸»æ§ç›´æ¥çš„é€šä¿¡ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„ç”µè„‘ å’Œ è·¯ç”±å™¨ ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰ä¸­é—´çš„ä»‹è´¨è¿˜èƒ½è¿æ¥ç½‘ç»œå—ï¼Ÿç­”æ¡ˆæ˜¯å¯ä»¥çš„</p>\n<p>å¦‚æœphyèŠ¯ç‰‡æ²¡æœ‰ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥é€šè¿‡ä¸¤ä¸ªmacè¿æ¥è¿›è¡Œé€šä¿¡ï¼Œä¹‹æ‰€ä»¥éœ€è¦mac ã€phyã€å˜å‹å™¨çš„ç›®çš„æ˜¯ä¸ºäº†è½¬æ¢æ•°æ®ç±»å‹é€‚é…æ‰€ä»¥çš„ç½‘çº¿ï¼Œä½†æ˜¯åœ¨ä¸€äº›ç”µè·¯ä¸Šï¼Œæ²¡å¿…è¦åŠ è¿™ä¹ˆå¤šä¸œè¥¿</p>\n<p>æ¯”å¦‚æ­è½½ Linuxç³»ç»Ÿçš„armèŠ¯ç‰‡æƒ³è¦ç½‘ç»œï¼Œå¯ä»¥ç›´æ¥é€šè¿‡macå’Œç½‘å¡èŠ¯ç‰‡è¿æ¥è·å–ï¼Œè¿™æ—¶å€™å°±éœ€è¦é€šè¿‡RGMIIæ¥å£æˆ–è€…MIIæ¥å£ å’Œ MDIO è¿æ¥ç½‘å¡èŠ¯ç‰‡ã€‚</p>\n<p>ï¼ˆç½‘å¡èŠ¯ç‰‡å†…ç½®ä¹Ÿæ˜¯mac+phyï¼Œæœ‰çš„åªæœ‰mac å±‚è¿™ä¸ªè¦çœ‹å…·ä½“çš„æ‰‹å†Œï¼‰</p>\n<p><img src=\"/../img/84b0b5e31bb246c0a970ace7c71a3f82.png\" alt=\"img\"></p>\n<h2 id=\"ä»€ä¹ˆæ˜¯MDIOåè®®\"><a href=\"#ä»€ä¹ˆæ˜¯MDIOåè®®\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯MDIOåè®®\"></a>ä»€ä¹ˆæ˜¯MDIOåè®®</h2><p>midoåè®®å³SMIåè®®</p>\n<p>SMIåè®®ä¹Ÿæ˜¯ä¸€ç§é€šä¿¡åè®®ç±»ä¼¼ä¸I2Cåè®®ä½†æ˜¯é€šä¿¡æ–¹å¼ä¸ä¸€æ ·</p>\n<p>SMIåŒ…å«ä¸¤æ ¹ä¿¡å·çº¿ï¼Œä¸€ä¸ªMDCæ—¶é’Ÿçº¿ï¼Œä¸€ä¸ªMDIOåŒå‘ä¼ è¾“çš„æ•°æ®çº¿ï¼Œ</p>\n<p>å¦‚å›¾ä¸ºSMIåº”ç”¨æ¡†å›¾ã€‚STAè®¾å¤‡é€šè¿‡MDIOæ¥å£ä¸PHYé€šä¿¡ã€‚STAï¼ˆStaTIon Managementï¼‰ä¸ºä¸»æ§è®¾å¤‡ï¼Œæ¯”å¦‚MCUã€MACã€ONUç­‰ã€‚PHYä¸ºä»è®¾å¤‡ã€‚ä¸€ä¸ªSTAæœ€å¤šç®¡ç†32ä¸ªPHYã€‚MDCä¿¡å·ç”±STAæ§åˆ¶ï¼ŒMDIOä¿¡å·æ ¹æ®é€šä¿¡æ–¹å¼çš„ä¸åŒå¯ä»¥ç”±STAæˆ–è€…PHYæ¥ç®¡æ§åˆ¶ã€‚å¦‚å›¾é€šå¸¸MDIOä¼šæ¥ä¸€ä¸ªç”µé˜»ä¸Šæ‹‰è‡³æ¥å£ç”µæºã€‚</p>\n<p><img src=\"/../img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_16,color_FFFFFF,t_70,g_se,x_16.png\" alt=\"img\"></p>\n<h2 id=\"MDIOçš„ä½œç”¨\"><a href=\"#MDIOçš„ä½œç”¨\" class=\"headerlink\" title=\"MDIOçš„ä½œç”¨\"></a>MDIOçš„ä½œç”¨</h2><p>ä»ä¸Šé¢çš„è¿æ¥å›¾å¯ä»¥çœ‹åˆ°MDIOæ˜¯ç”¨æ¥è¿æ¥ä¸»è®¾å¤‡å’Œå¤šä¸ªPHYè®¾å¤‡ï¼Œå¹¶ä¸”é€šè¿‡MDIOæ¥ä¼ è¾“æ•°æ®</p>\n<p>é‚£ä¹ˆä¼ è¾“çš„æ˜¯æ•°æ®æ˜¯å“ªäº›å‘¢ï¼Ÿä¸»è¦æ˜¯ä¼ è¾“é“¾æ¥çŠ¶æ€ã€ä¼ è¾“é€Ÿåº¦ä¸é€‰æ‹©ã€æ–­ç”µã€ä½åŠŸç‡<a href=\"https://baike.baidu.com/item/%E4%BC%91%E7%9C%A0%E7%8A%B6%E6%80%81?fromModule=lemma_inlink\">ä¼‘çœ çŠ¶æ€</a>ã€TX&#x2F;RXæ¨¡å¼é€‰æ‹©ã€<a href=\"https://baike.baidu.com/item/%E8%87%AA%E5%8A%A8%E5%8D%8F%E5%95%86/7765053?fromModule=lemma_inlink\">è‡ªåŠ¨åå•†</a>æ§åˆ¶ã€ç¯å›æ¨¡å¼æ§åˆ¶ç­‰ã€‚</p>\n<h3 id=\"MDIOæ²¡é‚£ä¹ˆé‡è¦\"><a href=\"#MDIOæ²¡é‚£ä¹ˆé‡è¦\" class=\"headerlink\" title=\"MDIOæ²¡é‚£ä¹ˆé‡è¦\"></a>MDIOæ²¡é‚£ä¹ˆé‡è¦</h3><p>MDIOåœ¨ä¸Šé¢è¯´åˆ°çš„ä¸¤ä¸ªæ¨¡å—é€šä¿¡ï¼Œæˆ‘æåˆ°äº† armèŠ¯ç‰‡å’Œç½‘å¡èŠ¯ç‰‡ç›´æ¥éœ€è¦ï¼Œé‚£ä¹ˆè¿™ä¸ªçœŸçš„æœ‰å¿…è¦å—ï¼Ÿå…¶å®æ²¡å¿…è¦è¿æ¥ï¼ï¼ï¼</p>\n<p>æ¢ä¸ªè¯è¯´ ä¸è¿æ¥ä¹Ÿå¯ä»¥ä½¿å¾—ç½‘ç»œç•…é€šï¼Œå› ä¸ºç½‘ç»œçš„æ•°æ®ä¼ è¾“æ—¶é RGMIIä¸æ˜¯é MDIOï¼ŒMDIOçš„ä½œç”¨ä»…ä»…åªæ˜¯ç”¨æ¥æŸ¥çœ‹ä¸€äº›çŠ¶æ€å’ŒåŠŸèƒ½ï¼Œè¿˜æœ‰ç®€å•çš„æ§åˆ¶ï¼Œè€Œè¿™äº›ç®€å•çš„æ§åˆ¶æ˜¯å®Œå…¨å¯ä»¥æœ‰ç½‘å¡èŠ¯ç‰‡å†…ç½®å»å†™æ­»ï¼Œarmå±‚åªè¦å’Œç½‘å¡çš„å†™çš„ä¸€ç›´å°±å¯ä»¥é€šè®¯ã€‚</p>\n<p>ä½†æ˜¯ä¸ºä»€ä¹ˆå¾ˆå¤šæ—¶å€™éœ€è¦é€šè¿‡mdioæ¥è¿›è¡Œè¯»å†™æ§åˆ¶ï¼Œè¿™ä¸ªåªæ˜¯åœ¨ç½‘ç»œé€šè®¯æ­£å¸¸åçš„å‡çº§ä¼˜åŒ–ï¼Œç”¨æ¥æ–¹ä¾¿æŸ¥çœ‹çŠ¶æ€ï¼Œå°±åƒå†™äº†ä¸ªå‰ç«¯ç½‘é¡µæ¥çœ‹åå°æ•°æ®ã€‚</p>\n<p>å¦‚æœmidoæ²¡æœ‰è¯»é€šï¼Œæˆ–è€…è¯»å–çš„æ•°æ®æ˜¯0xfffffï¼Œé‚£ä¹ˆä¸ä¸€å®šæ˜¯mdioçš„é—®é¢˜ï¼Œå¾ˆå¤šæ—¶å€™æ˜¯ç½‘å¡æœ¬èº«æ²¡æœ‰å¯åŠ¨ï¼</p>\n<h2 id=\"MDIOè¯»å†™æ—¶åº\"><a href=\"#MDIOè¯»å†™æ—¶åº\" class=\"headerlink\" title=\"MDIOè¯»å†™æ—¶åº\"></a>MDIOè¯»å†™æ—¶åº</h2><p><img src=\"/../img/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAZGFpc3kuc2t5ZQ==,size_18,color_FFFFFF,t_70,g_se,x_16.png\" alt=\"img\"></p>\n<p>Preambleï¼š32bitsçš„å‰å¯¼ç </p>\n<p>Startï¼š2bitçš„å¼€å§‹ä½ã€‚</p>\n<p>OP Codeï¼š2bitsçš„æ“ä½œç ï¼Œ10è¡¨ç¤ºè¯»ï¼Œ01è¡¨ç¤ºå†™ã€‚</p>\n<p>PHYADï¼š5bitsçš„PHYåœ°å€ã€‚</p>\n<p>REGADï¼š5bitsçš„å¯„å­˜å™¨åœ°å€ï¼Œå³è¦è¯»æˆ–å†™çš„å¯„å­˜å™¨ã€‚</p>\n<p>Turn Aroundï¼š2bitsçš„TAï¼Œåœ¨è¯»å‘½ä»¤ä¸­ï¼ŒMDIOåœ¨æ­¤æ—¶ç”±MACé©±åŠ¨æ”¹ä¸ºPHYé©±åŠ¨ï¼Œå¹¶ç­‰å¾…ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸå‡†å¤‡å‘é€æ•°æ®ã€‚åœ¨å†™å‘½ä»¤ä¸­ï¼Œä¸éœ€è¦MDIOæ–¹å‘å‘ç”Ÿå˜åŒ–ï¼Œåˆ™åªæ˜¯ç­‰å¾…ä¸¤ä¸ªæ—¶é’Ÿå‘¨æœŸå‡†å¤‡å†™å…¥æ•°æ®ã€‚</p>\n<p>Dataï¼š16bitsæ•°æ®ï¼Œåœ¨è¯»å‘½ä»¤ä¸­ï¼ŒPHYèŠ¯ç‰‡å°†è¯»åˆ°çš„å¯¹åº”PHYADçš„REGADå¯„å­˜å™¨çš„æ•°æ®å†™åˆ°Dataä¸­ï¼Œåœ¨å†™å‘½ä»¤ä¸­ï¼ŒMACå°†è¦å†™å…¥å¯¹åº”PHYADçš„REGADå¯„å­˜å™¨çš„å€¼å†™å…¥Dataä¸­ã€‚</p>\n<p>Idleï¼šç©ºé—²çŠ¶æ€ï¼Œæ­¤æ—¶MDIOæ— æºé©±åŠ¨ï¼Œå¤„é«˜é˜»çŠ¶æ€ï¼Œä½†ä¸€èˆ¬ç”¨ä¸Šæ‹‰ç”µé˜»ä½¿å…¶å¤„åœ¨é«˜ç”µå¹³ï¼Œä¸Šæ‹‰ç”µé˜»ä¸€èˆ¬ä¸º1.5Kã€‚<br>ä¸ºä»€ä¹ˆè¯´è¯»å–çš„phyæœ€å¤š32ä¸ª<br>å› ä¸ºmdioä¸­è¯»å–çš„phyåªæä¾›5bitçš„å­—èŠ‚å³æœ€é«˜11111 è½¬æˆåè¿›åˆ¶å°±æ˜¯31å³0-31å°±æ˜¯32ä¸ªï¼Œä½†è¿™æ˜¯ä»è¯»å–çš„æ–¹å¼åˆ¤æ–­çš„ï¼Œè€Œmdioè¯»å–æ˜¯ä¾ç…§phyèŠ¯ç‰‡æœ¬èº«åœ°å€ç©ºé—´å°±5ä¸º</p>\n<h2 id=\"ä¸ºä»€ä¹ˆè¯´regåœ°å€æœ€å¤š32ä¸ª\"><a href=\"#ä¸ºä»€ä¹ˆè¯´regåœ°å€æœ€å¤š32ä¸ª\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆè¯´regåœ°å€æœ€å¤š32ä¸ª\"></a>ä¸ºä»€ä¹ˆè¯´regåœ°å€æœ€å¤š32ä¸ª</h2><p>åŒæ ·mdioä¸­è¯»å–çš„regåªæä¾›5bitçš„å­—èŠ‚å³æœ€é«˜11111 è½¬æˆåè¿›åˆ¶å°±æ˜¯31å³0-31å°±æ˜¯32ä¸ª</p>\n<p> PHY èŠ¯ç‰‡å¯„å­˜å™¨åœ°å€ç©ºé—´ä¸º 5 ä½ï¼Œåœ°å€ 0-31 å…± 32 ä¸ªå¯„å­˜å™¨ï¼Œ IEEE å®šä¹‰äº† 0-15 è¿™ 16 ä¸ªå¯„å­˜å™¨çš„åŠŸèƒ½ï¼Œ 16<del>31 è¿™ 16 ä¸ªå¯„å­˜å™¨ç”±å‚å•†è‡ªè¡Œå®ç°ã€‚ ä¹Ÿå°±æ˜¯è¯´ä¸ç®¡ä½ ç”¨çš„å“ªä¸ªå‚å®¶çš„ PHY èŠ¯ç‰‡ï¼Œå…¶ä¸­ 0</del>15 è¿™ 16 ä¸ªå¯„å­˜å™¨æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚ ä»…é è¿™ 16 ä¸ªå¯„å­˜å™¨æ˜¯å®Œå…¨å¯ä»¥é©±åŠ¨èµ· PHY èŠ¯ç‰‡çš„ï¼Œè‡³å°‘èƒ½ä¿è¯åŸºæœ¬çš„ç½‘ç»œæ•°æ®é€šä¿¡ã€‚</p>\n<p>è½¬ï¼š</p>\n<p><a href=\"https://blog.csdn.net/qq_40715266/article/details/124095801\">PHYèŠ¯ç‰‡å¿«é€Ÿæ·±åº¦ç†è§£ï¼ˆæŒç»­æ›´æ–°ä¸­â€¦â€¦ï¼‰-CSDNåšå®¢</a></p>\n<p><a href=\"https://zhuanlan.zhihu.com/p/148538791\">PHYï¼ˆPhysical Layerï¼ŒPHYï¼‰ - çŸ¥ä¹ (zhihu.com)</a></p>\n"}],"PostAsset":[],"PostCategory":[{"post_id":"clvjcoaak0000r9w096yq3vus","category_id":"clvjcoaap0002r9w0crcqdq03","_id":"clvjcoaaw000cr9w08o1qg2p3"},{"post_id":"clvjcoaao0001r9w0de539y4w","category_id":"clvjcoaap0002r9w0crcqdq03","_id":"clvjcoaax000gr9w0ehtae99g"},{"post_id":"clvjcoaav000ar9w07gr4ho88","category_id":"clvjcoaap0002r9w0crcqdq03","_id":"clvjcoaax000kr9w0f4ky7c51"},{"post_id":"clvjcoaaw000er9w08cjhb54a","category_id":"clvjcoaap0002r9w0crcqdq03","_id":"clvjcoaay000lr9w0e3ria1o6"},{"post_id":"clvjcoaar0004r9w0en6ne5w9","category_id":"clvjcoaav000br9w04s5fhod2","_id":"clvjcoaay000or9w00pce3443"},{"post_id":"clvjcoaas0005r9w0fujveufw","category_id":"clvjcoaax000ir9w04u7q98wg","_id":"clvjcoaaz000sr9w0djz70avq"},{"post_id":"clvjcoaas0006r9w0ciswdc7c","category_id":"clvjcoaav000br9w04s5fhod2","_id":"clvjcoaaz000vr9w017tt2vjp"},{"post_id":"clvjcoaau0009r9w09xzi7r99","category_id":"clvjcoaav000br9w04s5fhod2","_id":"clvjcoab0000xr9w0426fd2m5"},{"post_id":"clw7gjvto00004zw06cc94zms","category_id":"clw7gjvtt00024zw0fh4pclyx","_id":"clw7gjvtx00084zw03eyl828h"},{"post_id":"clw7gjvtv00044zw001hi1y1n","category_id":"clw7gupas000164w0bopbhhya","_id":"clw7gupat000564w05o3563ug"},{"post_id":"clw7gjvtr00014zw0fnm7f1ci","category_id":"clw7gupat000364w0drn50ao5","_id":"clw7gupau000664w072cd3et3"},{"post_id":"clw7y3oy60000zfapahvk834m","category_id":"clw7gupas000164w0bopbhhya","_id":"clw7y3oye0002zfapcfp3hcq1"},{"post_id":"clw8xrfbp00009gw0cohxazat","category_id":"clvjcoaax000ir9w04u7q98wg","_id":"clw8xrfbz00039gw03vt392oi"},{"post_id":"clw8xrfby00029gw0eobh98nt","category_id":"clvjcoaax000ir9w04u7q98wg","_id":"clw8xrfc000069gw07omohu0b"},{"post_id":"clw95434m0001auw046z4fp3s","category_id":"clvjcoaav000br9w04s5fhod2","_id":"clw95434t0005auw07iq42zh6"}],"PostTag":[{"post_id":"clvjcoaak0000r9w096yq3vus","tag_id":"clvjcoaaq0003r9w08ymn3cfp","_id":"clvjcoaax000fr9w02xtp3tin"},{"post_id":"clvjcoaak0000r9w096yq3vus","tag_id":"clvjcoaat0008r9w05igj2bah","_id":"clvjcoaax000hr9w0gehbfdrt"},{"post_id":"clvjcoaao0001r9w0de539y4w","tag_id":"clvjcoaaw000dr9w04q1p9cdh","_id":"clvjcoaay000pr9w04nsc72sp"},{"post_id":"clvjcoaao0001r9w0de539y4w","tag_id":"clvjcoaat0008r9w05igj2bah","_id":"clvjcoaaz000qr9w0bnjl71ed"},{"post_id":"clvjcoaar0004r9w0en6ne5w9","tag_id":"clvjcoaay000nr9w0c45zbyxp","_id":"clvjcoaaz000ur9w01h1d21ws"},{"post_id":"clvjcoaas0005r9w0fujveufw","tag_id":"clvjcoaaz000tr9w0a5za0wkx","_id":"clvjcoab0000zr9w06rk38a4e"},{"post_id":"clvjcoaas0005r9w0fujveufw","tag_id":"clvjcoaaz000wr9w0a7ntbfe6","_id":"clvjcoab00010r9w0ajuncswp"},{"post_id":"clvjcoaas0006r9w0ciswdc7c","tag_id":"clvjcoaay000nr9w0c45zbyxp","_id":"clvjcoab00012r9w0b9ve9luz"},{"post_id":"clvjcoaau0009r9w09xzi7r99","tag_id":"clvjcoaay000nr9w0c45zbyxp","_id":"clvjcoab10014r9w048v69qhr"},{"post_id":"clvjcoaav000ar9w07gr4ho88","tag_id":"clvjcoab00013r9w0c8xwbm67","_id":"clvjcoab10016r9w07u1chj94"},{"post_id":"clvjcoaav000ar9w07gr4ho88","tag_id":"clvjcoaat0008r9w05igj2bah","_id":"clvjcoab10017r9w06r3w5vfb"},{"post_id":"clvjcoaaw000er9w08cjhb54a","tag_id":"clvjcoab10015r9w0gy9m55qe","_id":"clvjcoab10018r9w00o6f31ht"},{"post_id":"clvjcoaaw000er9w08cjhb54a","tag_id":"clvjcoaat0008r9w05igj2bah","_id":"clvjcoab10019r9w0bne6eeju"},{"post_id":"clw7gjvtv00044zw001hi1y1n","tag_id":"clw7gjvtx00094zw03hlaf5nx","_id":"clw7gjvty000e4zw0hb5cb7g4"},{"post_id":"clw7gjvtv00044zw001hi1y1n","tag_id":"clw7gjvtx000b4zw073y0bgcy","_id":"clw7gjvty000f4zw0114f3d1e"},{"post_id":"clw7gjvtv00044zw001hi1y1n","tag_id":"clw7gjvtx000c4zw04prpfaj1","_id":"clw7gjvty000g4zw06kgv5plx"},{"post_id":"clw7gjvtr00014zw0fnm7f1ci","tag_id":"clw7gjvtu00034zw01k8ceqqd","_id":"clw7gupat000264w0a1wu7io7"},{"post_id":"clw7gjvto00004zw06cc94zms","tag_id":"clw7gupao000064w0fvoobl7z","_id":"clw7gupat000464w0gs92a2g2"},{"post_id":"clw7y3oy60000zfapahvk834m","tag_id":"clw7y3oyb0001zfaphpdt0wj3","_id":"clw7y3oye0003zfap8b679qb4"},{"post_id":"clw8xrfbp00009gw0cohxazat","tag_id":"clw8xrfbw00019gw0blydb92o","_id":"clw8xrfc000059gw09e0j2bi1"},{"post_id":"clw8xrfby00029gw0eobh98nt","tag_id":"clw8xrfbz00049gw025d8fta2","_id":"clw8xrfc000079gw00xnihtux"},{"post_id":"clw95434m0001auw046z4fp3s","tag_id":"clw95434q0003auw0arpwg82o","_id":"clw95434t0006auw0dn4t41a8"}],"Tag":[{"name":"å­¦ä¹ ç½‘ç«™","_id":"clvjcoaaq0003r9w08ymn3cfp"},{"name":"rust","_id":"clvjcoaat0008r9w05igj2bah"},{"name":"rustç¯å¢ƒæ­å»º","_id":"clvjcoaaw000dr9w04q1p9cdh"},{"name":"test","_id":"clvjcoaay000nr9w0c45zbyxp"},{"name":"power","_id":"clvjcoaaz000tr9w0a5za0wkx"},{"name":"cpufreq","_id":"clvjcoaaz000wr9w0a7ntbfe6"},{"name":"ruståŸºæœ¬ç±»å‹","_id":"clvjcoab00013r9w0c8xwbm67"},{"name":"rustå¤åˆç±»å‹","_id":"clvjcoab10015r9w0gy9m55qe"},{"name":"block","_id":"clw7gjvtu00034zw01k8ceqqd"},{"name":"uboot","_id":"clw7gjvtw00064zw07bp6f6uj"},{"name":"fdt","_id":"clw7gjvtx00094zw03hlaf5nx"},{"name":"GPT","_id":"clw7gjvtx000b4zw073y0bgcy"},{"name":"rk3588","_id":"clw7gjvtx000c4zw04prpfaj1"},{"name":"vsfs","_id":"clw7gupao000064w0fvoobl7z"},{"name":"ubootæ¦‚å¿µ","_id":"clw7y3oyb0001zfaphpdt0wj3"},{"name":"cgroup","_id":"clw8xrfbw00019gw0blydb92o"},{"name":"pinctrl","_id":"clw8xrfbz00049gw025d8fta2"},{"name":"PHYèŠ¯ç‰‡","_id":"clw95434q0003auw0arpwg82o"}]}}